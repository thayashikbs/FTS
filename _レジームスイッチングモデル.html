<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>7 レジーム・スイッチング・モデル | 金融時系列解析</title>
  <meta name="description" content="7 レジーム・スイッチング・モデル | 金融時系列解析" />
  <meta name="generator" content="bookdown 0.40 and GitBook 2.6.7" />

  <meta property="og:title" content="7 レジーム・スイッチング・モデル | 金融時系列解析" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="7 レジーム・スイッチング・モデル | 金融時系列解析" />
  
  
  

<meta name="author" content="林 高樹" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="長期記憶過程.html"/>
<link rel="next" href="garchモデル.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> はじめに</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#時系列モデリング"><i class="fa fa-check"></i><b>1.1</b> 時系列モデリング</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#金融時系列データの特徴"><i class="fa fa-check"></i><b>1.2</b> 金融時系列データの特徴</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#金融時系列データの特徴-みずほ-8411-株価データの例"><i class="fa fa-check"></i>金融時系列データの特徴: みずほ (8411) 株価データの例</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#シミュレーションによるサンプルパス生成"><i class="fa fa-check"></i><b>1.3</b> シミュレーションによるサンプルパス生成</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#rにおける時系列オブジェクトクラスおよび関数の例"><i class="fa fa-check"></i><b>1.4</b> Rにおける時系列オブジェクト・クラスおよび関数の例</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="index.html"><a href="index.html#日付時間データに対するクラス"><i class="fa fa-check"></i><b>1.4.1</b> 日付・時間データに対するクラス</a></li>
<li class="chapter" data-level="1.4.2" data-path="index.html"><a href="index.html#時系列データに対するクラス1-tsクラス"><i class="fa fa-check"></i><b>1.4.2</b> 時系列データに対するクラス(1): tsクラス</a></li>
<li class="chapter" data-level="1.4.3" data-path="index.html"><a href="index.html#時系列データに対するクラス2-zooクラスとxtsクラス"><i class="fa fa-check"></i><b>1.4.3</b> 時系列データに対するクラス(2): zooクラスとxtsクラス</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#時系列データの分解"><i class="fa fa-check"></i><b>1.5</b> 時系列データの分解</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="index.html"><a href="index.html#トレンド抽出-平滑化-smoothing"><i class="fa fa-check"></i><b>1.5.1</b> トレンド抽出, 平滑化 (smoothing)</a></li>
<li class="chapter" data-level="1.5.2" data-path="index.html"><a href="index.html#分解モデル"><i class="fa fa-check"></i><b>1.5.2</b> 分解モデル</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="定常性と自己相関関数.html"><a href="定常性と自己相関関数.html"><i class="fa fa-check"></i><b>2</b> 定常性と自己相関関数</a>
<ul>
<li class="chapter" data-level="2.1" data-path="定常性と自己相関関数.html"><a href="定常性と自己相関関数.html#確率過程の2次特性-平均関数と自己共分散関数"><i class="fa fa-check"></i><b>2.1</b> 確率過程の2次特性: 平均関数と自己共分散関数</a></li>
<li class="chapter" data-level="2.2" data-path="定常性と自己相関関数.html"><a href="定常性と自己相関関数.html#定常性-stationarity"><i class="fa fa-check"></i><b>2.2</b> 定常性 (stationarity)</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="定常性と自己相関関数.html"><a href="定常性と自己相関関数.html#強定常性"><i class="fa fa-check"></i><b>2.2.1</b> 強定常性</a></li>
<li class="chapter" data-level="2.2.2" data-path="定常性と自己相関関数.html"><a href="定常性と自己相関関数.html#弱定常性"><i class="fa fa-check"></i><b>2.2.2</b> 弱定常性</a></li>
<li class="chapter" data-level="2.2.3" data-path="定常性と自己相関関数.html"><a href="定常性と自己相関関数.html#ホワイトノイズ"><i class="fa fa-check"></i><b>2.2.3</b> ホワイトノイズ</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="定常性と自己相関関数.html"><a href="定常性と自己相関関数.html#標本平均と標本自己共分散関数"><i class="fa fa-check"></i><b>2.3</b> 標本平均と標本自己共分散関数</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="定常性と自己相関関数.html"><a href="定常性と自己相関関数.html#アンサンブル平均-vs-標本平均"><i class="fa fa-check"></i><b>2.3.1</b> アンサンブル平均 vs 標本平均</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="定常性と自己相関関数.html"><a href="定常性と自己相関関数.html#r操作-標本acf"><i class="fa fa-check"></i><b>2.4</b> R操作: 標本ACF</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="定常性と自己相関関数.html"><a href="定常性と自己相関関数.html#白色ノイズ"><i class="fa fa-check"></i><b>2.4.1</b> 白色ノイズ</a></li>
<li class="chapter" data-level="2.4.2" data-path="定常性と自己相関関数.html"><a href="定常性と自己相関関数.html#ランダムウォーク"><i class="fa fa-check"></i><b>2.4.2</b> ランダムウォーク</a></li>
<li class="chapter" data-level="2.4.3" data-path="定常性と自己相関関数.html"><a href="定常性と自己相関関数.html#非定常成分を含む時系列"><i class="fa fa-check"></i><b>2.4.3</b> 非定常成分を含む時系列</a></li>
<li class="chapter" data-level="2.4.4" data-path="定常性と自己相関関数.html"><a href="定常性と自己相関関数.html#線形定常時系列モデル"><i class="fa fa-check"></i><b>2.4.4</b> 線形・定常時系列モデル</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="定常性と自己相関関数.html"><a href="定常性と自己相関関数.html#母acf-vs-標本acf"><i class="fa fa-check"></i><b>2.5</b> 母ACF vs 標本ACF</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="armapqモデル.html"><a href="armapqモデル.html"><i class="fa fa-check"></i><b>3</b> ARMA<span class="math inline">\((p,q)\)</span>モデル</a>
<ul>
<li class="chapter" data-level="3.1" data-path="armapqモデル.html"><a href="armapqモデル.html#armapqモデルとは"><i class="fa fa-check"></i><b>3.1</b> ARMA<span class="math inline">\((p,q)\)</span>モデルとは</a>
<ul>
<li class="chapter" data-level="" data-path="armapqモデル.html"><a href="armapqモデル.html#因果性と反転可能性"><i class="fa fa-check"></i>因果性と反転可能性</a></li>
<li class="chapter" data-level="" data-path="armapqモデル.html"><a href="armapqモデル.html#armapqモデルの意義"><i class="fa fa-check"></i>ARMA<span class="math inline">\((p,q)\)</span>モデルの意義</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="armapqモデル.html"><a href="armapqモデル.html#armapqモデルによる予測"><i class="fa fa-check"></i><b>3.2</b> ARMA<span class="math inline">\((p,q)\)</span>モデルによる予測</a></li>
<li class="chapter" data-level="3.3" data-path="armapqモデル.html"><a href="armapqモデル.html#armapqモデルの推定"><i class="fa fa-check"></i><b>3.3</b> ARMA<span class="math inline">\((p,q)\)</span>モデルの推定</a></li>
<li class="chapter" data-level="3.4" data-path="armapqモデル.html"><a href="armapqモデル.html#armapqモデルの同定-次数の特定"><i class="fa fa-check"></i><b>3.4</b> ARMA<span class="math inline">\((p,q)\)</span>モデルの同定 (次数の特定)</a></li>
<li class="chapter" data-level="3.5" data-path="armapqモデル.html"><a href="armapqモデル.html#r操作"><i class="fa fa-check"></i><b>3.5</b> R操作</a>
<ul>
<li class="chapter" data-level="" data-path="armapqモデル.html"><a href="armapqモデル.html#armapqモデルの同定-acfpacfeacfの利用"><i class="fa fa-check"></i>ARMA<span class="math inline">\((p,q)\)</span>モデルの同定 (ACF/PACF/EACFの利用)</a></li>
<li class="chapter" data-level="" data-path="armapqモデル.html"><a href="armapqモデル.html#armapqモデルの推定診断"><i class="fa fa-check"></i>ARMA<span class="math inline">\((p,q)\)</span>モデルの推定・診断</a></li>
<li class="chapter" data-level="" data-path="armapqモデル.html"><a href="armapqモデル.html#パッケージforecastの利用"><i class="fa fa-check"></i>パッケージ{forecast}の利用</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="armapqモデル.html"><a href="armapqモデル.html#データ分析例-tsay-ch2より"><i class="fa fa-check"></i><b>3.6</b> データ分析例 (Tsay, Ch2より)</a>
<ul>
<li class="chapter" data-level="" data-path="armapqモデル.html"><a href="armapqモデル.html#標本acf"><i class="fa fa-check"></i>標本ACF</a></li>
<li class="chapter" data-level="" data-path="armapqモデル.html"><a href="armapqモデル.html#ar-ma-arma-2.42.6"><i class="fa fa-check"></i>AR, MA, ARMA (2.4–2.6)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="arimasarimaモデル.html"><a href="arimasarimaモデル.html"><i class="fa fa-check"></i><b>4</b> ARIMA/SARIMAモデル</a>
<ul>
<li class="chapter" data-level="4.1" data-path="arimasarimaモデル.html"><a href="arimasarimaモデル.html#arimapdqモデルとは"><i class="fa fa-check"></i><b>4.1</b> ARIMA<span class="math inline">\((p,d,q)\)</span>モデルとは</a></li>
<li class="chapter" data-level="4.2" data-path="arimasarimaモデル.html"><a href="arimasarimaモデル.html#sarimapdqtimes-pdq_sモデル-周期sとは"><i class="fa fa-check"></i><b>4.2</b> SARIMA<span class="math inline">\((p,d,q)\times (P,D,Q)_s\)</span>モデル (周期<span class="math inline">\(s\)</span>)とは</a></li>
<li class="chapter" data-level="4.3" data-path="arimasarimaモデル.html"><a href="arimasarimaモデル.html#sarimaモデルのパス生成-パッケージsarimaの利用"><i class="fa fa-check"></i><b>4.3</b> SARIMAモデルのパス生成: パッケージ<strong>sarima</strong>の利用</a></li>
<li class="chapter" data-level="4.4" data-path="arimasarimaモデル.html"><a href="arimasarimaモデル.html#sarimaモデルの推定診断"><i class="fa fa-check"></i><b>4.4</b> SARIMAモデルの推定・診断</a>
<ul>
<li class="chapter" data-level="" data-path="arimasarimaモデル.html"><a href="arimasarimaモデル.html#パッケージforecastの利用-1"><i class="fa fa-check"></i>パッケージ<strong>forecast</strong>の利用</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="arimasarimaモデル.html"><a href="arimasarimaモデル.html#データ分析例"><i class="fa fa-check"></i><b>4.5</b> データ分析例</a>
<ul>
<li class="chapter" data-level="" data-path="arimasarimaモデル.html"><a href="arimasarimaモデル.html#データセット-bonds"><i class="fa fa-check"></i>データセット: bonds</a></li>
<li class="chapter" data-level="" data-path="arimasarimaモデル.html"><a href="arimasarimaモデル.html#データセット-airpassengers"><i class="fa fa-check"></i>データセット: AirPassengers</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="arimasarimaモデル.html"><a href="arimasarimaモデル.html#外生変数があるケース"><i class="fa fa-check"></i><b>4.6</b> 外生変数があるケース</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="確率的トレンドと単位根検定.html"><a href="確率的トレンドと単位根検定.html"><i class="fa fa-check"></i><b>5</b> 確率的トレンドと単位根検定</a>
<ul>
<li class="chapter" data-level="5.1" data-path="確率的トレンドと単位根検定.html"><a href="確率的トレンドと単位根検定.html#確率的トレンド-vs-確定的トレンド"><i class="fa fa-check"></i><b>5.1</b> 確率的トレンド vs 確定的トレンド</a></li>
<li class="chapter" data-level="5.2" data-path="確率的トレンドと単位根検定.html"><a href="確率的トレンドと単位根検定.html#単位根過程と見せかけの回帰"><i class="fa fa-check"></i><b>5.2</b> 単位根過程と見せかけの回帰</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="確率的トレンドと単位根検定.html"><a href="確率的トレンドと単位根検定.html#単位根過程"><i class="fa fa-check"></i><b>5.2.1</b> 単位根過程</a></li>
<li class="chapter" data-level="5.2.2" data-path="確率的トレンドと単位根検定.html"><a href="確率的トレンドと単位根検定.html#見せかけの回帰"><i class="fa fa-check"></i><b>5.2.2</b> 見せかけの回帰</a></li>
<li class="chapter" data-level="5.2.3" data-path="確率的トレンドと単位根検定.html"><a href="確率的トレンドと単位根検定.html#見せかけの回帰の判定"><i class="fa fa-check"></i><b>5.2.3</b> 見せかけの回帰の判定</a></li>
<li class="chapter" data-level="5.2.4" data-path="確率的トレンドと単位根検定.html"><a href="確率的トレンドと単位根検定.html#rで実行可能な主な単位根検定法"><i class="fa fa-check"></i><b>5.2.4</b> Rで実行可能な主な単位根検定法</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="確率的トレンドと単位根検定.html"><a href="確率的トレンドと単位根検定.html#augmented-dicky-fuller-adf-検定"><i class="fa fa-check"></i><b>5.3</b> Augmented Dicky-Fuller (ADF) 検定</a>
<ul>
<li class="chapter" data-level="" data-path="確率的トレンドと単位根検定.html"><a href="確率的トレンドと単位根検定.html#パッケージfunitroots"><i class="fa fa-check"></i>パッケージ<strong>fUnitRoots</strong></a></li>
<li class="chapter" data-level="" data-path="確率的トレンドと単位根検定.html"><a href="確率的トレンドと単位根検定.html#パッケージtseries"><i class="fa fa-check"></i>パッケージ<strong>tseries</strong></a></li>
<li class="chapter" data-level="" data-path="確率的トレンドと単位根検定.html"><a href="確率的トレンドと単位根検定.html#パッケージurca"><i class="fa fa-check"></i>パッケージ<strong>urca</strong></a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="確率的トレンドと単位根検定.html"><a href="確率的トレンドと単位根検定.html#adf検定以外の検定法"><i class="fa fa-check"></i><b>5.4</b> ADF検定以外の検定法</a>
<ul>
<li class="chapter" data-level="" data-path="確率的トレンドと単位根検定.html"><a href="確率的トレンドと単位根検定.html#phillips-perron-pp-検定"><i class="fa fa-check"></i>Phillips-Perron (PP) 検定</a></li>
<li class="chapter" data-level="" data-path="確率的トレンドと単位根検定.html"><a href="確率的トレンドと単位根検定.html#kwiatkowski-phillips-schmidt-shin-kpss-検定"><i class="fa fa-check"></i>Kwiatkowski-Phillips-Schmidt-Shin (KPSS) 検定</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="長期記憶過程.html"><a href="長期記憶過程.html"><i class="fa fa-check"></i><b>6</b> 長期記憶過程</a>
<ul>
<li class="chapter" data-level="6.1" data-path="長期記憶過程.html"><a href="長期記憶過程.html#長期記憶過程のシミュレーション"><i class="fa fa-check"></i><b>6.1</b> 長期記憶過程のシミュレーション</a>
<ul>
<li class="chapter" data-level="" data-path="長期記憶過程.html"><a href="長期記憶過程.html#パッケージfracdiffの利用"><i class="fa fa-check"></i>パッケージ<strong>fracdiff</strong>の利用</a></li>
<li class="chapter" data-level="" data-path="長期記憶過程.html"><a href="長期記憶過程.html#パッケージlongmemoの利用"><i class="fa fa-check"></i>パッケージ<strong>longmemo</strong>の利用</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="長期記憶過程.html"><a href="長期記憶過程.html#hurst指数の推定"><i class="fa fa-check"></i><b>6.2</b> Hurst指数の推定</a>
<ul>
<li class="chapter" data-level="" data-path="長期記憶過程.html"><a href="長期記憶過程.html#パッケージpracmaの利用"><i class="fa fa-check"></i>パッケージ<strong>pracma</strong>の利用</a></li>
<li class="chapter" data-level="" data-path="長期記憶過程.html"><a href="長期記憶過程.html#パッケージfractalの利用"><i class="fa fa-check"></i>パッケージ<strong>fractal</strong>の利用</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="長期記憶過程.html"><a href="長期記憶過程.html#arfimaモデルの推定"><i class="fa fa-check"></i><b>6.3</b> ARFIMAモデルの推定</a>
<ul>
<li class="chapter" data-level="" data-path="長期記憶過程.html"><a href="長期記憶過程.html#パッケージfracdiffの利用-1"><i class="fa fa-check"></i>パッケージ<strong>fracdiff</strong>の利用</a></li>
<li class="chapter" data-level="" data-path="長期記憶過程.html"><a href="長期記憶過程.html#パッケージnsarfimaの利用"><i class="fa fa-check"></i>パッケージ<strong>nsarfima</strong>の利用</a></li>
<li class="chapter" data-level="" data-path="長期記憶過程.html"><a href="長期記憶過程.html#階差次数dの代替的推定法"><i class="fa fa-check"></i>階差次数<span class="math inline">\(d\)</span>の代替的推定法</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="長期記憶過程.html"><a href="長期記憶過程.html#arfimaモデル-データ分析例-1"><i class="fa fa-check"></i><b>6.4</b> ARFIMAモデル: データ分析例 (1)</a></li>
<li class="chapter" data-level="6.5" data-path="長期記憶過程.html"><a href="長期記憶過程.html#arfimaモデル-データ分析例-2"><i class="fa fa-check"></i><b>6.5</b> ARFIMAモデル: データ分析例 (2)</a>
<ul>
<li class="chapter" data-level="" data-path="長期記憶過程.html"><a href="長期記憶過程.html#最適なarfimaモデルの選択および推定"><i class="fa fa-check"></i>最適なARFIMAモデルの選択および推定</a></li>
<li class="chapter" data-level="" data-path="長期記憶過程.html"><a href="長期記憶過程.html#arfimaモデルによる外挿予測"><i class="fa fa-check"></i>ARFIMAモデルによる外挿予測</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="レジームスイッチングモデル.html"><a href="レジームスイッチングモデル.html"><i class="fa fa-check"></i><b>7</b> レジーム・スイッチング・モデル</a>
<ul>
<li class="chapter" data-level="7.1" data-path="レジームスイッチングモデル.html"><a href="レジームスイッチングモデル.html#自己回帰マルコフスイッチングモデル-msm-ar"><i class="fa fa-check"></i><b>7.1</b> 自己回帰マルコフ・スイッチング・モデル (MSM-AR)</a></li>
<li class="chapter" data-level="7.2" data-path="レジームスイッチングモデル.html"><a href="レジームスイッチングモデル.html#パッケージnhmsarの利用"><i class="fa fa-check"></i><b>7.2</b> パッケージ<strong>NHMSAR</strong>の利用</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="garchモデル.html"><a href="garchモデル.html"><i class="fa fa-check"></i><b>8</b> GARCHモデル</a>
<ul>
<li class="chapter" data-level="8.1" data-path="garchモデル.html"><a href="garchモデル.html#収益率データとarch効果"><i class="fa fa-check"></i><b>8.1</b> 収益率データとARCH効果</a></li>
<li class="chapter" data-level="8.2" data-path="garchモデル.html"><a href="garchモデル.html#archgarchモデル"><i class="fa fa-check"></i><b>8.2</b> ARCH/GARCHモデル</a>
<ul>
<li class="chapter" data-level="" data-path="garchモデル.html"><a href="garchモデル.html#garchpqモデル"><i class="fa fa-check"></i>GARCH(p,q)モデル</a></li>
<li class="chapter" data-level="" data-path="garchモデル.html"><a href="garchモデル.html#garchモデリング"><i class="fa fa-check"></i>GARCHモデリング</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="garchモデル.html"><a href="garchモデル.html#archgarchモデルのシミュレーション"><i class="fa fa-check"></i><b>8.3</b> ARCH/GARCHモデルのシミュレーション</a>
<ul>
<li class="chapter" data-level="" data-path="garchモデル.html"><a href="garchモデル.html#パッケージfgarchの利用"><i class="fa fa-check"></i>パッケージ<strong>fGarch</strong>の利用</a></li>
<li class="chapter" data-level="" data-path="garchモデル.html"><a href="garchモデル.html#archpモデル"><i class="fa fa-check"></i>ARCH(p)モデル</a></li>
<li class="chapter" data-level="" data-path="garchモデル.html"><a href="garchモデル.html#garchpqモデル-1"><i class="fa fa-check"></i>GARCH(p,q)モデル</a></li>
<li class="chapter" data-level="" data-path="garchモデル.html"><a href="garchモデル.html#armapq-garchpqモデル"><i class="fa fa-check"></i>ARMA(p’,q’)-GARCH(p,q)モデル</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="garchモデル.html"><a href="garchモデル.html#archgarchモデルの適合"><i class="fa fa-check"></i><b>8.4</b> ARCH/GARCHモデルの適合</a>
<ul>
<li class="chapter" data-level="" data-path="garchモデル.html"><a href="garchモデル.html#パッケージrugarchの利用"><i class="fa fa-check"></i>パッケージ<strong>rugarch</strong>の利用</a></li>
<li class="chapter" data-level="" data-path="garchモデル.html"><a href="garchモデル.html#iarch11"><i class="fa fa-check"></i>IARCH(1,1)</a></li>
<li class="chapter" data-level="" data-path="garchモデル.html"><a href="garchモデル.html#gjr-garch11"><i class="fa fa-check"></i>GJR-GARCH(1,1)</a></li>
<li class="chapter" data-level="" data-path="garchモデル.html"><a href="garchモデル.html#aparch"><i class="fa fa-check"></i>APARCH</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="garchモデル.html"><a href="garchモデル.html#garchモデル-データ分析例-tsay-ch4"><i class="fa fa-check"></i><b>8.5</b> GARCHモデル: データ分析例 (Tsay, Ch4)</a>
<ul>
<li class="chapter" data-level="" data-path="garchモデル.html"><a href="garchモデル.html#必要な関数やデータセットの入手"><i class="fa fa-check"></i>必要な関数やデータセットの入手</a></li>
<li class="chapter" data-level="" data-path="garchモデル.html"><a href="garchモデル.html#integrated-garch-モデル"><i class="fa fa-check"></i>Integrated GARCH モデル</a></li>
<li class="chapter" data-level="" data-path="garchモデル.html"><a href="garchモデル.html#garch-m-モデル"><i class="fa fa-check"></i>GARCH-M モデル</a></li>
<li class="chapter" data-level="" data-path="garchモデル.html"><a href="garchモデル.html#exponential-garch-model"><i class="fa fa-check"></i>Exponential GARCH Model</a></li>
<li class="chapter" data-level="" data-path="garchモデル.html"><a href="garchモデル.html#threshold-garch-モデル"><i class="fa fa-check"></i>Threshold GARCH モデル</a></li>
<li class="chapter" data-level="" data-path="garchモデル.html"><a href="garchモデル.html#asymmetric-power-arch-モデル"><i class="fa fa-check"></i>Asymmetric Power ARCH モデル</a></li>
<li class="chapter" data-level="" data-path="garchモデル.html"><a href="garchモデル.html#nonsymmetric-garch-モデル"><i class="fa fa-check"></i>Nonsymmetric GARCH モデル</a></li>
<li class="chapter" data-level="" data-path="garchモデル.html"><a href="garchモデル.html#代替的アプリーチ間の比較"><i class="fa fa-check"></i>代替的アプリーチ間の比較</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="varモデル.html"><a href="varモデル.html"><i class="fa fa-check"></i><b>9</b> VARモデル</a>
<ul>
<li class="chapter" data-level="9.1" data-path="varモデル.html"><a href="varモデル.html#varpモデルのシミュレーション"><i class="fa fa-check"></i><b>9.1</b> VAR(<span class="math inline">\(p\)</span>)モデルのシミュレーション</a>
<ul>
<li class="chapter" data-level="" data-path="varモデル.html"><a href="varモデル.html#パッケージmts-varsの利用"><i class="fa fa-check"></i>パッケージ<strong>MTS</strong>, <strong>vars</strong>の利用</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="varモデル.html"><a href="varモデル.html#varpモデルの構築"><i class="fa fa-check"></i><b>9.2</b> VAR(<span class="math inline">\(p\)</span>)モデルの構築</a>
<ul>
<li class="chapter" data-level="" data-path="varモデル.html"><a href="varモデル.html#varpモデルの次数同定"><i class="fa fa-check"></i>VAR(<span class="math inline">\(p\)</span>)モデルの次数同定</a></li>
<li class="chapter" data-level="" data-path="varモデル.html"><a href="varモデル.html#varpモデルの推定"><i class="fa fa-check"></i>VAR(<span class="math inline">\(p\)</span>)モデルの推定</a></li>
<li class="chapter" data-level="" data-path="varモデル.html"><a href="varモデル.html#varpモデル予測"><i class="fa fa-check"></i>VAR(<span class="math inline">\(p\)</span>)モデル予測</a></li>
</ul></li>
</ul></li>
<li class="appendix"><span><b>Appendix 参考文献</b></span></li>
<li class="chapter" data-level="A" data-path="バブル-生成崩壊-検出.html"><a href="バブル-生成崩壊-検出.html"><i class="fa fa-check"></i><b>A</b> バブル (生成・崩壊) 検出</a>
<ul>
<li class="chapter" data-level="A.1" data-path="バブル-生成崩壊-検出.html"><a href="バブル-生成崩壊-検出.html#検定法に関する最近のレビュー論文"><i class="fa fa-check"></i><b>A.1</b> 検定法に関する最近のレビュー論文</a></li>
<li class="chapter" data-level="A.2" data-path="バブル-生成崩壊-検出.html"><a href="バブル-生成崩壊-検出.html#supreme-adf検定sadf-pwy-2011-generalized-supreme-adf-検定gsadf-psy-2015"><i class="fa fa-check"></i><b>A.2</b> Supreme ADF検定/SADF (PWY, 2011), Generalized supreme ADF 検定/GSADF (PSY, 2015)</a>
<ul>
<li class="chapter" data-level="A.2.1" data-path="バブル-生成崩壊-検出.html"><a href="バブル-生成崩壊-検出.html#数理ファイナンス-jarrow-protterら"><i class="fa fa-check"></i><b>A.2.1</b> 数理ファイナンス (Jarrow, Protterら)</a></li>
<li class="chapter" data-level="A.2.2" data-path="バブル-生成崩壊-検出.html"><a href="バブル-生成崩壊-検出.html#経済物理学-sornetteら"><i class="fa fa-check"></i><b>A.2.2</b> 経済物理学 (Sornetteら)</a></li>
</ul></li>
<li class="chapter" data-level="A.3" data-path="バブル-生成崩壊-検出.html"><a href="バブル-生成崩壊-検出.html#実証分析"><i class="fa fa-check"></i><b>A.3</b> 実証分析</a>
<ul>
<li class="chapter" data-level="" data-path="バブル-生成崩壊-検出.html"><a href="バブル-生成崩壊-検出.html#株式市場の例"><i class="fa fa-check"></i>株式市場の例</a></li>
<li class="chapter" data-level="" data-path="バブル-生成崩壊-検出.html"><a href="バブル-生成崩壊-検出.html#暗号資産市場の例"><i class="fa fa-check"></i>暗号資産市場の例</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="B" data-path="長期記憶過程-1.html"><a href="長期記憶過程-1.html"><i class="fa fa-check"></i><b>B</b> 長期記憶過程</a>
<ul>
<li class="chapter" data-level="B.1" data-path="長期記憶過程-1.html"><a href="長期記憶過程-1.html#理論概説"><i class="fa fa-check"></i><b>B.1</b> 理論・概説</a></li>
<li class="chapter" data-level="B.2" data-path="長期記憶過程-1.html"><a href="長期記憶過程-1.html#株式市場"><i class="fa fa-check"></i><b>B.2</b> 株式市場</a></li>
<li class="chapter" data-level="B.3" data-path="長期記憶過程-1.html"><a href="長期記憶過程-1.html#外国為替市場"><i class="fa fa-check"></i><b>B.3</b> 外国為替市場</a></li>
<li class="chapter" data-level="B.4" data-path="長期記憶過程-1.html"><a href="長期記憶過程-1.html#コモディティ暗号資産"><i class="fa fa-check"></i><b>B.4</b> コモディティ・暗号資産</a></li>
<li class="chapter" data-level="B.5" data-path="長期記憶過程-1.html"><a href="長期記憶過程-1.html#vix"><i class="fa fa-check"></i><b>B.5</b> VIX</a></li>
<li class="chapter" data-level="B.6" data-path="長期記憶過程-1.html"><a href="長期記憶過程-1.html#高頻度データ-ボラティリティ-注文フロー等"><i class="fa fa-check"></i><b>B.6</b> 高頻度データ (ボラティリティ, 注文フロー等)</a></li>
<li class="chapter" data-level="B.7" data-path="長期記憶過程-1.html"><a href="長期記憶過程-1.html#長期記憶性の発生要因-非長期記憶モデルによる近似"><i class="fa fa-check"></i><b>B.7</b> 長期記憶性の発生要因, 非長期記憶モデルによる近似</a></li>
</ul></li>
<li class="chapter" data-level="C" data-path="markov-switching-regime-switchingモデル.html"><a href="markov-switching-regime-switchingモデル.html"><i class="fa fa-check"></i><b>C</b> Markov switching/ regime switchingモデル</a>
<ul>
<li class="chapter" data-level="C.1" data-path="markov-switching-regime-switchingモデル.html"><a href="markov-switching-regime-switchingモデル.html#理論概説-1"><i class="fa fa-check"></i><b>C.1</b> 理論・概説</a></li>
<li class="chapter" data-level="C.2" data-path="markov-switching-regime-switchingモデル.html"><a href="markov-switching-regime-switchingモデル.html#株式市場-1"><i class="fa fa-check"></i><b>C.2</b> 株式市場</a></li>
<li class="chapter" data-level="C.3" data-path="markov-switching-regime-switchingモデル.html"><a href="markov-switching-regime-switchingモデル.html#金利債券市場"><i class="fa fa-check"></i><b>C.3</b> 金利・債券市場</a></li>
<li class="chapter" data-level="C.4" data-path="markov-switching-regime-switchingモデル.html"><a href="markov-switching-regime-switchingモデル.html#外国為替市場-1"><i class="fa fa-check"></i><b>C.4</b> 外国為替市場</a></li>
<li class="chapter" data-level="C.5" data-path="markov-switching-regime-switchingモデル.html"><a href="markov-switching-regime-switchingモデル.html#アセットアロケーション"><i class="fa fa-check"></i><b>C.5</b> アセット・アロケーション</a></li>
</ul></li>
<li class="chapter" data-level="D" data-path="archgarchモデル-1.html"><a href="archgarchモデル-1.html"><i class="fa fa-check"></i><b>D</b> ARCH/GARCHモデル</a>
<ul>
<li class="chapter" data-level="D.1" data-path="archgarchモデル-1.html"><a href="archgarchモデル-1.html#概説"><i class="fa fa-check"></i><b>D.1</b> 概説</a></li>
<li class="chapter" data-level="D.2" data-path="archgarchモデル-1.html"><a href="archgarchモデル-1.html#arch-model"><i class="fa fa-check"></i><b>D.2</b> ARCH model</a></li>
<li class="chapter" data-level="D.3" data-path="archgarchモデル-1.html"><a href="archgarchモデル-1.html#garch-model"><i class="fa fa-check"></i><b>D.3</b> GARCH model</a></li>
<li class="chapter" data-level="D.4" data-path="archgarchモデル-1.html"><a href="archgarchモデル-1.html#arch-m-model"><i class="fa fa-check"></i><b>D.4</b> ARCH-M Model</a></li>
<li class="chapter" data-level="D.5" data-path="archgarchモデル-1.html"><a href="archgarchモデル-1.html#gjr-model"><i class="fa fa-check"></i><b>D.5</b> GJR model</a></li>
<li class="chapter" data-level="D.6" data-path="archgarchモデル-1.html"><a href="archgarchモデル-1.html#aparch-model"><i class="fa fa-check"></i><b>D.6</b> APARCH model</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">金融時系列解析</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="レジームスイッチングモデル" class="section level1 hasAnchor" number="7">
<h1><span class="header-section-number">7</span> レジーム・スイッチング・モデル<a href="レジームスイッチングモデル.html#レジームスイッチングモデル" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="自己回帰マルコフスイッチングモデル-msm-ar" class="section level2 hasAnchor" number="7.1">
<h2><span class="header-section-number">7.1</span> 自己回帰マルコフ・スイッチング・モデル (MSM-AR)<a href="レジームスイッチングモデル.html#自己回帰マルコフスイッチングモデル-msm-ar" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>パッケージ<strong>MSwM</strong>に含まれているサンプルデータ<code>example</code>を使って,
MSM-ARモデルを適合する関数<code>msmFit()</code>の操作例を示す.</p>
<ul>
<li>出所: Jose A. Sanchez-Espigares and Alberto Lopez-Moreno (2018). “MSwM examples.”</li>
<li><code>example</code>: シミュレーションにより生成:
<span class="math display">\[y_{t}=\begin{cases}
8+2x_{t}+\epsilon_{t}^{(1)} &amp; \epsilon_{t}^{(1)}\sim N(0,1),\quad t=101:150,181:250\\
1+0.9y_{t-1}+\epsilon_{t}^{(2)} &amp; \epsilon_{t}^{(2)}\sim N(0,0.5),\quad t=1:100,151:180,251:300
\end{cases}\]</span>
ここで, <span class="math inline">\(x_t\)</span>は共変量.</li>
</ul>
<p>すなわち, <span class="math inline">\(y_t\)</span>は, 時間経過とともに, AR(1)モデルと <span class="math inline">\(x_t\)</span>
を外生変数とする単回帰モデルの間をスイッチする.</p>
<div class="sourceCode" id="cb489"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb489-1"><a href="レジームスイッチングモデル.html#cb489-1" tabindex="-1"></a><span class="fu">library</span>(MSwM)</span>
<span id="cb489-2"><a href="レジームスイッチングモデル.html#cb489-2" tabindex="-1"></a><span class="fu">data</span>(example)</span>
<span id="cb489-3"><a href="レジームスイッチングモデル.html#cb489-3" tabindex="-1"></a><span class="co">#vignette(&quot;examples&quot;) # マニュアル参照</span></span>
<span id="cb489-4"><a href="レジームスイッチングモデル.html#cb489-4" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">ts</span>(example))</span></code></pre></div>
<p><img src="060-MRS_files/figure-html/MSwM-1-1.png" width="75%" /></p>
<div class="sourceCode" id="cb490"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb490-1"><a href="レジームスイッチングモデル.html#cb490-1" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x, example)</span>
<span id="cb490-2"><a href="レジームスイッチングモデル.html#cb490-2" tabindex="-1"></a><span class="fu">summary</span>(mod)</span>
<span id="cb490-3"><a href="レジームスイッチングモデル.html#cb490-3" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb490-4"><a href="レジームスイッチングモデル.html#cb490-4" tabindex="-1"></a><span class="do">## Call:</span></span>
<span id="cb490-5"><a href="レジームスイッチングモデル.html#cb490-5" tabindex="-1"></a><span class="do">## lm(formula = y ~ x, data = example)</span></span>
<span id="cb490-6"><a href="レジームスイッチングモデル.html#cb490-6" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb490-7"><a href="レジームスイッチングモデル.html#cb490-7" tabindex="-1"></a><span class="do">## Residuals:</span></span>
<span id="cb490-8"><a href="レジームスイッチングモデル.html#cb490-8" tabindex="-1"></a><span class="do">##     Min      1Q  Median      3Q     Max </span></span>
<span id="cb490-9"><a href="レジームスイッチングモデル.html#cb490-9" tabindex="-1"></a><span class="do">## -2.8998 -0.8429 -0.0427  0.7420  4.0337 </span></span>
<span id="cb490-10"><a href="レジームスイッチングモデル.html#cb490-10" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb490-11"><a href="レジームスイッチングモデル.html#cb490-11" tabindex="-1"></a><span class="do">## Coefficients:</span></span>
<span id="cb490-12"><a href="レジームスイッチングモデル.html#cb490-12" tabindex="-1"></a><span class="do">##             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb490-13"><a href="レジームスイッチングモデル.html#cb490-13" tabindex="-1"></a><span class="do">## (Intercept)   9.0486     0.1398  64.709  &lt; 2e-16 ***</span></span>
<span id="cb490-14"><a href="レジームスイッチングモデル.html#cb490-14" tabindex="-1"></a><span class="do">## x             0.8235     0.2423   3.398  0.00077 ***</span></span>
<span id="cb490-15"><a href="レジームスイッチングモデル.html#cb490-15" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb490-16"><a href="レジームスイッチングモデル.html#cb490-16" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb490-17"><a href="レジームスイッチングモデル.html#cb490-17" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb490-18"><a href="レジームスイッチングモデル.html#cb490-18" tabindex="-1"></a><span class="do">## Residual standard error: 1.208 on 298 degrees of freedom</span></span>
<span id="cb490-19"><a href="レジームスイッチングモデル.html#cb490-19" tabindex="-1"></a><span class="do">## Multiple R-squared:  0.03731,    Adjusted R-squared:  0.03408 </span></span>
<span id="cb490-20"><a href="レジームスイッチングモデル.html#cb490-20" tabindex="-1"></a><span class="do">## F-statistic: 11.55 on 1 and 298 DF,  p-value: 0.0007701</span></span>
<span id="cb490-21"><a href="レジームスイッチングモデル.html#cb490-21" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb490-22"><a href="レジームスイッチングモデル.html#cb490-22" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">resid</span>(mod)); <span class="fu">qqline</span>(<span class="fu">resid</span>(mod), <span class="at">col =</span> <span class="dv">2</span>); <span class="fu">acf</span>(<span class="fu">resid</span>(mod))</span></code></pre></div>
<p><img src="060-MRS_files/figure-html/MSwM-1-2.png" width="75%" /></p>
<div class="sourceCode" id="cb491"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb491-1"><a href="レジームスイッチングモデル.html#cb491-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb491-2"><a href="レジームスイッチングモデル.html#cb491-2" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">resid</span>(mod), <span class="at">type =</span> <span class="st">&quot;l&quot;</span>); <span class="fu">abline</span>(<span class="at">v=</span><span class="fu">c</span>(<span class="dv">100</span>, <span class="dv">150</span>, <span class="dv">180</span>, <span class="dv">250</span>), <span class="at">lty =</span> <span class="st">&quot;dotted&quot;</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="060-MRS_files/figure-html/MSwM-1-3.png" width="75%" /></p>
<p>→ 単回帰係数は有意. が, 残差は正規分布から乖離, かつ, 有意な自己相関が持続.</p>
<p><strong>MSM-ARモデルの適合</strong></p>
<pre><code>- 関数msmFit(): Fitting Markov Switching Models using the EM algorithm
  - msmFit(object, k, sw, p, data, family, control)
  - k: numeric, レジーム数
  - sw: a logical vector, スイッチングする係数の指定
    ← intercept, sigmaはベクトルの両端に配置
  - p: integer, AR次数 (デフォルト値=0)
  - p&gt;0のケース → the last values of sw have to contain the AR coefficients which have switching
  - family: モデルのクラス (It is only required when the object is a &quot;General linear formula&quot;)</code></pre>
<p><code>examle</code>のケースにおいて, 正しいレジーム数 (<span class="math inline">\(k=2\)</span>).</p>
<p>ここでは, 正しいモデル構造を想定 (特定) 出来たものとしてモデル推定したとする:</p>
<div class="sourceCode" id="cb493"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb493-1"><a href="レジームスイッチングモデル.html#cb493-1" tabindex="-1"></a>mod.mswm <span class="ot">&lt;-</span> <span class="fu">msmFit</span>(mod, <span class="at">k =</span> <span class="dv">2</span>, <span class="at">p =</span> <span class="dv">1</span>, <span class="at">sw =</span> <span class="fu">c</span>(T, T, T, T), <span class="at">control =</span> <span class="fu">list</span>(<span class="at">parallel =</span> F))</span>
<span id="cb493-2"><a href="レジームスイッチングモデル.html#cb493-2" tabindex="-1"></a><span class="fu">summary</span>(mod.mswm)</span>
<span id="cb493-3"><a href="レジームスイッチングモデル.html#cb493-3" tabindex="-1"></a><span class="do">## Markov Switching Model</span></span>
<span id="cb493-4"><a href="レジームスイッチングモデル.html#cb493-4" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb493-5"><a href="レジームスイッチングモデル.html#cb493-5" tabindex="-1"></a><span class="do">## Call: msmFit(object = mod, k = 2, sw = c(T, T, T, T), p = 1, control = list(parallel = F))</span></span>
<span id="cb493-6"><a href="レジームスイッチングモデル.html#cb493-6" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb493-7"><a href="レジームスイッチングモデル.html#cb493-7" tabindex="-1"></a><span class="do">##        AIC     BIC    logLik</span></span>
<span id="cb493-8"><a href="レジームスイッチングモデル.html#cb493-8" tabindex="-1"></a><span class="do">##   637.0736 693.479 -312.5368</span></span>
<span id="cb493-9"><a href="レジームスイッチングモデル.html#cb493-9" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb493-10"><a href="レジームスイッチングモデル.html#cb493-10" tabindex="-1"></a><span class="do">## Coefficients:</span></span>
<span id="cb493-11"><a href="レジームスイッチングモデル.html#cb493-11" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb493-12"><a href="レジームスイッチングモデル.html#cb493-12" tabindex="-1"></a><span class="do">## Regime 1 </span></span>
<span id="cb493-13"><a href="レジームスイッチングモデル.html#cb493-13" tabindex="-1"></a><span class="do">## ---------</span></span>
<span id="cb493-14"><a href="レジームスイッチングモデル.html#cb493-14" tabindex="-1"></a><span class="do">##                Estimate Std. Error t value  Pr(&gt;|t|)    </span></span>
<span id="cb493-15"><a href="レジームスイッチングモデル.html#cb493-15" tabindex="-1"></a><span class="do">## (Intercept)(S)   8.6393     0.7311 11.8169 &lt; 2.2e-16 ***</span></span>
<span id="cb493-16"><a href="レジームスイッチングモデル.html#cb493-16" tabindex="-1"></a><span class="do">## x(S)             1.8771     0.3108  6.0396 1.545e-09 ***</span></span>
<span id="cb493-17"><a href="レジームスイッチングモデル.html#cb493-17" tabindex="-1"></a><span class="do">## y_1(S)          -0.0569     0.0805 -0.7068    0.4797    </span></span>
<span id="cb493-18"><a href="レジームスイッチングモデル.html#cb493-18" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb493-19"><a href="レジームスイッチングモデル.html#cb493-19" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb493-20"><a href="レジームスイッチングモデル.html#cb493-20" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb493-21"><a href="レジームスイッチングモデル.html#cb493-21" tabindex="-1"></a><span class="do">## Residual standard error: 0.9339683</span></span>
<span id="cb493-22"><a href="レジームスイッチングモデル.html#cb493-22" tabindex="-1"></a><span class="do">## Multiple R-squared: 0.2408</span></span>
<span id="cb493-23"><a href="レジームスイッチングモデル.html#cb493-23" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb493-24"><a href="レジームスイッチングモデル.html#cb493-24" tabindex="-1"></a><span class="do">## Standardized Residuals:</span></span>
<span id="cb493-25"><a href="レジームスイッチングモデル.html#cb493-25" tabindex="-1"></a><span class="do">##         Min          Q1         Med          Q3         Max </span></span>
<span id="cb493-26"><a href="レジームスイッチングモデル.html#cb493-26" tabindex="-1"></a><span class="do">## -2.31102193 -0.03317756  0.01034139  0.04509105  2.85245598 </span></span>
<span id="cb493-27"><a href="レジームスイッチングモデル.html#cb493-27" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb493-28"><a href="レジームスイッチングモデル.html#cb493-28" tabindex="-1"></a><span class="do">## Regime 2 </span></span>
<span id="cb493-29"><a href="レジームスイッチングモデル.html#cb493-29" tabindex="-1"></a><span class="do">## ---------</span></span>
<span id="cb493-30"><a href="レジームスイッチングモデル.html#cb493-30" tabindex="-1"></a><span class="do">##                Estimate Std. Error t value  Pr(&gt;|t|)    </span></span>
<span id="cb493-31"><a href="レジームスイッチングモデル.html#cb493-31" tabindex="-1"></a><span class="do">## (Intercept)(S)   0.8417     0.3033  2.7751  0.005518 ** </span></span>
<span id="cb493-32"><a href="レジームスイッチングモデル.html#cb493-32" tabindex="-1"></a><span class="do">## x(S)            -0.0533     0.1386 -0.3846  0.700534    </span></span>
<span id="cb493-33"><a href="レジームスイッチングモデル.html#cb493-33" tabindex="-1"></a><span class="do">## y_1(S)           0.9208     0.0306 30.0915 &lt; 2.2e-16 ***</span></span>
<span id="cb493-34"><a href="レジームスイッチングモデル.html#cb493-34" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb493-35"><a href="レジームスイッチングモデル.html#cb493-35" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb493-36"><a href="レジームスイッチングモデル.html#cb493-36" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb493-37"><a href="レジームスイッチングモデル.html#cb493-37" tabindex="-1"></a><span class="do">## Residual standard error: 0.5034675</span></span>
<span id="cb493-38"><a href="レジームスイッチングモデル.html#cb493-38" tabindex="-1"></a><span class="do">## Multiple R-squared: 0.8375</span></span>
<span id="cb493-39"><a href="レジームスイッチングモデル.html#cb493-39" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb493-40"><a href="レジームスイッチングモデル.html#cb493-40" tabindex="-1"></a><span class="do">## Standardized Residuals:</span></span>
<span id="cb493-41"><a href="レジームスイッチングモデル.html#cb493-41" tabindex="-1"></a><span class="do">##           Min            Q1           Med            Q3           Max </span></span>
<span id="cb493-42"><a href="レジームスイッチングモデル.html#cb493-42" tabindex="-1"></a><span class="do">## -1.5153666486 -0.0906543338  0.0001873641  0.1656717256  1.2020898988 </span></span>
<span id="cb493-43"><a href="レジームスイッチングモデル.html#cb493-43" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb493-44"><a href="レジームスイッチングモデル.html#cb493-44" tabindex="-1"></a><span class="do">## Transition probabilities:</span></span>
<span id="cb493-45"><a href="レジームスイッチングモデル.html#cb493-45" tabindex="-1"></a><span class="do">##            Regime 1   Regime 2</span></span>
<span id="cb493-46"><a href="レジームスイッチングモデル.html#cb493-46" tabindex="-1"></a><span class="do">## Regime 1 0.97709116 0.01500272</span></span>
<span id="cb493-47"><a href="レジームスイッチングモデル.html#cb493-47" tabindex="-1"></a><span class="do">## Regime 2 0.02290884 0.98499728</span></span></code></pre></div>
<div class="sourceCode" id="cb494"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb494-1"><a href="レジームスイッチングモデル.html#cb494-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb494-2"><a href="レジームスイッチングモデル.html#cb494-2" tabindex="-1"></a><span class="fu">qqnorm</span>(mod.mswm<span class="sc">@</span>Fit<span class="sc">@</span>error[, <span class="dv">1</span>]); <span class="fu">qqline</span>(mod.mswm<span class="sc">@</span>Fit<span class="sc">@</span>error[, <span class="dv">1</span>], <span class="at">col =</span> <span class="dv">2</span>); </span>
<span id="cb494-3"><a href="レジームスイッチングモデル.html#cb494-3" tabindex="-1"></a><span class="fu">qqnorm</span>(mod.mswm<span class="sc">@</span>Fit<span class="sc">@</span>error[, <span class="dv">2</span>]); <span class="fu">qqline</span>(mod.mswm<span class="sc">@</span>Fit<span class="sc">@</span>error[, <span class="dv">2</span>],<span class="at">col =</span> <span class="dv">2</span>); </span></code></pre></div>
<p><img src="060-MRS_files/figure-html/unnamed-chunk-1-1.png" width="75%" /></p>
<div class="sourceCode" id="cb495"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb495-1"><a href="レジームスイッチングモデル.html#cb495-1" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">ts</span>(mod.mswm<span class="sc">@</span>Fit<span class="sc">@</span>error))</span></code></pre></div>
<p><img src="060-MRS_files/figure-html/unnamed-chunk-1-2.png" width="75%" /></p>
<p>→ これらの図表から次のような点が観察される:</p>
<ul>
<li>モデルは2つのレジームを良く検出:
<ul>
<li>共変量<span class="math inline">\(x\)</span>が有意なレジーム</li>
<li>1期前ラグ変数<span class="math inline">\(y_{t-1}\)</span>が有意なレジーム</li>
</ul></li>
<li>状態推定確率の対角要素(同じレジームに留まる確率)は, いずれも約0.98</li>
</ul>
<p>さらに, 適合結果から以下のようなプロットを出力することができる.</p>
<p><strong>レジーム#1にある状態確率の推定値 (smoothed/ filtered probabilities):</strong></p>
<div class="sourceCode" id="cb496"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb496-1"><a href="レジームスイッチングモデル.html#cb496-1" tabindex="-1"></a><span class="fu">par</span>(<span class="st">&quot;mar&quot;</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb496-2"><a href="レジームスイッチングモデル.html#cb496-2" tabindex="-1"></a><span class="fu">plotProb</span>(mod.mswm, <span class="at">which =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="060-MRS_files/figure-html/MSwM-3-1.png" width="75%" /></p>
<p><strong>レジーム#2にある状態確率の推定値 (平滑化 (smoothed) 確率, フィルター化 (filtered) 確率):</strong></p>
<div class="sourceCode" id="cb497"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb497-1"><a href="レジームスイッチングモデル.html#cb497-1" tabindex="-1"></a><span class="fu">par</span>(<span class="st">&quot;mar&quot;</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb497-2"><a href="レジームスイッチングモデル.html#cb497-2" tabindex="-1"></a><span class="fu">plotProb</span>(mod.mswm, <span class="at">which =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="060-MRS_files/figure-html/MSwM-4-1.png" width="75%" /></p>
<p><strong>指定のレジームにおける, 反応変数, 説明変数, 状態確率の推定値 (平滑化確率) の同時プロット:</strong></p>
<div class="sourceCode" id="cb498"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb498-1"><a href="レジームスイッチングモデル.html#cb498-1" tabindex="-1"></a><span class="fu">par</span>(<span class="st">&quot;mar&quot;</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb498-2"><a href="レジームスイッチングモデル.html#cb498-2" tabindex="-1"></a><span class="fu">plotReg</span>(mod.mswm, <span class="at">expl =</span> <span class="st">&quot;x&quot;</span>)</span></code></pre></div>
<p><img src="060-MRS_files/figure-html/MSwM-5-1.png" width="75%" /></p>
<p><strong>引数<code>sw</code>の使い方</strong>
<code>sw</code>は, レジームスイッチするパラメータを論理値のベクトルで指定する. 今回のケース (<span class="math inline">\(p=1\)</span>) では, 具体的に, 順に, (切片項, 外生変数の回帰係数, AR(1)係数, 誤差項の標準偏差) に対応している.</p>
<p>例えば, swの2番目と4番目のパラメータが スイッチしないモデルをみてみよう.</p>
<div class="sourceCode" id="cb499"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb499-1"><a href="レジームスイッチングモデル.html#cb499-1" tabindex="-1"></a><span class="co"># swの使い方の確認</span></span>
<span id="cb499-2"><a href="レジームスイッチングモデル.html#cb499-2" tabindex="-1"></a>mod_mswm2 <span class="ot">&lt;-</span> <span class="fu">msmFit</span>(mod, <span class="at">k =</span> <span class="dv">2</span>, <span class="at">p =</span> <span class="dv">1</span>, <span class="at">sw =</span> <span class="fu">c</span>(T, F, T, F), <span class="at">control =</span> <span class="fu">list</span>(<span class="at">parallel =</span> F))</span>
<span id="cb499-3"><a href="レジームスイッチングモデル.html#cb499-3" tabindex="-1"></a><span class="fu">summary</span>(mod_mswm2)</span>
<span id="cb499-4"><a href="レジームスイッチングモデル.html#cb499-4" tabindex="-1"></a><span class="do">## Markov Switching Model</span></span>
<span id="cb499-5"><a href="レジームスイッチングモデル.html#cb499-5" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb499-6"><a href="レジームスイッチングモデル.html#cb499-6" tabindex="-1"></a><span class="do">## Call: msmFit(object = mod, k = 2, sw = c(T, F, T, F), p = 1, control = list(parallel = F))</span></span>
<span id="cb499-7"><a href="レジームスイッチングモデル.html#cb499-7" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb499-8"><a href="レジームスイッチングモデル.html#cb499-8" tabindex="-1"></a><span class="do">##        AIC      BIC    logLik</span></span>
<span id="cb499-9"><a href="レジームスイッチングモデル.html#cb499-9" tabindex="-1"></a><span class="do">##   717.8729 764.8773 -353.9364</span></span>
<span id="cb499-10"><a href="レジームスイッチングモデル.html#cb499-10" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb499-11"><a href="レジームスイッチングモデル.html#cb499-11" tabindex="-1"></a><span class="do">## Coefficients:</span></span>
<span id="cb499-12"><a href="レジームスイッチングモデル.html#cb499-12" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb499-13"><a href="レジームスイッチングモデル.html#cb499-13" tabindex="-1"></a><span class="do">## Regime 1 </span></span>
<span id="cb499-14"><a href="レジームスイッチングモデル.html#cb499-14" tabindex="-1"></a><span class="do">## ---------</span></span>
<span id="cb499-15"><a href="レジームスイッチングモデル.html#cb499-15" tabindex="-1"></a><span class="do">##                Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb499-16"><a href="レジームスイッチングモデル.html#cb499-16" tabindex="-1"></a><span class="do">## (Intercept)(S)   0.6801     0.0450 15.1133   &lt;2e-16 ***</span></span>
<span id="cb499-17"><a href="レジームスイッチングモデル.html#cb499-17" tabindex="-1"></a><span class="do">## x                0.6834     0.4448  1.5364   0.1244    </span></span>
<span id="cb499-18"><a href="レジームスイッチングモデル.html#cb499-18" tabindex="-1"></a><span class="do">## y_1(S)           0.8992     0.5994  1.5002   0.1336    </span></span>
<span id="cb499-19"><a href="レジームスイッチングモデル.html#cb499-19" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb499-20"><a href="レジームスイッチングモデル.html#cb499-20" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb499-21"><a href="レジームスイッチングモデル.html#cb499-21" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb499-22"><a href="レジームスイッチングモデル.html#cb499-22" tabindex="-1"></a><span class="do">## Residual standard error: 0.7471898</span></span>
<span id="cb499-23"><a href="レジームスイッチングモデル.html#cb499-23" tabindex="-1"></a><span class="do">## Multiple R-squared: 0.7873</span></span>
<span id="cb499-24"><a href="レジームスイッチングモデル.html#cb499-24" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb499-25"><a href="レジームスイッチングモデル.html#cb499-25" tabindex="-1"></a><span class="do">## Standardized Residuals:</span></span>
<span id="cb499-26"><a href="レジームスイッチングモデル.html#cb499-26" tabindex="-1"></a><span class="do">##          Min           Q1          Med           Q3          Max </span></span>
<span id="cb499-27"><a href="レジームスイッチングモデル.html#cb499-27" tabindex="-1"></a><span class="do">## -1.474238051 -0.199318297 -0.004289551  0.213164425  1.989968623 </span></span>
<span id="cb499-28"><a href="レジームスイッチングモデル.html#cb499-28" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb499-29"><a href="レジームスイッチングモデル.html#cb499-29" tabindex="-1"></a><span class="do">## Regime 2 </span></span>
<span id="cb499-30"><a href="レジームスイッチングモデル.html#cb499-30" tabindex="-1"></a><span class="do">## ---------</span></span>
<span id="cb499-31"><a href="レジームスイッチングモデル.html#cb499-31" tabindex="-1"></a><span class="do">##                Estimate Std. Error  t value Pr(&gt;|t|)    </span></span>
<span id="cb499-32"><a href="レジームスイッチングモデル.html#cb499-32" tabindex="-1"></a><span class="do">## (Intercept)(S)   9.2524     0.0659 140.4006   &lt;2e-16 ***</span></span>
<span id="cb499-33"><a href="レジームスイッチングモデル.html#cb499-33" tabindex="-1"></a><span class="do">## x                0.6834     0.4448   1.5364   0.1244    </span></span>
<span id="cb499-34"><a href="レジームスイッチングモデル.html#cb499-34" tabindex="-1"></a><span class="do">## y_1(S)          -0.0649     0.0450  -1.4422   0.1492    </span></span>
<span id="cb499-35"><a href="レジームスイッチングモデル.html#cb499-35" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb499-36"><a href="レジームスイッチングモデル.html#cb499-36" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb499-37"><a href="レジームスイッチングモデル.html#cb499-37" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb499-38"><a href="レジームスイッチングモデル.html#cb499-38" tabindex="-1"></a><span class="do">## Residual standard error: 0.7471898</span></span>
<span id="cb499-39"><a href="レジームスイッチングモデル.html#cb499-39" tabindex="-1"></a><span class="do">## Multiple R-squared: 0.04087</span></span>
<span id="cb499-40"><a href="レジームスイッチングモデル.html#cb499-40" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb499-41"><a href="レジームスイッチングモデル.html#cb499-41" tabindex="-1"></a><span class="do">## Standardized Residuals:</span></span>
<span id="cb499-42"><a href="レジームスイッチングモデル.html#cb499-42" tabindex="-1"></a><span class="do">##         Min          Q1         Med          Q3         Max </span></span>
<span id="cb499-43"><a href="レジームスイッチングモデル.html#cb499-43" tabindex="-1"></a><span class="do">## -2.49496049 -0.05348336  0.01063642  0.07316299  2.07533940 </span></span>
<span id="cb499-44"><a href="レジームスイッチングモデル.html#cb499-44" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb499-45"><a href="レジームスイッチングモデル.html#cb499-45" tabindex="-1"></a><span class="do">## Transition probabilities:</span></span>
<span id="cb499-46"><a href="レジームスイッチングモデル.html#cb499-46" tabindex="-1"></a><span class="do">##            Regime 1  Regime 2</span></span>
<span id="cb499-47"><a href="レジームスイッチングモデル.html#cb499-47" tabindex="-1"></a><span class="do">## Regime 1 0.98701875 0.0213371</span></span>
<span id="cb499-48"><a href="レジームスイッチングモデル.html#cb499-48" tabindex="-1"></a><span class="do">## Regime 2 0.01298125 0.9786629</span></span></code></pre></div>
<p>すなわち, 外生変数 (“x”), 誤差項の標準偏差 (“Residual standard error”) はレジーム共通の推定値 (それぞれ, 0.6834, 0.7471898) を持つことが確認される.</p>
<!---- 追加: 120825 -->
</div>
<div id="パッケージnhmsarの利用" class="section level2 hasAnchor" number="7.2">
<h2><span class="header-section-number">7.2</span> パッケージ<strong>NHMSAR</strong>の利用<a href="レジームスイッチングモデル.html#パッケージnhmsarの利用" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>注) 12/4/25時点では, CRANレポジトリから除かれているが, GitHubに用意されたCRANレポジトリのミラーから入手可能.</li>
</ul>
<p><strong>パッケージNHMSARのインストール</strong></p>
<div class="sourceCode" id="cb500"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb500-1"><a href="レジームスイッチングモデル.html#cb500-1" tabindex="-1"></a><span class="co"># devtoolsパッケージをインストールしていない場合</span></span>
<span id="cb500-2"><a href="レジームスイッチングモデル.html#cb500-2" tabindex="-1"></a><span class="co"># install.packages(&quot;devtools&quot;)</span></span>
<span id="cb500-3"><a href="レジームスイッチングモデル.html#cb500-3" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">&quot;cran/NHMSAR&quot;</span>)</span>
<span id="cb500-4"><a href="レジームスイッチングモデル.html#cb500-4" tabindex="-1"></a><span class="fu">library</span>(NHMSAR)</span></code></pre></div>
<p>ここでは, 英国の株価指数FTSEの月次終値データから計算される対数収益率系列を使用する.</p>
<div class="sourceCode" id="cb501"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb501-1"><a href="レジームスイッチングモデル.html#cb501-1" tabindex="-1"></a><span class="co"># 株価データ</span></span>
<span id="cb501-2"><a href="レジームスイッチングモデル.html#cb501-2" tabindex="-1"></a><span class="co"># cf. https://stackoverflow.com/questions/30281444/fitting-markov-switching-models-to-data-in-r</span></span>
<span id="cb501-3"><a href="レジームスイッチングモデル.html#cb501-3" tabindex="-1"></a><span class="fu">library</span>(tseries)</span>
<span id="cb501-4"><a href="レジームスイッチングモデル.html#cb501-4" tabindex="-1"></a>ftse <span class="ot">&lt;-</span> <span class="fu">get.hist.quote</span>(<span class="at">instrument =</span> <span class="st">&quot;^FTSE&quot;</span>, <span class="at">start =</span> <span class="st">&quot;1985-01-01&quot;</span>,</span>
<span id="cb501-5"><a href="レジームスイッチングモデル.html#cb501-5" tabindex="-1"></a>                       <span class="at">end =</span> <span class="st">&quot;2015-01-01&quot;</span>, <span class="at">quote =</span> <span class="st">&quot;AdjClose&quot;</span>, <span class="at">compression =</span> <span class="st">&quot;m&quot;</span>)</span>
<span id="cb501-6"><a href="レジームスイッチングモデル.html#cb501-6" tabindex="-1"></a><span class="co"># compression: &quot;m&quot; → 月次, &quot;w&quot; → 週次, &quot;d&quot; → &quot;日次&quot; (デフォルト)</span></span>
<span id="cb501-7"><a href="レジームスイッチングモデル.html#cb501-7" tabindex="-1"></a><span class="co"># Log-returns</span></span>
<span id="cb501-8"><a href="レジームスイッチングモデル.html#cb501-8" tabindex="-1"></a>ftse_ret <span class="ot">&lt;-</span> <span class="fu">diff</span>(<span class="fu">log</span>(ftse))</span>
<span id="cb501-9"><a href="レジームスイッチングモデル.html#cb501-9" tabindex="-1"></a>(tlen <span class="ot">&lt;-</span> <span class="fu">length</span>(ftse_ret))</span>
<span id="cb501-10"><a href="レジームスイッチングモデル.html#cb501-10" tabindex="-1"></a><span class="do">## [1] 360</span></span></code></pre></div>
<p>関数<code>fit.MSAR()</code>を使ってモデル適合する前に,
<code>init.theta.MSAR()</code>により入力データセットに前処理を施す必要がある.</p>
<pre><code>init.theta.MSAR(data, T, M):
- EMアリゴリズムによるNHMSARモデルのフィッティグ前の初期化
- 非斉次 (せいじ) 性 (non-homogeneity) を, 推移確率 (transitions) and/or (観測変数が満たす) 自己回帰モデルの切片項 (emissions) に仮定
- 引数
  - data: 1変量 or 多変量の　(T * N.samples * d-次元) 配列 (array)
  - T: タイムステップ数, N.samples: 同一定常過程からの実現パス数, d: 次元
  - M: レジーム数
  - order: AR次数
  - label:
    - &quot;HH&quot; for homogeneous MS AR model (デフォルト)
    - &quot;HN&quot; for non homogeneous emissions
    - &quot;NH&quot; for non homogeneous transitions
    - &quot;NN&quot; for non homogeneous emissions and non homogeneous transitions</code></pre>
<p>いま使用している<code>ftse_ret</code>は1変量であるから, d=1,
また, レジーム数 M=2, ARモデルの次数p=1, label=“HH”と設定する.</p>
<div class="sourceCode" id="cb503"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb503-1"><a href="レジームスイッチングモデル.html#cb503-1" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">array</span>(ftse_ret, <span class="fu">c</span>(tlen, <span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb503-2"><a href="レジームスイッチングモデル.html#cb503-2" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="dv">2</span>; order <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb503-3"><a href="レジームスイッチングモデル.html#cb503-3" tabindex="-1"></a><span class="co"># MS-ARモデルfittingのための初期設定</span></span>
<span id="cb503-4"><a href="レジームスイッチングモデル.html#cb503-4" tabindex="-1"></a>theta_init <span class="ot">&lt;-</span> <span class="fu">init.theta.MSAR</span>(data, <span class="at">M =</span> M, <span class="at">order =</span> order, <span class="at">label =</span> <span class="st">&quot;HH&quot;</span>)</span></code></pre></div>
<pre><code>fit.MSAR():
- EMアリゴリズムにより, (非)斉次MS-ARモデルを適合</code></pre>
<p><strong>MS-ARモデルの適合</strong></p>
<div class="sourceCode" id="cb505"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb505-1"><a href="レジームスイッチングモデル.html#cb505-1" tabindex="-1"></a>mod_hh <span class="ot">&lt;-</span> <span class="fu">fit.MSAR</span>(data, theta_init, <span class="at">verbose =</span> <span class="cn">TRUE</span>, <span class="at">MaxIter =</span> <span class="dv">20</span>)</span>
<span id="cb505-2"><a href="レジームスイッチングモデル.html#cb505-2" tabindex="-1"></a><span class="do">## [1] iteration        1                  loglik =       427.359384869746</span></span>
<span id="cb505-3"><a href="レジームスイッチングモデル.html#cb505-3" tabindex="-1"></a><span class="do">## [1] iteration        2                  loglik =       599.357434544203</span></span>
<span id="cb505-4"><a href="レジームスイッチングモデル.html#cb505-4" tabindex="-1"></a><span class="do">## [1] iteration        3                  loglik =       603.097700110407</span></span>
<span id="cb505-5"><a href="レジームスイッチングモデル.html#cb505-5" tabindex="-1"></a><span class="do">## [1] iteration        4                  loglik =       615.654861169996</span></span>
<span id="cb505-6"><a href="レジームスイッチングモデル.html#cb505-6" tabindex="-1"></a><span class="do">## [1] iteration        5                  loglik =       630.536548687041</span></span>
<span id="cb505-7"><a href="レジームスイッチングモデル.html#cb505-7" tabindex="-1"></a><span class="do">## [1] iteration        6                  loglik =       633.282737927781</span></span>
<span id="cb505-8"><a href="レジームスイッチングモデル.html#cb505-8" tabindex="-1"></a><span class="do">## [1] iteration        7                  loglik =       633.650514065381</span></span>
<span id="cb505-9"><a href="レジームスイッチングモデル.html#cb505-9" tabindex="-1"></a><span class="do">## [1] iteration      8                loglik =     633.7070393554</span></span>
<span id="cb505-10"><a href="レジームスイッチングモデル.html#cb505-10" tabindex="-1"></a><span class="do">## [1] iteration        9                  loglik =       633.717527533701</span></span>
<span id="cb505-11"><a href="レジームスイッチングモデル.html#cb505-11" tabindex="-1"></a><span class="do">## [1] iteration        10                 loglik =       633.719761891655</span></span></code></pre></div>
<p><strong>推定パラメータ</strong></p>
<div class="sourceCode" id="cb506"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb506-1"><a href="レジームスイッチングモデル.html#cb506-1" tabindex="-1"></a>mod_hh<span class="sc">$</span>theta</span>
<span id="cb506-2"><a href="レジームスイッチングモデル.html#cb506-2" tabindex="-1"></a><span class="do">## $A</span></span>
<span id="cb506-3"><a href="レジームスイッチングモデル.html#cb506-3" tabindex="-1"></a><span class="do">##                  A1</span></span>
<span id="cb506-4"><a href="レジームスイッチングモデル.html#cb506-4" tabindex="-1"></a><span class="do">## Regime1 -0.30455293</span></span>
<span id="cb506-5"><a href="レジームスイッチングモデル.html#cb506-5" tabindex="-1"></a><span class="do">## Regime2  0.06113744</span></span>
<span id="cb506-6"><a href="レジームスイッチングモデル.html#cb506-6" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb506-7"><a href="レジームスイッチングモデル.html#cb506-7" tabindex="-1"></a><span class="do">## $A0</span></span>
<span id="cb506-8"><a href="レジームスイッチングモデル.html#cb506-8" tabindex="-1"></a><span class="do">##                 A01</span></span>
<span id="cb506-9"><a href="レジームスイッチングモデル.html#cb506-9" tabindex="-1"></a><span class="do">## Regime1 0.013059816</span></span>
<span id="cb506-10"><a href="レジームスイッチングモデル.html#cb506-10" tabindex="-1"></a><span class="do">## Regime2 0.001084966</span></span>
<span id="cb506-11"><a href="レジームスイッチングモデル.html#cb506-11" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb506-12"><a href="レジームスイッチングモデル.html#cb506-12" tabindex="-1"></a><span class="do">## $sigma</span></span>
<span id="cb506-13"><a href="レジームスイッチングモデル.html#cb506-13" tabindex="-1"></a><span class="do">##                     </span></span>
<span id="cb506-14"><a href="レジームスイッチングモデル.html#cb506-14" tabindex="-1"></a><span class="do">## Regime1 0.0004807941</span></span>
<span id="cb506-15"><a href="レジームスイッチングモデル.html#cb506-15" tabindex="-1"></a><span class="do">## Regime2 0.002995211 </span></span>
<span id="cb506-16"><a href="レジームスイッチングモデル.html#cb506-16" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb506-17"><a href="レジームスイッチングモデル.html#cb506-17" tabindex="-1"></a><span class="do">## $prior</span></span>
<span id="cb506-18"><a href="レジームスイッチングモデル.html#cb506-18" tabindex="-1"></a><span class="do">##                     </span></span>
<span id="cb506-19"><a href="レジームスイッチングモデル.html#cb506-19" tabindex="-1"></a><span class="do">## Regime1 0.9997904917</span></span>
<span id="cb506-20"><a href="レジームスイッチングモデル.html#cb506-20" tabindex="-1"></a><span class="do">## Regime2 0.0002095083</span></span>
<span id="cb506-21"><a href="レジームスイッチングモデル.html#cb506-21" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb506-22"><a href="レジームスイッチングモデル.html#cb506-22" tabindex="-1"></a><span class="do">## $transmat</span></span>
<span id="cb506-23"><a href="レジームスイッチングモデル.html#cb506-23" tabindex="-1"></a><span class="do">##           Regime1    Regime2</span></span>
<span id="cb506-24"><a href="レジームスイッチングモデル.html#cb506-24" tabindex="-1"></a><span class="do">## Regime1 0.9383838 0.06161617</span></span>
<span id="cb506-25"><a href="レジームスイッチングモデル.html#cb506-25" tabindex="-1"></a><span class="do">## Regime2 0.0388313 0.96116870</span></span>
<span id="cb506-26"><a href="レジームスイッチングモデル.html#cb506-26" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb506-27"><a href="レジームスイッチングモデル.html#cb506-27" tabindex="-1"></a><span class="do">## attr(,&quot;NbComp&quot;)</span></span>
<span id="cb506-28"><a href="レジームスイッチングモデル.html#cb506-28" tabindex="-1"></a><span class="do">## [1] 1</span></span>
<span id="cb506-29"><a href="レジームスイッチングモデル.html#cb506-29" tabindex="-1"></a><span class="do">## attr(,&quot;NbRegimes&quot;)</span></span>
<span id="cb506-30"><a href="レジームスイッチングモデル.html#cb506-30" tabindex="-1"></a><span class="do">## [1] 2</span></span>
<span id="cb506-31"><a href="レジームスイッチングモデル.html#cb506-31" tabindex="-1"></a><span class="do">## attr(,&quot;order&quot;)</span></span>
<span id="cb506-32"><a href="レジームスイッチングモデル.html#cb506-32" tabindex="-1"></a><span class="do">## [1] 1</span></span>
<span id="cb506-33"><a href="レジームスイッチングモデル.html#cb506-33" tabindex="-1"></a><span class="do">## attr(,&quot;label&quot;)</span></span>
<span id="cb506-34"><a href="レジームスイッチングモデル.html#cb506-34" tabindex="-1"></a><span class="do">## [1] &quot;HH&quot;</span></span>
<span id="cb506-35"><a href="レジームスイッチングモデル.html#cb506-35" tabindex="-1"></a><span class="do">## attr(,&quot;n_par&quot;)</span></span>
<span id="cb506-36"><a href="レジームスイッチングモデル.html#cb506-36" tabindex="-1"></a><span class="do">## [1] 8</span></span>
<span id="cb506-37"><a href="レジームスイッチングモデル.html#cb506-37" tabindex="-1"></a><span class="do">## attr(,&quot;emis.linear&quot;)</span></span>
<span id="cb506-38"><a href="レジームスイッチングモデル.html#cb506-38" tabindex="-1"></a><span class="do">## [1] FALSE</span></span>
<span id="cb506-39"><a href="レジームスイッチングモデル.html#cb506-39" tabindex="-1"></a><span class="do">## attr(,&quot;class&quot;)</span></span>
<span id="cb506-40"><a href="レジームスイッチングモデル.html#cb506-40" tabindex="-1"></a><span class="do">## [1] &quot;MSAR&quot;</span></span></code></pre></div>
<p>–&gt; 観察結果:</p>
<ul>
<li>A0 (ARモデルの定数項<span class="math inline">\(\phi_0\)</span>). レジーム1: 0.0139, レジーム2: 0.0012</li>
<li>A (AR(1)モデルの係数<span class="math inline">\(\phi_1\)</span>): レジーム1: -0.2444, レジーム2: 0.0485</li>
<li>sigma. レジーム1: 0.0008, レジーム2: 0.0036</li>
<li>transmat. レジーム1 → 1の推移確率<span class="math inline">\(p_{11}=0.9077\)</span>, 1 → 2の推移確率<span class="math inline">\(p_{22}=0.9507\)</span>, etc.</li>
</ul>
<!-- sigma. レジーム1: 低ボラティリティ, レジーム2: 高ボラティリティ -->
<p><strong>MS-ARモデルのレジームのプロット</strong></p>
<div class="sourceCode" id="cb507"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb507-1"><a href="レジームスイッチングモデル.html#cb507-1" tabindex="-1"></a><span class="fu">regimes.plot.MSAR</span>(mod_hh, data, <span class="at">ylab =</span> <span class="st">&quot;FTSE return&quot;</span>)</span></code></pre></div>
<p><img src="060-MRS_files/figure-html/unnamed-chunk-8-1.png" width="75%" /></p>
<pre><code>##   [1] NA  1  1  1  1  1  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2
##  [26]  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2
##  [51]  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2
##  [76]  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  1  1  1
## [101]  1  1  1  1  1  1  1  1  2  2  2  2  2  2  2  2  2  2  2  1  1  1  1  1  1
## [126]  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1
## [151]  1  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2
## [176]  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2
## [201]  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  1  1
## [226]  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1
## [251]  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  2  2  2
## [276]  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2
## [301]  2  2  2  2  2  2  2  2  2  2  2  2  1  1  1  1  1  1  2  2  2  2  2  2  2
## [326]  2  2  2  2  2  2  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1
## [351]  1  1  1  1  1  1  1  1  1  1  1</code></pre>
<p>–&gt; high vola (グレイ色の区間), low volaの2レジーム</p>
<p><strong>各レジームの状態確率の推定値 (平滑化確率)</strong></p>
<div class="sourceCode" id="cb509"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb509-1"><a href="レジームスイッチングモデル.html#cb509-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb509-2"><a href="レジームスイッチングモデル.html#cb509-2" tabindex="-1"></a>mod_hh<span class="sc">$</span>smoothedprob <span class="sc">%&gt;%</span> <span class="fu">head</span>(<span class="dv">10</span>)</span>
<span id="cb509-3"><a href="レジームスイッチングモデル.html#cb509-3" tabindex="-1"></a><span class="do">##             [,1]         [,2]</span></span>
<span id="cb509-4"><a href="レジームスイッチングモデル.html#cb509-4" tabindex="-1"></a><span class="do">##  [1,] 0.99987172 0.0001282819</span></span>
<span id="cb509-5"><a href="レジームスイッチングモデル.html#cb509-5" tabindex="-1"></a><span class="do">##  [2,] 0.90334895 0.0966510491</span></span>
<span id="cb509-6"><a href="レジームスイッチングモデル.html#cb509-6" tabindex="-1"></a><span class="do">##  [3,] 0.66842528 0.3315747173</span></span>
<span id="cb509-7"><a href="レジームスイッチングモデル.html#cb509-7" tabindex="-1"></a><span class="do">##  [4,] 0.10257859 0.8974214066</span></span>
<span id="cb509-8"><a href="レジームスイッチングモデル.html#cb509-8" tabindex="-1"></a><span class="do">##  [5,] 0.09516542 0.9048345760</span></span>
<span id="cb509-9"><a href="レジームスイッチングモデル.html#cb509-9" tabindex="-1"></a><span class="do">##  [6,] 0.04786803 0.9521319652</span></span>
<span id="cb509-10"><a href="レジームスイッチングモデル.html#cb509-10" tabindex="-1"></a><span class="do">##  [7,] 0.04662355 0.9533764488</span></span>
<span id="cb509-11"><a href="レジームスイッチングモデル.html#cb509-11" tabindex="-1"></a><span class="do">##  [8,] 0.03918717 0.9608128316</span></span>
<span id="cb509-12"><a href="レジームスイッチングモデル.html#cb509-12" tabindex="-1"></a><span class="do">##  [9,] 0.02860799 0.9713920054</span></span>
<span id="cb509-13"><a href="レジームスイッチングモデル.html#cb509-13" tabindex="-1"></a><span class="do">## [10,] 0.04237943 0.9576205714</span></span></code></pre></div>
<p>ここでは, 一番単純なケース (1変量, かつ”HH”) を扱った.
より一般のケースについては, マニュアルを参照すること.</p>
<ul>
<li><a href="https://rdrr.io/cran/NHMSAR/">https://rdrr.io/cran/NHMSAR/</a></li>
</ul>
<p>但し, 上述の通り, 本パッケージは現時点ではバージョンの更新を停止し,
CRANレポジトリからは外れてしまっていることから,
いずれ動作しなくなる可能性があることに注意が必要である/</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="長期記憶過程.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="garchモデル.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": null,
    "text": null
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": null,
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "subsection"
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
