<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>6 長期記憶過程 | 金融時系列解析</title>
  <meta name="description" content="6 長期記憶過程 | 金融時系列解析" />
  <meta name="generator" content="bookdown 0.35 and GitBook 2.6.7" />

  <meta property="og:title" content="6 長期記憶過程 | 金融時系列解析" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="6 長期記憶過程 | 金融時系列解析" />
  
  
  

<meta name="author" content="林 高樹" />


<meta name="date" content="2023-11-17" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="単位根過程と単位根検定.html"/>
<link rel="next" href="バブル-生成崩壊-検出に関する参考文献.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> はじめに</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#時系列モデリング"><i class="fa fa-check"></i><b>1.1</b> 時系列モデリング</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#金融時系列データの特徴"><i class="fa fa-check"></i><b>1.2</b> 金融時系列データの特徴</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#金融時系列データの特徴-みずほ-8411-株価データの例"><i class="fa fa-check"></i>金融時系列データの特徴: みずほ (8411) 株価データの例</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#シミュレーションによるサンプルパス生成"><i class="fa fa-check"></i><b>1.3</b> シミュレーションによるサンプルパス生成</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#rにおける時系列オブジェクトクラスおよび関数の例"><i class="fa fa-check"></i><b>1.4</b> Rにおける時系列オブジェクト・クラスおよび関数の例</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="index.html"><a href="index.html#日付時間データに対するクラス"><i class="fa fa-check"></i><b>1.4.1</b> 日付・時間データに対するクラス</a></li>
<li class="chapter" data-level="1.4.2" data-path="index.html"><a href="index.html#時系列データに対するクラス1-tsクラス"><i class="fa fa-check"></i><b>1.4.2</b> 時系列データに対するクラス(1): tsクラス</a></li>
<li class="chapter" data-level="1.4.3" data-path="index.html"><a href="index.html#時系列データに対するクラス2-zooクラスとxtsクラス"><i class="fa fa-check"></i><b>1.4.3</b> 時系列データに対するクラス(2): zooクラスとxtsクラス</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#時系列データの分解"><i class="fa fa-check"></i><b>1.5</b> 時系列データの分解</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="index.html"><a href="index.html#トレンド抽出-平滑化smoothing"><i class="fa fa-check"></i><b>1.5.1</b> トレンド抽出, 平滑化(smoothing)</a></li>
<li class="chapter" data-level="1.5.2" data-path="index.html"><a href="index.html#時系列の分解"><i class="fa fa-check"></i><b>1.5.2</b> 時系列の分解</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="定常性と自己相関関数.html"><a href="定常性と自己相関関数.html"><i class="fa fa-check"></i><b>2</b> 定常性と自己相関関数</a>
<ul>
<li class="chapter" data-level="2.1" data-path="定常性と自己相関関数.html"><a href="定常性と自己相関関数.html#確率過程の2次特性-平均関数と自己共分散関数"><i class="fa fa-check"></i><b>2.1</b> 確率過程の2次特性: 平均関数と自己共分散関数</a></li>
<li class="chapter" data-level="2.2" data-path="定常性と自己相関関数.html"><a href="定常性と自己相関関数.html#定常性-stationarity"><i class="fa fa-check"></i><b>2.2</b> 定常性 (stationarity)</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="定常性と自己相関関数.html"><a href="定常性と自己相関関数.html#強定常性"><i class="fa fa-check"></i><b>2.2.1</b> 強定常性</a></li>
<li class="chapter" data-level="2.2.2" data-path="定常性と自己相関関数.html"><a href="定常性と自己相関関数.html#弱定常性"><i class="fa fa-check"></i><b>2.2.2</b> 弱定常性</a></li>
<li class="chapter" data-level="2.2.3" data-path="定常性と自己相関関数.html"><a href="定常性と自己相関関数.html#ホワイトノイズ"><i class="fa fa-check"></i><b>2.2.3</b> ホワイトノイズ</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="定常性と自己相関関数.html"><a href="定常性と自己相関関数.html#標本平均と標本自己共分散関数"><i class="fa fa-check"></i><b>2.3</b> 標本平均と標本自己共分散関数</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="定常性と自己相関関数.html"><a href="定常性と自己相関関数.html#アンサンブル平均-vs-標本平均"><i class="fa fa-check"></i><b>2.3.1</b> アンサンブル平均 vs 標本平均</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="定常性と自己相関関数.html"><a href="定常性と自己相関関数.html#標本自己相関関数"><i class="fa fa-check"></i><b>2.4</b> 標本自己相関関数</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="定常性と自己相関関数.html"><a href="定常性と自己相関関数.html#白色ノイズ"><i class="fa fa-check"></i><b>2.4.1</b> 白色ノイズ</a></li>
<li class="chapter" data-level="2.4.2" data-path="定常性と自己相関関数.html"><a href="定常性と自己相関関数.html#ランダムウォーク"><i class="fa fa-check"></i><b>2.4.2</b> ランダムウォーク</a></li>
<li class="chapter" data-level="2.4.3" data-path="定常性と自己相関関数.html"><a href="定常性と自己相関関数.html#非定常成分を含む時系列"><i class="fa fa-check"></i><b>2.4.3</b> 非定常成分を含む時系列</a></li>
<li class="chapter" data-level="2.4.4" data-path="定常性と自己相関関数.html"><a href="定常性と自己相関関数.html#線形時系列モデル"><i class="fa fa-check"></i><b>2.4.4</b> 線形時系列モデル</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="定常性と自己相関関数.html"><a href="定常性と自己相関関数.html#自己相関関数-標本値-vs-理論値"><i class="fa fa-check"></i><b>2.5</b> 自己相関関数 (標本値 vs 理論値)</a>
<ul>
<li class="chapter" data-level="" data-path="定常性と自己相関関数.html"><a href="定常性と自己相関関数.html#ar2-モデル"><i class="fa fa-check"></i>AR(2) モデル</a></li>
<li class="chapter" data-level="2.5.1" data-path="定常性と自己相関関数.html"><a href="定常性と自己相関関数.html#arma11モデル-1"><i class="fa fa-check"></i><b>2.5.1</b> ARMA(1,1)モデル</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="armapqモデル.html"><a href="armapqモデル.html"><i class="fa fa-check"></i><b>3</b> ARMA<span class="math inline">\((p,q)\)</span>モデル</a>
<ul>
<li class="chapter" data-level="3.1" data-path="armapqモデル.html"><a href="armapqモデル.html#armapqモデルとは"><i class="fa fa-check"></i><b>3.1</b> ARMA<span class="math inline">\((p,q)\)</span>モデルとは</a>
<ul>
<li class="chapter" data-level="" data-path="armapqモデル.html"><a href="armapqモデル.html#因果性と反転可能性"><i class="fa fa-check"></i>因果性と反転可能性</a></li>
<li class="chapter" data-level="" data-path="armapqモデル.html"><a href="armapqモデル.html#armapqモデルの意義"><i class="fa fa-check"></i>ARMA<span class="math inline">\((p,q)\)</span>モデルの意義</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="armapqモデル.html"><a href="armapqモデル.html#armapqモデルによる予測"><i class="fa fa-check"></i><b>3.2</b> ARMA<span class="math inline">\((p,q)\)</span>モデルによる予測</a></li>
<li class="chapter" data-level="3.3" data-path="armapqモデル.html"><a href="armapqモデル.html#armapqモデルの推定"><i class="fa fa-check"></i><b>3.3</b> ARMA<span class="math inline">\((p,q)\)</span>モデルの推定</a></li>
<li class="chapter" data-level="3.4" data-path="armapqモデル.html"><a href="armapqモデル.html#armapqモデルの同定-次数の特定"><i class="fa fa-check"></i><b>3.4</b> ARMA<span class="math inline">\((p,q)\)</span>モデルの同定 (次数の特定)</a></li>
<li class="chapter" data-level="3.5" data-path="armapqモデル.html"><a href="armapqモデル.html#rによる実行例"><i class="fa fa-check"></i><b>3.5</b> Rによる実行例</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="armapqモデル.html"><a href="armapqモデル.html#armapqモデルの同定-acfpacfeacfの利用"><i class="fa fa-check"></i><b>3.5.1</b> ARMA<span class="math inline">\((p,q)\)</span>モデルの同定 (ACF/PACF/EACFの利用)</a></li>
<li class="chapter" data-level="3.5.2" data-path="armapqモデル.html"><a href="armapqモデル.html#armapqモデルの推定診断"><i class="fa fa-check"></i><b>3.5.2</b> ARMA<span class="math inline">\((p,q)\)</span>モデルの推定・診断</a></li>
<li class="chapter" data-level="3.5.3" data-path="armapqモデル.html"><a href="armapqモデル.html#パッケージforecastの利用"><i class="fa fa-check"></i><b>3.5.3</b> パッケージ{forecast}の利用</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="armapqモデル.html"><a href="armapqモデル.html#armaモデル-データ分析例-tsay-ch2"><i class="fa fa-check"></i><b>3.6</b> ARMAモデル: データ分析例 (Tsay, Ch2)</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="armapqモデル.html"><a href="armapqモデル.html#標本acf"><i class="fa fa-check"></i><b>3.6.1</b> 標本ACF</a></li>
<li class="chapter" data-level="3.6.2" data-path="armapqモデル.html"><a href="armapqモデル.html#ar-ma-arma-2.42.6"><i class="fa fa-check"></i><b>3.6.2</b> AR, MA, ARMA (2.4–2.6)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="arimaモデルsarimaモデル.html"><a href="arimaモデルsarimaモデル.html"><i class="fa fa-check"></i><b>4</b> ARIMAモデル/SARIMAモデル</a>
<ul>
<li class="chapter" data-level="4.1" data-path="arimaモデルsarimaモデル.html"><a href="arimaモデルsarimaモデル.html#arimapdqモデルとは"><i class="fa fa-check"></i><b>4.1</b> ARIMA<span class="math inline">\((p,d,q)\)</span>モデルとは</a></li>
<li class="chapter" data-level="4.2" data-path="arimaモデルsarimaモデル.html"><a href="arimaモデルsarimaモデル.html#sarimapdqtimes-pdq_sモデル-周期sとは"><i class="fa fa-check"></i><b>4.2</b> SARIMA<span class="math inline">\((p,d,q)\times (P,D,Q)_s\)</span>モデル (周期<span class="math inline">\(s\)</span>)とは</a></li>
<li class="chapter" data-level="4.3" data-path="arimaモデルsarimaモデル.html"><a href="arimaモデルsarimaモデル.html#sarimaモデルのパス発生-sarimaパッケージの利用"><i class="fa fa-check"></i><b>4.3</b> SARIMAモデルのパス発生 ({sarima}パッケージの利用)</a></li>
<li class="chapter" data-level="4.4" data-path="arimaモデルsarimaモデル.html"><a href="arimaモデルsarimaモデル.html#sarimaモデルの推定診断"><i class="fa fa-check"></i><b>4.4</b> SARIMAモデルの推定・診断</a></li>
<li class="chapter" data-level="4.5" data-path="arimaモデルsarimaモデル.html"><a href="arimaモデルsarimaモデル.html#パッケージforecastの利用-1"><i class="fa fa-check"></i><b>4.5</b> パッケージ{forecast}の利用</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="単位根過程と単位根検定.html"><a href="単位根過程と単位根検定.html"><i class="fa fa-check"></i><b>5</b> 単位根過程と単位根検定</a>
<ul>
<li class="chapter" data-level="5.1" data-path="単位根過程と単位根検定.html"><a href="単位根過程と単位根検定.html#単位根過程と見せかけの回帰"><i class="fa fa-check"></i><b>5.1</b> 単位根過程と見せかけの回帰</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="単位根過程と単位根検定.html"><a href="単位根過程と単位根検定.html#単位根過程"><i class="fa fa-check"></i><b>5.1.1</b> 単位根過程</a></li>
<li class="chapter" data-level="5.1.2" data-path="単位根過程と単位根検定.html"><a href="単位根過程と単位根検定.html#見せかけの回帰"><i class="fa fa-check"></i><b>5.1.2</b> 見せかけの回帰</a></li>
<li class="chapter" data-level="5.1.3" data-path="単位根過程と単位根検定.html"><a href="単位根過程と単位根検定.html#見せかけの回帰の判定"><i class="fa fa-check"></i><b>5.1.3</b> 見せかけの回帰の判定</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="単位根過程と単位根検定.html"><a href="単位根過程と単位根検定.html#主な単位根検定法"><i class="fa fa-check"></i><b>5.2</b> 主な単位根検定法</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="単位根過程と単位根検定.html"><a href="単位根過程と単位根検定.html#augmented-dicky-fuller-adf-検定の実行例"><i class="fa fa-check"></i><b>5.2.1</b> Augmented Dicky-Fuller (ADF) 検定の実行例</a></li>
<li class="chapter" data-level="5.2.2" data-path="単位根過程と単位根検定.html"><a href="単位根過程と単位根検定.html#adf検定以外の検定法"><i class="fa fa-check"></i><b>5.2.2</b> ADF検定以外の検定法</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="長期記憶過程.html"><a href="長期記憶過程.html"><i class="fa fa-check"></i><b>6</b> 長期記憶過程</a>
<ul>
<li class="chapter" data-level="6.1" data-path="長期記憶過程.html"><a href="長期記憶過程.html#arfimapdq過程のシミュレーション"><i class="fa fa-check"></i><b>6.1</b> ARFIMA(p,d,q)過程のシミュレーション</a></li>
<li class="chapter" data-level="6.2" data-path="長期記憶過程.html"><a href="長期記憶過程.html#arfima-fractional-gaussian過程のシミュレーション"><i class="fa fa-check"></i><b>6.2</b> ARFIMA, fractional Gaussian過程のシミュレーション</a></li>
<li class="chapter" data-level="6.3" data-path="長期記憶過程.html"><a href="長期記憶過程.html#hurst指数の推定"><i class="fa fa-check"></i><b>6.3</b> Hurst指数の推定</a></li>
<li class="chapter" data-level="6.4" data-path="長期記憶過程.html"><a href="長期記憶過程.html#arfimaモデルの推定"><i class="fa fa-check"></i><b>6.4</b> ARFIMAモデルの推定</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="長期記憶過程.html"><a href="長期記憶過程.html#最尤法"><i class="fa fa-check"></i><b>6.4.1</b> 最尤法</a></li>
<li class="chapter" data-level="6.4.2" data-path="長期記憶過程.html"><a href="長期記憶過程.html#階差次数dの代替的推定法"><i class="fa fa-check"></i><b>6.4.2</b> 階差次数<span class="math inline">\(d\)</span>の代替的推定法</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="長期記憶過程.html"><a href="長期記憶過程.html#arfimaモデル-データ分析例-tsay-2.11-pp.119120"><i class="fa fa-check"></i><b>6.5</b> ARFIMAモデル: データ分析例 (Tsay, 2.11, pp.119–120)</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="バブル-生成崩壊-検出に関する参考文献.html"><a href="バブル-生成崩壊-検出に関する参考文献.html"><i class="fa fa-check"></i><b>A</b> バブル (生成・崩壊) 検出に関する参考文献</a>
<ul>
<li class="chapter" data-level="A.1" data-path="バブル-生成崩壊-検出に関する参考文献.html"><a href="バブル-生成崩壊-検出に関する参考文献.html#検定法に関する最近のレビュー論文"><i class="fa fa-check"></i><b>A.1</b> 検定法に関する最近のレビュー論文</a></li>
<li class="chapter" data-level="A.2" data-path="バブル-生成崩壊-検出に関する参考文献.html"><a href="バブル-生成崩壊-検出に関する参考文献.html#supreme-adf検定sadf-pwy-2011-generalized-supreme-adf-検定gsadf-psy-2015"><i class="fa fa-check"></i><b>A.2</b> Supreme ADF検定/SADF (PWY, 2011), Generalized supreme ADF 検定/GSADF (PSY, 2015)</a>
<ul>
<li class="chapter" data-level="A.2.1" data-path="バブル-生成崩壊-検出に関する参考文献.html"><a href="バブル-生成崩壊-検出に関する参考文献.html#数理ファイナンス-jarrow-protterら"><i class="fa fa-check"></i><b>A.2.1</b> 数理ファイナンス (Jarrow, Protterら)</a></li>
<li class="chapter" data-level="A.2.2" data-path="バブル-生成崩壊-検出に関する参考文献.html"><a href="バブル-生成崩壊-検出に関する参考文献.html#経済物理学-sornetteら"><i class="fa fa-check"></i><b>A.2.2</b> 経済物理学 (Sornetteら)</a></li>
<li class="chapter" data-level="A.2.3" data-path="バブル-生成崩壊-検出に関する参考文献.html"><a href="バブル-生成崩壊-検出に関する参考文献.html#実証分析"><i class="fa fa-check"></i><b>A.2.3</b> 実証分析</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="B" data-path="長期記憶モデルの参考文献.html"><a href="長期記憶モデルの参考文献.html"><i class="fa fa-check"></i><b>B</b> 長期記憶モデルの参考文献</a>
<ul>
<li class="chapter" data-level="B.1" data-path="長期記憶モデルの参考文献.html"><a href="長期記憶モデルの参考文献.html#理論概説"><i class="fa fa-check"></i><b>B.1</b> 理論・概説</a></li>
<li class="chapter" data-level="B.2" data-path="長期記憶モデルの参考文献.html"><a href="長期記憶モデルの参考文献.html#株式市場"><i class="fa fa-check"></i><b>B.2</b> 株式市場</a></li>
<li class="chapter" data-level="B.3" data-path="長期記憶モデルの参考文献.html"><a href="長期記憶モデルの参考文献.html#外国為替市場"><i class="fa fa-check"></i><b>B.3</b> 外国為替市場</a></li>
<li class="chapter" data-level="B.4" data-path="長期記憶モデルの参考文献.html"><a href="長期記憶モデルの参考文献.html#コモディティ暗号資産"><i class="fa fa-check"></i><b>B.4</b> コモディティ・暗号資産</a></li>
<li class="chapter" data-level="B.5" data-path="長期記憶モデルの参考文献.html"><a href="長期記憶モデルの参考文献.html#vix"><i class="fa fa-check"></i><b>B.5</b> VIX</a></li>
<li class="chapter" data-level="B.6" data-path="長期記憶モデルの参考文献.html"><a href="長期記憶モデルの参考文献.html#高頻度データ-ボラティリティ-注文フロー等"><i class="fa fa-check"></i><b>B.6</b> 高頻度データ (ボラティリティ, 注文フロー等)</a></li>
<li class="chapter" data-level="B.7" data-path="長期記憶モデルの参考文献.html"><a href="長期記憶モデルの参考文献.html#長期記憶性の発生要因-非長期記憶モデルによる近似"><i class="fa fa-check"></i><b>B.7</b> 長期記憶性の発生要因, 非長期記憶モデルによる近似</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">金融時系列解析</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="長期記憶過程" class="section level1 hasAnchor" number="6">
<h1><span class="header-section-number">6</span> 長期記憶過程<a href="長期記憶過程.html#長期記憶過程" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="arfimapdq過程のシミュレーション" class="section level2 hasAnchor" number="6.1">
<h2><span class="header-section-number">6.1</span> ARFIMA(p,d,q)過程のシミュレーション<a href="長期記憶過程.html#arfimapdq過程のシミュレーション" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li><strong>fracdiff</strong>パッケージの利用</li>
<li>サンプルパス生成(1): p = 2, d = 0.49, q = 0
<ul>
<li>簡単のため, MA項入れず</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb365"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb365-1"><a href="長期記憶過程.html#cb365-1" tabindex="-1"></a>Tlen <span class="ot">=</span> <span class="dv">300</span></span>
<span id="cb365-2"><a href="長期記憶過程.html#cb365-2" tabindex="-1"></a>Seedv <span class="ot">=</span> <span class="dv">100</span>; <span class="fu">set.seed</span>(Seedv)</span>
<span id="cb365-3"><a href="長期記憶過程.html#cb365-3" tabindex="-1"></a><span class="fu">library</span>(fracdiff)</span>
<span id="cb365-4"><a href="長期記憶過程.html#cb365-4" tabindex="-1"></a>fds_sim <span class="ot">&lt;-</span> <span class="fu">fracdiff.sim</span>(Tlen, <span class="at">ar =</span> <span class="fu">c</span>(<span class="fl">0.7</span>, <span class="sc">-</span><span class="fl">0.2</span>), <span class="at">d =</span> <span class="fl">0.49</span>)  <span class="co"># -0.5&lt;=d&lt;=0.5</span></span>
<span id="cb365-5"><a href="長期記憶過程.html#cb365-5" tabindex="-1"></a>x <span class="ot">&lt;-</span> fds_sim<span class="sc">$</span>series             <span class="co"># 長期記憶系列</span></span>
<span id="cb365-6"><a href="長期記憶過程.html#cb365-6" tabindex="-1"></a><span class="fu">plot</span>(x, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>)</span></code></pre></div>
<p><img src="050-longmemory_files/figure-html/sim_path_8-1.png" width="75%" /></p>
<div class="sourceCode" id="cb366"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb366-1"><a href="長期記憶過程.html#cb366-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb366-2"><a href="長期記憶過程.html#cb366-2" tabindex="-1"></a><span class="fu">acf</span>(x) <span class="co"># 自己相関(ACF)</span></span>
<span id="cb366-3"><a href="長期記憶過程.html#cb366-3" tabindex="-1"></a><span class="fu">pacf</span>(x) <span class="co"># 偏自己相関(PACF)</span></span></code></pre></div>
<p><img src="050-longmemory_files/figure-html/sim_path_8-2.png" width="75%" /></p>
<ul>
<li>サンプルパス生成(2): p = 2, d = 0.1, q = 0</li>
</ul>
<div class="sourceCode" id="cb367"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb367-1"><a href="長期記憶過程.html#cb367-1" tabindex="-1"></a><span class="fu">set.seed</span>(Seedv)</span>
<span id="cb367-2"><a href="長期記憶過程.html#cb367-2" tabindex="-1"></a>fds_sim <span class="ot">&lt;-</span> <span class="fu">fracdiff.sim</span>(Tlen, <span class="at">ar =</span> <span class="fu">c</span>(<span class="fl">0.7</span>, <span class="sc">-</span><span class="fl">0.2</span>), <span class="at">d =</span> <span class="fl">0.1</span>)</span>
<span id="cb367-3"><a href="長期記憶過程.html#cb367-3" tabindex="-1"></a>x <span class="ot">&lt;-</span> fds_sim<span class="sc">$</span>series             <span class="co"># 長期記憶系列</span></span>
<span id="cb367-4"><a href="長期記憶過程.html#cb367-4" tabindex="-1"></a><span class="fu">plot</span>(x, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>)</span></code></pre></div>
<p><img src="050-longmemory_files/figure-html/sim_path_8-2-1.png" width="75%" /></p>
<div class="sourceCode" id="cb368"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb368-1"><a href="長期記憶過程.html#cb368-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb368-2"><a href="長期記憶過程.html#cb368-2" tabindex="-1"></a><span class="fu">acf</span>(x) <span class="co"># 自己相関(ACF)</span></span>
<span id="cb368-3"><a href="長期記憶過程.html#cb368-3" tabindex="-1"></a><span class="fu">pacf</span>(x) <span class="co"># 偏自己相関(PACF)</span></span></code></pre></div>
<p><img src="050-longmemory_files/figure-html/sim_path_8-2-2.png" width="75%" /></p>
<ul>
<li>サンプルパス生成(3): p = 2, d = -0.49, q = 0</li>
</ul>
<div class="sourceCode" id="cb369"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb369-1"><a href="長期記憶過程.html#cb369-1" tabindex="-1"></a><span class="fu">set.seed</span>(Seedv)</span>
<span id="cb369-2"><a href="長期記憶過程.html#cb369-2" tabindex="-1"></a>fds_sim <span class="ot">&lt;-</span> <span class="fu">fracdiff.sim</span>(Tlen, <span class="at">ar =</span> <span class="fu">c</span>(<span class="fl">0.7</span>, <span class="sc">-</span><span class="fl">0.2</span>), <span class="at">d =</span> <span class="sc">-</span><span class="fl">0.49</span>)</span>
<span id="cb369-3"><a href="長期記憶過程.html#cb369-3" tabindex="-1"></a>x <span class="ot">&lt;-</span> fds_sim<span class="sc">$</span>series             <span class="co"># 長期記憶系列</span></span>
<span id="cb369-4"><a href="長期記憶過程.html#cb369-4" tabindex="-1"></a><span class="fu">plot</span>(x, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>)</span></code></pre></div>
<p><img src="050-longmemory_files/figure-html/sim_path_8-3-1.png" width="75%" /></p>
<div class="sourceCode" id="cb370"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb370-1"><a href="長期記憶過程.html#cb370-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb370-2"><a href="長期記憶過程.html#cb370-2" tabindex="-1"></a><span class="fu">acf</span>(x) <span class="co"># 自己相関(ACF)</span></span>
<span id="cb370-3"><a href="長期記憶過程.html#cb370-3" tabindex="-1"></a><span class="fu">pacf</span>(x) <span class="co"># 偏自己相関(PACF)</span></span></code></pre></div>
<p><img src="050-longmemory_files/figure-html/sim_path_8-3-2.png" width="75%" /></p>
</div>
<div id="arfima-fractional-gaussian過程のシミュレーション" class="section level2 hasAnchor" number="6.2">
<h2><span class="header-section-number">6.2</span> ARFIMA, fractional Gaussian過程のシミュレーション<a href="長期記憶過程.html#arfima-fractional-gaussian過程のシミュレーション" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li><strong>longmemo</strong>パッケージの利用</li>
</ul>
<pre><code>- ckARMA0(n, H)
  - Compute the Autocovariances of a fractional ARIMA(0,d,0) process (d = H - 1/2).
  - The theoretical formula, C(k) = (-1)^k Γ(1-2d) / (Γ(k+1-d) Γ(1-k-d)) ,
  where d = H - 1/2, leads to over-/underflow for larger lags k;
  hence use the asymptotical formula there.
- ckFGN0(n, H)
  - Compute the Autocovariances of a fractional Gaussian process</code></pre>
<div class="sourceCode" id="cb372"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb372-1"><a href="長期記憶過程.html#cb372-1" tabindex="-1"></a><span class="do">###########################################################</span></span>
<span id="cb372-2"><a href="長期記憶過程.html#cb372-2" tabindex="-1"></a><span class="co">#install.packages(&quot;longmemo&quot;)</span></span>
<span id="cb372-3"><a href="長期記憶過程.html#cb372-3" tabindex="-1"></a><span class="fu">library</span>(longmemo)</span>
<span id="cb372-4"><a href="長期記憶過程.html#cb372-4" tabindex="-1"></a><span class="co">#data(&quot;NileMin&quot;) # Nile River Minima, yearly 622-1284</span></span>
<span id="cb372-5"><a href="長期記憶過程.html#cb372-5" tabindex="-1"></a><span class="co">#nile &lt;- NileMin</span></span>
<span id="cb372-6"><a href="長期記憶過程.html#cb372-6" tabindex="-1"></a>Seedv <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb372-7"><a href="長期記憶過程.html#cb372-7" tabindex="-1"></a>Tlen <span class="ot">&lt;-</span> <span class="dv">100</span>; Hval <span class="ot">&lt;-</span> <span class="fl">0.9</span></span>
<span id="cb372-8"><a href="長期記憶過程.html#cb372-8" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">ckARMA0</span>(Tlen, <span class="at">H =</span> Hval), <span class="at">type =</span> <span class="st">&quot;h&quot;</span>)</span></code></pre></div>
<p><img src="050-longmemory_files/figure-html/unnamed-chunk-2-1.png" width="75%" /></p>
<div class="sourceCode" id="cb373"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb373-1"><a href="長期記憶過程.html#cb373-1" tabindex="-1"></a><span class="co"># H &gt; 0.5の時のみ</span></span>
<span id="cb373-2"><a href="長期記憶過程.html#cb373-2" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> <span class="dv">0</span><span class="sc">:</span>(Tlen<span class="dv">-1</span>), <span class="fu">ckARMA0</span>(Tlen, <span class="at">H =</span> Hval),</span>
<span id="cb373-3"><a href="長期記憶過程.html#cb373-3" tabindex="-1"></a>      <span class="at">type =</span> <span class="st">&quot;h&quot;</span>, <span class="at">log =</span> <span class="st">&quot;xy&quot;</span>,</span>
<span id="cb373-4"><a href="長期記憶過程.html#cb373-4" tabindex="-1"></a>       <span class="at">main =</span> <span class="fu">paste0</span>(<span class="st">&quot;Log-Log ACF for ARFIMA(0,d,0) with H = &quot;</span>, Hval))</span></code></pre></div>
<p><img src="050-longmemory_files/figure-html/unnamed-chunk-2-2.png" width="75%" /></p>
<div class="sourceCode" id="cb374"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb374-1"><a href="長期記憶過程.html#cb374-1" tabindex="-1"></a><span class="co"># ckFGN0(n, H)</span></span>
<span id="cb374-2"><a href="長期記憶過程.html#cb374-2" tabindex="-1"></a><span class="co"># Compute the Autocovariances of a fractional Gaussian process</span></span>
<span id="cb374-3"><a href="長期記憶過程.html#cb374-3" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">ckFGN0</span>(Tlen, <span class="at">H =</span> Hval), <span class="at">type =</span> <span class="st">&quot;h&quot;</span>)</span></code></pre></div>
<p><img src="050-longmemory_files/figure-html/unnamed-chunk-3-1.png" width="75%" /></p>
<div class="sourceCode" id="cb375"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb375-1"><a href="長期記憶過程.html#cb375-1" tabindex="-1"></a><span class="co"># (H &gt; 0.5の時のみ)</span></span>
<span id="cb375-2"><a href="長期記憶過程.html#cb375-2" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> <span class="dv">0</span><span class="sc">:</span>(Tlen<span class="dv">-1</span>), <span class="fu">ckFGN0</span>(Tlen, <span class="at">H =</span> Hval), </span>
<span id="cb375-3"><a href="長期記憶過程.html#cb375-3" tabindex="-1"></a>       <span class="at">type =</span> <span class="st">&quot;h&quot;</span>, <span class="at">log =</span> <span class="st">&quot;xy&quot;</span>,</span>
<span id="cb375-4"><a href="長期記憶過程.html#cb375-4" tabindex="-1"></a>        <span class="at">main =</span> <span class="fu">paste0</span>(<span class="st">&quot;Log-Log ACF for frac. Gauss. Noise(H = &quot;</span>, Hval, <span class="st">&quot;)&quot;</span>))</span></code></pre></div>
<p><img src="050-longmemory_files/figure-html/unnamed-chunk-3-2.png" width="75%" /></p>
<pre><code>- simGauss: implements the method by Davies and Harte which is relatively fast using the FFT (fft) twice.
  - To simulate ARIMA(p, d, q), (for d in (-1/2, 1,2), you can use arima.sim(n, model = list(ar= .., ma = ..), innov= simARMA0(n,H=d+1/2) , n.start = 0).
  - simFGN.fft() is about twice as fast as simFGN0() and uses Paxson&#39;s proposal, by default via B.specFGN(*, k.approx = 3, adjust = TRUE).</code></pre>
<div class="sourceCode" id="cb377"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb377-1"><a href="長期記憶過程.html#cb377-1" tabindex="-1"></a>Seedv <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb377-2"><a href="長期記憶過程.html#cb377-2" tabindex="-1"></a><span class="fu">set.seed</span>(Seedv)</span>
<span id="cb377-3"><a href="長期記憶過程.html#cb377-3" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">simFGN0</span>(Tlen, <span class="at">H =</span> Hval)</span>
<span id="cb377-4"><a href="長期記憶過程.html#cb377-4" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">simARMA0</span>(Tlen, <span class="at">H =</span> Hval)</span>
<span id="cb377-5"><a href="長期記憶過程.html#cb377-5" tabindex="-1"></a><span class="fu">ts.plot</span>(<span class="fu">ts.union</span>(x1, x2), <span class="at">col =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,</span>
<span id="cb377-6"><a href="長期記憶過程.html#cb377-6" tabindex="-1"></a>        <span class="at">main =</span> <span class="fu">paste0</span>(<span class="st">&quot;frac. Gauss. Noise vs ARFIMA(0,d,0): H = &quot;</span>, Hval))</span></code></pre></div>
<p><img src="050-longmemory_files/figure-html/unnamed-chunk-4-1.png" width="75%" /></p>
<div class="sourceCode" id="cb378"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb378-1"><a href="長期記憶過程.html#cb378-1" tabindex="-1"></a><span class="co">#ts.plot(cbind(x1, x2), col = 1:2, lty = 1:2)</span></span>
<span id="cb378-2"><a href="長期記憶過程.html#cb378-2" tabindex="-1"></a>fBM_path <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">tlen =</span> <span class="dv">100</span>, <span class="at">H =</span> <span class="fl">0.5</span>, <span class="at">sd_val =</span> <span class="dv">1</span>) {</span>
<span id="cb378-3"><a href="長期記憶過程.html#cb378-3" tabindex="-1"></a>  <span class="fu">set.seed</span>(sd_val)</span>
<span id="cb378-4"><a href="長期記憶過程.html#cb378-4" tabindex="-1"></a>  <span class="fu">cumsum</span>(<span class="fu">simFGN0</span>(tlen, H))</span>
<span id="cb378-5"><a href="長期記憶過程.html#cb378-5" tabindex="-1"></a>}</span>
<span id="cb378-6"><a href="長期記憶過程.html#cb378-6" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb378-7"><a href="長期記憶過程.html#cb378-7" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">fBM_path</span>(Tlen, Hval, Seedv), <span class="at">type =</span> <span class="st">&quot;l&quot;</span>)</span></code></pre></div>
<p><img src="050-longmemory_files/figure-html/unnamed-chunk-4-2.png" width="75%" /></p>
<div class="sourceCode" id="cb379"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb379-1"><a href="長期記憶過程.html#cb379-1" tabindex="-1"></a><span class="co"># 異なるHの値でのサンプルパスの比較</span></span>
<span id="cb379-2"><a href="長期記憶過程.html#cb379-2" tabindex="-1"></a>hvals <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.1</span>, <span class="fl">0.8</span>)</span>
<span id="cb379-3"><a href="長期記憶過程.html#cb379-3" tabindex="-1"></a>fBM1 <span class="ot">&lt;-</span> <span class="fu">fBM_path</span>(Tlen, hvals[<span class="dv">1</span>], Seedv)</span>
<span id="cb379-4"><a href="長期記憶過程.html#cb379-4" tabindex="-1"></a>fBM2 <span class="ot">&lt;-</span> <span class="fu">fBM_path</span>(Tlen, hvals[<span class="dv">2</span>], Seedv)</span>
<span id="cb379-5"><a href="長期記憶過程.html#cb379-5" tabindex="-1"></a>fBM3 <span class="ot">&lt;-</span> <span class="fu">fBM_path</span>(Tlen, hvals[<span class="dv">3</span>], Seedv)</span>
<span id="cb379-6"><a href="長期記憶過程.html#cb379-6" tabindex="-1"></a><span class="fu">ts.plot</span>(<span class="fu">cbind</span>(fBM1, fBM2, fBM3), <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>), <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">lwd =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">3</span>),</span>
<span id="cb379-7"><a href="長期記憶過程.html#cb379-7" tabindex="-1"></a>        <span class="at">main =</span> <span class="fu">paste0</span>(<span class="st">&quot;frac. Brownian Motions: H = &quot;</span>, <span class="fu">paste</span>(hvals, <span class="at">collapse =</span> <span class="st">&quot;,&quot;</span>)))</span></code></pre></div>
<p><img src="050-longmemory_files/figure-html/unnamed-chunk-4-3.png" width="75%" /></p>
</div>
<div id="hurst指数の推定" class="section level2 hasAnchor" number="6.3">
<h2><span class="header-section-number">6.3</span> Hurst指数の推定<a href="長期記憶過程.html#hurst指数の推定" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li><strong>pracma</strong>パッケージの利用</li>
</ul>
<pre><code>- hurstexp: R/S分析によるHurst指数推定
- 出力:
  - Hs - simplified R over S approach
  - Hrs - corrected R over S Hurst exponent
  - He - empirical Hurst exponent
  - Hal - corrected empirical Hurst exponent
  - Ht - theoretical Hurst exponent</code></pre>
<div class="sourceCode" id="cb381"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb381-1"><a href="長期記憶過程.html#cb381-1" tabindex="-1"></a><span class="fu">library</span>(pracma)</span>
<span id="cb381-2"><a href="長期記憶過程.html#cb381-2" tabindex="-1"></a><span class="fu">data</span>(brown72)</span>
<span id="cb381-3"><a href="長期記憶過程.html#cb381-3" tabindex="-1"></a>x72 <span class="ot">&lt;-</span> brown72                          <span class="co">#  H = 0.72</span></span>
<span id="cb381-4"><a href="長期記憶過程.html#cb381-4" tabindex="-1"></a>xgn <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1024</span>)                      <span class="co">#  H = 0.50</span></span>
<span id="cb381-5"><a href="長期記憶過程.html#cb381-5" tabindex="-1"></a>xlm <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">1024</span>); xlm[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fl">0.1</span>     <span class="co">#  H = 0.43</span></span>
<span id="cb381-6"><a href="長期記憶過程.html#cb381-6" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">1024</span>) xlm[i] <span class="ot">&lt;-</span> <span class="dv">4</span> <span class="sc">*</span> xlm[i<span class="dv">-1</span>] <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> xlm[i<span class="dv">-1</span>])</span>
<span id="cb381-7"><a href="長期記憶過程.html#cb381-7" tabindex="-1"></a></span>
<span id="cb381-8"><a href="長期記憶過程.html#cb381-8" tabindex="-1"></a><span class="fu">plot</span>(x72, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>)</span></code></pre></div>
<p><img src="050-longmemory_files/figure-html/unnamed-chunk-5-1.png" width="75%" /></p>
<div class="sourceCode" id="cb382"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb382-1"><a href="長期記憶過程.html#cb382-1" tabindex="-1"></a><span class="fu">plot</span>(xgn, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>)</span></code></pre></div>
<p><img src="050-longmemory_files/figure-html/unnamed-chunk-5-2.png" width="75%" /></p>
<div class="sourceCode" id="cb383"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb383-1"><a href="長期記憶過程.html#cb383-1" tabindex="-1"></a><span class="fu">plot</span>(xlm, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>)</span></code></pre></div>
<p><img src="050-longmemory_files/figure-html/unnamed-chunk-5-3.png" width="75%" /></p>
<div class="sourceCode" id="cb384"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb384-1"><a href="長期記憶過程.html#cb384-1" tabindex="-1"></a></span>
<span id="cb384-2"><a href="長期記憶過程.html#cb384-2" tabindex="-1"></a><span class="fu">hurstexp</span>(brown72) <span class="co"># d: smallest box size (default = 50)</span></span>
<span id="cb384-3"><a href="長期記憶過程.html#cb384-3" tabindex="-1"></a><span class="do">## Simple R/S Hurst estimation:         0.6628842 </span></span>
<span id="cb384-4"><a href="長期記憶過程.html#cb384-4" tabindex="-1"></a><span class="do">## Corrected R over S Hurst exponent:   0.7378703 </span></span>
<span id="cb384-5"><a href="長期記憶過程.html#cb384-5" tabindex="-1"></a><span class="do">## Empirical Hurst exponent:            0.6920439 </span></span>
<span id="cb384-6"><a href="長期記憶過程.html#cb384-6" tabindex="-1"></a><span class="do">## Corrected empirical Hurst exponent:  0.6577233 </span></span>
<span id="cb384-7"><a href="長期記憶過程.html#cb384-7" tabindex="-1"></a><span class="do">## Theoretical Hurst exponent:          0.5404756</span></span>
<span id="cb384-8"><a href="長期記憶過程.html#cb384-8" tabindex="-1"></a><span class="fu">hurstexp</span>(xgn)</span>
<span id="cb384-9"><a href="長期記憶過程.html#cb384-9" tabindex="-1"></a><span class="do">## Simple R/S Hurst estimation:         0.4784489 </span></span>
<span id="cb384-10"><a href="長期記憶過程.html#cb384-10" tabindex="-1"></a><span class="do">## Corrected R over S Hurst exponent:   0.4898617 </span></span>
<span id="cb384-11"><a href="長期記憶過程.html#cb384-11" tabindex="-1"></a><span class="do">## Empirical Hurst exponent:            0.5041802 </span></span>
<span id="cb384-12"><a href="長期記憶過程.html#cb384-12" tabindex="-1"></a><span class="do">## Corrected empirical Hurst exponent:  0.4636032 </span></span>
<span id="cb384-13"><a href="長期記憶過程.html#cb384-13" tabindex="-1"></a><span class="do">## Theoretical Hurst exponent:          0.5404756</span></span>
<span id="cb384-14"><a href="長期記憶過程.html#cb384-14" tabindex="-1"></a><span class="fu">hurstexp</span>(xlm)</span>
<span id="cb384-15"><a href="長期記憶過程.html#cb384-15" tabindex="-1"></a><span class="do">## Simple R/S Hurst estimation:         0.4762169 </span></span>
<span id="cb384-16"><a href="長期記憶過程.html#cb384-16" tabindex="-1"></a><span class="do">## Corrected R over S Hurst exponent:   0.4722421 </span></span>
<span id="cb384-17"><a href="長期記憶過程.html#cb384-17" tabindex="-1"></a><span class="do">## Empirical Hurst exponent:            0.4872281 </span></span>
<span id="cb384-18"><a href="長期記憶過程.html#cb384-18" tabindex="-1"></a><span class="do">## Corrected empirical Hurst exponent:  0.4460807 </span></span>
<span id="cb384-19"><a href="長期記憶過程.html#cb384-19" tabindex="-1"></a><span class="do">## Theoretical Hurst exponent:          0.5404756</span></span></code></pre></div>
<ul>
<li><strong>fractal</strong>パッケージの利用</li>
</ul>
<div class="sourceCode" id="cb385"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb385-1"><a href="長期記憶過程.html#cb385-1" tabindex="-1"></a><span class="fu">library</span>(fractal)</span>
<span id="cb385-2"><a href="長期記憶過程.html#cb385-2" tabindex="-1"></a>x <span class="ot">&lt;-</span> x72</span>
<span id="cb385-3"><a href="長期記憶過程.html#cb385-3" tabindex="-1"></a><span class="fu">hurstSpec</span>(x)</span>
<span id="cb385-4"><a href="長期記憶過程.html#cb385-4" tabindex="-1"></a><span class="fu">RoverS</span>(x)</span>
<span id="cb385-5"><a href="長期記憶過程.html#cb385-5" tabindex="-1"></a><span class="fu">hurstBlock</span>(x, <span class="at">method=</span><span class="st">&quot;aggAbs&quot;</span>)</span>
<span id="cb385-6"><a href="長期記憶過程.html#cb385-6" tabindex="-1"></a><span class="fu">hurstBlock</span>(x, <span class="at">method=</span><span class="st">&quot;aggVar&quot;</span>)</span>
<span id="cb385-7"><a href="長期記憶過程.html#cb385-7" tabindex="-1"></a><span class="fu">hurstBlock</span>(x, <span class="at">method=</span><span class="st">&quot;diffvar&quot;</span>)</span>
<span id="cb385-8"><a href="長期記憶過程.html#cb385-8" tabindex="-1"></a><span class="fu">hurstBlock</span>(x, <span class="at">method=</span><span class="st">&quot;higuchi&quot;</span>)</span></code></pre></div>
</div>
<div id="arfimaモデルの推定" class="section level2 hasAnchor" number="6.4">
<h2><span class="header-section-number">6.4</span> ARFIMAモデルの推定<a href="長期記憶過程.html#arfimaモデルの推定" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="最尤法" class="section level3 hasAnchor" number="6.4.1">
<h3><span class="header-section-number">6.4.1</span> 最尤法<a href="長期記憶過程.html#最尤法" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>誤ってARモデルを選択した場合</li>
</ul>
<div class="sourceCode" id="cb386"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb386-1"><a href="長期記憶過程.html#cb386-1" tabindex="-1"></a><span class="fu">set.seed</span>(Seedv)</span>
<span id="cb386-2"><a href="長期記憶過程.html#cb386-2" tabindex="-1"></a>fds_sim <span class="ot">&lt;-</span> <span class="fu">fracdiff.sim</span>(Tlen, <span class="at">ar =</span> <span class="fu">c</span>(<span class="fl">0.7</span>, <span class="sc">-</span><span class="fl">0.2</span>), <span class="at">d =</span> <span class="sc">-</span><span class="fl">0.49</span>)</span>
<span id="cb386-3"><a href="長期記憶過程.html#cb386-3" tabindex="-1"></a>x <span class="ot">&lt;-</span> fds_sim<span class="sc">$</span>series             <span class="co"># 長期記憶系列</span></span>
<span id="cb386-4"><a href="長期記憶過程.html#cb386-4" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb386-5"><a href="長期記憶過程.html#cb386-5" tabindex="-1"></a>(ar_fit <span class="ot">&lt;-</span> <span class="fu">ar</span>(x, <span class="at">method =</span> <span class="st">&quot;mle&quot;</span>))</span>
<span id="cb386-6"><a href="長期記憶過程.html#cb386-6" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb386-7"><a href="長期記憶過程.html#cb386-7" tabindex="-1"></a><span class="do">## Call:</span></span>
<span id="cb386-8"><a href="長期記憶過程.html#cb386-8" tabindex="-1"></a><span class="do">## ar(x = x, method = &quot;mle&quot;)</span></span>
<span id="cb386-9"><a href="長期記憶過程.html#cb386-9" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb386-10"><a href="長期記憶過程.html#cb386-10" tabindex="-1"></a><span class="do">## Coefficients:</span></span>
<span id="cb386-11"><a href="長期記憶過程.html#cb386-11" tabindex="-1"></a><span class="do">##       1        2        3        4        5        6  </span></span>
<span id="cb386-12"><a href="長期記憶過程.html#cb386-12" tabindex="-1"></a><span class="do">##  0.2060  -0.2321  -0.2082  -0.1717  -0.1534  -0.1875  </span></span>
<span id="cb386-13"><a href="長期記憶過程.html#cb386-13" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb386-14"><a href="長期記憶過程.html#cb386-14" tabindex="-1"></a><span class="do">## Order selected 6  sigma^2 estimated as  0.7814</span></span></code></pre></div>
<ul>
<li><p>→ 大きい<span class="math inline">\(p\)</span>を選択</p></li>
<li><p>AR係数, MA係数, 階差次数<span class="math inline">\(d\)</span>を最尤推定 (以下, <span class="math inline">\(p=2\)</span>を正しくしていたと仮定)</p></li>
</ul>
<div class="sourceCode" id="cb387"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb387-1"><a href="長期記憶過程.html#cb387-1" tabindex="-1"></a><span class="co"># nar=p, nma=q      # AR, MAパラメーター数</span></span>
<span id="cb387-2"><a href="長期記憶過程.html#cb387-2" tabindex="-1"></a>(fds_fit <span class="ot">&lt;-</span> <span class="fu">fracdiff</span>(x, <span class="at">nar =</span> <span class="dv">2</span>))</span>
<span id="cb387-3"><a href="長期記憶過程.html#cb387-3" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb387-4"><a href="長期記憶過程.html#cb387-4" tabindex="-1"></a><span class="do">## Call:</span></span>
<span id="cb387-5"><a href="長期記憶過程.html#cb387-5" tabindex="-1"></a><span class="do">##   fracdiff(x = x, nar = 2) </span></span>
<span id="cb387-6"><a href="長期記憶過程.html#cb387-6" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb387-7"><a href="長期記憶過程.html#cb387-7" tabindex="-1"></a><span class="do">## Coefficients:</span></span>
<span id="cb387-8"><a href="長期記憶過程.html#cb387-8" tabindex="-1"></a><span class="do">##             d           ar1           ar2 </span></span>
<span id="cb387-9"><a href="長期記憶過程.html#cb387-9" tabindex="-1"></a><span class="do">##  4.583013e-05  3.478729e-01 -2.143891e-01 </span></span>
<span id="cb387-10"><a href="長期記憶過程.html#cb387-10" tabindex="-1"></a><span class="do">## sigma[eps] = 0.9577181 </span></span>
<span id="cb387-11"><a href="長期記憶過程.html#cb387-11" tabindex="-1"></a><span class="do">## a list with components:</span></span>
<span id="cb387-12"><a href="長期記憶過程.html#cb387-12" tabindex="-1"></a><span class="do">##  [1] &quot;log.likelihood&quot;  &quot;n&quot;               &quot;msg&quot;             &quot;d&quot;              </span></span>
<span id="cb387-13"><a href="長期記憶過程.html#cb387-13" tabindex="-1"></a><span class="do">##  [5] &quot;ar&quot;              &quot;ma&quot;              &quot;covariance.dpq&quot;  &quot;fnormMin&quot;       </span></span>
<span id="cb387-14"><a href="長期記憶過程.html#cb387-14" tabindex="-1"></a><span class="do">##  [9] &quot;sigma&quot;           &quot;stderror.dpq&quot;    &quot;correlation.dpq&quot; &quot;h&quot;              </span></span>
<span id="cb387-15"><a href="長期記憶過程.html#cb387-15" tabindex="-1"></a><span class="do">## [13] &quot;d.tol&quot;           &quot;M&quot;               &quot;hessian.dpq&quot;     &quot;length.w&quot;       </span></span>
<span id="cb387-16"><a href="長期記憶過程.html#cb387-16" tabindex="-1"></a><span class="do">## [17] &quot;residuals&quot;       &quot;fitted&quot;          &quot;call&quot;</span></span></code></pre></div>
<ul>
<li><p>→ 通常は<span class="math inline">\(p,q\)</span>は未知　→　複数のnar, nmaを試すべき</p></li>
<li><p><strong>nsarfima</strong>パッケージの利用</p></li>
</ul>
<div class="sourceCode" id="cb388"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb388-1"><a href="長期記憶過程.html#cb388-1" tabindex="-1"></a><span class="fu">library</span>(nsarfima)</span>
<span id="cb388-2"><a href="長期記憶過程.html#cb388-2" tabindex="-1"></a><span class="co"># nar = p, nma = q      # AR, MAパラメーター数</span></span>
<span id="cb388-3"><a href="長期記憶過程.html#cb388-3" tabindex="-1"></a>(arfima.fit <span class="ot">&lt;-</span> <span class="fu">mle.arfima</span>(x, <span class="at">p =</span> <span class="dv">2</span>))</span>
<span id="cb388-4"><a href="長期記憶過程.html#cb388-4" tabindex="-1"></a><span class="do">## $pars</span></span>
<span id="cb388-5"><a href="長期記憶過程.html#cb388-5" tabindex="-1"></a><span class="do">##            mu          sig2             d          ar.1          ar.2 </span></span>
<span id="cb388-6"><a href="長期記憶過程.html#cb388-6" tabindex="-1"></a><span class="do">## -1.267263e-02  9.022758e-01  5.522776e-08  3.414323e-01 -2.625068e-01 </span></span>
<span id="cb388-7"><a href="長期記憶過程.html#cb388-7" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb388-8"><a href="長期記憶過程.html#cb388-8" tabindex="-1"></a><span class="do">## $std.errs</span></span>
<span id="cb388-9"><a href="長期記憶過程.html#cb388-9" tabindex="-1"></a><span class="do">##        mu      sig2         d      ar.1      ar.2 </span></span>
<span id="cb388-10"><a href="長期記憶過程.html#cb388-10" tabindex="-1"></a><span class="do">## 0.1016556 0.1395288 0.1733823 0.2163811 0.1612114 </span></span>
<span id="cb388-11"><a href="長期記憶過程.html#cb388-11" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb388-12"><a href="長期記憶過程.html#cb388-12" tabindex="-1"></a><span class="do">## $cov.mat</span></span>
<span id="cb388-13"><a href="長期記憶過程.html#cb388-13" tabindex="-1"></a><span class="do">##              sig2           d        ar.1         ar.2</span></span>
<span id="cb388-14"><a href="長期記憶過程.html#cb388-14" tabindex="-1"></a><span class="do">## sig2  0.019468294  0.00740705 -0.01170439 -0.004266261</span></span>
<span id="cb388-15"><a href="長期記憶過程.html#cb388-15" tabindex="-1"></a><span class="do">## d     0.007407050  0.03006142 -0.03229578 -0.021628130</span></span>
<span id="cb388-16"><a href="長期記憶過程.html#cb388-16" tabindex="-1"></a><span class="do">## ar.1 -0.011704389 -0.03229578  0.04682076  0.024479505</span></span>
<span id="cb388-17"><a href="長期記憶過程.html#cb388-17" tabindex="-1"></a><span class="do">## ar.2 -0.004266261 -0.02162813  0.02447951  0.025989126</span></span>
<span id="cb388-18"><a href="長期記憶過程.html#cb388-18" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb388-19"><a href="長期記憶過程.html#cb388-19" tabindex="-1"></a><span class="do">## $fit.obj</span></span>
<span id="cb388-20"><a href="長期記憶過程.html#cb388-20" tabindex="-1"></a><span class="do">## $fit.obj$par</span></span>
<span id="cb388-21"><a href="長期記憶過程.html#cb388-21" tabindex="-1"></a><span class="do">##             d          ar.1          ar.2 </span></span>
<span id="cb388-22"><a href="長期記憶過程.html#cb388-22" tabindex="-1"></a><span class="do">##  5.522776e-08  3.414323e-01 -2.625068e-01 </span></span>
<span id="cb388-23"><a href="長期記憶過程.html#cb388-23" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb388-24"><a href="長期記憶過程.html#cb388-24" tabindex="-1"></a><span class="do">## $fit.obj$value</span></span>
<span id="cb388-25"><a href="長期記憶過程.html#cb388-25" tabindex="-1"></a><span class="do">## [1] 89.3253</span></span>
<span id="cb388-26"><a href="長期記憶過程.html#cb388-26" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb388-27"><a href="長期記憶過程.html#cb388-27" tabindex="-1"></a><span class="do">## $fit.obj$counts</span></span>
<span id="cb388-28"><a href="長期記憶過程.html#cb388-28" tabindex="-1"></a><span class="do">## function gradient </span></span>
<span id="cb388-29"><a href="長期記憶過程.html#cb388-29" tabindex="-1"></a><span class="do">##      208       NA </span></span>
<span id="cb388-30"><a href="長期記憶過程.html#cb388-30" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb388-31"><a href="長期記憶過程.html#cb388-31" tabindex="-1"></a><span class="do">## $fit.obj$convergence</span></span>
<span id="cb388-32"><a href="長期記憶過程.html#cb388-32" tabindex="-1"></a><span class="do">## [1] 0</span></span>
<span id="cb388-33"><a href="長期記憶過程.html#cb388-33" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb388-34"><a href="長期記憶過程.html#cb388-34" tabindex="-1"></a><span class="do">## $fit.obj$message</span></span>
<span id="cb388-35"><a href="長期記憶過程.html#cb388-35" tabindex="-1"></a><span class="do">## NULL</span></span>
<span id="cb388-36"><a href="長期記憶過程.html#cb388-36" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb388-37"><a href="長期記憶過程.html#cb388-37" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb388-38"><a href="長期記憶過程.html#cb388-38" tabindex="-1"></a><span class="do">## $p.val</span></span>
<span id="cb388-39"><a href="長期記憶過程.html#cb388-39" tabindex="-1"></a><span class="do">## [1] 0.8912225</span></span>
<span id="cb388-40"><a href="長期記憶過程.html#cb388-40" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb388-41"><a href="長期記憶過程.html#cb388-41" tabindex="-1"></a><span class="do">## $residuals</span></span>
<span id="cb388-42"><a href="長期記憶過程.html#cb388-42" tabindex="-1"></a><span class="do">##   [1] -0.6764961052 -0.2968632520 -1.2310910722  1.4561378726 -0.0388534504</span></span>
<span id="cb388-43"><a href="長期記憶過程.html#cb388-43" tabindex="-1"></a><span class="do">##   [6] -0.8423204011  0.4686722844  0.4643382756  0.4107973532 -0.4309650411</span></span>
<span id="cb388-44"><a href="長期記憶過程.html#cb388-44" tabindex="-1"></a><span class="do">##  [11]  1.4299789135 -0.0006787575 -0.7857763053 -2.3890626204  1.1014635252</span></span>
<span id="cb388-45"><a href="長期記憶過程.html#cb388-45" tabindex="-1"></a><span class="do">##  [16] -0.3966402031  0.1652482404  1.0616568645  0.7446050471  0.5154245086</span></span>
<span id="cb388-46"><a href="長期記憶過程.html#cb388-46" tabindex="-1"></a><span class="do">##  [21]  0.7564241338  0.4668174692 -0.2693729499 -2.3064083881  0.5227350640</span></span>
<span id="cb388-47"><a href="長期記憶過程.html#cb388-47" tabindex="-1"></a><span class="do">##  [26] -0.4642720829 -0.1309552624 -1.4100725427 -0.2774497899  0.4650877267</span></span>
<span id="cb388-48"><a href="長期記憶過程.html#cb388-48" tabindex="-1"></a><span class="do">##  [31]  1.4649891568 -0.0290343810  0.5782727746 -0.1757284573 -1.4912805335</span></span>
<span id="cb388-49"><a href="長期記憶過程.html#cb388-49" tabindex="-1"></a><span class="do">##  [36] -0.3789621380 -0.4655630075  0.0738483187  1.2914770769  0.8336925539</span></span>
<span id="cb388-50"><a href="長期記憶過程.html#cb388-50" tabindex="-1"></a><span class="do">##  [41] -0.0737873115 -0.2251819617  0.5774490180  0.3286308280 -0.8047251630</span></span>
<span id="cb388-51"><a href="長期記憶過程.html#cb388-51" tabindex="-1"></a><span class="do">##  [46] -0.6986673145  0.2958393665  0.6510135686 -0.1339248247  0.9675384987</span></span>
<span id="cb388-52"><a href="長期記憶過程.html#cb388-52" tabindex="-1"></a><span class="do">##  [51]  0.2259759735 -0.7281405491  0.2716268869 -1.3784731074  1.4943394505</span></span>
<span id="cb388-53"><a href="長期記憶過程.html#cb388-53" tabindex="-1"></a><span class="do">##  [56]  1.7164276897 -0.5272803532 -1.0201592423  0.3729804733 -0.5359889283</span></span>
<span id="cb388-54"><a href="長期記憶過程.html#cb388-54" tabindex="-1"></a><span class="do">##  [61]  2.3350415888 -0.4086512940  0.6924717331 -0.3606512486 -1.0759283895</span></span>
<span id="cb388-55"><a href="長期記憶過程.html#cb388-55" tabindex="-1"></a><span class="do">##  [66] -0.0506511539 -2.1101132511  1.5976097508 -0.1172982949  2.3325016401</span></span>
<span id="cb388-56"><a href="長期記憶過程.html#cb388-56" tabindex="-1"></a><span class="do">##  [71]  0.2254993256 -0.8129057325  0.3788283790 -1.4331970583 -1.3747001462</span></span>
<span id="cb388-57"><a href="長期記憶過程.html#cb388-57" tabindex="-1"></a><span class="do">##  [76]  0.2411732472 -0.5537230862  0.2049218798  0.2004499504 -0.4766722677</span></span>
<span id="cb388-58"><a href="長期記憶過程.html#cb388-58" tabindex="-1"></a><span class="do">##  [81] -0.4042575452 -0.0270582246  1.2728679869 -1.5304518129  0.9624356049</span></span>
<span id="cb388-59"><a href="長期記憶過程.html#cb388-59" tabindex="-1"></a><span class="do">##  [86]  0.2186716228  1.1235112273 -0.3688834767  0.4233844401  0.0726586865</span></span>
<span id="cb388-60"><a href="長期記憶過程.html#cb388-60" tabindex="-1"></a><span class="do">##  [91] -0.6954346528  1.1689570269  0.8808727109  0.5369119812  1.3879840390</span></span>
<span id="cb388-61"><a href="長期記憶過程.html#cb388-61" tabindex="-1"></a><span class="do">##  [96]  0.0879308998 -1.6719344153 -0.8630402713 -1.6381541198 -0.5431240556</span></span></code></pre></div>
<ul>
<li><p>モデル診断/残差チェック方法の例</p>
<ul>
<li>時系列データ<span class="math inline">\(x_t\)</span>と<span class="math inline">\(d\)</span>の推定値(初期値)があるとする</li>
<li>推定された<span class="math inline">\(d\)</span>が正しい値ならば, <span class="math inline">\(Y_t=(1-B)^d X_t\)</span>はARMA過程になるはず</li>
<li><span class="math inline">\(x_t\)</span>より, パス<span class="math inline">\(y_t\)</span>を(近似的に)生成する (get_fracdiff_ts関数使用. 配布のRコード参照)</li>
<li>ARMAモデルを生成パス<span class="math inline">\(y_t\)</span>に適合する. 得られる残差系列が白色ノイズか?</li>
<li>(納得いくまで) 候補を変えて試す.</li>
</ul></li>
<li><p>ここでは, AR(p)モデルに限定. 以下, 上で生成したパス<span class="math inline">\(x_t\)</span>, 得られた<span class="math inline">\(d\)</span>の推定値をそのまま使用.</p></li>
<li><p>長期記憶過程xより非整数階差系列yを生成する関数 (以下で使用)</p></li>
</ul>
<div class="sourceCode" id="cb389"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb389-1"><a href="長期記憶過程.html#cb389-1" tabindex="-1"></a><span class="co"># 参考: Cowpertwait and Metcalfe(2009), Ch.8</span></span>
<span id="cb389-2"><a href="長期記憶過程.html#cb389-2" tabindex="-1"></a>get_fracdiff_ts <span class="ot">&lt;-</span> <span class="cf">function</span>(x, d, <span class="at">L =</span> <span class="dv">30</span>){  </span>
<span id="cb389-3"><a href="長期記憶過程.html#cb389-3" tabindex="-1"></a><span class="co"># L: 項の打ち切り数</span></span>
<span id="cb389-4"><a href="長期記憶過程.html#cb389-4" tabindex="-1"></a>    n <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb389-5"><a href="長期記憶過程.html#cb389-5" tabindex="-1"></a></span>
<span id="cb389-6"><a href="長期記憶過程.html#cb389-6" tabindex="-1"></a>    <span class="co"># fdc: (1-B)^dの2項展開係数ベクトルを生成</span></span>
<span id="cb389-7"><a href="長期記憶過程.html#cb389-7" tabindex="-1"></a>    fdc <span class="ot">&lt;-</span> d                </span>
<span id="cb389-8"><a href="長期記憶過程.html#cb389-8" tabindex="-1"></a>    fdc[<span class="dv">1</span>] <span class="ot">&lt;-</span> fdc</span>
<span id="cb389-9"><a href="長期記憶過程.html#cb389-9" tabindex="-1"></a>    <span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>L) fdc[k] <span class="ot">&lt;-</span> fdc[k<span class="dv">-1</span>] <span class="sc">*</span> (d<span class="sc">+</span><span class="dv">1</span><span class="sc">-</span>k) <span class="sc">/</span> k </span>
<span id="cb389-10"><a href="長期記憶過程.html#cb389-10" tabindex="-1"></a>    </span>
<span id="cb389-11"><a href="長期記憶過程.html#cb389-11" tabindex="-1"></a>    <span class="co"># y, 非整数階差系列(fractionally differenced series)を生成</span></span>
<span id="cb389-12"><a href="長期記憶過程.html#cb389-12" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, L)</span>
<span id="cb389-13"><a href="長期記憶過程.html#cb389-13" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> (L<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n) {</span>
<span id="cb389-14"><a href="長期記憶過程.html#cb389-14" tabindex="-1"></a>        csm <span class="ot">&lt;-</span> x[i]     <span class="co"># x, 原系列（長期記憶過程)</span></span>
<span id="cb389-15"><a href="長期記憶過程.html#cb389-15" tabindex="-1"></a>        </span>
<span id="cb389-16"><a href="長期記憶過程.html#cb389-16" tabindex="-1"></a>            <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>L) csm <span class="ot">&lt;-</span> csm <span class="sc">+</span> ((<span class="sc">-</span><span class="dv">1</span>)<span class="sc">^</span>j) <span class="sc">*</span> fdc[j] <span class="sc">*</span> x[i<span class="sc">-</span>j]</span>
<span id="cb389-17"><a href="長期記憶過程.html#cb389-17" tabindex="-1"></a>                y[i] <span class="ot">&lt;-</span> csm     </span>
<span id="cb389-18"><a href="長期記憶過程.html#cb389-18" tabindex="-1"></a>    }</span>
<span id="cb389-19"><a href="長期記憶過程.html#cb389-19" tabindex="-1"></a>    y <span class="ot">&lt;-</span> y[(L<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n]</span>
<span id="cb389-20"><a href="長期記憶過程.html#cb389-20" tabindex="-1"></a>    <span class="fu">return</span>(y)</span>
<span id="cb389-21"><a href="長期記憶過程.html#cb389-21" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb390"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb390-1"><a href="長期記憶過程.html#cb390-1" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">get_fracdiff_ts</span>(x, fds_fit<span class="sc">$</span>d)  <span class="co"># {x_t}より非整数階差系列{y_t}を生成</span></span>
<span id="cb390-2"><a href="長期記憶過程.html#cb390-2" tabindex="-1"></a>(z.ar <span class="ot">&lt;-</span> <span class="fu">ar</span>(y))     <span class="co"># ARモデルをフィット</span></span>
<span id="cb390-3"><a href="長期記憶過程.html#cb390-3" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb390-4"><a href="長期記憶過程.html#cb390-4" tabindex="-1"></a><span class="do">## Call:</span></span>
<span id="cb390-5"><a href="長期記憶過程.html#cb390-5" tabindex="-1"></a><span class="do">## ar(x = y)</span></span>
<span id="cb390-6"><a href="長期記憶過程.html#cb390-6" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb390-7"><a href="長期記憶過程.html#cb390-7" tabindex="-1"></a><span class="do">## Coefficients:</span></span>
<span id="cb390-8"><a href="長期記憶過程.html#cb390-8" tabindex="-1"></a><span class="do">##       1        2        3        4  </span></span>
<span id="cb390-9"><a href="長期記憶過程.html#cb390-9" tabindex="-1"></a><span class="do">##  0.2598  -0.0943  -0.1637  -0.2469  </span></span>
<span id="cb390-10"><a href="長期記憶過程.html#cb390-10" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb390-11"><a href="長期記憶過程.html#cb390-11" tabindex="-1"></a><span class="do">## Order selected 4  sigma^2 estimated as  0.8692</span></span>
<span id="cb390-12"><a href="長期記憶過程.html#cb390-12" tabindex="-1"></a>ns <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">+</span> z.ar<span class="sc">$</span>order</span>
<span id="cb390-13"><a href="長期記憶過程.html#cb390-13" tabindex="-1"></a>z <span class="ot">&lt;-</span> z.ar<span class="sc">$</span>res [ns<span class="sc">:</span><span class="fu">length</span>(y)]  <span class="co"># z.ar$resの最初のns個は欠損</span></span>
<span id="cb390-14"><a href="長期記憶過程.html#cb390-14" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfcol =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb390-15"><a href="長期記憶過程.html#cb390-15" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">as.ts</span>(x), <span class="at">ylab =</span> <span class="st">&quot;x&quot;</span>)</span>
<span id="cb390-16"><a href="長期記憶過程.html#cb390-16" tabindex="-1"></a><span class="fu">acf</span>(x) ; <span class="fu">acf</span>(y) ; <span class="fu">acf</span>(z)</span></code></pre></div>
<p><img src="050-longmemory_files/figure-html/arfima_res-1.png" width="75%" /></p>
<div class="sourceCode" id="cb391"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb391-1"><a href="長期記憶過程.html#cb391-1" tabindex="-1"></a><span class="fu">Box.test</span>(z, <span class="at">lag =</span> <span class="dv">30</span>, <span class="at">type =</span> <span class="st">&quot;Ljung&quot;</span>)</span>
<span id="cb391-2"><a href="長期記憶過程.html#cb391-2" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb391-3"><a href="長期記憶過程.html#cb391-3" tabindex="-1"></a><span class="do">##  Box-Ljung test</span></span>
<span id="cb391-4"><a href="長期記憶過程.html#cb391-4" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb391-5"><a href="長期記憶過程.html#cb391-5" tabindex="-1"></a><span class="do">## data:  z</span></span>
<span id="cb391-6"><a href="長期記憶過程.html#cb391-6" tabindex="-1"></a><span class="do">## X-squared = 29.658, df = 30, p-value = 0.4833</span></span></code></pre></div>
</div>
<div id="階差次数dの代替的推定法" class="section level3 hasAnchor" number="6.4.2">
<h3><span class="header-section-number">6.4.2</span> 階差次数<span class="math inline">\(d\)</span>の代替的推定法<a href="長期記憶過程.html#階差次数dの代替的推定法" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><strong>fracdiff</strong>パッケージ利用</li>
<li>Geweke and Porter-Hudak(83), Reisen(94)
<ul>
<li>時系列データのperidogram (スペクトル密度の推定値) ベース</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb392"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb392-1"><a href="長期記憶過程.html#cb392-1" tabindex="-1"></a><span class="co"># library(fracdiff)</span></span>
<span id="cb392-2"><a href="長期記憶過程.html#cb392-2" tabindex="-1"></a><span class="co"># Geweke and Porter-Hudak(83)の方法</span></span>
<span id="cb392-3"><a href="長期記憶過程.html#cb392-3" tabindex="-1"></a>(<span class="at">d_GPH =</span> <span class="fu">fdGPH</span>(x))</span>
<span id="cb392-4"><a href="長期記憶過程.html#cb392-4" tabindex="-1"></a><span class="do">## $d</span></span>
<span id="cb392-5"><a href="長期記憶過程.html#cb392-5" tabindex="-1"></a><span class="do">## [1] -0.7167363</span></span>
<span id="cb392-6"><a href="長期記憶過程.html#cb392-6" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb392-7"><a href="長期記憶過程.html#cb392-7" tabindex="-1"></a><span class="do">## $sd.as</span></span>
<span id="cb392-8"><a href="長期記憶過程.html#cb392-8" tabindex="-1"></a><span class="do">## [1] 0.2935592</span></span>
<span id="cb392-9"><a href="長期記憶過程.html#cb392-9" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb392-10"><a href="長期記憶過程.html#cb392-10" tabindex="-1"></a><span class="do">## $sd.reg</span></span>
<span id="cb392-11"><a href="長期記憶過程.html#cb392-11" tabindex="-1"></a><span class="do">## [1] 0.2232167</span></span>
<span id="cb392-12"><a href="長期記憶過程.html#cb392-12" tabindex="-1"></a><span class="co"># Reisen(94)の方法</span></span>
<span id="cb392-13"><a href="長期記憶過程.html#cb392-13" tabindex="-1"></a>(<span class="at">d_Sper =</span> <span class="fu">fdSperio</span>(x))</span>
<span id="cb392-14"><a href="長期記憶過程.html#cb392-14" tabindex="-1"></a><span class="do">## $d</span></span>
<span id="cb392-15"><a href="長期記憶過程.html#cb392-15" tabindex="-1"></a><span class="do">## [1] -0.6491031</span></span>
<span id="cb392-16"><a href="長期記憶過程.html#cb392-16" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb392-17"><a href="長期記憶過程.html#cb392-17" tabindex="-1"></a><span class="do">## $sd.as</span></span>
<span id="cb392-18"><a href="長期記憶過程.html#cb392-18" tabindex="-1"></a><span class="do">## [1] 0.1334138</span></span>
<span id="cb392-19"><a href="長期記憶過程.html#cb392-19" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb392-20"><a href="長期記憶過程.html#cb392-20" tabindex="-1"></a><span class="do">## $sd.reg</span></span>
<span id="cb392-21"><a href="長期記憶過程.html#cb392-21" tabindex="-1"></a><span class="do">## [1] 0.08329104</span></span></code></pre></div>
<div class="sourceCode" id="cb393"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb393-1"><a href="長期記憶過程.html#cb393-1" tabindex="-1"></a><span class="co"># GPH推定値の使用</span></span>
<span id="cb393-2"><a href="長期記憶過程.html#cb393-2" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">get_fracdiff_ts</span>(x, d_GPH<span class="sc">$</span>d) <span class="co"># {x_t}より非整数階差系列{y_t}を生成</span></span>
<span id="cb393-3"><a href="長期記憶過程.html#cb393-3" tabindex="-1"></a><span class="co"># ARMAモデルの適合に, forecastパッケージのauto.arima関数使用</span></span>
<span id="cb393-4"><a href="長期記憶過程.html#cb393-4" tabindex="-1"></a><span class="fu">library</span>(forecast)</span>
<span id="cb393-5"><a href="長期記憶過程.html#cb393-5" tabindex="-1"></a>(y_fit <span class="ot">&lt;-</span> <span class="fu">auto.arima</span>(y))        <span class="co"># ARモデルをフィット</span></span>
<span id="cb393-6"><a href="長期記憶過程.html#cb393-6" tabindex="-1"></a><span class="do">## Series: y </span></span>
<span id="cb393-7"><a href="長期記憶過程.html#cb393-7" tabindex="-1"></a><span class="do">## ARIMA(0,0,3) with zero mean </span></span>
<span id="cb393-8"><a href="長期記憶過程.html#cb393-8" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb393-9"><a href="長期記憶過程.html#cb393-9" tabindex="-1"></a><span class="do">## Coefficients:</span></span>
<span id="cb393-10"><a href="長期記憶過程.html#cb393-10" tabindex="-1"></a><span class="do">##          ma1     ma2     ma3</span></span>
<span id="cb393-11"><a href="長期記憶過程.html#cb393-11" tabindex="-1"></a><span class="do">##       0.8403  0.5521  0.2549</span></span>
<span id="cb393-12"><a href="長期記憶過程.html#cb393-12" tabindex="-1"></a><span class="do">## s.e.  0.1171  0.1411  0.1297</span></span>
<span id="cb393-13"><a href="長期記憶過程.html#cb393-13" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb393-14"><a href="長期記憶過程.html#cb393-14" tabindex="-1"></a><span class="do">## sigma^2 = 0.8098:  log likelihood = -90.83</span></span>
<span id="cb393-15"><a href="長期記憶過程.html#cb393-15" tabindex="-1"></a><span class="do">## AIC=189.66   AICc=190.27   BIC=198.65</span></span>
<span id="cb393-16"><a href="長期記憶過程.html#cb393-16" tabindex="-1"></a>y_resid <span class="ot">&lt;-</span> y_fit<span class="sc">$</span>res</span>
<span id="cb393-17"><a href="長期記憶過程.html#cb393-17" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfcol =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb393-18"><a href="長期記憶過程.html#cb393-18" tabindex="-1"></a><span class="fu">acf</span>(y_resid); <span class="fu">pacf</span>(y_resid)</span></code></pre></div>
<p><img src="050-longmemory_files/figure-html/arfima_res2-1.png" width="75%" /></p>
<div class="sourceCode" id="cb394"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb394-1"><a href="長期記憶過程.html#cb394-1" tabindex="-1"></a><span class="fu">Box.test</span>(y_resid, <span class="at">lag =</span> <span class="dv">30</span>, <span class="at">type =</span> <span class="st">&quot;Ljung&quot;</span>)</span>
<span id="cb394-2"><a href="長期記憶過程.html#cb394-2" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb394-3"><a href="長期記憶過程.html#cb394-3" tabindex="-1"></a><span class="do">##  Box-Ljung test</span></span>
<span id="cb394-4"><a href="長期記憶過程.html#cb394-4" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb394-5"><a href="長期記憶過程.html#cb394-5" tabindex="-1"></a><span class="do">## data:  y_resid</span></span>
<span id="cb394-6"><a href="長期記憶過程.html#cb394-6" tabindex="-1"></a><span class="do">## X-squared = 17.267, df = 30, p-value = 0.9692</span></span></code></pre></div>
<ul>
<li>よりフォーマルなモデル同定・推定の手順は, 配布資料参照.</li>
</ul>
</div>
</div>
<div id="arfimaモデル-データ分析例-tsay-2.11-pp.119120" class="section level2 hasAnchor" number="6.5">
<h2><span class="header-section-number">6.5</span> ARFIMAモデル: データ分析例 (Tsay, 2.11, pp.119–120)<a href="長期記憶過程.html#arfimaモデル-データ分析例-tsay-2.11-pp.119120" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>データ&amp;コードの出所: <a href="https://sites.google.com/site/econometricsr/home/rcode" class="uri">https://sites.google.com/site/econometricsr/home/rcode</a></li>
<li>コードは一部改</li>
</ul>
<div class="sourceCode" id="cb395"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb395-1"><a href="長期記憶過程.html#cb395-1" tabindex="-1"></a><span class="co">#library(fracdiff)</span></span>
<span id="cb395-2"><a href="長期記憶過程.html#cb395-2" tabindex="-1"></a>ifl <span class="ot">&lt;-</span> <span class="fu">file.path</span>(dir_introTS, <span class="st">&quot;d-ibm3dx7008.txt&quot;</span>)</span>
<span id="cb395-3"><a href="長期記憶過程.html#cb395-3" tabindex="-1"></a>da <span class="ot">=</span> <span class="fu">read.table</span>(ifl, <span class="at">header =</span> T)</span>
<span id="cb395-4"><a href="長期記憶過程.html#cb395-4" tabindex="-1"></a><span class="fu">head</span>(da)</span>
<span id="cb395-5"><a href="長期記憶過程.html#cb395-5" tabindex="-1"></a><span class="do">##       Date       rtn    vwretd    ewretd    sprtrn</span></span>
<span id="cb395-6"><a href="長期記憶過程.html#cb395-6" tabindex="-1"></a><span class="do">## 1 19700102  0.000686  0.012137  0.033450  0.010211</span></span>
<span id="cb395-7"><a href="長期記憶過程.html#cb395-7" tabindex="-1"></a><span class="do">## 2 19700105  0.009596  0.006375  0.018947  0.004946</span></span>
<span id="cb395-8"><a href="長期記憶過程.html#cb395-8" tabindex="-1"></a><span class="do">## 3 19700106  0.000679 -0.007233 -0.005776 -0.006848</span></span>
<span id="cb395-9"><a href="長期記憶過程.html#cb395-9" tabindex="-1"></a><span class="do">## 4 19700107  0.000678 -0.001272  0.003559 -0.002047</span></span>
<span id="cb395-10"><a href="長期記憶過程.html#cb395-10" tabindex="-1"></a><span class="do">## 5 19700108  0.002034  0.000564  0.002890  0.000540</span></span>
<span id="cb395-11"><a href="長期記憶過程.html#cb395-11" tabindex="-1"></a><span class="do">## 6 19700109 -0.001353 -0.002797 -0.002923 -0.003021</span></span>
<span id="cb395-12"><a href="長期記憶過程.html#cb395-12" tabindex="-1"></a>ew <span class="ot">=</span> <span class="fu">abs</span>(da<span class="sc">$</span>vwretd)     <span class="co"># daily abs ret&#39;s of value-weighted CRSP, 1970--2008</span></span>
<span id="cb395-13"><a href="長期記憶過程.html#cb395-13" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">as.ts</span>(ew))</span></code></pre></div>
<p><img src="050-longmemory_files/figure-html/unnamed-chunk-7-1.png" width="75%" /></p>
<ul>
<li>次数dの推定</li>
</ul>
<div class="sourceCode" id="cb396"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb396-1"><a href="長期記憶過程.html#cb396-1" tabindex="-1"></a><span class="co"># pure fractionally differenced modelに対して(p=0, q=0)</span></span>
<span id="cb396-2"><a href="長期記憶過程.html#cb396-2" tabindex="-1"></a><span class="co"># Geweke-Porter-Hudak(83) estimate</span></span>
<span id="cb396-3"><a href="長期記憶過程.html#cb396-3" tabindex="-1"></a><span class="co">#(m3 = fdGPH(da$vwretd))        # d=0.05282</span></span>
<span id="cb396-4"><a href="長期記憶過程.html#cb396-4" tabindex="-1"></a>(<span class="at">m3 =</span> <span class="fu">fdGPH</span>(ew))</span>
<span id="cb396-5"><a href="長期記憶過程.html#cb396-5" tabindex="-1"></a><span class="do">## $d</span></span>
<span id="cb396-6"><a href="長期記憶過程.html#cb396-6" tabindex="-1"></a><span class="do">## [1] 0.372226</span></span>
<span id="cb396-7"><a href="長期記憶過程.html#cb396-7" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb396-8"><a href="長期記憶過程.html#cb396-8" tabindex="-1"></a><span class="do">## $sd.as</span></span>
<span id="cb396-9"><a href="長期記憶過程.html#cb396-9" tabindex="-1"></a><span class="do">## [1] 0.0698385</span></span>
<span id="cb396-10"><a href="長期記憶過程.html#cb396-10" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb396-11"><a href="長期記憶過程.html#cb396-11" tabindex="-1"></a><span class="do">## $sd.reg</span></span>
<span id="cb396-12"><a href="長期記憶過程.html#cb396-12" tabindex="-1"></a><span class="do">## [1] 0.06868857</span></span></code></pre></div>
<ul>
<li>→ 0&lt;d&lt;0.5　∴ stationary, invertible</li>
</ul>
<div class="sourceCode" id="cb397"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb397-1"><a href="長期記憶過程.html#cb397-1" tabindex="-1"></a><span class="co"># Reisen (94) estimate</span></span>
<span id="cb397-2"><a href="長期記憶過程.html#cb397-2" tabindex="-1"></a><span class="co"># (m3.2 = fdSperio(ew))     # 0.3784656</span></span></code></pre></div>
<div class="sourceCode" id="cb398"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb398-1"><a href="長期記憶過程.html#cb398-1" tabindex="-1"></a><span class="co"># 最尤法 (nar, nmaの指定必要)</span></span>
<span id="cb398-2"><a href="長期記憶過程.html#cb398-2" tabindex="-1"></a><span class="co">#m3.0 = fracdiff(ew,nar = 0, nma = 0)       # デフォルト: nar = 0, nma = 0</span></span>
<span id="cb398-3"><a href="長期記憶過程.html#cb398-3" tabindex="-1"></a><span class="co">#summary(m3.0)</span></span>
<span id="cb398-4"><a href="長期記憶過程.html#cb398-4" tabindex="-1"></a></span>
<span id="cb398-5"><a href="長期記憶過程.html#cb398-5" tabindex="-1"></a><span class="co"># ARFIMA(1,d,1)の最尤推定</span></span>
<span id="cb398-6"><a href="長期記憶過程.html#cb398-6" tabindex="-1"></a>m2 <span class="ot">=</span> <span class="fu">fracdiff</span>(ew, <span class="at">nar =</span> <span class="dv">1</span>, <span class="at">nma =</span> <span class="dv">1</span>)</span>
<span id="cb398-7"><a href="長期記憶過程.html#cb398-7" tabindex="-1"></a><span class="fu">summary</span>(m2)</span>
<span id="cb398-8"><a href="長期記憶過程.html#cb398-8" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb398-9"><a href="長期記憶過程.html#cb398-9" tabindex="-1"></a><span class="do">## Call:</span></span>
<span id="cb398-10"><a href="長期記憶過程.html#cb398-10" tabindex="-1"></a><span class="do">##   fracdiff(x = ew, nar = 1, nma = 1) </span></span>
<span id="cb398-11"><a href="長期記憶過程.html#cb398-11" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb398-12"><a href="長期記憶過程.html#cb398-12" tabindex="-1"></a><span class="do">## Coefficients:</span></span>
<span id="cb398-13"><a href="長期記憶過程.html#cb398-13" tabindex="-1"></a><span class="do">##    Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span id="cb398-14"><a href="長期記憶過程.html#cb398-14" tabindex="-1"></a><span class="do">## d  0.490938   0.007997   61.39   &lt;2e-16 ***</span></span>
<span id="cb398-15"><a href="長期記憶過程.html#cb398-15" tabindex="-1"></a><span class="do">## ar 0.113389   0.005988   18.94   &lt;2e-16 ***</span></span>
<span id="cb398-16"><a href="長期記憶過程.html#cb398-16" tabindex="-1"></a><span class="do">## ma 0.575895   0.005946   96.85   &lt;2e-16 ***</span></span>
<span id="cb398-17"><a href="長期記憶過程.html#cb398-17" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb398-18"><a href="長期記憶過程.html#cb398-18" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb398-19"><a href="長期記憶過程.html#cb398-19" tabindex="-1"></a><span class="do">## sigma[eps] = 0.0065619 </span></span>
<span id="cb398-20"><a href="長期記憶過程.html#cb398-20" tabindex="-1"></a><span class="do">## [d.tol = 0.0001221, M = 100, h = 0.0003742]</span></span>
<span id="cb398-21"><a href="長期記憶過程.html#cb398-21" tabindex="-1"></a><span class="do">## Log likelihood: 3.551e+04 ==&gt; AIC = -71021.02 [4 deg.freedom]</span></span>
<span id="cb398-22"><a href="長期記憶過程.html#cb398-22" tabindex="-1"></a><span class="fu">coef</span>(m2)</span>
<span id="cb398-23"><a href="長期記憶過程.html#cb398-23" tabindex="-1"></a><span class="do">##         d        ar        ma </span></span>
<span id="cb398-24"><a href="長期記憶過程.html#cb398-24" tabindex="-1"></a><span class="do">## 0.4909382 0.1133893 0.5758949</span></span>
<span id="cb398-25"><a href="長期記憶過程.html#cb398-25" tabindex="-1"></a><span class="fu">confint</span>(m2)</span>
<span id="cb398-26"><a href="長期記憶過程.html#cb398-26" tabindex="-1"></a><span class="do">##        2.5 %    97.5 %</span></span>
<span id="cb398-27"><a href="長期記憶過程.html#cb398-27" tabindex="-1"></a><span class="do">## d  0.4752637 0.5066127</span></span>
<span id="cb398-28"><a href="長期記憶過程.html#cb398-28" tabindex="-1"></a><span class="do">## ar 0.1016536 0.1251250</span></span>
<span id="cb398-29"><a href="長期記憶過程.html#cb398-29" tabindex="-1"></a><span class="do">## ma 0.5642407 0.5875491</span></span></code></pre></div>
<ul>
<li>注: MA係数の符号が, arima()の符号とは反対</li>
</ul>
<table>
<caption><span id="tab:unnamed-chunk-11">Table 6.1: </span>パラメータ推定値</caption>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right"></th>
<th align="right">2.5 %</th>
<th align="right">97.5 %</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">d</td>
<td align="right">0.4909382</td>
<td align="right">0.4752637</td>
<td align="right">0.5066127</td>
</tr>
<tr class="even">
<td align="left">ar</td>
<td align="right">0.1133893</td>
<td align="right">0.1016536</td>
<td align="right">0.1251250</td>
</tr>
<tr class="odd">
<td align="left">ma</td>
<td align="right">0.5758949</td>
<td align="right">0.5642407</td>
<td align="right">0.5875491</td>
</tr>
</tbody>
</table>
<ul>
<li>→ dの値, 非定常境界(d=0.5)に近い</li>
</ul>
<div class="sourceCode" id="cb399"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb399-1"><a href="長期記憶過程.html#cb399-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">101</span>)</span>
<span id="cb399-2"><a href="長期記憶過程.html#cb399-2" tabindex="-1"></a>m2_sim <span class="ot">&lt;-</span> <span class="fu">fracdiff.sim</span>(<span class="dv">512</span>, <span class="at">ar =</span> <span class="fu">coef</span>(m2)[<span class="st">&quot;ar&quot;</span>], <span class="at">ma =</span> <span class="sc">-</span> <span class="fu">coef</span>(m2)[<span class="st">&quot;ma&quot;</span>], <span class="at">d =</span> <span class="fu">coef</span>(m2)[<span class="st">&quot;d&quot;</span>])</span>
<span id="cb399-3"><a href="長期記憶過程.html#cb399-3" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">as.ts</span>(m2_sim<span class="sc">$</span>series))</span></code></pre></div>
<p><img src="050-longmemory_files/figure-html/unnamed-chunk-12-1.png" width="75%" /></p>
<div class="sourceCode" id="cb400"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb400-1"><a href="長期記憶過程.html#cb400-1" tabindex="-1"></a><span class="fu">hurstexp</span>(ew) <span class="co"># ハースト指数</span></span>
<span id="cb400-2"><a href="長期記憶過程.html#cb400-2" tabindex="-1"></a><span class="do">## Simple R/S Hurst estimation:         0.7368679 </span></span>
<span id="cb400-3"><a href="長期記憶過程.html#cb400-3" tabindex="-1"></a><span class="do">## Corrected R over S Hurst exponent:   0.8540535 </span></span>
<span id="cb400-4"><a href="長期記憶過程.html#cb400-4" tabindex="-1"></a><span class="do">## Empirical Hurst exponent:            0.9058207 </span></span>
<span id="cb400-5"><a href="長期記憶過程.html#cb400-5" tabindex="-1"></a><span class="do">## Corrected empirical Hurst exponent:  0.8784372 </span></span>
<span id="cb400-6"><a href="長期記憶過程.html#cb400-6" tabindex="-1"></a><span class="do">## Theoretical Hurst exponent:          0.5264069</span></span></code></pre></div>

</div>
</div>



            </section>

          </div>
        </div>
      </div>
<a href="単位根過程と単位根検定.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="バブル-生成崩壊-検出に関する参考文献.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
