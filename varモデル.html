<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>9 VARモデル | 金融時系列解析</title>
  <meta name="description" content="9 VARモデル | 金融時系列解析" />
  <meta name="generator" content="bookdown 0.40 and GitBook 2.6.7" />

  <meta property="og:title" content="9 VARモデル | 金融時系列解析" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="9 VARモデル | 金融時系列解析" />
  
  
  

<meta name="author" content="林 高樹" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="garchモデル.html"/>
<link rel="next" href="共和分分析.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> はじめに</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#時系列モデリング"><i class="fa fa-check"></i><b>1.1</b> 時系列モデリング</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#金融時系列データの特徴"><i class="fa fa-check"></i><b>1.2</b> 金融時系列データの特徴</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#金融時系列データの特徴-みずほ-8411-株価データの例"><i class="fa fa-check"></i>金融時系列データの特徴: みずほ (8411) 株価データの例</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#シミュレーションによるサンプルパス生成"><i class="fa fa-check"></i><b>1.3</b> シミュレーションによるサンプルパス生成</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#rにおける時系列オブジェクトクラスおよび関数の例"><i class="fa fa-check"></i><b>1.4</b> Rにおける時系列オブジェクト・クラスおよび関数の例</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="index.html"><a href="index.html#日付時間データに対するクラス"><i class="fa fa-check"></i><b>1.4.1</b> 日付・時間データに対するクラス</a></li>
<li class="chapter" data-level="1.4.2" data-path="index.html"><a href="index.html#時系列データに対するクラス1-tsクラス"><i class="fa fa-check"></i><b>1.4.2</b> 時系列データに対するクラス(1): tsクラス</a></li>
<li class="chapter" data-level="1.4.3" data-path="index.html"><a href="index.html#時系列データに対するクラス2-zooクラスとxtsクラス"><i class="fa fa-check"></i><b>1.4.3</b> 時系列データに対するクラス(2): zooクラスとxtsクラス</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#時系列データの分解"><i class="fa fa-check"></i><b>1.5</b> 時系列データの分解</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="index.html"><a href="index.html#トレンド抽出-平滑化-smoothing"><i class="fa fa-check"></i><b>1.5.1</b> トレンド抽出, 平滑化 (smoothing)</a></li>
<li class="chapter" data-level="1.5.2" data-path="index.html"><a href="index.html#分解モデル"><i class="fa fa-check"></i><b>1.5.2</b> 分解モデル</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="定常性と自己相関関数.html"><a href="定常性と自己相関関数.html"><i class="fa fa-check"></i><b>2</b> 定常性と自己相関関数</a>
<ul>
<li class="chapter" data-level="2.1" data-path="定常性と自己相関関数.html"><a href="定常性と自己相関関数.html#確率過程の2次特性-平均関数と自己共分散関数"><i class="fa fa-check"></i><b>2.1</b> 確率過程の2次特性: 平均関数と自己共分散関数</a></li>
<li class="chapter" data-level="2.2" data-path="定常性と自己相関関数.html"><a href="定常性と自己相関関数.html#定常性-stationarity"><i class="fa fa-check"></i><b>2.2</b> 定常性 (stationarity)</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="定常性と自己相関関数.html"><a href="定常性と自己相関関数.html#強定常性"><i class="fa fa-check"></i><b>2.2.1</b> 強定常性</a></li>
<li class="chapter" data-level="2.2.2" data-path="定常性と自己相関関数.html"><a href="定常性と自己相関関数.html#弱定常性"><i class="fa fa-check"></i><b>2.2.2</b> 弱定常性</a></li>
<li class="chapter" data-level="2.2.3" data-path="定常性と自己相関関数.html"><a href="定常性と自己相関関数.html#ホワイトノイズ"><i class="fa fa-check"></i><b>2.2.3</b> ホワイトノイズ</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="定常性と自己相関関数.html"><a href="定常性と自己相関関数.html#標本平均と標本自己共分散関数"><i class="fa fa-check"></i><b>2.3</b> 標本平均と標本自己共分散関数</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="定常性と自己相関関数.html"><a href="定常性と自己相関関数.html#アンサンブル平均-vs-標本平均"><i class="fa fa-check"></i><b>2.3.1</b> アンサンブル平均 vs 標本平均</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="定常性と自己相関関数.html"><a href="定常性と自己相関関数.html#r操作-標本acf"><i class="fa fa-check"></i><b>2.4</b> R操作: 標本ACF</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="定常性と自己相関関数.html"><a href="定常性と自己相関関数.html#白色ノイズ"><i class="fa fa-check"></i><b>2.4.1</b> 白色ノイズ</a></li>
<li class="chapter" data-level="2.4.2" data-path="定常性と自己相関関数.html"><a href="定常性と自己相関関数.html#ランダムウォーク"><i class="fa fa-check"></i><b>2.4.2</b> ランダムウォーク</a></li>
<li class="chapter" data-level="2.4.3" data-path="定常性と自己相関関数.html"><a href="定常性と自己相関関数.html#非定常成分を含む時系列"><i class="fa fa-check"></i><b>2.4.3</b> 非定常成分を含む時系列</a></li>
<li class="chapter" data-level="2.4.4" data-path="定常性と自己相関関数.html"><a href="定常性と自己相関関数.html#線形定常時系列モデル"><i class="fa fa-check"></i><b>2.4.4</b> 線形・定常時系列モデル</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="定常性と自己相関関数.html"><a href="定常性と自己相関関数.html#母acf-vs-標本acf"><i class="fa fa-check"></i><b>2.5</b> 母ACF vs 標本ACF</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="armapqモデル.html"><a href="armapqモデル.html"><i class="fa fa-check"></i><b>3</b> ARMA<span class="math inline">\((p,q)\)</span>モデル</a>
<ul>
<li class="chapter" data-level="3.1" data-path="armapqモデル.html"><a href="armapqモデル.html#armapqモデルとは"><i class="fa fa-check"></i><b>3.1</b> ARMA<span class="math inline">\((p,q)\)</span>モデルとは</a>
<ul>
<li class="chapter" data-level="" data-path="armapqモデル.html"><a href="armapqモデル.html#因果性と反転可能性"><i class="fa fa-check"></i>因果性と反転可能性</a></li>
<li class="chapter" data-level="" data-path="armapqモデル.html"><a href="armapqモデル.html#armapqモデルの意義"><i class="fa fa-check"></i>ARMA<span class="math inline">\((p,q)\)</span>モデルの意義</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="armapqモデル.html"><a href="armapqモデル.html#armapqモデルによる予測"><i class="fa fa-check"></i><b>3.2</b> ARMA<span class="math inline">\((p,q)\)</span>モデルによる予測</a></li>
<li class="chapter" data-level="3.3" data-path="armapqモデル.html"><a href="armapqモデル.html#armapqモデルの推定"><i class="fa fa-check"></i><b>3.3</b> ARMA<span class="math inline">\((p,q)\)</span>モデルの推定</a></li>
<li class="chapter" data-level="3.4" data-path="armapqモデル.html"><a href="armapqモデル.html#armapqモデルの同定-次数の特定"><i class="fa fa-check"></i><b>3.4</b> ARMA<span class="math inline">\((p,q)\)</span>モデルの同定 (次数の特定)</a></li>
<li class="chapter" data-level="3.5" data-path="armapqモデル.html"><a href="armapqモデル.html#r操作"><i class="fa fa-check"></i><b>3.5</b> R操作</a>
<ul>
<li class="chapter" data-level="" data-path="armapqモデル.html"><a href="armapqモデル.html#armapqモデルの同定-acfpacfeacfの利用"><i class="fa fa-check"></i>ARMA<span class="math inline">\((p,q)\)</span>モデルの同定 (ACF/PACF/EACFの利用)</a></li>
<li class="chapter" data-level="" data-path="armapqモデル.html"><a href="armapqモデル.html#armapqモデルの推定診断"><i class="fa fa-check"></i>ARMA<span class="math inline">\((p,q)\)</span>モデルの推定・診断</a></li>
<li class="chapter" data-level="" data-path="armapqモデル.html"><a href="armapqモデル.html#パッケージforecastの利用"><i class="fa fa-check"></i>パッケージ{forecast}の利用</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="armapqモデル.html"><a href="armapqモデル.html#データ分析例-tsay-ch2より"><i class="fa fa-check"></i><b>3.6</b> データ分析例 (Tsay, Ch2より)</a>
<ul>
<li class="chapter" data-level="" data-path="armapqモデル.html"><a href="armapqモデル.html#標本acf"><i class="fa fa-check"></i>標本ACF</a></li>
<li class="chapter" data-level="" data-path="armapqモデル.html"><a href="armapqモデル.html#ar-ma-arma-2.42.6"><i class="fa fa-check"></i>AR, MA, ARMA (2.4–2.6)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="arimasarimaモデル.html"><a href="arimasarimaモデル.html"><i class="fa fa-check"></i><b>4</b> ARIMA/SARIMAモデル</a>
<ul>
<li class="chapter" data-level="4.1" data-path="arimasarimaモデル.html"><a href="arimasarimaモデル.html#arimapdqモデルとは"><i class="fa fa-check"></i><b>4.1</b> ARIMA<span class="math inline">\((p,d,q)\)</span>モデルとは</a></li>
<li class="chapter" data-level="4.2" data-path="arimasarimaモデル.html"><a href="arimasarimaモデル.html#sarimapdqtimes-pdq_sモデル-周期sとは"><i class="fa fa-check"></i><b>4.2</b> SARIMA<span class="math inline">\((p,d,q)\times (P,D,Q)_s\)</span>モデル (周期<span class="math inline">\(s\)</span>)とは</a></li>
<li class="chapter" data-level="4.3" data-path="arimasarimaモデル.html"><a href="arimasarimaモデル.html#sarimaモデルのパス生成-パッケージsarimaの利用"><i class="fa fa-check"></i><b>4.3</b> SARIMAモデルのパス生成: パッケージ<strong>sarima</strong>の利用</a></li>
<li class="chapter" data-level="4.4" data-path="arimasarimaモデル.html"><a href="arimasarimaモデル.html#sarimaモデルの推定診断"><i class="fa fa-check"></i><b>4.4</b> SARIMAモデルの推定・診断</a>
<ul>
<li class="chapter" data-level="" data-path="arimasarimaモデル.html"><a href="arimasarimaモデル.html#パッケージforecastの利用-1"><i class="fa fa-check"></i>パッケージ<strong>forecast</strong>の利用</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="arimasarimaモデル.html"><a href="arimasarimaモデル.html#データ分析例"><i class="fa fa-check"></i><b>4.5</b> データ分析例</a>
<ul>
<li class="chapter" data-level="" data-path="arimasarimaモデル.html"><a href="arimasarimaモデル.html#データセット-bonds"><i class="fa fa-check"></i>データセット: bonds</a></li>
<li class="chapter" data-level="" data-path="arimasarimaモデル.html"><a href="arimasarimaモデル.html#データセット-airpassengers"><i class="fa fa-check"></i>データセット: AirPassengers</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="arimasarimaモデル.html"><a href="arimasarimaモデル.html#外生的トレンドがあるケース"><i class="fa fa-check"></i><b>4.6</b> 外生的トレンドがあるケース</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="確率的トレンドと単位根検定.html"><a href="確率的トレンドと単位根検定.html"><i class="fa fa-check"></i><b>5</b> 確率的トレンドと単位根検定</a>
<ul>
<li class="chapter" data-level="5.1" data-path="確率的トレンドと単位根検定.html"><a href="確率的トレンドと単位根検定.html#確率的トレンド-vs-確定的トレンド"><i class="fa fa-check"></i><b>5.1</b> 確率的トレンド vs 確定的トレンド</a></li>
<li class="chapter" data-level="5.2" data-path="確率的トレンドと単位根検定.html"><a href="確率的トレンドと単位根検定.html#単位根過程と見せかけの回帰"><i class="fa fa-check"></i><b>5.2</b> 単位根過程と見せかけの回帰</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="確率的トレンドと単位根検定.html"><a href="確率的トレンドと単位根検定.html#単位根過程"><i class="fa fa-check"></i><b>5.2.1</b> 単位根過程</a></li>
<li class="chapter" data-level="5.2.2" data-path="確率的トレンドと単位根検定.html"><a href="確率的トレンドと単位根検定.html#見せかけの回帰"><i class="fa fa-check"></i><b>5.2.2</b> 見せかけの回帰</a></li>
<li class="chapter" data-level="5.2.3" data-path="確率的トレンドと単位根検定.html"><a href="確率的トレンドと単位根検定.html#見せかけの回帰の判定"><i class="fa fa-check"></i><b>5.2.3</b> 見せかけの回帰の判定</a></li>
<li class="chapter" data-level="5.2.4" data-path="確率的トレンドと単位根検定.html"><a href="確率的トレンドと単位根検定.html#rで実行可能な主な単位根検定法"><i class="fa fa-check"></i><b>5.2.4</b> Rで実行可能な主な単位根検定法</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="確率的トレンドと単位根検定.html"><a href="確率的トレンドと単位根検定.html#augmented-dicky-fuller-adf-検定"><i class="fa fa-check"></i><b>5.3</b> Augmented Dicky-Fuller (ADF) 検定</a>
<ul>
<li class="chapter" data-level="" data-path="確率的トレンドと単位根検定.html"><a href="確率的トレンドと単位根検定.html#パッケージfunitroots"><i class="fa fa-check"></i>パッケージ<strong>fUnitRoots</strong></a></li>
<li class="chapter" data-level="" data-path="確率的トレンドと単位根検定.html"><a href="確率的トレンドと単位根検定.html#パッケージtseries"><i class="fa fa-check"></i>パッケージ<strong>tseries</strong></a></li>
<li class="chapter" data-level="" data-path="確率的トレンドと単位根検定.html"><a href="確率的トレンドと単位根検定.html#パッケージurca"><i class="fa fa-check"></i>パッケージ<strong>urca</strong></a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="確率的トレンドと単位根検定.html"><a href="確率的トレンドと単位根検定.html#adf検定以外の検定法"><i class="fa fa-check"></i><b>5.4</b> ADF検定以外の検定法</a>
<ul>
<li class="chapter" data-level="" data-path="確率的トレンドと単位根検定.html"><a href="確率的トレンドと単位根検定.html#phillips-perron-pp-検定"><i class="fa fa-check"></i>Phillips-Perron (PP) 検定</a></li>
<li class="chapter" data-level="" data-path="確率的トレンドと単位根検定.html"><a href="確率的トレンドと単位根検定.html#kwiatkowski-phillips-schmidt-shin-kpss-検定"><i class="fa fa-check"></i>Kwiatkowski-Phillips-Schmidt-Shin (KPSS) 検定</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="長期記憶過程.html"><a href="長期記憶過程.html"><i class="fa fa-check"></i><b>6</b> 長期記憶過程</a>
<ul>
<li class="chapter" data-level="6.1" data-path="長期記憶過程.html"><a href="長期記憶過程.html#長期記憶過程のシミュレーション"><i class="fa fa-check"></i><b>6.1</b> 長期記憶過程のシミュレーション</a>
<ul>
<li class="chapter" data-level="" data-path="長期記憶過程.html"><a href="長期記憶過程.html#パッケージfracdiffの利用"><i class="fa fa-check"></i>パッケージ<strong>fracdiff</strong>の利用</a></li>
<li class="chapter" data-level="" data-path="長期記憶過程.html"><a href="長期記憶過程.html#パッケージlongmemoの利用"><i class="fa fa-check"></i>パッケージ<strong>longmemo</strong>の利用</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="長期記憶過程.html"><a href="長期記憶過程.html#hurst指数の推定"><i class="fa fa-check"></i><b>6.2</b> Hurst指数の推定</a>
<ul>
<li class="chapter" data-level="" data-path="長期記憶過程.html"><a href="長期記憶過程.html#パッケージpracmaの利用"><i class="fa fa-check"></i>パッケージ<strong>pracma</strong>の利用</a></li>
<li class="chapter" data-level="" data-path="長期記憶過程.html"><a href="長期記憶過程.html#パッケージfractalの利用"><i class="fa fa-check"></i>パッケージ<strong>fractal</strong>の利用</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="長期記憶過程.html"><a href="長期記憶過程.html#arfimaモデルの推定"><i class="fa fa-check"></i><b>6.3</b> ARFIMAモデルの推定</a>
<ul>
<li class="chapter" data-level="" data-path="長期記憶過程.html"><a href="長期記憶過程.html#パッケージfracdiffの利用-1"><i class="fa fa-check"></i>パッケージ<strong>fracdiff</strong>の利用</a></li>
<li class="chapter" data-level="" data-path="長期記憶過程.html"><a href="長期記憶過程.html#パッケージnsarfimaの利用"><i class="fa fa-check"></i>パッケージ<strong>nsarfima</strong>の利用</a></li>
<li class="chapter" data-level="" data-path="長期記憶過程.html"><a href="長期記憶過程.html#階差次数dの代替的推定法"><i class="fa fa-check"></i>階差次数<span class="math inline">\(d\)</span>の代替的推定法</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="長期記憶過程.html"><a href="長期記憶過程.html#arfimaモデル-データ分析例-1"><i class="fa fa-check"></i><b>6.4</b> ARFIMAモデル: データ分析例 (1)</a></li>
<li class="chapter" data-level="6.5" data-path="長期記憶過程.html"><a href="長期記憶過程.html#arfimaモデル-データ分析例-2"><i class="fa fa-check"></i><b>6.5</b> ARFIMAモデル: データ分析例 (2)</a>
<ul>
<li class="chapter" data-level="" data-path="長期記憶過程.html"><a href="長期記憶過程.html#最適なarfimaモデルの選択および推定"><i class="fa fa-check"></i>最適なARFIMAモデルの選択および推定</a></li>
<li class="chapter" data-level="" data-path="長期記憶過程.html"><a href="長期記憶過程.html#arfimaモデルによる外挿予測"><i class="fa fa-check"></i>ARFIMAモデルによる外挿予測</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="レジームスイッチングモデル.html"><a href="レジームスイッチングモデル.html"><i class="fa fa-check"></i><b>7</b> レジーム・スイッチング・モデル</a>
<ul>
<li class="chapter" data-level="7.1" data-path="レジームスイッチングモデル.html"><a href="レジームスイッチングモデル.html#自己回帰マルコフスイッチングモデル-msm-ar"><i class="fa fa-check"></i><b>7.1</b> 自己回帰マルコフ・スイッチング・モデル (MSM-AR)</a></li>
<li class="chapter" data-level="7.2" data-path="レジームスイッチングモデル.html"><a href="レジームスイッチングモデル.html#msm-arモデルの適合"><i class="fa fa-check"></i><b>7.2</b> MSM-ARモデルの適合</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="garchモデル.html"><a href="garchモデル.html"><i class="fa fa-check"></i><b>8</b> GARCHモデル</a>
<ul>
<li class="chapter" data-level="8.1" data-path="garchモデル.html"><a href="garchモデル.html#収益率データとarch効果"><i class="fa fa-check"></i><b>8.1</b> 収益率データとARCH効果</a></li>
<li class="chapter" data-level="8.2" data-path="garchモデル.html"><a href="garchモデル.html#archgarchモデル"><i class="fa fa-check"></i><b>8.2</b> ARCH/GARCHモデル</a>
<ul>
<li class="chapter" data-level="" data-path="garchモデル.html"><a href="garchモデル.html#garchpqモデル"><i class="fa fa-check"></i>GARCH(p,q)モデル</a></li>
<li class="chapter" data-level="" data-path="garchモデル.html"><a href="garchモデル.html#garchモデリング"><i class="fa fa-check"></i>GARCHモデリング</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="garchモデル.html"><a href="garchモデル.html#archgarchモデルのシミュレーション"><i class="fa fa-check"></i><b>8.3</b> ARCH/GARCHモデルのシミュレーション</a>
<ul>
<li class="chapter" data-level="" data-path="garchモデル.html"><a href="garchモデル.html#パッケージfgarchの利用"><i class="fa fa-check"></i>パッケージ<strong>fGarch</strong>の利用</a></li>
<li class="chapter" data-level="" data-path="garchモデル.html"><a href="garchモデル.html#archpモデル"><i class="fa fa-check"></i>ARCH(p)モデル</a></li>
<li class="chapter" data-level="" data-path="garchモデル.html"><a href="garchモデル.html#garchpqモデル-1"><i class="fa fa-check"></i>GARCH(p,q)モデル</a></li>
<li class="chapter" data-level="" data-path="garchモデル.html"><a href="garchモデル.html#armapq-garchpqモデル"><i class="fa fa-check"></i>ARMA(p’,q’)-GARCH(p,q)モデル</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="garchモデル.html"><a href="garchモデル.html#archgarchモデルの適合"><i class="fa fa-check"></i><b>8.4</b> ARCH/GARCHモデルの適合</a>
<ul>
<li class="chapter" data-level="" data-path="garchモデル.html"><a href="garchモデル.html#パッケージrugarchの利用"><i class="fa fa-check"></i>パッケージ<strong>rugarch</strong>の利用</a></li>
<li class="chapter" data-level="" data-path="garchモデル.html"><a href="garchモデル.html#iarch11"><i class="fa fa-check"></i>IARCH(1,1)</a></li>
<li class="chapter" data-level="" data-path="garchモデル.html"><a href="garchモデル.html#gjr-garch11"><i class="fa fa-check"></i>GJR-GARCH(1,1)</a></li>
<li class="chapter" data-level="" data-path="garchモデル.html"><a href="garchモデル.html#aparch"><i class="fa fa-check"></i>APARCH</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="garchモデル.html"><a href="garchモデル.html#garchモデル-データ分析例-tsay-ch4"><i class="fa fa-check"></i><b>8.5</b> GARCHモデル: データ分析例 (Tsay, Ch4)</a>
<ul>
<li class="chapter" data-level="" data-path="garchモデル.html"><a href="garchモデル.html#必要な関数やデータセットの入手"><i class="fa fa-check"></i>必要な関数やデータセットの入手</a></li>
<li class="chapter" data-level="" data-path="garchモデル.html"><a href="garchモデル.html#integrated-garch-モデル"><i class="fa fa-check"></i>Integrated GARCH モデル</a></li>
<li class="chapter" data-level="" data-path="garchモデル.html"><a href="garchモデル.html#garch-m-モデル"><i class="fa fa-check"></i>GARCH-M モデル</a></li>
<li class="chapter" data-level="" data-path="garchモデル.html"><a href="garchモデル.html#exponential-garch-model"><i class="fa fa-check"></i>Exponential GARCH Model</a></li>
<li class="chapter" data-level="" data-path="garchモデル.html"><a href="garchモデル.html#threshold-garch-モデル"><i class="fa fa-check"></i>Threshold GARCH モデル</a></li>
<li class="chapter" data-level="" data-path="garchモデル.html"><a href="garchモデル.html#asymmetric-power-arch-モデル"><i class="fa fa-check"></i>Asymmetric Power ARCH モデル</a></li>
<li class="chapter" data-level="" data-path="garchモデル.html"><a href="garchモデル.html#nonsymmetric-garch-モデル"><i class="fa fa-check"></i>Nonsymmetric GARCH モデル</a></li>
<li class="chapter" data-level="" data-path="garchモデル.html"><a href="garchモデル.html#代替的アプリーチ間の比較"><i class="fa fa-check"></i>代替的アプリーチ間の比較</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="varモデル.html"><a href="varモデル.html"><i class="fa fa-check"></i><b>9</b> VARモデル</a>
<ul>
<li class="chapter" data-level="9.1" data-path="varモデル.html"><a href="varモデル.html#varpモデルのシミュレーション"><i class="fa fa-check"></i><b>9.1</b> VAR(<span class="math inline">\(p\)</span>)モデルのシミュレーション</a>
<ul>
<li class="chapter" data-level="" data-path="varモデル.html"><a href="varモデル.html#パッケージmts-varsの利用"><i class="fa fa-check"></i>パッケージ<strong>MTS</strong>, <strong>vars</strong>の利用</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="varモデル.html"><a href="varモデル.html#varpモデルの構築"><i class="fa fa-check"></i><b>9.2</b> VAR(<span class="math inline">\(p\)</span>)モデルの構築</a>
<ul>
<li class="chapter" data-level="" data-path="varモデル.html"><a href="varモデル.html#varpモデルの次数同定"><i class="fa fa-check"></i>VAR(<span class="math inline">\(p\)</span>)モデルの次数同定</a></li>
<li class="chapter" data-level="" data-path="varモデル.html"><a href="varモデル.html#varpモデルの推定"><i class="fa fa-check"></i>VAR(<span class="math inline">\(p\)</span>)モデルの推定</a></li>
<li class="chapter" data-level="" data-path="varモデル.html"><a href="varモデル.html#varpモデル予測"><i class="fa fa-check"></i>VAR(<span class="math inline">\(p\)</span>)モデル予測</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="varモデル.html"><a href="varモデル.html#var解析"><i class="fa fa-check"></i><b>9.3</b> VAR解析</a>
<ul>
<li class="chapter" data-level="" data-path="varモデル.html"><a href="varモデル.html#varp-モデルの構築-復習"><i class="fa fa-check"></i>VAR(<span class="math inline">\(p\)</span>) モデルの構築 (復習)</a></li>
<li class="chapter" data-level="" data-path="varモデル.html"><a href="varモデル.html#グレンジャーの因果性検定"><i class="fa fa-check"></i>グレンジャーの因果性検定</a></li>
<li class="chapter" data-level="" data-path="varモデル.html"><a href="varモデル.html#インパルス応答"><i class="fa fa-check"></i>インパルス応答</a></li>
<li class="chapter" data-level="" data-path="varモデル.html"><a href="varモデル.html#予測誤差分散分解-forecast-error-variance-decomposition"><i class="fa fa-check"></i>予測誤差分散分解 (forecast error variance decomposition)</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="varモデル.html"><a href="varモデル.html#var解析-データ分析例"><i class="fa fa-check"></i><b>9.4</b> VAR解析 (データ分析例)</a>
<ul>
<li class="chapter" data-level="" data-path="varモデル.html"><a href="varモデル.html#事例1-ソフトバンク9434-vs-ソフトバンクグループ9984"><i class="fa fa-check"></i>事例1: ソフトバンク(9434) vs ソフトバンクグループ(9984)</a></li>
<li class="chapter" data-level="" data-path="varモデル.html"><a href="varモデル.html#事例2-米英日3株式市場-sp500-ftse-日経平均"><i class="fa fa-check"></i>事例2: 米英日3株式市場 (S&amp;P500, FTSE, 日経平均)</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="varモデル.html"><a href="varモデル.html#補足-分散共分散行列のコレスキー分解"><i class="fa fa-check"></i><b>9.5</b> 補足: 分散共分散行列のコレスキー分解</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="共和分分析.html"><a href="共和分分析.html"><i class="fa fa-check"></i><b>10</b> 共和分分析</a>
<ul>
<li class="chapter" data-level="10.1" data-path="共和分分析.html"><a href="共和分分析.html#見せかけの回帰-再掲"><i class="fa fa-check"></i><b>10.1</b> 見せかけの回帰 (再掲)</a>
<ul>
<li class="chapter" data-level="" data-path="共和分分析.html"><a href="共和分分析.html#durbin-watson検定"><i class="fa fa-check"></i>Durbin-Watson検定</a></li>
<li class="chapter" data-level="" data-path="共和分分析.html"><a href="共和分分析.html#rで実行可能な主な単位根検定法-1"><i class="fa fa-check"></i>Rで実行可能な主な単位根検定法</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="共和分分析.html"><a href="共和分分析.html#共和分分析-1"><i class="fa fa-check"></i><b>10.2</b> 共和分分析</a>
<ul>
<li class="chapter" data-level="" data-path="共和分分析.html"><a href="共和分分析.html#englegrangerの方法-philips-ouliaris検定"><i class="fa fa-check"></i>Engle–Grangerの方法 (Philips-Ouliaris検定)</a></li>
<li class="chapter" data-level="" data-path="共和分分析.html"><a href="共和分分析.html#johansenの方法"><i class="fa fa-check"></i>Johansenの方法</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="共和分分析.html"><a href="共和分分析.html#誤差修正モデル-データ分析例-tsay-mts-ch5"><i class="fa fa-check"></i><b>10.3</b> 誤差修正モデル: データ分析例 (Tsay, MTS, Ch5)</a>
<ul>
<li class="chapter" data-level="" data-path="共和分分析.html"><a href="共和分分析.html#共和分検定"><i class="fa fa-check"></i>共和分検定</a></li>
<li class="chapter" data-level="" data-path="共和分分析.html"><a href="共和分分析.html#johansenの方法-1"><i class="fa fa-check"></i>Johansenの方法</a></li>
<li class="chapter" data-level="" data-path="共和分分析.html"><a href="共和分分析.html#誤差修正モデル-ecm-の推定"><i class="fa fa-check"></i>誤差修正モデル (ECM) の推定</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="多変量ボラティリティモデル.html"><a href="多変量ボラティリティモデル.html"><i class="fa fa-check"></i><b>11</b> 多変量ボラティリティ・モデル</a>
<ul>
<li class="chapter" data-level="11.1" data-path="多変量ボラティリティモデル.html"><a href="多変量ボラティリティモデル.html#ボラティリティスピルオーバー-volatility-spillover"><i class="fa fa-check"></i><b>11.1</b> ボラティリティ・スピルオーバー (volatility spillover)</a></li>
<li class="chapter" data-level="11.2" data-path="多変量ボラティリティモデル.html"><a href="多変量ボラティリティモデル.html#多変量garchモデル-データ分析例-tsay-mts-ch.7"><i class="fa fa-check"></i><b>11.2</b> 多変量GARCHモデル: データ分析例 (Tsay, MTS, Ch.7)</a>
<ul>
<li class="chapter" data-level="" data-path="多変量ボラティリティモデル.html"><a href="多変量ボラティリティモデル.html#多変量時系列データの条件付不均一分散性の検定"><i class="fa fa-check"></i>多変量時系列データの条件付不均一分散性の検定</a></li>
<li class="chapter" data-level="" data-path="多変量ボラティリティモデル.html"><a href="多変量ボラティリティモデル.html#指数加重移動平均法-ewma"><i class="fa fa-check"></i>指数加重移動平均法 (EWMA)</a></li>
<li class="chapter" data-level="" data-path="多変量ボラティリティモデル.html"><a href="多変量ボラティリティモデル.html#bekk1-1モデル"><i class="fa fa-check"></i>BEKK(1, 1)モデル</a></li>
<li class="chapter" data-level="" data-path="多変量ボラティリティモデル.html"><a href="多変量ボラティリティモデル.html#cholesky分解を利用したボラティリティモデリングおよび推定"><i class="fa fa-check"></i>Cholesky分解を利用したボラティリティ・モデリングおよび推定</a></li>
<li class="chapter" data-level="" data-path="多変量ボラティリティモデル.html"><a href="多変量ボラティリティモデル.html#dcc-dynamic-conditional-correlation-モデル"><i class="fa fa-check"></i>DCC (Dynamic Conditional Correlation) モデル</a></li>
<li class="chapter" data-level="" data-path="多変量ボラティリティモデル.html"><a href="多変量ボラティリティモデル.html#go-garchモデル"><i class="fa fa-check"></i>GO-GARCHモデル</a></li>
<li class="chapter" data-level="" data-path="多変量ボラティリティモデル.html"><a href="多変量ボラティリティモデル.html#コピュラに基づくアプローチ"><i class="fa fa-check"></i>コピュラに基づくアプローチ</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="動的線形モデル.html"><a href="動的線形モデル.html"><i class="fa fa-check"></i><b>12</b> 動的線形モデル</a>
<ul>
<li class="chapter" data-level="12.1" data-path="動的線形モデル.html"><a href="動的線形モデル.html#局所水準-local-level-モデル"><i class="fa fa-check"></i><b>12.1</b> 局所水準 (local level) モデル</a>
<ul>
<li class="chapter" data-level="" data-path="動的線形モデル.html"><a href="動的線形モデル.html#フィルタリング"><i class="fa fa-check"></i>フィルタリング</a></li>
<li class="chapter" data-level="" data-path="動的線形モデル.html"><a href="動的線形モデル.html#スムージング-平滑化"><i class="fa fa-check"></i>スムージング (平滑化)</a></li>
<li class="chapter" data-level="" data-path="動的線形モデル.html"><a href="動的線形モデル.html#状態予測"><i class="fa fa-check"></i>状態予測</a></li>
<li class="chapter" data-level="" data-path="動的線形モデル.html"><a href="動的線形モデル.html#モデル診断-1"><i class="fa fa-check"></i>モデル診断</a></li>
<li class="chapter" data-level="" data-path="動的線形モデル.html"><a href="動的線形モデル.html#モデルパラメータの推定"><i class="fa fa-check"></i>モデル・パラメータの推定</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="動的線形モデル.html"><a href="動的線形モデル.html#local-level-plus-seasonal-componentモデル"><i class="fa fa-check"></i><b>12.2</b> local level plus seasonal componentモデル</a>
<ul>
<li class="chapter" data-level="" data-path="動的線形モデル.html"><a href="動的線形モデル.html#状態予測-1"><i class="fa fa-check"></i>状態予測</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="動的線形モデル.html"><a href="動的線形モデル.html#動的回帰モデル"><i class="fa fa-check"></i><b>12.3</b> 動的回帰モデル</a>
<ul>
<li class="chapter" data-level="" data-path="動的線形モデル.html"><a href="動的線形モデル.html#スムージング"><i class="fa fa-check"></i>スムージング</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="動的線形モデル.html"><a href="動的線形モデル.html#sur-seemingly-unrelated-regression-モデル-3.3.3"><i class="fa fa-check"></i><b>12.4</b> SUR (Seemingly Unrelated Regression) モデル (3.3.3)</a>
<ul>
<li class="chapter" data-level="" data-path="動的線形モデル.html"><a href="動的線形モデル.html#参考文献"><i class="fa fa-check"></i>参考文献</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="高頻度データ分析.html"><a href="高頻度データ分析.html"><i class="fa fa-check"></i><b>13</b> 高頻度データ分析</a>
<ul>
<li class="chapter" data-level="13.1" data-path="高頻度データ分析.html"><a href="高頻度データ分析.html#ボラティリティ推定"><i class="fa fa-check"></i><b>13.1</b> ボラティリティ推定</a>
<ul>
<li class="chapter" data-level="" data-path="高頻度データ分析.html"><a href="高頻度データ分析.html#データセット1-topix指数データ"><i class="fa fa-check"></i>データセット1: TOPIX指数データ</a></li>
<li class="chapter" data-level="" data-path="高頻度データ分析.html"><a href="高頻度データ分析.html#実現ボラティリティの計算"><i class="fa fa-check"></i>実現ボラティリティの計算</a></li>
<li class="chapter" data-level="" data-path="高頻度データ分析.html"><a href="高頻度データ分析.html#parkinsonボラティリティの計算"><i class="fa fa-check"></i>Parkinsonボラティリティの計算</a></li>
<li class="chapter" data-level="" data-path="高頻度データ分析.html"><a href="高頻度データ分析.html#har-rvモデルによる予測"><i class="fa fa-check"></i>HAR-RVモデルによる予測</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="高頻度データ分析.html"><a href="高頻度データ分析.html#共分散相関の推定"><i class="fa fa-check"></i><b>13.2</b> 共分散・相関の推定</a>
<ul>
<li class="chapter" data-level="" data-path="高頻度データ分析.html"><a href="高頻度データ分析.html#データセット2-株価指数先物データ"><i class="fa fa-check"></i>データセット2: 株価指数先物データ</a></li>
<li class="chapter" data-level="" data-path="高頻度データ分析.html"><a href="高頻度データ分析.html#共分散相関の推定-1"><i class="fa fa-check"></i>共分散・相関の推定</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="高頻度データ分析.html"><a href="高頻度データ分析.html#acdモデル"><i class="fa fa-check"></i><b>13.3</b> ACDモデル</a>
<ul>
<li class="chapter" data-level="" data-path="高頻度データ分析.html"><a href="高頻度データ分析.html#補足-等間隔データを作成するための方法"><i class="fa fa-check"></i>補足: 等間隔データを作成するための方法</a></li>
</ul></li>
</ul></li>
<li class="appendix"><span><b>Appendix 参考文献</b></span></li>
<li class="chapter" data-level="A" data-path="バブル-生成崩壊-検出.html"><a href="バブル-生成崩壊-検出.html"><i class="fa fa-check"></i><b>A</b> バブル (生成・崩壊) 検出</a>
<ul>
<li class="chapter" data-level="A.1" data-path="バブル-生成崩壊-検出.html"><a href="バブル-生成崩壊-検出.html#検定法に関する最近のレビュー論文"><i class="fa fa-check"></i><b>A.1</b> 検定法に関する最近のレビュー論文</a></li>
<li class="chapter" data-level="A.2" data-path="バブル-生成崩壊-検出.html"><a href="バブル-生成崩壊-検出.html#supreme-adf検定sadf-pwy-2011-generalized-supreme-adf-検定gsadf-psy-2015"><i class="fa fa-check"></i><b>A.2</b> Supreme ADF検定/SADF (PWY, 2011), Generalized supreme ADF 検定/GSADF (PSY, 2015)</a>
<ul>
<li class="chapter" data-level="A.2.1" data-path="バブル-生成崩壊-検出.html"><a href="バブル-生成崩壊-検出.html#数理ファイナンス-jarrow-protterら"><i class="fa fa-check"></i><b>A.2.1</b> 数理ファイナンス (Jarrow, Protterら)</a></li>
<li class="chapter" data-level="A.2.2" data-path="バブル-生成崩壊-検出.html"><a href="バブル-生成崩壊-検出.html#経済物理学-sornetteら"><i class="fa fa-check"></i><b>A.2.2</b> 経済物理学 (Sornetteら)</a></li>
</ul></li>
<li class="chapter" data-level="A.3" data-path="バブル-生成崩壊-検出.html"><a href="バブル-生成崩壊-検出.html#実証分析"><i class="fa fa-check"></i><b>A.3</b> 実証分析</a>
<ul>
<li class="chapter" data-level="" data-path="バブル-生成崩壊-検出.html"><a href="バブル-生成崩壊-検出.html#株式市場の例"><i class="fa fa-check"></i>株式市場の例</a></li>
<li class="chapter" data-level="" data-path="バブル-生成崩壊-検出.html"><a href="バブル-生成崩壊-検出.html#暗号資産市場の例"><i class="fa fa-check"></i>暗号資産市場の例</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="B" data-path="長期記憶過程-1.html"><a href="長期記憶過程-1.html"><i class="fa fa-check"></i><b>B</b> 長期記憶過程</a>
<ul>
<li class="chapter" data-level="B.1" data-path="長期記憶過程-1.html"><a href="長期記憶過程-1.html#理論概説"><i class="fa fa-check"></i><b>B.1</b> 理論・概説</a></li>
<li class="chapter" data-level="B.2" data-path="長期記憶過程-1.html"><a href="長期記憶過程-1.html#株式市場"><i class="fa fa-check"></i><b>B.2</b> 株式市場</a></li>
<li class="chapter" data-level="B.3" data-path="長期記憶過程-1.html"><a href="長期記憶過程-1.html#外国為替市場"><i class="fa fa-check"></i><b>B.3</b> 外国為替市場</a></li>
<li class="chapter" data-level="B.4" data-path="長期記憶過程-1.html"><a href="長期記憶過程-1.html#コモディティ暗号資産"><i class="fa fa-check"></i><b>B.4</b> コモディティ・暗号資産</a></li>
<li class="chapter" data-level="B.5" data-path="長期記憶過程-1.html"><a href="長期記憶過程-1.html#vix"><i class="fa fa-check"></i><b>B.5</b> VIX</a></li>
<li class="chapter" data-level="B.6" data-path="長期記憶過程-1.html"><a href="長期記憶過程-1.html#高頻度データ-ボラティリティ-注文フロー等"><i class="fa fa-check"></i><b>B.6</b> 高頻度データ (ボラティリティ, 注文フロー等)</a></li>
<li class="chapter" data-level="B.7" data-path="長期記憶過程-1.html"><a href="長期記憶過程-1.html#長期記憶性の発生要因-非長期記憶モデルによる近似"><i class="fa fa-check"></i><b>B.7</b> 長期記憶性の発生要因, 非長期記憶モデルによる近似</a></li>
</ul></li>
<li class="chapter" data-level="C" data-path="markov-switching-regime-switchingモデル.html"><a href="markov-switching-regime-switchingモデル.html"><i class="fa fa-check"></i><b>C</b> Markov switching/ regime switchingモデル</a>
<ul>
<li class="chapter" data-level="C.1" data-path="markov-switching-regime-switchingモデル.html"><a href="markov-switching-regime-switchingモデル.html#理論概説-1"><i class="fa fa-check"></i><b>C.1</b> 理論・概説</a></li>
<li class="chapter" data-level="C.2" data-path="markov-switching-regime-switchingモデル.html"><a href="markov-switching-regime-switchingモデル.html#株式市場-1"><i class="fa fa-check"></i><b>C.2</b> 株式市場</a></li>
<li class="chapter" data-level="C.3" data-path="markov-switching-regime-switchingモデル.html"><a href="markov-switching-regime-switchingモデル.html#金利債券市場"><i class="fa fa-check"></i><b>C.3</b> 金利・債券市場</a></li>
<li class="chapter" data-level="C.4" data-path="markov-switching-regime-switchingモデル.html"><a href="markov-switching-regime-switchingモデル.html#外国為替市場-1"><i class="fa fa-check"></i><b>C.4</b> 外国為替市場</a></li>
<li class="chapter" data-level="C.5" data-path="markov-switching-regime-switchingモデル.html"><a href="markov-switching-regime-switchingモデル.html#アセットアロケーション"><i class="fa fa-check"></i><b>C.5</b> アセット・アロケーション</a></li>
</ul></li>
<li class="chapter" data-level="D" data-path="archgarchモデル-1.html"><a href="archgarchモデル-1.html"><i class="fa fa-check"></i><b>D</b> ARCH/GARCHモデル</a>
<ul>
<li class="chapter" data-level="D.1" data-path="archgarchモデル-1.html"><a href="archgarchモデル-1.html#概説"><i class="fa fa-check"></i><b>D.1</b> 概説</a></li>
<li class="chapter" data-level="D.2" data-path="archgarchモデル-1.html"><a href="archgarchモデル-1.html#arch-model"><i class="fa fa-check"></i><b>D.2</b> ARCH model</a></li>
<li class="chapter" data-level="D.3" data-path="archgarchモデル-1.html"><a href="archgarchモデル-1.html#garch-model"><i class="fa fa-check"></i><b>D.3</b> GARCH model</a></li>
<li class="chapter" data-level="D.4" data-path="archgarchモデル-1.html"><a href="archgarchモデル-1.html#arch-m-model"><i class="fa fa-check"></i><b>D.4</b> ARCH-M Model</a></li>
<li class="chapter" data-level="D.5" data-path="archgarchモデル-1.html"><a href="archgarchモデル-1.html#gjr-model"><i class="fa fa-check"></i><b>D.5</b> GJR model</a></li>
<li class="chapter" data-level="D.6" data-path="archgarchモデル-1.html"><a href="archgarchモデル-1.html#aparch-model"><i class="fa fa-check"></i><b>D.6</b> APARCH model</a></li>
</ul></li>
<li class="chapter" data-level="E" data-path="共和分-誤差修正モデル.html"><a href="共和分-誤差修正モデル.html"><i class="fa fa-check"></i><b>E</b> 共和分/ 誤差修正モデル</a>
<ul>
<li class="chapter" data-level="E.1" data-path="共和分-誤差修正モデル.html"><a href="共和分-誤差修正モデル.html#株式市場とマクロ変数-国際株式市場間の分析"><i class="fa fa-check"></i><b>E.1</b> 株式市場とマクロ変数, 国際株式市場間の分析</a></li>
<li class="chapter" data-level="E.2" data-path="共和分-誤差修正モデル.html"><a href="共和分-誤差修正モデル.html#個別株式の複数取引所株価間の分析"><i class="fa fa-check"></i><b>E.2</b> 個別株式の複数取引所株価間の分析</a></li>
<li class="chapter" data-level="E.3" data-path="共和分-誤差修正モデル.html"><a href="共和分-誤差修正モデル.html#高頻度データ-bidask価格-の分析"><i class="fa fa-check"></i><b>E.3</b> 高頻度データ (bid/ask価格) の分析</a></li>
<li class="chapter" data-level="E.4" data-path="共和分-誤差修正モデル.html"><a href="共和分-誤差修正モデル.html#統計的アービトラージ-ペアトレード"><i class="fa fa-check"></i><b>E.4</b> 統計的アービトラージ / ペアトレード</a></li>
<li class="chapter" data-level="E.5" data-path="共和分-誤差修正モデル.html"><a href="共和分-誤差修正モデル.html#国際株式市場間のヘッジ"><i class="fa fa-check"></i><b>E.5</b> 国際株式市場間のヘッジ</a></li>
<li class="chapter" data-level="E.6" data-path="共和分-誤差修正モデル.html"><a href="共和分-誤差修正モデル.html#クレジットスプレッド-株式-cds-債券-の分析"><i class="fa fa-check"></i><b>E.6</b> クレジット・スプレッド (株式, CDS, 債券) の分析</a></li>
</ul></li>
<li class="chapter" data-level="F" data-path="今後の学習のために.html"><a href="今後の学習のために.html"><i class="fa fa-check"></i><b>F</b> 今後の学習のために</a>
<ul>
<li class="chapter" data-level="F.1" data-path="今後の学習のために.html"><a href="今後の学習のために.html#ai機械学習と時系列解析"><i class="fa fa-check"></i><b>F.1</b> AI/機械学習と時系列解析</a></li>
<li class="chapter" data-level="F.2" data-path="今後の学習のために.html"><a href="今後の学習のために.html#カテゴリーデータや整数値データ等に対する時系列解析"><i class="fa fa-check"></i><b>F.2</b> カテゴリーデータや整数値データ等に対する時系列解析</a></li>
<li class="chapter" data-level="F.3" data-path="今後の学習のために.html"><a href="今後の学習のために.html#状態空間モデル動的線形モデル"><i class="fa fa-check"></i><b>F.3</b> 状態空間モデル・動的線形モデル</a></li>
<li class="chapter" data-level="F.4" data-path="今後の学習のために.html"><a href="今後の学習のために.html#その他"><i class="fa fa-check"></i><b>F.4</b> その他</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">金融時系列解析</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="varモデル" class="section level1 hasAnchor" number="9">
<h1><span class="header-section-number">9</span> VARモデル<a href="varモデル.html#varモデル" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<!--
## VARモデル
- 以下では, **MTS**パッケージ, **vars**パッケージを利用
  - https://www.rdocumentation.org/packages/MTS/versions/1.0
  - https://www.rdocumentation.org/packages/vars/versions/1.5-3
-->
<div id="varpモデルのシミュレーション" class="section level2 hasAnchor" number="9.1">
<h2><span class="header-section-number">9.1</span> VAR(<span class="math inline">\(p\)</span>)モデルのシミュレーション<a href="varモデル.html#varpモデルのシミュレーション" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="パッケージmts-varsの利用" class="section level3 unnumbered hasAnchor">
<h3>パッケージ<strong>MTS</strong>, <strong>vars</strong>の利用<a href="varモデル.html#パッケージmts-varsの利用" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>本章では主に, Tsayが作成した多変量時系列解析用のパッケージ<strong>MTS</strong>
および, パッケージ<strong>vars</strong>を利用する.
<!-- 操作性や出力内容を比較するため, --></p>
<ul>
<li><p><a href="https://www.rdocumentation.org/packages/MTS/versions/1.0" class="uri">https://www.rdocumentation.org/packages/MTS/versions/1.0</a></p></li>
<li><p><a href="https://www.rdocumentation.org/packages/vars/versions/1.5-3" class="uri">https://www.rdocumentation.org/packages/vars/versions/1.5-3</a></p></li>
<li><p>関数<code>MTS::VARMAsim()</code> (VARMA(<span class="math inline">\(p,q\)</span>)モデルのパス生成)</p></li>
<li><p>VAR(2)モデル例:
<span class="math display">\[Y_{1,t}=0.3 + 0.2 Y_{1,t-1} + 0.3 Y_{2,t-1} - 0.5 Y_{1,t-2} (+0 \cdot Y_{2,t-2}) + \epsilon_{1,t}\]</span>
<span class="math display">\[Y_{2,t}=-0.3  -0.6 Y_{1,t-1} + 1.1 Y_{2,t-1} (+0 \cdot Y_{1,t-2}) - 0.6 Y_{2,t-2} + \epsilon_{2,t}\]</span>
<span class="math display">\[ \left[
  \begin{array}{r}
    \epsilon_{1,t} \\ \epsilon_{2,t}
  \end{array}
\right] \sim_{\it i.i.d.} N \Big(\left[
  \begin{array}{r}
    0 \\ 0
  \end{array}
\right], \left[
  \begin{array}{rr}
    4 &amp; 0.8 \\ 0.8 &amp; 1
  \end{array}
\right]\Big) \]</span></p></li>
<li><p>上記VAR(2)モデルのサンプルパスの生成</p></li>
</ul>
<div class="sourceCode" id="cb628"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb628-1"><a href="varモデル.html#cb628-1" tabindex="-1"></a><span class="fu">library</span>(MTS)</span>
<span id="cb628-2"><a href="varモデル.html#cb628-2" tabindex="-1"></a>nlen <span class="ot">&lt;-</span> <span class="dv">300</span></span>
<span id="cb628-3"><a href="varモデル.html#cb628-3" tabindex="-1"></a>seed_val <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb628-4"><a href="varモデル.html#cb628-4" tabindex="-1"></a><span class="fu">set.seed</span>(seed_val)</span>
<span id="cb628-5"><a href="varモデル.html#cb628-5" tabindex="-1"></a>p0 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.3</span>, <span class="sc">-</span><span class="fl">0.3</span>)              <span class="co"># Phi0 (定数項)</span></span>
<span id="cb628-6"><a href="varモデル.html#cb628-6" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fl">0.2</span>, <span class="sc">-</span><span class="fl">0.6</span>, <span class="fl">0.3</span>, <span class="fl">1.1</span>), <span class="dv">2</span>, <span class="dv">2</span>)  <span class="co"># Phi1 (ラグ1のVAR係数行列)</span></span>
<span id="cb628-7"><a href="varモデル.html#cb628-7" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.5</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="sc">-</span><span class="fl">0.6</span>), <span class="dv">2</span>, <span class="dv">2</span>)         <span class="co"># Phi2 (ラグ2のVAR係数行列)</span></span>
<span id="cb628-8"><a href="varモデル.html#cb628-8" tabindex="-1"></a>p_mat <span class="ot">&lt;-</span> <span class="fu">cbind</span>(p1, p2)                      <span class="co"># VAR係数行列を重ねた行列</span></span>
<span id="cb628-9"><a href="varモデル.html#cb628-9" tabindex="-1"></a>sig_mat <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">4</span>, <span class="fl">0.8</span>, <span class="fl">0.8</span>, <span class="dv">1</span>), <span class="dv">2</span>, <span class="dv">2</span>)      <span class="co"># イノベーションの分散共分散行列 (正値定符号)</span></span>
<span id="cb628-10"><a href="varモデル.html#cb628-10" tabindex="-1"></a>p_mat; sig_mat</span>
<span id="cb628-11"><a href="varモデル.html#cb628-11" tabindex="-1"></a><span class="do">##      [,1] [,2] [,3] [,4]</span></span>
<span id="cb628-12"><a href="varモデル.html#cb628-12" tabindex="-1"></a><span class="do">## [1,]  0.2  0.3 -0.5  0.0</span></span>
<span id="cb628-13"><a href="varモデル.html#cb628-13" tabindex="-1"></a><span class="do">## [2,] -0.6  1.1  0.0 -0.6</span></span>
<span id="cb628-14"><a href="varモデル.html#cb628-14" tabindex="-1"></a><span class="do">##      [,1] [,2]</span></span>
<span id="cb628-15"><a href="varモデル.html#cb628-15" tabindex="-1"></a><span class="do">## [1,]  4.0  0.8</span></span>
<span id="cb628-16"><a href="varモデル.html#cb628-16" tabindex="-1"></a><span class="do">## [2,]  0.8  1.0</span></span>
<span id="cb628-17"><a href="varモデル.html#cb628-17" tabindex="-1"></a>ysim <span class="ot">&lt;-</span> <span class="fu">VARMAsim</span>(nlen, <span class="at">arlags =</span> <span class="dv">2</span>, <span class="at">cnst =</span> p0, <span class="at">phi =</span> p_mat, <span class="at">sigma =</span> sig_mat)</span>
<span id="cb628-18"><a href="varモデル.html#cb628-18" tabindex="-1"></a>Yt <span class="ot">&lt;-</span> ysim<span class="sc">$</span>series</span>
<span id="cb628-19"><a href="varモデル.html#cb628-19" tabindex="-1"></a><span class="fu">MTSplot</span>(Yt)　<span class="co"># 時系列プロット</span></span></code></pre></div>
<p><img src="090-VAR_files/figure-html/VARsim_12-1.png" width="75%" /></p>
<ul>
<li>生成パス<span class="math inline">\(y_t\)</span>の標本自己共分散行列
<ul>
<li>対角成分: 各成分の自己相関 <span class="math inline">\(\hat{\rho}_1(h), \hat{\rho}_2(h)\)</span></li>
<li>非対角成分: <span class="math inline">\(y^1_t,y^2_t\)</span>間のクロス相関
<ul>
<li>行列の(1,2)成分: <span class="math inline">\(\hat{\rho}_{1,2}(h),\,h\ge0\)</span></li>
<li>行列の(2,1)成分: <span class="math inline">\(\hat{\rho}_{1,2}(h)\equiv\hat{\rho}_{2,1}(-h), \,h\le0\)</span></li>
</ul></li>
</ul></li>
</ul>
<div class="sourceCode" id="cb629"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb629-1"><a href="varモデル.html#cb629-1" tabindex="-1"></a><span class="fu">acf</span>(Yt)　　　<span class="co"># 標本自己共分散行列 (2x2-行列)</span></span></code></pre></div>
<p><img src="090-VAR_files/figure-html/unnamed-chunk-1-1.png" width="75%" /></p>
<div class="sourceCode" id="cb630"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb630-1"><a href="varモデル.html#cb630-1" tabindex="-1"></a><span class="co"># acf()の出力結果の非対角成分の確認</span></span>
<span id="cb630-2"><a href="varモデル.html#cb630-2" tabindex="-1"></a><span class="co"># cor(Y1(t+h), Y2(t))</span></span>
<span id="cb630-3"><a href="varモデル.html#cb630-3" tabindex="-1"></a><span class="co"># h&gt;0</span></span>
<span id="cb630-4"><a href="varモデル.html#cb630-4" tabindex="-1"></a><span class="fu">cor</span>(Yt[<span class="dv">2</span><span class="sc">:</span>nlen, <span class="dv">1</span>], Yt[<span class="dv">1</span><span class="sc">:</span>(nlen<span class="dv">-1</span>), <span class="dv">2</span>]) <span class="co"># Y1(t+1) vs Y2(t)</span></span>
<span id="cb630-5"><a href="varモデル.html#cb630-5" tabindex="-1"></a><span class="do">## [1] -0.2491788</span></span>
<span id="cb630-6"><a href="varモデル.html#cb630-6" tabindex="-1"></a><span class="fu">cor</span>(Yt[<span class="dv">3</span><span class="sc">:</span>nlen, <span class="dv">1</span>], Yt[<span class="dv">1</span><span class="sc">:</span>(nlen<span class="dv">-2</span>), <span class="dv">2</span>]) <span class="co"># Y1(t+2) vs Y2(t)</span></span>
<span id="cb630-7"><a href="varモデル.html#cb630-7" tabindex="-1"></a><span class="do">## [1] 0.5855889</span></span>
<span id="cb630-8"><a href="varモデル.html#cb630-8" tabindex="-1"></a><span class="co"># h&lt;0</span></span>
<span id="cb630-9"><a href="varモデル.html#cb630-9" tabindex="-1"></a><span class="fu">cor</span>(Yt[<span class="dv">1</span><span class="sc">:</span>(nlen<span class="dv">-1</span>), <span class="dv">1</span>], Yt[<span class="dv">2</span><span class="sc">:</span>nlen, <span class="dv">2</span>]) <span class="co"># Y1(t) vs Y2(t+1)</span></span>
<span id="cb630-10"><a href="varモデル.html#cb630-10" tabindex="-1"></a><span class="do">## [1] -0.2269957</span></span>
<span id="cb630-11"><a href="varモデル.html#cb630-11" tabindex="-1"></a><span class="fu">cor</span>(Yt[<span class="dv">1</span><span class="sc">:</span>(nlen<span class="dv">-2</span>), <span class="dv">1</span>], Yt[<span class="dv">3</span><span class="sc">:</span>nlen, <span class="dv">2</span>]) <span class="co"># y1(t) vs Y2(t+2)</span></span>
<span id="cb630-12"><a href="varモデル.html#cb630-12" tabindex="-1"></a><span class="do">## [1] 0.2156902</span></span></code></pre></div>
</div>
</div>
<div id="varpモデルの構築" class="section level2 hasAnchor" number="9.2">
<h2><span class="header-section-number">9.2</span> VAR(<span class="math inline">\(p\)</span>)モデルの構築<a href="varモデル.html#varpモデルの構築" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>ここでは, VAR(<span class="math inline">\(p\)</span>)モデル構築の中核のステップである,
同定・推定・予測の方法について示す.</p>
<div id="varpモデルの次数同定" class="section level3 unnumbered hasAnchor">
<h3>VAR(<span class="math inline">\(p\)</span>)モデルの次数同定<a href="varモデル.html#varpモデルの次数同定" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>分析者による最適なラグ次数の選択を支援</li>
</ul>
<pre><code>- 関数MTS::VARorder()
  - maxp: ラグ次数の最大値 (デフォルト=13)
  - 出力: BIC, HQ (Hannan and Quinn情報量規準), M(p), p-value (カイ二乗検定統計量 &amp; p値)</code></pre>
<div class="sourceCode" id="cb632"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb632-1"><a href="varモデル.html#cb632-1" tabindex="-1"></a><span class="fu">VARorder</span>(Yt, <span class="at">maxp =</span> <span class="dv">10</span>, <span class="at">output =</span> T)</span>
<span id="cb632-2"><a href="varモデル.html#cb632-2" tabindex="-1"></a><span class="do">## selected order: aic =  2 </span></span>
<span id="cb632-3"><a href="varモデル.html#cb632-3" tabindex="-1"></a><span class="do">## selected order: bic =  2 </span></span>
<span id="cb632-4"><a href="varモデル.html#cb632-4" tabindex="-1"></a><span class="do">## selected order: hq =  2 </span></span>
<span id="cb632-5"><a href="varモデル.html#cb632-5" tabindex="-1"></a><span class="do">## Summary table:  </span></span>
<span id="cb632-6"><a href="varモデル.html#cb632-6" tabindex="-1"></a><span class="do">##        p    AIC    BIC     HQ     M(p) p-value</span></span>
<span id="cb632-7"><a href="varモデル.html#cb632-7" tabindex="-1"></a><span class="do">##  [1,]  0 4.2159 4.2159 4.2159   0.0000  0.0000</span></span>
<span id="cb632-8"><a href="varモデル.html#cb632-8" tabindex="-1"></a><span class="do">##  [2,]  1 3.8924 3.9418 3.9122 100.3170  0.0000</span></span>
<span id="cb632-9"><a href="varモデル.html#cb632-9" tabindex="-1"></a><span class="do">##  [3,]  2 1.5169 1.6157 1.5564 683.4158  0.0000</span></span>
<span id="cb632-10"><a href="varモデル.html#cb632-10" tabindex="-1"></a><span class="do">##  [4,]  3 1.5299 1.6781 1.5892   3.8619  0.4250</span></span>
<span id="cb632-11"><a href="varモデル.html#cb632-11" tabindex="-1"></a><span class="do">##  [5,]  4 1.5434 1.7409 1.6224   3.6978  0.4484</span></span>
<span id="cb632-12"><a href="varモデル.html#cb632-12" tabindex="-1"></a><span class="do">##  [6,]  5 1.5325 1.7794 1.6313  10.4626  0.0333</span></span>
<span id="cb632-13"><a href="varモデル.html#cb632-13" tabindex="-1"></a><span class="do">##  [7,]  6 1.5548 1.8511 1.6734   1.2025  0.8777</span></span>
<span id="cb632-14"><a href="varモデル.html#cb632-14" tabindex="-1"></a><span class="do">##  [8,]  7 1.5575 1.9032 1.6958   6.5850  0.1595</span></span>
<span id="cb632-15"><a href="varモデル.html#cb632-15" tabindex="-1"></a><span class="do">##  [9,]  8 1.5799 1.9750 1.7381   1.1470  0.8867</span></span>
<span id="cb632-16"><a href="varモデル.html#cb632-16" tabindex="-1"></a><span class="do">## [10,]  9 1.5896 2.0340 1.7674   4.6092  0.3298</span></span>
<span id="cb632-17"><a href="varモデル.html#cb632-17" tabindex="-1"></a><span class="do">## [11,] 10 1.6099 2.1037 1.8075   1.7109  0.7887</span></span></code></pre></div>
<pre><code>- 関数vars::VARselect()
  - lag.max: ラグ次数の最大値 (デフォルト=10)
  - type: 確定的な(定数・トレンド)項の種類
    &quot;const&quot;(定数項有), &quot;trend&quot;(トレンド有), &quot;both&quot;(定数項・トレンド共有), &quot;none&quot;(両方無)
  - 出力: AIC, HQ, SC (Schwarz情報量規準), FPE (forecast prediction error)</code></pre>
<div class="sourceCode" id="cb634"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb634-1"><a href="varモデル.html#cb634-1" tabindex="-1"></a><span class="fu">library</span>(vars)</span>
<span id="cb634-2"><a href="varモデル.html#cb634-2" tabindex="-1"></a>vars<span class="sc">::</span><span class="fu">VARselect</span>(Yt, <span class="at">lag.max =</span> <span class="dv">10</span>, <span class="at">type =</span> <span class="st">&quot;const&quot;</span>)</span>
<span id="cb634-3"><a href="varモデル.html#cb634-3" tabindex="-1"></a><span class="do">## $selection</span></span>
<span id="cb634-4"><a href="varモデル.html#cb634-4" tabindex="-1"></a><span class="do">## AIC(n)  HQ(n)  SC(n) FPE(n) </span></span>
<span id="cb634-5"><a href="varモデル.html#cb634-5" tabindex="-1"></a><span class="do">##      2      2      2      2 </span></span>
<span id="cb634-6"><a href="varモデル.html#cb634-6" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb634-7"><a href="varモデル.html#cb634-7" tabindex="-1"></a><span class="do">## $criteria</span></span>
<span id="cb634-8"><a href="varモデル.html#cb634-8" tabindex="-1"></a><span class="do">##                1        2        3        4        5        6        7        8</span></span>
<span id="cb634-9"><a href="varモデル.html#cb634-9" tabindex="-1"></a><span class="do">## AIC(n)  3.907125 1.532547 1.546463 1.560866 1.550885 1.574122 1.577719 1.601096</span></span>
<span id="cb634-10"><a href="varモデル.html#cb634-10" tabindex="-1"></a><span class="do">## HQ(n)   3.937546 1.583248 1.617444 1.652128 1.662427 1.705945 1.729823 1.773480</span></span>
<span id="cb634-11"><a href="varモデル.html#cb634-11" tabindex="-1"></a><span class="do">## SC(n)   3.983054 1.659094 1.723629 1.788652 1.829289 1.903146 1.957362 2.031358</span></span>
<span id="cb634-12"><a href="varモデル.html#cb634-12" tabindex="-1"></a><span class="do">## FPE(n) 49.755778 4.629985 4.694921 4.763133 4.715983 4.827081 4.844789 4.959798</span></span>
<span id="cb634-13"><a href="varモデル.html#cb634-13" tabindex="-1"></a><span class="do">##               9       10</span></span>
<span id="cb634-14"><a href="varモデル.html#cb634-14" tabindex="-1"></a><span class="do">## AIC(n) 1.611643 1.632857</span></span>
<span id="cb634-15"><a href="varモデル.html#cb634-15" tabindex="-1"></a><span class="do">## HQ(n)  1.804307 1.845802</span></span>
<span id="cb634-16"><a href="varモデル.html#cb634-16" tabindex="-1"></a><span class="do">## SC(n)  2.092524 2.164357</span></span>
<span id="cb634-17"><a href="varモデル.html#cb634-17" tabindex="-1"></a><span class="do">## FPE(n) 5.012920 5.121076</span></span></code></pre></div>
<!--
"In statistics, the Bayesian information criterion (BIC) or Schwarz information criterion (also SIC, SBC, SBIC) is a criterion for model selection ..." (wiki)
- パッケージ**vars**の用法: https://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=&ved=2ahUKEwjZ5trv742DAxXHr1YBHcPVBrkQFnoECA0QAQ&url=https%3A%2F%2Fwww.researchgate.net%2Fprofile%2FDavid-Booth-7%2Fpost%2FHow_to_select_optimal_lag_between_dependent_variable_and_independent_variables%2Fattachment%2F59d649eb79197b80779a450a%2FAS%253A473055043559424%25401489796519099%2Fdownload%2FVARS_how_to_use.pdf&usg=AOvVaw0WQ5jq3ZBjvAgOHYlLtqv3&opi=89978449
-->
</div>
<div id="varpモデルの推定" class="section level3 unnumbered hasAnchor">
<h3>VAR(<span class="math inline">\(p\)</span>)モデルの推定<a href="varモデル.html#varpモデルの推定" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>最小2乗法によるパラメータ推定</li>
</ul>
<pre><code>- 関数MTS::VAR()
  - p: ラグ次数
  - include.mean: 平均ベクトルを加える(推定する)か (デフォルト=T)
  - fixed: パラメータに制約を付与する論理値行列. 制約付推定 (主に有意でない推定値の除去) に使用</code></pre>
<div class="sourceCode" id="cb636"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb636-1"><a href="varモデル.html#cb636-1" tabindex="-1"></a>est_VAR1 <span class="ot">&lt;-</span> MTS<span class="sc">::</span><span class="fu">VAR</span>(Yt, <span class="at">p =</span> <span class="dv">2</span>, <span class="at">output =</span> T, <span class="at">include.mean =</span> T, <span class="at">fixed =</span> <span class="cn">NULL</span>) </span>
<span id="cb636-2"><a href="varモデル.html#cb636-2" tabindex="-1"></a><span class="do">## Constant term: </span></span>
<span id="cb636-3"><a href="varモデル.html#cb636-3" tabindex="-1"></a><span class="do">## Estimates:  0.7010694 -0.4390955 </span></span>
<span id="cb636-4"><a href="varモデル.html#cb636-4" tabindex="-1"></a><span class="do">## Std.Error:  0.2935926 0.1458662 </span></span>
<span id="cb636-5"><a href="varモデル.html#cb636-5" tabindex="-1"></a><span class="do">## AR coefficient matrix </span></span>
<span id="cb636-6"><a href="varモデル.html#cb636-6" tabindex="-1"></a><span class="do">## AR( 1 )-matrix </span></span>
<span id="cb636-7"><a href="varモデル.html#cb636-7" tabindex="-1"></a><span class="do">##         [,1]    [,2]</span></span>
<span id="cb636-8"><a href="varモデル.html#cb636-8" tabindex="-1"></a><span class="do">## [1,] -0.0928  0.0954</span></span>
<span id="cb636-9"><a href="varモデル.html#cb636-9" tabindex="-1"></a><span class="do">## [2,] -0.0197 -0.0286</span></span>
<span id="cb636-10"><a href="varモデル.html#cb636-10" tabindex="-1"></a><span class="do">## standard error </span></span>
<span id="cb636-11"><a href="varモデル.html#cb636-11" tabindex="-1"></a><span class="do">##        [,1]   [,2]</span></span>
<span id="cb636-12"><a href="varモデル.html#cb636-12" tabindex="-1"></a><span class="do">## [1,] 0.0575 0.0462</span></span>
<span id="cb636-13"><a href="varモデル.html#cb636-13" tabindex="-1"></a><span class="do">## [2,] 0.0286 0.0230</span></span>
<span id="cb636-14"><a href="varモデル.html#cb636-14" tabindex="-1"></a><span class="do">## AR( 2 )-matrix </span></span>
<span id="cb636-15"><a href="varモデル.html#cb636-15" tabindex="-1"></a><span class="do">##        [,1]  [,2]</span></span>
<span id="cb636-16"><a href="varモデル.html#cb636-16" tabindex="-1"></a><span class="do">## [1,]  0.105 0.402</span></span>
<span id="cb636-17"><a href="varモデル.html#cb636-17" tabindex="-1"></a><span class="do">## [2,] -0.616 1.117</span></span>
<span id="cb636-18"><a href="varモデル.html#cb636-18" tabindex="-1"></a><span class="do">## standard error </span></span>
<span id="cb636-19"><a href="varモデル.html#cb636-19" tabindex="-1"></a><span class="do">##        [,1]   [,2]</span></span>
<span id="cb636-20"><a href="varモデル.html#cb636-20" tabindex="-1"></a><span class="do">## [1,] 0.0575 0.0465</span></span>
<span id="cb636-21"><a href="varモデル.html#cb636-21" tabindex="-1"></a><span class="do">## [2,] 0.0285 0.0231</span></span>
<span id="cb636-22"><a href="varモデル.html#cb636-22" tabindex="-1"></a><span class="do">##   </span></span>
<span id="cb636-23"><a href="varモデル.html#cb636-23" tabindex="-1"></a><span class="do">## Residuals cov-mtx: </span></span>
<span id="cb636-24"><a href="varモデル.html#cb636-24" tabindex="-1"></a><span class="do">##           [,1]      [,2]</span></span>
<span id="cb636-25"><a href="varモデル.html#cb636-25" tabindex="-1"></a><span class="do">## [1,] 4.4990390 0.8786783</span></span>
<span id="cb636-26"><a href="varモデル.html#cb636-26" tabindex="-1"></a><span class="do">## [2,] 0.8786783 1.1105526</span></span>
<span id="cb636-27"><a href="varモデル.html#cb636-27" tabindex="-1"></a><span class="do">##   </span></span>
<span id="cb636-28"><a href="varモデル.html#cb636-28" tabindex="-1"></a><span class="do">## det(SSE) =  4.224344 </span></span>
<span id="cb636-29"><a href="varモデル.html#cb636-29" tabindex="-1"></a><span class="do">## AIC =  1.494197 </span></span>
<span id="cb636-30"><a href="varモデル.html#cb636-30" tabindex="-1"></a><span class="do">## BIC =  1.592965 </span></span>
<span id="cb636-31"><a href="varモデル.html#cb636-31" tabindex="-1"></a><span class="do">## HQ  =  1.533724</span></span></code></pre></div>
<pre><code>- 関数vars::VAR()
  - p: ラグ次数
  - type: 確定的な(定数・トレンド)項の種類
    &quot;const&quot;(定数項有), &quot;trend&quot;(トレンド有), &quot;both&quot;(定数項・トレンド共有), &quot;none&quot;(両方無)
  - season: 中心化済の季節性ダミー変数の追加 (frequencyを表す整数を指定)
  - exogen: 外生変数の追加
  - lag.max: ラグ次数の最大値 (ラグ次数選択において)
  - in: 情報量規準 (lag.maxを指定している場合)</code></pre>
<!-- 8/26/22時点: Build Book時, 以下でエラー発生(→解決済)
- Error in match.fun(FUN) : object 'stdev' not found -->
<div class="sourceCode" id="cb638"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb638-1"><a href="varモデル.html#cb638-1" tabindex="-1"></a>est_VAR2 <span class="ot">&lt;-</span> vars<span class="sc">::</span><span class="fu">VAR</span>(Yt, <span class="at">p =</span> <span class="dv">2</span>, <span class="at">type =</span> <span class="st">&quot;const&quot;</span>)    </span>
<span id="cb638-2"><a href="varモデル.html#cb638-2" tabindex="-1"></a><span class="co"># 最小2乗法によるパラメータ推定</span></span>
<span id="cb638-3"><a href="varモデル.html#cb638-3" tabindex="-1"></a><span class="co"># type: &quot;const&quot;(定数項有), trend:(&quot;トレンド有&quot;), &quot;both&quot;, &quot;none&quot;</span></span>
<span id="cb638-4"><a href="varモデル.html#cb638-4" tabindex="-1"></a><span class="fu">summary</span>(est_VAR2)</span>
<span id="cb638-5"><a href="varモデル.html#cb638-5" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb638-6"><a href="varモデル.html#cb638-6" tabindex="-1"></a><span class="do">## VAR Estimation Results:</span></span>
<span id="cb638-7"><a href="varモデル.html#cb638-7" tabindex="-1"></a><span class="do">## ========================= </span></span>
<span id="cb638-8"><a href="varモデル.html#cb638-8" tabindex="-1"></a><span class="do">## Endogenous variables: y1, y2 </span></span>
<span id="cb638-9"><a href="varモデル.html#cb638-9" tabindex="-1"></a><span class="do">## Deterministic variables: const </span></span>
<span id="cb638-10"><a href="varモデル.html#cb638-10" tabindex="-1"></a><span class="do">## Sample size: 298 </span></span>
<span id="cb638-11"><a href="varモデル.html#cb638-11" tabindex="-1"></a><span class="do">## Log Likelihood: -1060.376 </span></span>
<span id="cb638-12"><a href="varモデル.html#cb638-12" tabindex="-1"></a><span class="do">## Roots of the characteristic polynomial:</span></span>
<span id="cb638-13"><a href="varモデル.html#cb638-13" tabindex="-1"></a><span class="do">## 0.9308 0.7541 0.7541 0.6891</span></span>
<span id="cb638-14"><a href="varモデル.html#cb638-14" tabindex="-1"></a><span class="do">## Call:</span></span>
<span id="cb638-15"><a href="varモデル.html#cb638-15" tabindex="-1"></a><span class="do">## vars::VAR(y = Yt, p = 2, type = &quot;const&quot;)</span></span>
<span id="cb638-16"><a href="varモデル.html#cb638-16" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb638-17"><a href="varモデル.html#cb638-17" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb638-18"><a href="varモデル.html#cb638-18" tabindex="-1"></a><span class="do">## Estimation results for equation y1: </span></span>
<span id="cb638-19"><a href="varモデル.html#cb638-19" tabindex="-1"></a><span class="do">## =================================== </span></span>
<span id="cb638-20"><a href="varモデル.html#cb638-20" tabindex="-1"></a><span class="do">## y1 = y1.l1 + y2.l1 + y1.l2 + y2.l2 + const </span></span>
<span id="cb638-21"><a href="varモデル.html#cb638-21" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb638-22"><a href="varモデル.html#cb638-22" tabindex="-1"></a><span class="do">##       Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb638-23"><a href="varモデル.html#cb638-23" tabindex="-1"></a><span class="do">## y1.l1 -0.09285    0.05751  -1.614   0.1075    </span></span>
<span id="cb638-24"><a href="varモデル.html#cb638-24" tabindex="-1"></a><span class="do">## y2.l1  0.09536    0.04624   2.062   0.0401 *  </span></span>
<span id="cb638-25"><a href="varモデル.html#cb638-25" tabindex="-1"></a><span class="do">## y1.l2  0.10498    0.05745   1.827   0.0687 .  </span></span>
<span id="cb638-26"><a href="varモデル.html#cb638-26" tabindex="-1"></a><span class="do">## y2.l2  0.40175    0.04645   8.648 3.49e-16 ***</span></span>
<span id="cb638-27"><a href="varモデル.html#cb638-27" tabindex="-1"></a><span class="do">## const  0.70107    0.29359   2.388   0.0176 *  </span></span>
<span id="cb638-28"><a href="varモデル.html#cb638-28" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb638-29"><a href="varモデル.html#cb638-29" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb638-30"><a href="varモデル.html#cb638-30" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb638-31"><a href="varモデル.html#cb638-31" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb638-32"><a href="varモデル.html#cb638-32" tabindex="-1"></a><span class="do">## Residual standard error: 2.139 on 293 degrees of freedom</span></span>
<span id="cb638-33"><a href="varモデル.html#cb638-33" tabindex="-1"></a><span class="do">## Multiple R-Squared: 0.3636,  Adjusted R-squared: 0.3549 </span></span>
<span id="cb638-34"><a href="varモデル.html#cb638-34" tabindex="-1"></a><span class="do">## F-statistic: 41.86 on 4 and 293 DF,  p-value: &lt; 2.2e-16 </span></span>
<span id="cb638-35"><a href="varモデル.html#cb638-35" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb638-36"><a href="varモデル.html#cb638-36" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb638-37"><a href="varモデル.html#cb638-37" tabindex="-1"></a><span class="do">## Estimation results for equation y2: </span></span>
<span id="cb638-38"><a href="varモデル.html#cb638-38" tabindex="-1"></a><span class="do">## =================================== </span></span>
<span id="cb638-39"><a href="varモデル.html#cb638-39" tabindex="-1"></a><span class="do">## y2 = y1.l1 + y2.l1 + y1.l2 + y2.l2 + const </span></span>
<span id="cb638-40"><a href="varモデル.html#cb638-40" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb638-41"><a href="varモデル.html#cb638-41" tabindex="-1"></a><span class="do">##       Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb638-42"><a href="varモデル.html#cb638-42" tabindex="-1"></a><span class="do">## y1.l1 -0.01967    0.02857  -0.688  0.49185    </span></span>
<span id="cb638-43"><a href="varモデル.html#cb638-43" tabindex="-1"></a><span class="do">## y2.l1 -0.02859    0.02297  -1.244  0.21435    </span></span>
<span id="cb638-44"><a href="varモデル.html#cb638-44" tabindex="-1"></a><span class="do">## y1.l2 -0.61604    0.02854 -21.583  &lt; 2e-16 ***</span></span>
<span id="cb638-45"><a href="varモデル.html#cb638-45" tabindex="-1"></a><span class="do">## y2.l2  1.11695    0.02308  48.395  &lt; 2e-16 ***</span></span>
<span id="cb638-46"><a href="varモデル.html#cb638-46" tabindex="-1"></a><span class="do">## const -0.43910    0.14587  -3.010  0.00284 ** </span></span>
<span id="cb638-47"><a href="varモデル.html#cb638-47" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb638-48"><a href="varモデル.html#cb638-48" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb638-49"><a href="varモデル.html#cb638-49" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb638-50"><a href="varモデル.html#cb638-50" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb638-51"><a href="varモデル.html#cb638-51" tabindex="-1"></a><span class="do">## Residual standard error: 1.063 on 293 degrees of freedom</span></span>
<span id="cb638-52"><a href="varモデル.html#cb638-52" tabindex="-1"></a><span class="do">## Multiple R-Squared: 0.9232,  Adjusted R-squared: 0.9222 </span></span>
<span id="cb638-53"><a href="varモデル.html#cb638-53" tabindex="-1"></a><span class="do">## F-statistic: 880.9 on 4 and 293 DF,  p-value: &lt; 2.2e-16 </span></span>
<span id="cb638-54"><a href="varモデル.html#cb638-54" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb638-55"><a href="varモデル.html#cb638-55" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb638-56"><a href="varモデル.html#cb638-56" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb638-57"><a href="varモデル.html#cb638-57" tabindex="-1"></a><span class="do">## Covariance matrix of residuals:</span></span>
<span id="cb638-58"><a href="varモデル.html#cb638-58" tabindex="-1"></a><span class="do">##        y1     y2</span></span>
<span id="cb638-59"><a href="varモデル.html#cb638-59" tabindex="-1"></a><span class="do">## y1 4.5758 0.8937</span></span>
<span id="cb638-60"><a href="varモデル.html#cb638-60" tabindex="-1"></a><span class="do">## y2 0.8937 1.1295</span></span>
<span id="cb638-61"><a href="varモデル.html#cb638-61" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb638-62"><a href="varモデル.html#cb638-62" tabindex="-1"></a><span class="do">## Correlation matrix of residuals:</span></span>
<span id="cb638-63"><a href="varモデル.html#cb638-63" tabindex="-1"></a><span class="do">##        y1     y2</span></span>
<span id="cb638-64"><a href="varモデル.html#cb638-64" tabindex="-1"></a><span class="do">## y1 1.0000 0.3931</span></span>
<span id="cb638-65"><a href="varモデル.html#cb638-65" tabindex="-1"></a><span class="do">## y2 0.3931 1.0000</span></span></code></pre></div>
</div>
<div id="varpモデル予測" class="section level3 unnumbered hasAnchor">
<h3>VAR(<span class="math inline">\(p\)</span>)モデル予測<a href="varモデル.html#varpモデル予測" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<pre><code>- 関数MTS::VARpred()
  - h: 予測期間の長さ
  - orig: 予測の起点 (デフォルト=0, 最終のデータ点)
  - Out.level: 出力の詳細のコントロール (T/F)</code></pre>
<div class="sourceCode" id="cb640"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb640-1"><a href="varモデル.html#cb640-1" tabindex="-1"></a>pred_VAR1 <span class="ot">&lt;-</span> <span class="fu">VARpred</span>(est_VAR1, <span class="at">h =</span> <span class="dv">20</span>, <span class="at">orig =</span> <span class="dv">0</span>, <span class="at">Out.level =</span> F, <span class="at">output =</span> T)</span>
<span id="cb640-2"><a href="varモデル.html#cb640-2" tabindex="-1"></a><span class="do">## orig  300 </span></span>
<span id="cb640-3"><a href="varモデル.html#cb640-3" tabindex="-1"></a><span class="do">## Forecasts at origin:  300 </span></span>
<span id="cb640-4"><a href="varモデル.html#cb640-4" tabindex="-1"></a><span class="do">##          [,1]   [,2]</span></span>
<span id="cb640-5"><a href="varモデル.html#cb640-5" tabindex="-1"></a><span class="do">##  [1,] -1.6935 -4.659</span></span>
<span id="cb640-6"><a href="varモデル.html#cb640-6" tabindex="-1"></a><span class="do">##  [2,] -1.5588 -2.224</span></span>
<span id="cb640-7"><a href="varモデル.html#cb640-7" tabindex="-1"></a><span class="do">##  [3,] -1.4159 -4.506</span></span>
<span id="cb640-8"><a href="varモデル.html#cb640-8" tabindex="-1"></a><span class="do">##  [4,] -0.6541 -1.806</span></span>
<span id="cb640-9"><a href="varモデル.html#cb640-9" tabindex="-1"></a><span class="do">##  [5,] -1.3692 -4.535</span></span>
<span id="cb640-10"><a href="varモデル.html#cb640-10" tabindex="-1"></a><span class="do">##  [6,] -0.3984 -1.896</span></span>
<span id="cb640-11"><a href="varモデル.html#cb640-11" tabindex="-1"></a><span class="do">##  [7,] -1.4084 -4.599</span></span>
<span id="cb640-12"><a href="varモデル.html#cb640-12" tabindex="-1"></a><span class="do">##  [8,] -0.4105 -2.153</span></span>
<span id="cb640-13"><a href="varモデル.html#cb640-13" tabindex="-1"></a><span class="do">##  [9,] -1.4616 -4.638</span></span>
<span id="cb640-14"><a href="varモデル.html#cb640-14" tabindex="-1"></a><span class="do">## [10,] -0.5135 -2.429</span></span>
<span id="cb640-15"><a href="varモデル.html#cb640-15" tabindex="-1"></a><span class="do">## [11,] -1.4999 -4.640</span></span>
<span id="cb640-16"><a href="varモデル.html#cb640-16" tabindex="-1"></a><span class="do">## [12,] -0.6321 -2.674</span></span>
<span id="cb640-17"><a href="varモデル.html#cb640-17" tabindex="-1"></a><span class="do">## [13,] -1.5169 -4.609</span></span>
<span id="cb640-18"><a href="varモデル.html#cb640-18" tabindex="-1"></a><span class="do">## [14,] -0.7383 -2.875</span></span>
<span id="cb640-19"><a href="varモデル.html#cb640-19" tabindex="-1"></a><span class="do">## [15,] -1.5155 -4.556</span></span>
<span id="cb640-20"><a href="varモデル.html#cb640-20" tabindex="-1"></a><span class="do">## [16,] -0.8252 -3.035</span></span>
<span id="cb640-21"><a href="varモデル.html#cb640-21" tabindex="-1"></a><span class="do">## [17,] -1.5012 -4.491</span></span>
<span id="cb640-22"><a href="varモデル.html#cb640-22" tabindex="-1"></a><span class="do">## [18,] -0.8939 -3.163</span></span>
<span id="cb640-23"><a href="varモデル.html#cb640-23" tabindex="-1"></a><span class="do">## [19,] -1.4795 -4.423</span></span>
<span id="cb640-24"><a href="varモデル.html#cb640-24" tabindex="-1"></a><span class="do">## [20,] -0.9480 -3.266</span></span>
<span id="cb640-25"><a href="varモデル.html#cb640-25" tabindex="-1"></a><span class="do">## Standard Errors of predictions:  </span></span>
<span id="cb640-26"><a href="varモデル.html#cb640-26" tabindex="-1"></a><span class="do">##        [,1]  [,2]</span></span>
<span id="cb640-27"><a href="varモデル.html#cb640-27" tabindex="-1"></a><span class="do">##  [1,] 2.121 1.054</span></span>
<span id="cb640-28"><a href="varモデル.html#cb640-28" tabindex="-1"></a><span class="do">##  [2,] 2.129 1.056</span></span>
<span id="cb640-29"><a href="varモデル.html#cb640-29" tabindex="-1"></a><span class="do">##  [3,] 2.199 1.729</span></span>
<span id="cb640-30"><a href="varモデル.html#cb640-30" tabindex="-1"></a><span class="do">##  [4,] 2.205 1.734</span></span>
<span id="cb640-31"><a href="varモデル.html#cb640-31" tabindex="-1"></a><span class="do">##  [5,] 2.269 2.315</span></span>
<span id="cb640-32"><a href="varモデル.html#cb640-32" tabindex="-1"></a><span class="do">##  [6,] 2.270 2.333</span></span>
<span id="cb640-33"><a href="varモデル.html#cb640-33" tabindex="-1"></a><span class="do">##  [7,] 2.357 2.728</span></span>
<span id="cb640-34"><a href="varモデル.html#cb640-34" tabindex="-1"></a><span class="do">##  [8,] 2.358 2.760</span></span>
<span id="cb640-35"><a href="varモデル.html#cb640-35" tabindex="-1"></a><span class="do">##  [9,] 2.432 3.010</span></span>
<span id="cb640-36"><a href="varモデル.html#cb640-36" tabindex="-1"></a><span class="do">## [10,] 2.435 3.050</span></span>
<span id="cb640-37"><a href="varモデル.html#cb640-37" tabindex="-1"></a><span class="do">## [11,] 2.488 3.207</span></span>
<span id="cb640-38"><a href="varモデル.html#cb640-38" tabindex="-1"></a><span class="do">## [12,] 2.493 3.249</span></span>
<span id="cb640-39"><a href="varモデル.html#cb640-39" tabindex="-1"></a><span class="do">## [13,] 2.528 3.349</span></span>
<span id="cb640-40"><a href="varモデル.html#cb640-40" tabindex="-1"></a><span class="do">## [14,] 2.535 3.388</span></span>
<span id="cb640-41"><a href="varモデル.html#cb640-41" tabindex="-1"></a><span class="do">## [15,] 2.557 3.453</span></span>
<span id="cb640-42"><a href="varモデル.html#cb640-42" tabindex="-1"></a><span class="do">## [16,] 2.564 3.486</span></span>
<span id="cb640-43"><a href="varモデル.html#cb640-43" tabindex="-1"></a><span class="do">## [17,] 2.579 3.530</span></span>
<span id="cb640-44"><a href="varモデル.html#cb640-44" tabindex="-1"></a><span class="do">## [18,] 2.586 3.557</span></span>
<span id="cb640-45"><a href="varモデル.html#cb640-45" tabindex="-1"></a><span class="do">## [19,] 2.596 3.588</span></span>
<span id="cb640-46"><a href="varモデル.html#cb640-46" tabindex="-1"></a><span class="do">## [20,] 2.602 3.609</span></span>
<span id="cb640-47"><a href="varモデル.html#cb640-47" tabindex="-1"></a><span class="do">## Root mean square errors of predictions:  </span></span>
<span id="cb640-48"><a href="varモデル.html#cb640-48" tabindex="-1"></a><span class="do">##        [,1]  [,2]</span></span>
<span id="cb640-49"><a href="varモデル.html#cb640-49" tabindex="-1"></a><span class="do">##  [1,] 2.139 1.063</span></span>
<span id="cb640-50"><a href="varモデル.html#cb640-50" tabindex="-1"></a><span class="do">##  [2,] 2.154 1.061</span></span>
<span id="cb640-51"><a href="varモデル.html#cb640-51" tabindex="-1"></a><span class="do">##  [3,] 2.408 2.994</span></span>
<span id="cb640-52"><a href="varモデル.html#cb640-52" tabindex="-1"></a><span class="do">##  [4,] 2.226 1.751</span></span>
<span id="cb640-53"><a href="varモデル.html#cb640-53" tabindex="-1"></a><span class="do">##  [5,] 2.460 3.586</span></span>
<span id="cb640-54"><a href="varモデル.html#cb640-54" tabindex="-1"></a><span class="do">##  [6,] 2.275 2.391</span></span>
<span id="cb640-55"><a href="varモデル.html#cb640-55" tabindex="-1"></a><span class="do">##  [7,] 2.616 3.717</span></span>
<span id="cb640-56"><a href="varモデル.html#cb640-56" tabindex="-1"></a><span class="do">##  [8,] 2.359 2.859</span></span>
<span id="cb640-57"><a href="varモデル.html#cb640-57" tabindex="-1"></a><span class="do">##  [9,] 2.656 3.698</span></span>
<span id="cb640-58"><a href="varモデル.html#cb640-58" tabindex="-1"></a><span class="do">## [10,] 2.444 3.174</span></span>
<span id="cb640-59"><a href="varモデル.html#cb640-59" tabindex="-1"></a><span class="do">## [11,] 2.649 3.664</span></span>
<span id="cb640-60"><a href="varモデル.html#cb640-60" tabindex="-1"></a><span class="do">## [12,] 2.510 3.378</span></span>
<span id="cb640-61"><a href="varモデル.html#cb640-61" tabindex="-1"></a><span class="do">## [13,] 2.636 3.650</span></span>
<span id="cb640-62"><a href="varモデル.html#cb640-62" tabindex="-1"></a><span class="do">## [14,] 2.557 3.508</span></span>
<span id="cb640-63"><a href="varモデル.html#cb640-63" tabindex="-1"></a><span class="do">## [15,] 2.628 3.653</span></span>
<span id="cb640-64"><a href="varモデル.html#cb640-64" tabindex="-1"></a><span class="do">## [16,] 2.587 3.591</span></span>
<span id="cb640-65"><a href="varモデル.html#cb640-65" tabindex="-1"></a><span class="do">## [17,] 2.626 3.667</span></span>
<span id="cb640-66"><a href="varモデル.html#cb640-66" tabindex="-1"></a><span class="do">## [18,] 2.607 3.643</span></span>
<span id="cb640-67"><a href="varモデル.html#cb640-67" tabindex="-1"></a><span class="do">## [19,] 2.627 3.683</span></span>
<span id="cb640-68"><a href="varモデル.html#cb640-68" tabindex="-1"></a><span class="do">## [20,] 2.620 3.678</span></span></code></pre></div>
<pre><code>- 関数predict() (`vars::VAR`の出力に対して適用)
  - n.ahead: 予測期間の長さ
  - ci: 予測信頼区間</code></pre>
<div class="sourceCode" id="cb642"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb642-1"><a href="varモデル.html#cb642-1" tabindex="-1"></a>pred_VAR2 <span class="ot">&lt;-</span> <span class="fu">predict</span>(est_VAR2, <span class="at">n.ahead =</span> <span class="dv">10</span>)</span>
<span id="cb642-2"><a href="varモデル.html#cb642-2" tabindex="-1"></a><span class="fu">plot</span>(pred_VAR2)</span></code></pre></div>
<p><img src="090-VAR_files/figure-html/VApred2_12-1.png" width="75%" /></p>
<div class="sourceCode" id="cb643"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb643-1"><a href="varモデル.html#cb643-1" tabindex="-1"></a>pred_VAR2<span class="sc">$</span>fcst</span>
<span id="cb643-2"><a href="varモデル.html#cb643-2" tabindex="-1"></a><span class="do">## $y1</span></span>
<span id="cb643-3"><a href="varモデル.html#cb643-3" tabindex="-1"></a><span class="do">##             fcst     lower    upper       CI</span></span>
<span id="cb643-4"><a href="varモデル.html#cb643-4" tabindex="-1"></a><span class="do">##  [1,] -1.6935489 -5.886138 2.499040 4.192589</span></span>
<span id="cb643-5"><a href="varモデル.html#cb643-5" tabindex="-1"></a><span class="do">##  [2,] -1.5588289 -5.766916 2.649258 4.208087</span></span>
<span id="cb643-6"><a href="varモデル.html#cb643-6" tabindex="-1"></a><span class="do">##  [3,] -1.4158594 -5.761805 2.930087 4.345946</span></span>
<span id="cb643-7"><a href="varモデル.html#cb643-7" tabindex="-1"></a><span class="do">##  [4,] -0.6541053 -5.012838 3.704628 4.358733</span></span>
<span id="cb643-8"><a href="varモデル.html#cb643-8" tabindex="-1"></a><span class="do">##  [5,] -1.3691744 -5.853357 3.115008 4.484182</span></span>
<span id="cb643-9"><a href="varモデル.html#cb643-9" tabindex="-1"></a><span class="do">##  [6,] -0.3983955 -4.885523 4.088732 4.487127</span></span>
<span id="cb643-10"><a href="varモデル.html#cb643-10" tabindex="-1"></a><span class="do">##  [7,] -1.4084408 -6.067917 3.251035 4.659476</span></span>
<span id="cb643-11"><a href="varモデル.html#cb643-11" tabindex="-1"></a><span class="do">##  [8,] -0.4104564 -5.070912 4.250000 4.660456</span></span>
<span id="cb643-12"><a href="varモデル.html#cb643-12" tabindex="-1"></a><span class="do">##  [9,] -1.4615648 -6.269351 3.346221 4.807786</span></span>
<span id="cb643-13"><a href="varモデル.html#cb643-13" tabindex="-1"></a><span class="do">## [10,] -0.5135316 -5.326625 4.299561 4.813093</span></span>
<span id="cb643-14"><a href="varモデル.html#cb643-14" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb643-15"><a href="varモデル.html#cb643-15" tabindex="-1"></a><span class="do">## $y2</span></span>
<span id="cb643-16"><a href="varモデル.html#cb643-16" tabindex="-1"></a><span class="do">##            fcst      lower       upper       CI</span></span>
<span id="cb643-17"><a href="varモデル.html#cb643-17" tabindex="-1"></a><span class="do">##  [1,] -4.659151  -6.742164 -2.57613758 2.083013</span></span>
<span id="cb643-18"><a href="varモデル.html#cb643-18" tabindex="-1"></a><span class="do">##  [2,] -2.223532  -4.309952 -0.13711248 2.086420</span></span>
<span id="cb643-19"><a href="varモデル.html#cb643-19" tabindex="-1"></a><span class="do">##  [3,] -4.505606  -7.922276 -1.08893531 3.416670</span></span>
<span id="cb643-20"><a href="varモデル.html#cb643-20" tabindex="-1"></a><span class="do">##  [4,] -1.805711  -5.233098  1.62167648 3.427387</span></span>
<span id="cb643-21"><a href="varモデル.html#cb643-21" tabindex="-1"></a><span class="do">##  [5,] -4.534908  -9.110020  0.04020335 4.575112</span></span>
<span id="cb643-22"><a href="varモデル.html#cb643-22" tabindex="-1"></a><span class="do">##  [6,] -1.896451  -6.507997  2.71509585 4.611547</span></span>
<span id="cb643-23"><a href="varモデル.html#cb643-23" tabindex="-1"></a><span class="do">##  [7,] -4.598833  -9.990735  0.79306982 5.391903</span></span>
<span id="cb643-24"><a href="varモデル.html#cb643-24" tabindex="-1"></a><span class="do">##  [8,] -2.152730  -7.607556  3.30209602 5.454826</span></span>
<span id="cb643-25"><a href="varモデル.html#cb643-25" tabindex="-1"></a><span class="do">##  [9,] -4.638479 -10.588832  1.31187382 5.950353</span></span>
<span id="cb643-26"><a href="varモデル.html#cb643-26" tabindex="-1"></a><span class="do">## [10,] -2.429372  -8.458542  3.59979824 6.029170</span></span></code></pre></div>
<!---
  - dumvar: 関数ca.jo()において引数dumvarが, または, 関数VAR()において引数exogenが使われた時に得られた'vec2var'や'varest'クラスのオブジェクトに対する行列
--->
<ul>
<li><strong>MTS</strong>パッケージは, 外生変数有りのVARXモデル, VMAモデル, さらには, 一般のVARMAモデルに対しても, 次数同定, モデル推定, 予測のための関数を用意.</li>
</ul>

</div>
</div>
<div id="var解析" class="section level2 hasAnchor" number="9.3">
<h2><span class="header-section-number">9.3</span> VAR解析<a href="varモデル.html#var解析" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>VARモデルによる変数間の動学的関係性の分析を行う方法論として,
グレンジャー因果性分析, インパルス応答分析,
分散分解の三つがある.</p>
<ul>
<li><strong>グレンジャー因果性分析</strong>: ある変数のラグ値が他の変数の予測に有用かを調べる</li>
</ul>
<!-- ラグ係数に対するF検定またはWald検定を実施 -->
<!-- 係数の結合有意性を検証 -->
<!--
- 変数間の予測関係について, 以下の可能性を考慮：
  - 双方向にグレンジャー因果性なし
  - 一方向のグレンジャー因果性
  - 双方向のグレンジャー因果性
-->
<ul>
<li><strong>インパルス応答関数（IRF)</strong>:
一変数の撹乱項に1単位のショックを与えた場合の他の変数への伝播の様子を調べる
<!-- 複数期間にわたって追跡 -->
<!-- 応答の信頼区間を生成 --></li>
</ul>
<!--
- 直交化IRFを実行する場合, 変数を外生性の高い順に並べる
 (結果は変数の並びに依存) -->
<!-- 信頼できるIRFのためのVARモデルの安定性確認
- IRFが時間とともにゼロに収束することを確認
- 自己相関がないことを確認
-->
<ul>
<li><strong>分散分解</strong>:
各変数の予測誤差分散を各ショックからの相対的寄与の大きさに分解する</li>
</ul>
<!-- 異なる予測期間での分析-->
<!-- 変数を外生性の高い順に並べる (結果は変数の並びに依存)-->
<!-- 最初の変数は自身の瞬時的な予測誤差の100%を説明
- 各予測期間において寄与度の合計は100%
-->
<p>これらの分析により, 以下について包括的な理解が得られる:
- 変数間の動的な関係
- ショックの伝播メカニズム
- システム内の互いに動的に影響を与える各変数の相対的な重要性</p>
<div id="varp-モデルの構築-復習" class="section level3 unnumbered hasAnchor">
<h3>VAR(<span class="math inline">\(p\)</span>) モデルの構築 (復習)<a href="varモデル.html#varp-モデルの構築-復習" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>VAR解析を行うには, 事前に分析対象の多変量時系列データに対して
前節までに解説してきたように, 適切な定常VARモデルを構築し推定することが重要である.</p>
<p><strong>モデル特定・推定</strong>
- 分析の目的や, 経済理論や専門知識等に基づいてモデリングに使用する変数 (内生変数) を選択
- 変数の定常性を確認. 必要に応じて, 差分を取る, 分解する等データ加工
- 情報量基準等を用いて適切なラグ次数を決定
- モデルを推定
<!-- 安定性条件と変数の定常性を確認 -->
<!-- 仮定が満たされている場合、OLSを用いてVARモデルを推定 --></p>
<p><strong>モデル診断</strong>
- 残差の自己相関検定
- 不均一分散 (ARCH効果) の確認
- 残差の正規性検定, 等
<!-- モデルの安定性確認 -->
- 必要に応じて, モデルの特定・推定をやり直す</p>
<p>以下では, 引き続き, <strong>MTS</strong>パッケージ, <strong>vars</strong>パッケージを利用する</p>
<ul>
<li><a href="https://www.rdocumentation.org/packages/MTS/versions/1.0" class="uri">https://www.rdocumentation.org/packages/MTS/versions/1.0</a></li>
<li><a href="https://www.rdocumentation.org/packages/vars/versions/1.5-3" class="uri">https://www.rdocumentation.org/packages/vars/versions/1.5-3</a></li>
</ul>
<!-- ### VAR($p$)モデルの推定 (復習) {-} -->
<p>以下では, シミュレーションデータを使用する</p>
<ul>
<li><strong>MTS</strong>パッケージの関数<code>VARsim()</code>でパスを生成</li>
<li><strong>var</strong>パッケージの関数<code>VARselect()</code>,<code>VAR()</code>を使って, 次数同定およびモデル推定</li>
</ul>
<p><span class="math display">\[Y_{1,t}=1.0 + 0.6 Y_{1,t-1} + 0.1 Y_{2,t-1} + \epsilon_{1,t}\]</span>
<span class="math display">\[Y_{2,t}=-1.0 +0.5 Y_{1,t-1} + 0.7 Y_{2,t-1} + \epsilon_{2,t}\]</span>
<span class="math display">\[ \left[
    \begin{array}{r}
      \epsilon_{1,t} \\ \epsilon_{2,t}
    \end{array}
  \right] \sim_{\it i.i.d.} N \Big(\left[
    \begin{array}{r}
      0 \\ 0
    \end{array}
  \right], \left[
    \begin{array}{rr}
      4 &amp; 1 \\ 1 &amp; 1
    \end{array}
  \right]\Big) \]</span></p>
<div class="sourceCode" id="cb644"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb644-1"><a href="varモデル.html#cb644-1" tabindex="-1"></a><span class="fu">library</span>(MTS)</span>
<span id="cb644-2"><a href="varモデル.html#cb644-2" tabindex="-1"></a>nlen <span class="ot">&lt;-</span> <span class="dv">300</span></span>
<span id="cb644-3"><a href="varモデル.html#cb644-3" tabindex="-1"></a>seed_val <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb644-4"><a href="varモデル.html#cb644-4" tabindex="-1"></a><span class="fu">set.seed</span>(seed_val)</span>
<span id="cb644-5"><a href="varモデル.html#cb644-5" tabindex="-1"></a>p0 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>)          <span class="co"># Phi0 (定数項)</span></span>
<span id="cb644-6"><a href="varモデル.html#cb644-6" tabindex="-1"></a>p_mat <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fl">0.6</span>, <span class="fl">0.5</span>, <span class="fl">0.1</span>, <span class="fl">0.7</span>), <span class="dv">2</span>, <span class="dv">2</span>)    <span class="co"># Phi1 (ラグ1のVAR係数行列)</span></span>
<span id="cb644-7"><a href="varモデル.html#cb644-7" tabindex="-1"></a>sig_mat <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>), <span class="dv">2</span>, <span class="dv">2</span>)      <span class="co"># イノベーションの分散共分散行列 (正値定符号)</span></span>
<span id="cb644-8"><a href="varモデル.html#cb644-8" tabindex="-1"></a>p_mat; sig_mat</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]  0.6  0.1
## [2,]  0.5  0.7</code></pre>
<pre><code>##      [,1] [,2]
## [1,]    4    1
## [2,]    1    1</code></pre>
<div class="sourceCode" id="cb647"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb647-1"><a href="varモデル.html#cb647-1" tabindex="-1"></a>ysim <span class="ot">&lt;-</span> <span class="fu">VARMAsim</span>(nlen, <span class="at">arlags =</span> <span class="dv">1</span>, <span class="at">cnst =</span> p0, <span class="at">phi =</span> p_mat, <span class="at">sigma =</span> sig_mat)</span>
<span id="cb647-2"><a href="varモデル.html#cb647-2" tabindex="-1"></a>Yt <span class="ot">&lt;-</span> ysim<span class="sc">$</span>series</span>
<span id="cb647-3"><a href="varモデル.html#cb647-3" tabindex="-1"></a><span class="fu">acf</span>(Yt)　　　<span class="co"># クロス相関</span></span></code></pre></div>
<p><img src="092-VAR2_files/figure-html/VARsim_13-1.png" width="672" /></p>
<div class="sourceCode" id="cb648"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb648-1"><a href="varモデル.html#cb648-1" tabindex="-1"></a><span class="fu">MTSplot</span>(Yt)　<span class="co"># 時系列プロット</span></span></code></pre></div>
<p><img src="092-VAR2_files/figure-html/VARsim_13-2.png" width="672" /></p>
<div id="varpモデルの次数同定-1" class="section level4 unnumbered hasAnchor">
<h4>VAR(<span class="math inline">\(p\)</span>)モデルの次数同定<a href="varモデル.html#varpモデルの次数同定-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li>関数<code>vars::VARselect()</code></li>
</ul>
<div class="sourceCode" id="cb649"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb649-1"><a href="varモデル.html#cb649-1" tabindex="-1"></a><span class="fu">library</span>(vars)</span></code></pre></div>
<pre><code>## Loading required package: MASS</code></pre>
<pre><code>## Loading required package: strucchange</code></pre>
<pre><code>## Loading required package: zoo</code></pre>
<pre><code>## 
## Attaching package: &#39;zoo&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     as.Date, as.Date.numeric</code></pre>
<pre><code>## Loading required package: sandwich</code></pre>
<pre><code>## Loading required package: urca</code></pre>
<pre><code>## Loading required package: lmtest</code></pre>
<pre><code>## 
## Attaching package: &#39;vars&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:MTS&#39;:
## 
##     VAR</code></pre>
<div class="sourceCode" id="cb660"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb660-1"><a href="varモデル.html#cb660-1" tabindex="-1"></a>Yt <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Y1 =</span> Yt[,<span class="dv">1</span>], <span class="at">Y2 =</span> Yt[,<span class="dv">2</span>])</span>
<span id="cb660-2"><a href="varモデル.html#cb660-2" tabindex="-1"></a><span class="fu">VARselect</span>(Yt, <span class="at">lag.max =</span> <span class="dv">5</span>,  <span class="at">type =</span> <span class="st">&quot;const&quot;</span>)</span></code></pre></div>
<pre><code>## $selection
## AIC(n)  HQ(n)  SC(n) FPE(n) 
##      1      1      1      1 
## 
## $criteria
##               1        2        3        4        5
## AIC(n) 1.417189 1.432965 1.454790 1.471126 1.460469
## HQ(n)  1.447216 1.483011 1.524855 1.561208 1.570570
## SC(n)  1.492178 1.557947 1.629765 1.696094 1.735430
## FPE(n) 4.125512 4.191134 4.283662 4.354299 4.308277</code></pre>
</div>
<div id="varpモデルの推定-1" class="section level4 unnumbered hasAnchor">
<h4>VAR(<span class="math inline">\(p\)</span>)モデルの推定<a href="varモデル.html#varpモデルの推定-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li>関数<code>vars::VAR()</code></li>
</ul>
<div class="sourceCode" id="cb662"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb662-1"><a href="varモデル.html#cb662-1" tabindex="-1"></a>est_VAR1 <span class="ot">&lt;-</span> vars<span class="sc">::</span><span class="fu">VAR</span>(Yt, <span class="at">p =</span> <span class="dv">1</span>, <span class="at">type =</span> <span class="st">&quot;const&quot;</span>)</span>
<span id="cb662-2"><a href="varモデル.html#cb662-2" tabindex="-1"></a><span class="fu">summary</span>(est_VAR1)</span></code></pre></div>
<pre><code>## 
## VAR Estimation Results:
## ========================= 
## Endogenous variables: Y1, Y2 
## Deterministic variables: const 
## Sample size: 299 
## Log Likelihood: -1051.693 
## Roots of the characteristic polynomial:
## 0.8123 0.3886
## Call:
## vars::VAR(y = Yt, p = 1, type = &quot;const&quot;)
## 
## 
## Estimation results for equation Y1: 
## =================================== 
## Y1 = Y1.l1 + Y2.l1 + const 
## 
##       Estimate Std. Error t value Pr(&gt;|t|)    
## Y1.l1  0.50728    0.06004   8.449 1.35e-15 ***
## Y2.l1  0.07759    0.04514   1.719   0.0866 .  
## const  1.08864    0.17861   6.095 3.40e-09 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## 
## Residual standard error: 2.133 on 296 degrees of freedom
## Multiple R-Squared: 0.3322,  Adjusted R-squared: 0.3277 
## F-statistic: 73.64 on 2 and 296 DF,  p-value: &lt; 2.2e-16 
## 
## 
## Estimation results for equation Y2: 
## =================================== 
## Y2 = Y1.l1 + Y2.l1 + const 
## 
##       Estimate Std. Error t value Pr(&gt;|t|)    
## Y1.l1  0.46669    0.03001   15.55   &lt;2e-16 ***
## Y2.l1  0.69357    0.02256   30.74   &lt;2e-16 ***
## const -0.97716    0.08928  -10.95   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## 
## Residual standard error: 1.066 on 296 degrees of freedom
## Multiple R-Squared: 0.9054,  Adjusted R-squared: 0.9048 
## F-statistic:  1417 on 2 and 296 DF,  p-value: &lt; 2.2e-16 
## 
## 
## 
## Covariance matrix of residuals:
##       Y1    Y2
## Y1 4.551 1.096
## Y2 1.096 1.137
## 
## Correlation matrix of residuals:
##       Y1    Y2
## Y1 1.000 0.482
## Y2 0.482 1.000</code></pre>
<p>次に, 上で推定されたVAR(1)モデルを使用して, VARモデルによる変数間の動学的関係性の分析を行う.</p>
</div>
</div>
<div id="グレンジャーの因果性検定" class="section level3 unnumbered hasAnchor">
<h3>グレンジャーの因果性検定<a href="varモデル.html#グレンジャーの因果性検定" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<pre><code>- 関数vars::causality()
  - x: 関数VAR()により生成された&#39;varest&#39;クラスのオブジェクト
  - cause: cause変数 (デフォルトは入力x$yの第1列の変数) 
  - vcov.: 推定係数の共分散行列の指定
  - boot: 棄却点を計算する際にwildブートストラップを使用するか否か(T/F)   
  - boot.runs: boot=TRUEの場合のブートストラップの反復数</code></pre>
<div class="sourceCode" id="cb665"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb665-1"><a href="varモデル.html#cb665-1" tabindex="-1"></a>vars<span class="sc">::</span><span class="fu">causality</span>(est_VAR1, <span class="at">cause =</span> <span class="st">&quot;Y1&quot;</span>) </span></code></pre></div>
<pre><code>## $Granger
## 
##  Granger causality H0: Y1 do not Granger-cause Y2
## 
## data:  VAR object est_VAR1
## F-Test = 241.8, df1 = 1, df2 = 592, p-value &lt; 2.2e-16
## 
## 
## $Instant
## 
##  H0: No instantaneous causality between: Y1 and Y2
## 
## data:  VAR object est_VAR1
## Chi-squared = 56.374, df = 1, p-value = 5.995e-14</code></pre>
<div class="sourceCode" id="cb667"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb667-1"><a href="varモデル.html#cb667-1" tabindex="-1"></a><span class="co"># VAR(1)の推定結果var1を用い, Y1に関するGranger因果性検定</span></span>
<span id="cb667-2"><a href="varモデル.html#cb667-2" tabindex="-1"></a>vars<span class="sc">::</span><span class="fu">causality</span>(est_VAR1, <span class="at">cause =</span> <span class="st">&quot;Y2&quot;</span>) </span></code></pre></div>
<pre><code>## $Granger
## 
##  Granger causality H0: Y2 do not Granger-cause Y1
## 
## data:  VAR object est_VAR1
## F-Test = 2.9555, df1 = 1, df2 = 592, p-value = 0.08611
## 
## 
## $Instant
## 
##  H0: No instantaneous causality between: Y2 and Y1
## 
## data:  VAR object est_VAR1
## Chi-squared = 56.374, df = 1, p-value = 5.995e-14</code></pre>
<div class="sourceCode" id="cb669"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb669-1"><a href="varモデル.html#cb669-1" tabindex="-1"></a><span class="co"># 同, Y2に関するGranger因果性検定</span></span></code></pre></div>
</div>
<div id="インパルス応答" class="section level3 unnumbered hasAnchor">
<h3>インパルス応答<a href="varモデル.html#インパルス応答" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="直交インパルス応答" class="section level4 unnumbered hasAnchor">
<h4>直交インパルス応答<a href="varモデル.html#直交インパルス応答" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<pre><code>- 関数vars::irf()
  - x: 関数VAR()により生成された&#39;varest&#39;クラスのオブジェクト等
  - impulse: インパルス変数 (デフォルト=全変数)    
  - response: 応答変数 (デフォルト=全変数)
  - n.ahead: 将来区間の長さ
  - ortho: 直交インパルス応答か (デフォルト=T) 
  - cumulative: 累積インパルス応答か (デフォルト=F)
  - boot: インパルス応答係数のブートストラップ誤差バンド計算の有無 (T/F)    
  - ci: bootstrap誤差バンドの信頼区間
  - runs: bootstrap回数</code></pre>
<div class="sourceCode" id="cb671"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb671-1"><a href="varモデル.html#cb671-1" tabindex="-1"></a><span class="co"># vars::irf()関数 (ortho = T (デフォルト))</span></span>
<span id="cb671-2"><a href="varモデル.html#cb671-2" tabindex="-1"></a>ip1 <span class="ot">&lt;-</span> vars<span class="sc">::</span><span class="fu">irf</span>(est_VAR1, <span class="at">impulse =</span> <span class="fu">c</span>(<span class="st">&quot;Y1&quot;</span>), <span class="at">response =</span> <span class="fu">c</span>(<span class="st">&quot;Y1&quot;</span>, <span class="st">&quot;Y2&quot;</span>),</span>
<span id="cb671-3"><a href="varモデル.html#cb671-3" tabindex="-1"></a>                 <span class="at">n.ahead =</span> <span class="dv">5</span>, <span class="at">boot =</span> T)</span>
<span id="cb671-4"><a href="varモデル.html#cb671-4" tabindex="-1"></a>ip2 <span class="ot">&lt;-</span> vars<span class="sc">::</span><span class="fu">irf</span>(est_VAR1, <span class="at">impulse =</span> <span class="fu">c</span>(<span class="st">&quot;Y2&quot;</span>), <span class="at">response =</span> <span class="fu">c</span>(<span class="st">&quot;Y1&quot;</span>, <span class="st">&quot;Y2&quot;</span>),</span>
<span id="cb671-5"><a href="varモデル.html#cb671-5" tabindex="-1"></a>                 <span class="at">n.ahead =</span> <span class="dv">5</span>, <span class="at">boot =</span> T)</span>
<span id="cb671-6"><a href="varモデル.html#cb671-6" tabindex="-1"></a><span class="fu">plot</span>(ip1)</span></code></pre></div>
<p><img src="092-VAR2_files/figure-html/VARirf1-1.png" width="672" /></p>
<div class="sourceCode" id="cb672"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb672-1"><a href="varモデル.html#cb672-1" tabindex="-1"></a><span class="fu">plot</span>(ip2)</span></code></pre></div>
<p><img src="092-VAR2_files/figure-html/VARirf1-2.png" width="672" /></p>
<div class="sourceCode" id="cb673"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb673-1"><a href="varモデル.html#cb673-1" tabindex="-1"></a><span class="co"># 破線は信頼区間</span></span>
<span id="cb673-2"><a href="varモデル.html#cb673-2" tabindex="-1"></a><span class="co"># ip1; ip2</span></span></code></pre></div>
</div>
<div id="非直交インパルス応答" class="section level4 unnumbered hasAnchor">
<h4>非直交インパルス応答<a href="varモデル.html#非直交インパルス応答" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb674"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb674-1"><a href="varモデル.html#cb674-1" tabindex="-1"></a><span class="co"># vars::irf()関数 (ortho = F)</span></span>
<span id="cb674-2"><a href="varモデル.html#cb674-2" tabindex="-1"></a>ip1 <span class="ot">&lt;-</span> vars<span class="sc">::</span><span class="fu">irf</span>(est_VAR1, <span class="at">impulse =</span> <span class="fu">c</span>(<span class="st">&quot;Y1&quot;</span>), <span class="at">response =</span> <span class="fu">c</span>(<span class="st">&quot;Y1&quot;</span>, <span class="st">&quot;Y2&quot;</span>), </span>
<span id="cb674-3"><a href="varモデル.html#cb674-3" tabindex="-1"></a>                 <span class="at">ortho =</span> F, <span class="at">n.ahead =</span> <span class="dv">5</span>, <span class="at">boot =</span> T)</span>
<span id="cb674-4"><a href="varモデル.html#cb674-4" tabindex="-1"></a>ip2 <span class="ot">&lt;-</span> vars<span class="sc">::</span><span class="fu">irf</span>(est_VAR1, <span class="at">impulse =</span> <span class="fu">c</span>(<span class="st">&quot;Y2&quot;</span>), <span class="at">response =</span> <span class="fu">c</span>(<span class="st">&quot;Y1&quot;</span>, <span class="st">&quot;Y2&quot;</span>), </span>
<span id="cb674-5"><a href="varモデル.html#cb674-5" tabindex="-1"></a>                 <span class="at">ortho =</span> F, <span class="at">n.ahead =</span> <span class="dv">5</span>, <span class="at">boot =</span> T)</span>
<span id="cb674-6"><a href="varモデル.html#cb674-6" tabindex="-1"></a><span class="fu">plot</span>(ip1)</span></code></pre></div>
<p><img src="092-VAR2_files/figure-html/VARirf2-1.png" width="672" /></p>
<div class="sourceCode" id="cb675"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb675-1"><a href="varモデル.html#cb675-1" tabindex="-1"></a><span class="fu">plot</span>(ip2)</span></code></pre></div>
<p><img src="092-VAR2_files/figure-html/VARirf2-2.png" width="672" /></p>
<div class="sourceCode" id="cb676"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb676-1"><a href="varモデル.html#cb676-1" tabindex="-1"></a><span class="co"># ip1; ip2</span></span></code></pre></div>
<ul>
<li>累積インパルス応答</li>
</ul>
<div class="sourceCode" id="cb677"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb677-1"><a href="varモデル.html#cb677-1" tabindex="-1"></a>ip1_cum <span class="ot">&lt;-</span> vars<span class="sc">::</span><span class="fu">irf</span>(est_VAR1, <span class="at">impulse =</span> <span class="fu">c</span>(<span class="st">&quot;Y1&quot;</span>), <span class="at">response =</span> <span class="fu">c</span>(<span class="st">&quot;Y1&quot;</span>,<span class="st">&quot;Y2&quot;</span>), </span>
<span id="cb677-2"><a href="varモデル.html#cb677-2" tabindex="-1"></a>                     <span class="at">n.ahead =</span> <span class="dv">5</span>, <span class="at">boot =</span> <span class="cn">TRUE</span>, <span class="at">cumulative=</span>T)</span>
<span id="cb677-3"><a href="varモデル.html#cb677-3" tabindex="-1"></a>ip2_cum <span class="ot">&lt;-</span> vars<span class="sc">::</span><span class="fu">irf</span>(est_VAR1, <span class="at">impulse =</span> <span class="fu">c</span>(<span class="st">&quot;Y2&quot;</span>), <span class="at">response =</span> <span class="fu">c</span>(<span class="st">&quot;Y2&quot;</span>,<span class="st">&quot;Y1&quot;</span>), </span>
<span id="cb677-4"><a href="varモデル.html#cb677-4" tabindex="-1"></a>                     <span class="at">n.ahead =</span> <span class="dv">5</span>, <span class="at">boot =</span> <span class="cn">TRUE</span>, <span class="at">cumulative=</span>T)</span>
<span id="cb677-5"><a href="varモデル.html#cb677-5" tabindex="-1"></a><span class="fu">plot</span>(ip1_cum)</span></code></pre></div>
<p><img src="092-VAR2_files/figure-html/VARirf3-1.png" width="672" /></p>
<div class="sourceCode" id="cb678"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb678-1"><a href="varモデル.html#cb678-1" tabindex="-1"></a><span class="fu">plot</span>(ip2_cum)</span></code></pre></div>
<p><img src="092-VAR2_files/figure-html/VARirf3-2.png" width="672" /></p>
</div>
</div>
<div id="予測誤差分散分解-forecast-error-variance-decomposition" class="section level3 unnumbered hasAnchor">
<h3>予測誤差分散分解 (forecast error variance decomposition)<a href="varモデル.html#予測誤差分散分解-forecast-error-variance-decomposition" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<pre><code>- 関数vars::fevd()
  - x: 関数VAR()により生成された&#39;varest&#39;クラスのオブジェクト等
  - n.ahead: 予測区間の長さ</code></pre>
<ul>
<li>直交化インパルス応答関数を使い, 第<span class="math inline">\(j(=1,2)\)</span>変数の第<span class="math inline">\(k(=1,2)\)</span>変数の<span class="math inline">\(h(=1,\ldots,10)\)</span>先予測誤差分散への寄与を評価</li>
</ul>
<div class="sourceCode" id="cb680"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb680-1"><a href="varモデル.html#cb680-1" tabindex="-1"></a>res_fevd <span class="ot">&lt;-</span> vars<span class="sc">::</span><span class="fu">fevd</span>(est_VAR1, <span class="at">n.ahead =</span> <span class="dv">10</span>)  <span class="co"># 10期先まで評価する</span></span>
<span id="cb680-2"><a href="varモデル.html#cb680-2" tabindex="-1"></a><span class="fu">plot</span>(res_fevd)</span></code></pre></div>
<p><img src="092-VAR2_files/figure-html/VARfevd-1.png" width="672" /></p>

</div>
</div>
<div id="var解析-データ分析例" class="section level2 hasAnchor" number="9.4">
<h2><span class="header-section-number">9.4</span> VAR解析 (データ分析例)<a href="varモデル.html#var解析-データ分析例" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>VARモデルによる変数間の動学的関係性の分析</p>
<div id="事例1-ソフトバンク9434-vs-ソフトバンクグループ9984" class="section level3 unnumbered hasAnchor">
<h3>事例1: ソフトバンク(9434) vs ソフトバンクグループ(9984)<a href="varモデル.html#事例1-ソフトバンク9434-vs-ソフトバンクグループ9984" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>ソフトバンク(9434): 上場日 2018年12月19日</li>
<li>親会社ソフトバンクG (9984)
<ul>
<li>保有比率(%): 66.49 (2019.03), 67.13 (2020.03), 40.86 (2021.03), 40.68 (2022.03), 40.47 (2023.03)</li>
<li>cf. <a href="https://www.buffett-code.com/company/9434/mainshareholder" class="uri">https://www.buffett-code.com/company/9434/mainshareholder</a></li>
</ul></li>
<li>データをYahoo!ファイナンスより入手</li>
</ul>
<div class="sourceCode" id="cb681"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb681-1"><a href="varモデル.html#cb681-1" tabindex="-1"></a><span class="fu">library</span>(quantmod)</span></code></pre></div>
<pre><code>## Loading required package: xts</code></pre>
<pre><code>## Loading required package: zoo</code></pre>
<pre><code>## 
## Attaching package: &#39;zoo&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     as.Date, as.Date.numeric</code></pre>
<pre><code>## Loading required package: TTR</code></pre>
<pre><code>## Registered S3 method overwritten by &#39;quantmod&#39;:
##   method            from
##   as.zoo.data.frame zoo</code></pre>
<div class="sourceCode" id="cb688"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb688-1"><a href="varモデル.html#cb688-1" tabindex="-1"></a>s9984 <span class="ot">&lt;-</span> <span class="fu">getSymbols</span>(<span class="st">&#39;9984.T&#39;</span>, <span class="at">from =</span> <span class="st">&#39;2018-12-19&#39;</span>, <span class="at">auto.assign =</span> <span class="cn">FALSE</span>)</span>
<span id="cb688-2"><a href="varモデル.html#cb688-2" tabindex="-1"></a>s9434 <span class="ot">&lt;-</span> <span class="fu">getSymbols</span>(<span class="st">&#39;9434.T&#39;</span>, <span class="at">from =</span> <span class="st">&#39;2018-12-19&#39;</span>, <span class="at">auto.assign =</span> <span class="cn">FALSE</span>)</span>
<span id="cb688-3"><a href="varモデル.html#cb688-3" tabindex="-1"></a></span>
<span id="cb688-4"><a href="varモデル.html#cb688-4" tabindex="-1"></a>s9984ret <span class="ot">&lt;-</span> <span class="fu">diff</span>(<span class="fu">log</span>(s9984<span class="sc">$</span><span class="st">`</span><span class="at">9984.T.Adjusted</span><span class="st">`</span>))[<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb688-5"><a href="varモデル.html#cb688-5" tabindex="-1"></a>s9434ret <span class="ot">&lt;-</span> <span class="fu">diff</span>(<span class="fu">log</span>(s9434<span class="sc">$</span><span class="st">`</span><span class="at">9434.T.Adjusted</span><span class="st">`</span>))[<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb688-6"><a href="varモデル.html#cb688-6" tabindex="-1"></a>sb <span class="ot">&lt;-</span> <span class="fu">merge.xts</span>(s9984ret, s9434ret, <span class="at">join =</span> <span class="st">&quot;inner&quot;</span>)</span>
<span id="cb688-7"><a href="varモデル.html#cb688-7" tabindex="-1"></a><span class="fu">colnames</span>(sb) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;s9984&quot;</span>, <span class="st">&quot;s9434&quot;</span>)</span></code></pre></div>
<ul>
<li>各変数の単位根検定</li>
</ul>
<div class="sourceCode" id="cb689"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb689-1"><a href="varモデル.html#cb689-1" tabindex="-1"></a><span class="fu">library</span>(fUnitRoots)</span>
<span id="cb689-2"><a href="varモデル.html#cb689-2" tabindex="-1"></a><span class="co"># unitrootTest(s9984, type = &quot;c&quot;, lags = 1) # type: &quot;nc&quot;, &quot;c&quot;, &quot;ct&quot;</span></span>
<span id="cb689-3"><a href="varモデル.html#cb689-3" tabindex="-1"></a><span class="fu">unitrootTest</span>(s9984ret, <span class="at">type =</span> <span class="st">&quot;c&quot;</span>, <span class="at">lags =</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>## 
## Title:
##  Augmented Dickey-Fuller Test
## 
## Test Results:
##   PARAMETER:
##     Lag Order: 1
##   STATISTIC:
##     DF: -26.4993
##   P VALUE:
##     t: &lt; 2.2e-16 
##     n: 0.00225 
## 
## Description:
##  Sun Feb  2 15:37:03 2025 by user:</code></pre>
<div class="sourceCode" id="cb691"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb691-1"><a href="varモデル.html#cb691-1" tabindex="-1"></a><span class="fu">unitrootTest</span>(s9434ret, <span class="at">type =</span> <span class="st">&quot;c&quot;</span>, <span class="at">lags =</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>## 
## Title:
##  Augmented Dickey-Fuller Test
## 
## Test Results:
##   PARAMETER:
##     Lag Order: 1
##   STATISTIC:
##     DF: -28.6553
##   P VALUE:
##     t: &lt; 2.2e-16 
##     n: 0.00131 
## 
## Description:
##  Sun Feb  2 15:37:03 2025 by user:</code></pre>
<ul>
<li><p>–&gt; 帰無仮説(<span class="math inline">\(\phi_1 = 1\)</span>)を棄却 (単位根なし)</p></li>
<li><p>標本自己共分散行列</p></li>
</ul>
<div class="sourceCode" id="cb693"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb693-1"><a href="varモデル.html#cb693-1" tabindex="-1"></a><span class="fu">acf</span>(sb)</span></code></pre></div>
<p><img src="093-VAR3_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<div id="varモデルの推定" class="section level4 unnumbered hasAnchor">
<h4>VARモデルの推定<a href="varモデル.html#varモデルの推定" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li>以下, パッケージ<strong>vars</strong>を利用</li>
<li>VAR(p)モデルの次数の決定</li>
</ul>
<div class="sourceCode" id="cb694"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb694-1"><a href="varモデル.html#cb694-1" tabindex="-1"></a><span class="fu">library</span>(vars)</span></code></pre></div>
<pre><code>## Loading required package: MASS</code></pre>
<pre><code>## Loading required package: strucchange</code></pre>
<pre><code>## Loading required package: sandwich</code></pre>
<pre><code>## Loading required package: urca</code></pre>
<pre><code>## 
## Attaching package: &#39;urca&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:fUnitRoots&#39;:
## 
##     punitroot, qunitroot, unitrootTable</code></pre>
<pre><code>## Loading required package: lmtest</code></pre>
<div class="sourceCode" id="cb702"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb702-1"><a href="varモデル.html#cb702-1" tabindex="-1"></a>vars<span class="sc">::</span><span class="fu">VARselect</span>(sb, <span class="at">lag.max =</span> <span class="dv">5</span>,  <span class="at">type =</span> <span class="st">&quot;const&quot;</span>)   <span class="co"># &quot;const&quot;(定数項有), trend:(&quot;トレンド有&quot;), &quot;both&quot;, &quot;none&quot;</span></span></code></pre></div>
<pre><code>## $selection
## AIC(n)  HQ(n)  SC(n) FPE(n) 
##      3      1      1      3 
## 
## $criteria
##                    1             2             3             4             5
## AIC(n) -1.633298e+01 -1.633264e+01 -1.633312e+01 -1.633069e+01 -1.632768e+01
## HQ(n)  -1.632499e+01 -1.631933e+01 -1.631449e+01 -1.630673e+01 -1.629840e+01
## SC(n)  -1.631155e+01 -1.629693e+01 -1.628313e+01 -1.626641e+01 -1.624912e+01
## FPE(n)  8.066348e-08  8.069076e-08  8.065185e-08  8.084818e-08  8.109184e-08</code></pre>
<ul>
<li><p>–&gt; AIC, FPEでは3, HQ, SCでは1が最適</p></li>
<li><p>VAR(1)モデルの推定 (OLS推定)</p></li>
</ul>
<div class="sourceCode" id="cb704"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb704-1"><a href="varモデル.html#cb704-1" tabindex="-1"></a>var1 <span class="ot">&lt;-</span> vars<span class="sc">::</span><span class="fu">VAR</span>(sb, <span class="at">p =</span> <span class="dv">1</span>, <span class="at">type =</span> <span class="st">&quot;const&quot;</span>)</span>
<span id="cb704-2"><a href="varモデル.html#cb704-2" tabindex="-1"></a><span class="fu">summary</span>(var1)</span></code></pre></div>
<pre><code>## 
## VAR Estimation Results:
## ========================= 
## Endogenous variables: s9984, s9434 
## Deterministic variables: const 
## Sample size: 1489 
## Log Likelihood: 7931.129 
## Roots of the characteristic polynomial:
## 0.02715 0.006565
## Call:
## vars::VAR(y = sb, p = 1, type = &quot;const&quot;)
## 
## 
## Estimation results for equation s9984: 
## ====================================== 
## s9984 = s9984.l1 + s9434.l1 + const 
## 
##            Estimate Std. Error t value Pr(&gt;|t|)    
## s9984.l1  0.0536245  0.0265394   2.021 0.043504 *  
## s9434.l1 -0.2348141  0.0709433  -3.310 0.000956 ***
## const     0.0006875  0.0007246   0.949 0.342908    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## 
## Residual standard error: 0.02794 on 1486 degrees of freedom
## Multiple R-Squared: 0.00841, Adjusted R-squared: 0.007076 
## F-statistic: 6.302 on 2 and 1486 DF,  p-value: 0.001883 
## 
## 
## Estimation results for equation s9434: 
## ====================================== 
## s9434 = s9984.l1 + s9434.l1 + const 
## 
##            Estimate Std. Error t value Pr(&gt;|t|)
## s9984.l1  0.0067873  0.0099711   0.681    0.496
## s9434.l1 -0.0330441  0.0266540  -1.240    0.215
## const     0.0004181  0.0002722   1.536    0.125
## 
## 
## Residual standard error: 0.0105 on 1486 degrees of freedom
## Multiple R-Squared: 0.001142,    Adjusted R-squared: -0.0002023 
## F-statistic: 0.8495 on 2 and 1486 DF,  p-value: 0.4278 
## 
## 
## 
## Covariance matrix of residuals:
##           s9984     s9434
## s9984 7.805e-04 6.824e-05
## s9434 6.824e-05 1.102e-04
## 
## Correlation matrix of residuals:
##        s9984  s9434
## s9984 1.0000 0.2327
## s9434 0.2327 1.0000</code></pre>
<ul>
<li>–&gt; 2式とも, 9984_{t-1}の係数, 有意でない. 一方, 9434_{t-1} → 9984_tの係数, 有意</li>
</ul>
</div>
<div id="インパルス応答-1" class="section level4 unnumbered hasAnchor">
<h4>インパルス応答<a href="varモデル.html#インパルス応答-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li><strong>直交化インパルス応答</strong></li>
</ul>
<div class="sourceCode" id="cb706"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb706-1"><a href="varモデル.html#cb706-1" tabindex="-1"></a><span class="co"># s9434 --&gt; 将来のs9434, s9984の変動を調べる</span></span>
<span id="cb706-2"><a href="varモデル.html#cb706-2" tabindex="-1"></a>ip <span class="ot">&lt;-</span> vars<span class="sc">::</span><span class="fu">irf</span>(var1, <span class="at">impulse =</span> <span class="fu">c</span>(<span class="st">&quot;s9434&quot;</span>), <span class="at">response =</span> <span class="fu">c</span>(<span class="st">&quot;s9434&quot;</span>, <span class="st">&quot;s9984&quot;</span>),</span>
<span id="cb706-3"><a href="varモデル.html#cb706-3" tabindex="-1"></a>                <span class="at">n.ahead =</span> <span class="dv">5</span>, <span class="at">boot =</span> <span class="cn">TRUE</span>)</span>
<span id="cb706-4"><a href="varモデル.html#cb706-4" tabindex="-1"></a><span class="co"># ip &lt;- vars::irf(var1, impulse = c(&quot;s9984&quot;), response = c(&quot;s9984&quot;, &quot;s9434&quot;),</span></span>
<span id="cb706-5"><a href="varモデル.html#cb706-5" tabindex="-1"></a><span class="co">#                n.ahead = 5, boot = TRUE)</span></span>
<span id="cb706-6"><a href="varモデル.html#cb706-6" tabindex="-1"></a><span class="co"># ortho = T (デフォルト): 直交化インパルス応答; ortho = F: 非直交化インパルス応答</span></span>
<span id="cb706-7"><a href="varモデル.html#cb706-7" tabindex="-1"></a><span class="co"># boot = T: ブートストラップ法により, 信頼区間計算</span></span>
<span id="cb706-8"><a href="varモデル.html#cb706-8" tabindex="-1"></a><span class="co"># cumulative = T: 累積インパルス応答. デフォルトはF.</span></span>
<span id="cb706-9"><a href="varモデル.html#cb706-9" tabindex="-1"></a><span class="fu">plot</span>(ip)</span></code></pre></div>
<p><img src="093-VAR3_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<div class="sourceCode" id="cb707"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb707-1"><a href="varモデル.html#cb707-1" tabindex="-1"></a><span class="co"># 破線は信頼区間</span></span>
<span id="cb707-2"><a href="varモデル.html#cb707-2" tabindex="-1"></a>ip</span></code></pre></div>
<pre><code>## 
## Impulse response coefficients
## $s9434
##              s9984         s9434
## [1,]  0.000000e+00  1.020824e-02
## [2,] -2.397039e-03 -3.373225e-04
## [3,] -4.933194e-05 -5.122915e-06
## [4,] -1.442469e-06 -1.655489e-07
## [5,] -3.847845e-08 -4.320061e-09
## [6,] -1.048977e-09 -1.184125e-10
## 
## 
## Lower Band, CI= 0.95 
## $s9434
##              s9984         s9434
## [1,]  0.000000e+00  9.493183e-03
## [2,] -3.582770e-03 -9.457099e-04
## [3,] -3.065790e-04 -4.916439e-05
## [4,] -3.267405e-05 -1.079402e-05
## [5,] -3.744469e-06 -1.572134e-07
## [6,] -4.437798e-07 -7.913895e-08
## 
## 
## Upper Band, CI= 0.95 
## $s9434
##              s9984        s9434
## [1,]  0.000000e+00 1.102003e-02
## [2,] -1.251266e-03 2.370375e-04
## [3,]  1.789836e-04 8.678255e-05
## [4,]  5.133117e-06 1.961858e-06
## [5,]  1.937481e-06 8.368933e-07
## [6,]  3.886047e-08 4.649871e-08</code></pre>
<div class="sourceCode" id="cb709"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb709-1"><a href="varモデル.html#cb709-1" tabindex="-1"></a>ip_2 <span class="ot">&lt;-</span> vars<span class="sc">::</span><span class="fu">irf</span>(var1, <span class="at">impulse =</span> <span class="fu">c</span>(<span class="st">&quot;s9984&quot;</span>), <span class="at">response =</span> <span class="fu">c</span>(<span class="st">&quot;s9984&quot;</span>, <span class="st">&quot;s9434&quot;</span>),</span>
<span id="cb709-2"><a href="varモデル.html#cb709-2" tabindex="-1"></a>                <span class="at">n.ahead =</span> <span class="dv">5</span>, <span class="at">boot =</span> <span class="cn">TRUE</span>)</span>
<span id="cb709-3"><a href="varモデル.html#cb709-3" tabindex="-1"></a><span class="fu">plot</span>(ip_2)</span></code></pre></div>
<p><img src="093-VAR3_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<div class="sourceCode" id="cb710"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb710-1"><a href="varモデル.html#cb710-1" tabindex="-1"></a>ip_2</span></code></pre></div>
<pre><code>## 
## Impulse response coefficients
## $s9984
##             s9984        s9434
## [1,] 2.793763e-02 2.442718e-03
## [2,] 9.245571e-04 1.089039e-04
## [3,] 2.400676e-05 2.676622e-06
## [4,] 6.588420e-07 7.449465e-08
## [5,] 1.783768e-08 2.010154e-09
## [6,] 4.845245e-10 5.464610e-11
## 
## 
## Lower Band, CI= 0.95 
## $s9984
##              s9984         s9434
## [1,]  2.571446e-02  1.690034e-03
## [2,] -4.160368e-04 -3.768580e-04
## [3,] -1.044847e-04 -1.905597e-05
## [4,] -5.268220e-06 -3.539625e-06
## [5,] -5.060434e-07 -1.725492e-07
## [6,] -2.630376e-08 -2.392929e-08
## 
## 
## Upper Band, CI= 0.95 
## $s9984
##             s9984        s9434
## [1,] 2.976239e-02 3.289291e-03
## [2,] 2.267830e-03 5.811297e-04
## [3,] 2.476625e-04 3.752598e-05
## [4,] 2.183536e-05 1.265666e-06
## [5,] 2.624359e-06 1.337788e-07
## [6,] 2.536941e-07 1.075852e-08</code></pre>
<ul>
<li><strong>非直交化インパルス応答</strong></li>
</ul>
<div class="sourceCode" id="cb712"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb712-1"><a href="varモデル.html#cb712-1" tabindex="-1"></a>ip_3 <span class="ot">&lt;-</span> vars<span class="sc">::</span><span class="fu">irf</span>(var1, <span class="at">impulse =</span> <span class="fu">c</span>(<span class="st">&quot;s9434&quot;</span>), <span class="at">response =</span> <span class="fu">c</span>(<span class="st">&quot;s9434&quot;</span>, <span class="st">&quot;s9984&quot;</span>),</span>
<span id="cb712-2"><a href="varモデル.html#cb712-2" tabindex="-1"></a>                  <span class="at">ortho =</span> F, <span class="at">n.ahead =</span> <span class="dv">5</span>, <span class="at">boot =</span> <span class="cn">TRUE</span>)</span>
<span id="cb712-3"><a href="varモデル.html#cb712-3" tabindex="-1"></a><span class="fu">plot</span>(ip_3)</span></code></pre></div>
<p><img src="093-VAR3_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<div class="sourceCode" id="cb713"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb713-1"><a href="varモデル.html#cb713-1" tabindex="-1"></a>ip_3</span></code></pre></div>
<pre><code>## 
## Impulse response coefficients
## $s9434
##              s9984         s9434
## [1,]  0.000000e+00  1.000000e+00
## [2,] -2.348141e-01 -3.304414e-02
## [3,] -4.832561e-03 -5.018412e-04
## [4,] -1.413043e-04 -1.621719e-05
## [5,] -3.769352e-06 -4.231935e-07
## [6,] -1.027578e-07 -1.159970e-08
## 
## 
## Lower Band, CI= 0.95 
## $s9434
##              s9984         s9434
## [1,]  0.0000000000  1.000000e+00
## [2,] -0.3693210967 -8.068528e-02
## [3,] -0.0231772919 -5.970923e-03
## [4,] -0.0025977950 -5.512115e-04
## [5,] -0.0002252708 -6.639547e-06
## [6,] -0.0000273763 -3.885097e-06
## 
## 
## Upper Band, CI= 0.95 
## $s9434
##              s9984        s9434
## [1,]  0.000000e+00 1.000000e+00
## [2,] -1.328334e-01 1.678846e-02
## [3,]  1.801831e-02 6.571675e-03
## [4,]  1.081558e-03 2.044872e-04
## [5,]  1.554910e-04 5.002845e-05
## [6,]  1.980854e-06 2.672168e-06</code></pre>
<ul>
<li><strong>累積インパルス応答</strong></li>
</ul>
<div class="sourceCode" id="cb715"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb715-1"><a href="varモデル.html#cb715-1" tabindex="-1"></a>ip_cum <span class="ot">&lt;-</span> vars<span class="sc">::</span><span class="fu">irf</span>(var1, <span class="at">impulse =</span> <span class="fu">c</span>(<span class="st">&quot;s9434&quot;</span>), <span class="at">response =</span> <span class="fu">c</span>(<span class="st">&quot;s9434&quot;</span>, <span class="st">&quot;s9984&quot;</span>),</span>
<span id="cb715-2"><a href="varモデル.html#cb715-2" tabindex="-1"></a>                    <span class="at">n.ahead =</span> <span class="dv">5</span>, <span class="at">boot =</span> <span class="cn">TRUE</span>, <span class="at">cumulative =</span> T)</span>
<span id="cb715-3"><a href="varモデル.html#cb715-3" tabindex="-1"></a><span class="fu">plot</span>(ip_cum)</span></code></pre></div>
<p><img src="093-VAR3_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
</div>
<div id="grangerの因果性検定" class="section level4 unnumbered hasAnchor">
<h4>Grangerの因果性検定<a href="varモデル.html#grangerの因果性検定" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb716"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb716-1"><a href="varモデル.html#cb716-1" tabindex="-1"></a>vars<span class="sc">::</span><span class="fu">causality</span>(var1, <span class="at">cause =</span> <span class="st">&quot;s9434&quot;</span>)  <span class="co"># VAR(1)の推定結果var1を用い, 9434をcauseとするGranger因果性検定</span></span></code></pre></div>
<pre><code>## $Granger
## 
##  Granger causality H0: s9434 do not Granger-cause s9984
## 
## data:  VAR object var1
## F-Test = 10.955, df1 = 1, df2 = 2972, p-value = 0.0009445
## 
## 
## $Instant
## 
##  H0: No instantaneous causality between: s9434 and s9984
## 
## data:  VAR object var1
## Chi-squared = 76.498, df = 1, p-value &lt; 2.2e-16</code></pre>
<ul>
<li>–&gt; 帰無仮説(因果性なし)棄却　→　9434をcauseとするGranger因果性の存在を示唆</li>
</ul>
<div class="sourceCode" id="cb718"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb718-1"><a href="varモデル.html#cb718-1" tabindex="-1"></a>vars<span class="sc">::</span><span class="fu">causality</span>(var1, <span class="at">cause =</span> <span class="st">&quot;s9984&quot;</span>)</span></code></pre></div>
<pre><code>## $Granger
## 
##  Granger causality H0: s9984 do not Granger-cause s9434
## 
## data:  VAR object var1
## F-Test = 0.46335, df1 = 1, df2 = 2972, p-value = 0.4961
## 
## 
## $Instant
## 
##  H0: No instantaneous causality between: s9984 and s9434
## 
## data:  VAR object var1
## Chi-squared = 76.498, df = 1, p-value &lt; 2.2e-16</code></pre>
<ul>
<li>–&gt; 帰無仮説(因果性なし)棄却できず　→　9984をcauseとするGranger因果性存在せず</li>
<li>一方、Grangerの瞬時因果性, 9984, 9434, いずれの方向も棄却できず → 存在を示唆</li>
</ul>
</div>
</div>
<div id="事例2-米英日3株式市場-sp500-ftse-日経平均" class="section level3 unnumbered hasAnchor">
<h3>事例2: 米英日3株式市場 (S&amp;P500, FTSE, 日経平均)<a href="varモデル.html#事例2-米英日3株式市場-sp500-ftse-日経平均" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>データを<strong>quantmod</strong>パッケージを使って, Yahoo!ファイナンスより入手
<!-- toを指定しないと, 三市場データの長さが異なる可能性がある.
ow, 日付を月末に揃えるなどすれば, mergeが使えるはずだが... --></li>
</ul>
<div class="sourceCode" id="cb720"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb720-1"><a href="varモデル.html#cb720-1" tabindex="-1"></a>gspc <span class="ot">&lt;-</span> <span class="fu">getSymbols</span>(<span class="st">&#39;^GSPC&#39;</span>, <span class="at">periodicity =</span> <span class="st">&quot;monthly&quot;</span>, <span class="at">from =</span> <span class="st">&#39;1999-12-01&#39;</span>, <span class="at">to =</span> <span class="st">&#39;2024-11-30&#39;</span>, <span class="at">auto.assign =</span> <span class="cn">FALSE</span>)</span>
<span id="cb720-2"><a href="varモデル.html#cb720-2" tabindex="-1"></a>ftse <span class="ot">&lt;-</span> <span class="fu">getSymbols</span>(<span class="st">&#39;^FTSE&#39;</span>, <span class="at">periodicity =</span> <span class="st">&quot;monthly&quot;</span>, <span class="at">from =</span> <span class="st">&#39;1999-12-01&#39;</span>, <span class="at">to =</span> <span class="st">&#39;2024-11-30&#39;</span>, <span class="at">auto.assign =</span> <span class="cn">FALSE</span>)</span>
<span id="cb720-3"><a href="varモデル.html#cb720-3" tabindex="-1"></a>n225 <span class="ot">&lt;-</span> <span class="fu">getSymbols</span>(<span class="st">&#39;^N225&#39;</span>, <span class="at">periodicity =</span> <span class="st">&quot;monthly&quot;</span>, <span class="at">from =</span> <span class="st">&#39;1999-12-01&#39;</span>, <span class="at">to =</span> <span class="st">&#39;2024-11-30&#39;</span>, <span class="at">auto.assign =</span> <span class="cn">FALSE</span>)</span>
<span id="cb720-4"><a href="varモデル.html#cb720-4" tabindex="-1"></a><span class="co"># gspc: 1999-12-01-- (月末株価なのに, 1日表示)</span></span>
<span id="cb720-5"><a href="varモデル.html#cb720-5" tabindex="-1"></a><span class="co"># ftse: 1999-12-01-- (同)</span></span>
<span id="cb720-6"><a href="varモデル.html#cb720-6" tabindex="-1"></a><span class="co"># n225: 1999-12-31-- (月末表示)</span></span>
<span id="cb720-7"><a href="varモデル.html#cb720-7" tabindex="-1"></a><span class="co"># → n225に合わせる</span></span>
<span id="cb720-8"><a href="varモデル.html#cb720-8" tabindex="-1"></a></span>
<span id="cb720-9"><a href="varモデル.html#cb720-9" tabindex="-1"></a><span class="co"># 月次終値 (調整済) より対数収益率を計算</span></span>
<span id="cb720-10"><a href="varモデル.html#cb720-10" tabindex="-1"></a>us <span class="ot">&lt;-</span> <span class="fu">diff</span>(<span class="fu">log</span>(gspc<span class="sc">$</span>GSPC.Adjusted))[<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb720-11"><a href="varモデル.html#cb720-11" tabindex="-1"></a>uk <span class="ot">&lt;-</span> <span class="fu">diff</span>(<span class="fu">log</span>(ftse<span class="sc">$</span>FTSE.Adjusted))[<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb720-12"><a href="varモデル.html#cb720-12" tabindex="-1"></a>jp <span class="ot">&lt;-</span> <span class="fu">diff</span>(<span class="fu">log</span>(n225<span class="sc">$</span>N225.Adjusted))[<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb720-13"><a href="varモデル.html#cb720-13" tabindex="-1"></a></span>
<span id="cb720-14"><a href="varモデル.html#cb720-14" tabindex="-1"></a><span class="co"># 3市場データの結合</span></span>
<span id="cb720-15"><a href="varモデル.html#cb720-15" tabindex="-1"></a>mkt <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">coredata</span>(us), <span class="fu">coredata</span>(uk), <span class="fu">coredata</span>(jp))</span>
<span id="cb720-16"><a href="varモデル.html#cb720-16" tabindex="-1"></a><span class="fu">colnames</span>(mkt) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;us&quot;</span>, <span class="st">&quot;uk&quot;</span>, <span class="st">&quot;jp&quot;</span>)</span>
<span id="cb720-17"><a href="varモデル.html#cb720-17" tabindex="-1"></a>mkt <span class="ot">&lt;-</span> <span class="fu">xts</span>(mkt, <span class="fu">index</span>(jp))</span>
<span id="cb720-18"><a href="varモデル.html#cb720-18" tabindex="-1"></a>mkt <span class="ot">&lt;-</span> mkt[<span class="sc">-</span><span class="fu">nrow</span>(mkt), ] <span class="co"># 最終行は月中時点 (未完)</span></span>
<span id="cb720-19"><a href="varモデル.html#cb720-19" tabindex="-1"></a></span>
<span id="cb720-20"><a href="varモデル.html#cb720-20" tabindex="-1"></a><span class="co"># 結果の表示</span></span>
<span id="cb720-21"><a href="varモデル.html#cb720-21" tabindex="-1"></a><span class="fu">head</span>(mkt)</span></code></pre></div>
<pre><code>##                     us           uk          jp
## 1999-12-31 -0.05224485 -0.100351609  0.03147106
## 2000-01-31 -0.02031300 -0.005743495  0.02125795
## 2000-02-29  0.09232375  0.048174179  0.01875144
## 2000-03-31 -0.03127991 -0.033078382 -0.12354810
## 2000-04-30 -0.02215875  0.005044624 -0.09575560
## 2000-05-31  0.02365163 -0.007370510  0.06395117</code></pre>
<div class="sourceCode" id="cb722"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb722-1"><a href="varモデル.html#cb722-1" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">cumsum</span>(mkt), <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;lightblue&quot;</span>, <span class="st">&quot;orange&quot;</span>),</span>
<span id="cb722-2"><a href="varモデル.html#cb722-2" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;S&amp;P500 (black), FTSE (lightblue), NK225 (orange)&quot;</span>)</span></code></pre></div>
<p><img src="093-VAR3_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<div id="varモデルの推定-1" class="section level4 unnumbered hasAnchor">
<h4>VARモデルの推定<a href="varモデル.html#varモデルの推定-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li>以下, 引き続きパッケージ<strong>vars</strong>を利用</li>
<li>3変量VAR(2)モデルを仮定した場合の推定</li>
</ul>
<div class="sourceCode" id="cb723"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb723-1"><a href="varモデル.html#cb723-1" tabindex="-1"></a>usukjp <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(mkt<span class="sc">$</span>us, mkt<span class="sc">$</span>uk, mkt<span class="sc">$</span>jp)</span>
<span id="cb723-2"><a href="varモデル.html#cb723-2" tabindex="-1"></a><span class="fu">head</span>(usukjp, <span class="dv">5</span>)</span></code></pre></div>
<pre><code>##                     us           uk          jp
## 1999-12-31 -0.05224485 -0.100351609  0.03147106
## 2000-01-31 -0.02031300 -0.005743495  0.02125795
## 2000-02-29  0.09232375  0.048174179  0.01875144
## 2000-03-31 -0.03127991 -0.033078382 -0.12354810
## 2000-04-30 -0.02215875  0.005044624 -0.09575560</code></pre>
<div class="sourceCode" id="cb725"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb725-1"><a href="varモデル.html#cb725-1" tabindex="-1"></a>var2usukjp <span class="ot">&lt;-</span> vars<span class="sc">::</span><span class="fu">VAR</span>(usukjp, <span class="at">p =</span> <span class="dv">2</span>, <span class="at">type =</span> <span class="st">&quot;const&quot;</span>)</span>
<span id="cb725-2"><a href="varモデル.html#cb725-2" tabindex="-1"></a><span class="co"># summary(var2usukjp)</span></span>
<span id="cb725-3"><a href="varモデル.html#cb725-3" tabindex="-1"></a></span>
<span id="cb725-4"><a href="varモデル.html#cb725-4" tabindex="-1"></a><span class="co"># 係数推定値 (値のみ）</span></span>
<span id="cb725-5"><a href="varモデル.html#cb725-5" tabindex="-1"></a><span class="fu">coef</span>(var2usukjp)</span></code></pre></div>
<pre><code>## $us
##           Estimate  Std. Error     t value   Pr(&gt;|t|)
## us.l1 -0.100789381 0.104185184 -0.96740609 0.33414994
## uk.l1  0.045868853 0.110362568  0.41561966 0.67799677
## jp.l1  0.114750906 0.063975226  1.79367723 0.07391004
## us.l2 -0.133893130 0.104714293 -1.27865190 0.20204551
## uk.l2  0.008473531 0.109109720  0.07766065 0.93815174
## jp.l2  0.055752503 0.063474022  0.87835150 0.38048265
## const  0.005481561 0.002653987  2.06540610 0.03977602
## 
## $uk
##           Estimate  Std. Error    t value  Pr(&gt;|t|)
## us.l1  0.077801084 0.090443271  0.8602197 0.3903810
## uk.l1 -0.143021810 0.095805864 -1.4928294 0.1365727
## jp.l1  0.081557621 0.055536963  1.4685286 0.1430483
## us.l2 -0.144458741 0.090902591 -1.5891598 0.1131177
## uk.l2  0.059647469 0.094718266  0.6297357 0.5293651
## jp.l2  0.010718471 0.055101867  0.1945210 0.8459046
## const  0.001059086 0.002303929  0.4596871 0.6460865
## 
## $jp
##           Estimate  Std. Error    t value  Pr(&gt;|t|)
## us.l1 -0.019909207 0.127544318 -0.1560964 0.8760660
## uk.l1  0.100071793 0.135106719  0.7406870 0.4594846
## jp.l1  0.078471208 0.078318972  1.0019438 0.3172089
## us.l2 -0.183655004 0.128192057 -1.4326551 0.1530372
## uk.l2  0.076219074 0.133572973  0.5706175 0.5687024
## jp.l2  0.075815442 0.077705394  0.9756780 0.3300400
## const  0.002701346 0.003249032  0.8314311 0.4064165</code></pre>
<div class="sourceCode" id="cb727"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb727-1"><a href="varモデル.html#cb727-1" tabindex="-1"></a><span class="co"># 係数推定値の行列表示 (t値や標準誤差は非表示)</span></span>
<span id="cb727-2"><a href="varモデル.html#cb727-2" tabindex="-1"></a>vars<span class="sc">::</span><span class="fu">Acoef</span>(var2usukjp)     <span class="co"># as a list of matrices</span></span></code></pre></div>
<pre><code>## [[1]]
##          us.l1       uk.l1      jp.l1
## us -0.10078938  0.04586885 0.11475091
## uk  0.07780108 -0.14302181 0.08155762
## jp -0.01990921  0.10007179 0.07847121
## 
## [[2]]
##         us.l2       uk.l2      jp.l2
## us -0.1338931 0.008473531 0.05575250
## uk -0.1444587 0.059647469 0.01071847
## jp -0.1836550 0.076219074 0.07581544</code></pre>
<div class="sourceCode" id="cb729"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb729-1"><a href="varモデル.html#cb729-1" tabindex="-1"></a>vars<span class="sc">::</span><span class="fu">Bcoef</span>(var2usukjp)     <span class="co"># as a matrix</span></span></code></pre></div>
<pre><code>##          us.l1       uk.l1      jp.l1      us.l2       uk.l2      jp.l2
## us -0.10078938  0.04586885 0.11475091 -0.1338931 0.008473531 0.05575250
## uk  0.07780108 -0.14302181 0.08155762 -0.1444587 0.059647469 0.01071847
## jp -0.01990921  0.10007179 0.07847121 -0.1836550 0.076219074 0.07581544
##          const
## us 0.005481561
## uk 0.001059086
## jp 0.002701346</code></pre>
<ul>
<li>次数<span class="math inline">\(p\)</span>を選択する場合</li>
<li>関数<code>VAR()</code>によって, 情報量規準により最適な次数を選択
<ul>
<li>最大次数<code>lag.max</code>と採用する情報量規準<code>ic</code>を指定</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb731"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb731-1"><a href="varモデル.html#cb731-1" tabindex="-1"></a>varusukjp <span class="ot">&lt;-</span> vars<span class="sc">::</span><span class="fu">VAR</span>(usukjp, <span class="at">type =</span> <span class="st">&quot;const&quot;</span>, <span class="at">lag.max =</span> <span class="dv">5</span>, <span class="at">ic =</span> <span class="st">&quot;AIC&quot;</span>)</span>
<span id="cb731-2"><a href="varモデル.html#cb731-2" tabindex="-1"></a><span class="fu">summary</span>(varusukjp)</span></code></pre></div>
<pre><code>## 
## VAR Estimation Results:
## ========================= 
## Endogenous variables: us, uk, jp 
## Deterministic variables: const 
## Sample size: 297 
## Log Likelihood: 1727.17 
## Roots of the characteristic polynomial:
## 0.1921 0.1145 0.08493
## Call:
## vars::VAR(y = usukjp, type = &quot;const&quot;, lag.max = 5, ic = &quot;AIC&quot;)
## 
## 
## Estimation results for equation us: 
## =================================== 
## us = us.l1 + uk.l1 + jp.l1 + const 
## 
##        Estimate Std. Error t value Pr(&gt;|t|)  
## us.l1 -0.085850   0.102719  -0.836   0.4040  
## uk.l1  0.047703   0.106645   0.447   0.6550  
## jp.l1  0.101421   0.063066   1.608   0.1089  
## const  0.004874   0.002611   1.867   0.0629 .
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## 
## Residual standard error: 0.0445 on 293 degrees of freedom
## Multiple R-Squared: 0.01079, Adjusted R-squared: 0.0006629 
## F-statistic: 1.065 on 3 and 293 DF,  p-value: 0.364 
## 
## 
## Estimation results for equation uk: 
## =================================== 
## uk = us.l1 + uk.l1 + jp.l1 + const 
## 
##         Estimate Std. Error t value Pr(&gt;|t|)  
## us.l1  0.0960686  0.0893126   1.076   0.2830  
## uk.l1 -0.1543287  0.0927260  -1.664   0.0971 .
## jp.l1  0.0699508  0.0548350   1.276   0.2031  
## const  0.0003514  0.0022701   0.155   0.8771  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## 
## Residual standard error: 0.03869 on 293 degrees of freedom
## Multiple R-Squared: 0.01622, Adjusted R-squared: 0.006143 
## F-statistic:  1.61 on 3 and 293 DF,  p-value: 0.1872 
## 
## 
## Estimation results for equation jp: 
## =================================== 
## jp = us.l1 + uk.l1 + jp.l1 + const 
## 
##       Estimate Std. Error t value Pr(&gt;|t|)
## us.l1 0.006425   0.125600   0.051    0.959
## uk.l1 0.068097   0.130400   0.522    0.602
## jp.l1 0.077618   0.077114   1.007    0.315
## const 0.002083   0.003192   0.653    0.515
## 
## 
## Residual standard error: 0.05441 on 293 degrees of freedom
## Multiple R-Squared: 0.01366, Adjusted R-squared: 0.003559 
## F-statistic: 1.352 on 3 and 293 DF,  p-value: 0.2576 
## 
## 
## 
## Covariance matrix of residuals:
##          us       uk       jp
## us 0.001980 0.001358 0.001589
## uk 0.001358 0.001497 0.001206
## jp 0.001589 0.001206 0.002960
## 
## Correlation matrix of residuals:
##        us     uk     jp
## us 1.0000 0.7890 0.6564
## uk 0.7890 1.0000 0.5729
## jp 0.6564 0.5729 1.0000</code></pre>
<div class="sourceCode" id="cb733"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb733-1"><a href="varモデル.html#cb733-1" tabindex="-1"></a><span class="co"># ic = AIC, HQ, SC, FPE</span></span>
<span id="cb733-2"><a href="varモデル.html#cb733-2" tabindex="-1"></a><span class="co"># HQ: Hannan-Quinn 情報量規準,  FPE: forecast prediction error 規準</span></span></code></pre></div>
<ul>
<li><p>–&gt; <span class="math inline">\(p=1\)</span>を選択</p></li>
<li><p>推定されたVARモデルによる予測</p></li>
</ul>
<div class="sourceCode" id="cb734"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb734-1"><a href="varモデル.html#cb734-1" tabindex="-1"></a><span class="fu">predict</span>(var2usukjp, <span class="at">n.ahead =</span> <span class="dv">10</span>, <span class="at">ci =</span> <span class="fl">0.95</span>)    <span class="co"># 95%区間予測を 10期先まで</span></span></code></pre></div>
<pre><code>## $us
##              fcst       lower      upper         CI
##  [1,] 0.005354386 -0.08196850 0.09267728 0.08732289
##  [2,] 0.007556693 -0.08033117 0.09544455 0.08788786
##  [3,] 0.004571038 -0.08365687 0.09279894 0.08822791
##  [4,] 0.004610780 -0.08361901 0.09284057 0.08822979
##  [5,] 0.004786821 -0.08344433 0.09301797 0.08823115
##  [6,] 0.004797814 -0.08343334 0.09302897 0.08823116
##  [7,] 0.004783284 -0.08344788 0.09301445 0.08823117
##  [8,] 0.004784083 -0.08344709 0.09301525 0.08823117
##  [9,] 0.004785395 -0.08344577 0.09301656 0.08823117
## [10,] 0.004785293 -0.08344588 0.09301646 0.08823117
## 
## $uk
##               fcst       lower      upper         CI
##  [1,] 0.0008720553 -0.07493304 0.07667715 0.07580510
##  [2,] 0.0019663688 -0.07445110 0.07838383 0.07641747
##  [3,] 0.0010561816 -0.07590648 0.07801884 0.07696266
##  [4,] 0.0005145362 -0.07645512 0.07748419 0.07696966
##  [5,] 0.0009359646 -0.07603696 0.07790889 0.07697293
##  [6,] 0.0008651470 -0.07610795 0.07783825 0.07697310
##  [7,] 0.0008779161 -0.07609521 0.07785104 0.07697312
##  [8,] 0.0008696381 -0.07610349 0.07784276 0.07697313
##  [9,] 0.0008733833 -0.07609974 0.07784651 0.07697313
## [10,] 0.0008725149 -0.07610061 0.07784564 0.07697313
## 
## $jp
##               fcst      lower     upper        CI
##  [1,] -0.002681770 -0.1095831 0.1042196 0.1069014
##  [2,]  0.005402640 -0.1022622 0.1130675 0.1076648
##  [3,]  0.002051416 -0.1060374 0.1101403 0.1080888
##  [4,]  0.002048665 -0.1060410 0.1101384 0.1080897
##  [5,]  0.002218337 -0.1058723 0.1103090 0.1080907
##  [6,]  0.002221528 -0.1058692 0.1103122 0.1080907
##  [7,]  0.002227127 -0.1058636 0.1103178 0.1080907
##  [8,]  0.002221959 -0.1058688 0.1103127 0.1080907
##  [9,]  0.002224775 -0.1058659 0.1103155 0.1080907
## [10,]  0.002224175 -0.1058665 0.1103149 0.1080907</code></pre>
</div>
<div id="granger因果性の検定" class="section level4 unnumbered hasAnchor">
<h4>Granger因果性の検定<a href="varモデル.html#granger因果性の検定" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li>日本 (jp) を<code>cause</code>とする因果性</li>
</ul>
<div class="sourceCode" id="cb736"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb736-1"><a href="varモデル.html#cb736-1" tabindex="-1"></a>var3usukjp <span class="ot">&lt;-</span> vars<span class="sc">::</span><span class="fu">VAR</span>(usukjp, <span class="at">p =</span> <span class="dv">3</span>, <span class="at">type =</span> <span class="st">&quot;const&quot;</span>)</span>
<span id="cb736-2"><a href="varモデル.html#cb736-2" tabindex="-1"></a><span class="fu">head</span>(var3usukjp<span class="sc">$</span>y)      <span class="co">#</span></span></code></pre></div>
<pre><code>##                     us           uk          jp
## 1999-12-31 -0.05224485 -0.100351609  0.03147106
## 2000-01-31 -0.02031300 -0.005743495  0.02125795
## 2000-02-29  0.09232375  0.048174179  0.01875144
## 2000-03-31 -0.03127991 -0.033078382 -0.12354810
## 2000-04-30 -0.02215875  0.005044624 -0.09575560
## 2000-05-31  0.02365163 -0.007370510  0.06395117</code></pre>
<div class="sourceCode" id="cb738"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb738-1"><a href="varモデル.html#cb738-1" tabindex="-1"></a>vars<span class="sc">::</span><span class="fu">causality</span>(var3usukjp, <span class="at">cause =</span> <span class="st">&quot;jp&quot;</span>) <span class="co"># jp --&gt; us, uk</span></span></code></pre></div>
<pre><code>## $Granger
## 
##  Granger causality H0: jp do not Granger-cause us uk
## 
## data:  VAR object var3usukjp
## F-Test = 0.62058, df1 = 6, df2 = 855, p-value = 0.714
## 
## 
## $Instant
## 
##  H0: No instantaneous causality between: jp and us uk
## 
## data:  VAR object var3usukjp
## Chi-squared = 89.743, df = 2, p-value &lt; 2.2e-16</code></pre>
<ul>
<li><p>–&gt; Gragnerの意味での因果性なし. 同時因果性あり</p></li>
<li><p>日英をcauseとする因果性</p></li>
</ul>
<div class="sourceCode" id="cb740"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb740-1"><a href="varモデル.html#cb740-1" tabindex="-1"></a>vars<span class="sc">::</span><span class="fu">causality</span>(var3usukjp, <span class="at">cause =</span> <span class="fu">c</span>(<span class="st">&quot;jp&quot;</span>, <span class="st">&quot;uk&quot;</span>))  <span class="co"># jp, uk --&gt; us</span></span></code></pre></div>
<pre><code>## $Granger
## 
##  Granger causality H0: uk jp do not Granger-cause us
## 
## data:  VAR object var3usukjp
## F-Test = 0.63403, df1 = 6, df2 = 855, p-value = 0.7031
## 
## 
## $Instant
## 
##  H0: No instantaneous causality between: uk jp and us
## 
## data:  VAR object var3usukjp
## Chi-squared = 119.65, df = 2, p-value &lt; 2.2e-16</code></pre>
<ul>
<li>–&gt; Grangerの意味での因果性なし. 同時因果性あり</li>
</ul>
<pre><code>- 関数vars::causality()
  - causeを指定なし (デフォルト) では, 第1列の変数がcause
  - K変量VARモデルに対する因果性検定 (対応する係数にゼロ制約を課す)
  - ← 特定の2変量のみの因果性を調べる検定ではない</code></pre>
</div>
<div id="予測誤差分散分解-forecast-error-variance-decomposition-1" class="section level4 unnumbered hasAnchor">
<h4>予測誤差分散分解 (forecast error variance decomposition)<a href="varモデル.html#予測誤差分散分解-forecast-error-variance-decomposition-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li>直交化インパルス応答関数を使い, 第j変数の第k変数のh先予測誤差分散への寄与</li>
</ul>
<div class="sourceCode" id="cb743"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb743-1"><a href="varモデル.html#cb743-1" tabindex="-1"></a><span class="co"># library(vars)</span></span>
<span id="cb743-2"><a href="varモデル.html#cb743-2" tabindex="-1"></a>var3_fevd <span class="ot">&lt;-</span> vars<span class="sc">::</span><span class="fu">fevd</span>(var3usukjp, <span class="at">n.ahead =</span> <span class="dv">10</span>)   <span class="co"># 10期先まで評価する</span></span>
<span id="cb743-3"><a href="varモデル.html#cb743-3" tabindex="-1"></a><span class="fu">plot</span>(var3_fevd)</span>
<span id="cb743-4"><a href="varモデル.html#cb743-4" tabindex="-1"></a></span>
<span id="cb743-5"><a href="varモデル.html#cb743-5" tabindex="-1"></a>varmkt <span class="ot">&lt;-</span> vars<span class="sc">::</span><span class="fu">VAR</span>(mkt, <span class="at">p =</span> <span class="dv">3</span>, <span class="at">type =</span> <span class="st">&quot;const&quot;</span>)</span>
<span id="cb743-6"><a href="varモデル.html#cb743-6" tabindex="-1"></a>varmkt_fevd <span class="ot">&lt;-</span> vars<span class="sc">::</span><span class="fu">fevd</span>(varmkt, <span class="at">n.ahead =</span> <span class="dv">10</span>)     <span class="co"># 10期先まで評価する</span></span>
<span id="cb743-7"><a href="varモデル.html#cb743-7" tabindex="-1"></a><span class="fu">plot</span>(varmkt_fevd)</span></code></pre></div>
<p><img src="093-VAR3_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<ul>
<li>変数の順番の影響の確認</li>
<li>分散分解 (変数の順序入れ替え)</li>
</ul>
<div class="sourceCode" id="cb744"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb744-1"><a href="varモデル.html#cb744-1" tabindex="-1"></a>usjpuk <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(mkt<span class="sc">$</span>us, mkt<span class="sc">$</span>jp, mkt<span class="sc">$</span>uk)</span>
<span id="cb744-2"><a href="varモデル.html#cb744-2" tabindex="-1"></a><span class="fu">cov</span>(usukjp)</span></code></pre></div>
<pre><code>##             us          uk          jp
## us 0.001985518 0.001368410 0.001584889
## uk 0.001368410 0.001535432 0.001192584
## jp 0.001584889 0.001192584 0.002963727</code></pre>
<div class="sourceCode" id="cb746"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb746-1"><a href="varモデル.html#cb746-1" tabindex="-1"></a><span class="fu">cov</span>(usjpuk)</span></code></pre></div>
<pre><code>##             us          jp          uk
## us 0.001985518 0.001584889 0.001368410
## jp 0.001584889 0.002963727 0.001192584
## uk 0.001368410 0.001192584 0.001535432</code></pre>
<div class="sourceCode" id="cb748"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb748-1"><a href="varモデル.html#cb748-1" tabindex="-1"></a>var3usjpuk <span class="ot">&lt;-</span> vars<span class="sc">::</span><span class="fu">VAR</span>(usjpuk, <span class="at">p =</span> <span class="dv">3</span>, <span class="at">type =</span> <span class="st">&quot;const&quot;</span>)</span>
<span id="cb748-2"><a href="varモデル.html#cb748-2" tabindex="-1"></a>var3_fevd_2 <span class="ot">&lt;-</span> vars<span class="sc">::</span><span class="fu">fevd</span>(var3usjpuk, <span class="at">n.ahead =</span> <span class="dv">10</span>)     <span class="co"># 10期先まで評価する</span></span>
<span id="cb748-3"><a href="varモデル.html#cb748-3" tabindex="-1"></a><span class="fu">plot</span>(var3_fevd_2)</span></code></pre></div>
<p><img src="093-VAR3_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
<ul>
<li>直交インパルス応答</li>
<li>米国 → 他市場
<ul>
<li>(米国, 英国, 日本)の順序 vs (米国, 日本, 英国)の順序</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb749"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb749-1"><a href="varモデル.html#cb749-1" tabindex="-1"></a><span class="co"># (us, uk, jp)</span></span>
<span id="cb749-2"><a href="varモデル.html#cb749-2" tabindex="-1"></a>ip1 <span class="ot">&lt;-</span> vars<span class="sc">::</span><span class="fu">irf</span>(var3usukjp, <span class="at">impulse =</span> <span class="fu">c</span>(<span class="st">&quot;us&quot;</span>), <span class="at">n.ahead =</span> <span class="dv">5</span>, <span class="at">boot =</span> <span class="cn">TRUE</span>)</span>
<span id="cb749-3"><a href="varモデル.html#cb749-3" tabindex="-1"></a><span class="co"># ortho = T (デフォルト): 直交化インパルス応答; ortho = F: 非直交化インパルス応答</span></span>
<span id="cb749-4"><a href="varモデル.html#cb749-4" tabindex="-1"></a><span class="co"># boot = T: ブートストラップ法により, 信頼区間計算</span></span>
<span id="cb749-5"><a href="varモデル.html#cb749-5" tabindex="-1"></a><span class="co"># cumulative = T: 累積インパルス応答. デフォルトはF.</span></span>
<span id="cb749-6"><a href="varモデル.html#cb749-6" tabindex="-1"></a><span class="fu">plot</span>(ip1)</span></code></pre></div>
<p><img src="093-VAR3_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
<div class="sourceCode" id="cb750"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb750-1"><a href="varモデル.html#cb750-1" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb750-2"><a href="varモデル.html#cb750-2" tabindex="-1"></a><span class="co"># (us, jp, uk)</span></span>
<span id="cb750-3"><a href="varモデル.html#cb750-3" tabindex="-1"></a>ip2 <span class="ot">&lt;-</span> vars<span class="sc">::</span><span class="fu">irf</span>(var3usjpuk, <span class="at">impulse =</span> <span class="fu">c</span>(<span class="st">&quot;us&quot;</span>), <span class="at">n.ahead =</span> <span class="dv">5</span>, <span class="at">boot =</span> <span class="cn">TRUE</span>)</span>
<span id="cb750-4"><a href="varモデル.html#cb750-4" tabindex="-1"></a><span class="fu">plot</span>(ip2)</span></code></pre></div>
<p><img src="093-VAR3_files/figure-html/unnamed-chunk-20-2.png" width="672" /></p>
<ul>
<li>日本 → 他市場</li>
</ul>
<div class="sourceCode" id="cb751"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb751-1"><a href="varモデル.html#cb751-1" tabindex="-1"></a><span class="co"># (us, uk, jp)</span></span>
<span id="cb751-2"><a href="varモデル.html#cb751-2" tabindex="-1"></a><span class="co"># ip3 &lt;- vars::irf(var3usukjp, impulse = c(&quot;uk&quot;), n.ahead = 5, boot = TRUE)</span></span>
<span id="cb751-3"><a href="varモデル.html#cb751-3" tabindex="-1"></a>ip3 <span class="ot">&lt;-</span> vars<span class="sc">::</span><span class="fu">irf</span>(var3usukjp, <span class="at">impulse =</span> <span class="fu">c</span>(<span class="st">&quot;jp&quot;</span>), <span class="at">n.ahead =</span> <span class="dv">5</span>, <span class="at">boot =</span> <span class="cn">TRUE</span>)</span>
<span id="cb751-4"><a href="varモデル.html#cb751-4" tabindex="-1"></a><span class="fu">plot</span>(ip3)</span></code></pre></div>
<p><img src="093-VAR3_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
<p>上図では, 日本が第三の変数 (外生性が一番低いと仮定) となっていることから,
日本固有のショックが<span class="math inline">\(t=0\)</span>に生じた時点では,
日本より上位にある米, 英両市場は反応しておらず,
<span class="math inline">\(t=1\)</span>になってVAR係数を通じてショックが伝播する様子が
分かる.</p>
<div class="sourceCode" id="cb752"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb752-1"><a href="varモデル.html#cb752-1" tabindex="-1"></a><span class="co"># (us, jp, uk)</span></span>
<span id="cb752-2"><a href="varモデル.html#cb752-2" tabindex="-1"></a>ip4 <span class="ot">&lt;-</span> vars<span class="sc">::</span><span class="fu">irf</span>(var3usjpuk, <span class="at">impulse =</span> <span class="fu">c</span>(<span class="st">&quot;jp&quot;</span>), <span class="at">n.ahead =</span> <span class="dv">5</span>, <span class="at">boot =</span> <span class="cn">TRUE</span>)</span>
<span id="cb752-3"><a href="varモデル.html#cb752-3" tabindex="-1"></a><span class="fu">plot</span>(ip4)</span></code></pre></div>
<p><img src="093-VAR3_files/figure-html/unnamed-chunk-22-1.png" width="672" /></p>
<p>他方, ここでは, 日本が第二の変数となっていることから,
日本固有のショックが<span class="math inline">\(t=0\)</span>に生じた時点で,
日本より下位にある英市場もわずかながらであるがショックが同時発生しているが, 上位にある米はやはり<span class="math inline">\(t=1\)</span>になってショックが伝播していることが分かる.</p>
<ul>
<li>確認: Choleski分解: <span class="math inline">\(\Sigma = P P&#39;\)</span></li>
</ul>
<div class="sourceCode" id="cb753"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb753-1"><a href="varモデル.html#cb753-1" tabindex="-1"></a><span class="co"># chol(cov(usjpuk)) # 上三角行列P&#39;</span></span>
<span id="cb753-2"><a href="varモデル.html#cb753-2" tabindex="-1"></a><span class="co"># (us, uk, jp)</span></span>
<span id="cb753-3"><a href="varモデル.html#cb753-3" tabindex="-1"></a><span class="fu">t</span>(<span class="fu">chol</span>(<span class="fu">cov</span>(usukjp)))    <span class="co"># 下三角行列P&#39;</span></span></code></pre></div>
<pre><code>##            us          uk         jp
## us 0.04455916 0.000000000 0.00000000
## uk 0.03070996 0.024337838 0.00000000
## jp 0.03556821 0.004120564 0.04100794</code></pre>
<div class="sourceCode" id="cb755"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb755-1"><a href="varモデル.html#cb755-1" tabindex="-1"></a><span class="co"># (us, jp, uk)</span></span>
<span id="cb755-2"><a href="varモデル.html#cb755-2" tabindex="-1"></a><span class="fu">t</span>(<span class="fu">chol</span>(<span class="fu">cov</span>(usjpuk)))    <span class="co"># 下三角行列P&#39;</span></span></code></pre></div>
<pre><code>##            us          jp        uk
## us 0.04455916 0.000000000 0.0000000
## jp 0.03556821 0.041214439 0.0000000
## uk 0.03070996 0.002433265 0.0242159</code></pre>
<ul>
<li>(参考) Tsay氏作成パッケージMTS</li>
</ul>
<div class="sourceCode" id="cb757"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb757-1"><a href="varモデル.html#cb757-1" tabindex="-1"></a><span class="fu">library</span>(MTS)    <span class="co"># &#39;vars&#39;との同時使用は避ける (VAR()関数が重複)</span></span>
<span id="cb757-2"><a href="varモデル.html#cb757-2" tabindex="-1"></a>var3 <span class="ot">&lt;-</span> MTS<span class="sc">::</span><span class="fu">VAR</span>(usukjp, <span class="at">p =</span> <span class="dv">3</span>) <span class="co"># include.mean = T (デフォルト), VAR係数の最小2乗推定</span></span>
<span id="cb757-3"><a href="varモデル.html#cb757-3" tabindex="-1"></a>MTS<span class="sc">::</span><span class="fu">GrangerTest</span>(usukjp, <span class="at">p =</span> <span class="dv">3</span>) <span class="co"># include.mean = T (デフォルト)</span></span>
<span id="cb757-4"><a href="varモデル.html#cb757-4" tabindex="-1"></a>MTS<span class="sc">::</span><span class="fu">VARMAirf</span>(<span class="at">Phi =</span> var3<span class="sc">$</span>Phi, <span class="at">Sigma =</span> var3<span class="sc">$</span>Sigma)       <span class="co"># Theta = NULL (デフォルト): VMA係数行列</span></span></code></pre></div>
</div>
<div id="その他-granger因果性検定の関数" class="section level4 unnumbered hasAnchor">
<h4>その他: Granger因果性検定の関数<a href="varモデル.html#その他-granger因果性検定の関数" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li>パッケージ<strong>lmtest</strong></li>
</ul>
<pre><code>- 関数grangertest(): 2変量間のGranger因果性検定
  - usage: grangertest(x, y, order = 1, na.action = na.omit, ...)</code></pre>
<div class="sourceCode" id="cb759"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb759-1"><a href="varモデル.html#cb759-1" tabindex="-1"></a><span class="co"># library(lmtest)</span></span>
<span id="cb759-2"><a href="varモデル.html#cb759-2" tabindex="-1"></a><span class="fu">data</span>(ChickEgg)  <span class="co"># mts, tsクラス</span></span>
<span id="cb759-3"><a href="varモデル.html#cb759-3" tabindex="-1"></a><span class="fu">plot</span>(ChickEgg)</span></code></pre></div>
<p><img src="093-VAR3_files/figure-html/unnamed-chunk-25-1.png" width="672" /></p>
<div class="sourceCode" id="cb760"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb760-1"><a href="varモデル.html#cb760-1" tabindex="-1"></a>lmtest<span class="sc">::</span><span class="fu">grangertest</span>(egg <span class="sc">~</span> chicken, <span class="at">order =</span> <span class="dv">3</span>, <span class="at">data =</span> ChickEgg)  <span class="co"># → 有意でない</span></span></code></pre></div>
<pre><code>## Granger causality test
## 
## Model 1: egg ~ Lags(egg, 1:3) + Lags(chicken, 1:3)
## Model 2: egg ~ Lags(egg, 1:3)
##   Res.Df Df      F Pr(&gt;F)
## 1     44                 
## 2     47 -3 0.5916 0.6238</code></pre>
<div class="sourceCode" id="cb762"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb762-1"><a href="varモデル.html#cb762-1" tabindex="-1"></a>lmtest<span class="sc">::</span><span class="fu">grangertest</span>(chicken <span class="sc">~</span> egg, <span class="at">order =</span> <span class="dv">3</span>, <span class="at">data =</span> ChickEgg)  <span class="co"># → 有意(1%)</span></span></code></pre></div>
<pre><code>## Granger causality test
## 
## Model 1: chicken ~ Lags(chicken, 1:3) + Lags(egg, 1:3)
## Model 2: chicken ~ Lags(chicken, 1:3)
##   Res.Df Df     F   Pr(&gt;F)   
## 1     44                     
## 2     47 -3 5.405 0.002966 **
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb764"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb764-1"><a href="varモデル.html#cb764-1" tabindex="-1"></a><span class="fu">ccf</span>(ChickEgg[, <span class="st">&quot;chicken&quot;</span>], ChickEgg[, <span class="st">&quot;egg&quot;</span>])       <span class="co"># 1: chicken, 2: egg</span></span></code></pre></div>
<p><img src="093-VAR3_files/figure-html/unnamed-chunk-25-2.png" width="672" /></p>
<ul>
<li>パッケージ<strong>NlinTS</strong>: 非線形時系列解析, 因果性検出</li>
</ul>
<pre><code>- 関数causality.test(): 2変量間のGranger因果性検定
  - usage: causality.test(ts1, ts2, lag, diff = FALSE)</code></pre>
<div class="sourceCode" id="cb766"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb766-1"><a href="varモデル.html#cb766-1" tabindex="-1"></a><span class="fu">library</span> (NlinTS)        <span class="co"># 非線形時系列解析, 因果性検出. causality.test()</span></span></code></pre></div>
<pre><code>## Loading required package: Rcpp</code></pre>
<div class="sourceCode" id="cb768"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb768-1"><a href="varモデル.html#cb768-1" tabindex="-1"></a>res1 <span class="ot">&lt;-</span> NlinTS<span class="sc">::</span><span class="fu">causality.test</span>(ChickEgg[, <span class="st">&quot;egg&quot;</span>], ChickEgg[, <span class="st">&quot;chicken&quot;</span>], <span class="at">lag =</span> <span class="dv">3</span>)</span>
<span id="cb768-2"><a href="varモデル.html#cb768-2" tabindex="-1"></a>res2 <span class="ot">&lt;-</span> NlinTS<span class="sc">::</span><span class="fu">causality.test</span>(ChickEgg[, <span class="st">&quot;chicken&quot;</span>], ChickEgg[, <span class="st">&quot;egg&quot;</span>], <span class="at">lag =</span> <span class="dv">3</span>)</span>
<span id="cb768-3"><a href="varモデル.html#cb768-3" tabindex="-1"></a>res1<span class="sc">$</span><span class="fu">summary</span>()</span></code></pre></div>
<pre><code>## --------------------
##     Test summary
## --------------------
## The lag parameter: p = 3
## The Granger causality Index: GCI = 0.0395451
## The value of the F-test: 0.591615
## The p_value of the F-test: 0.623786
## The critical value with 5% of risk:: 2.822</code></pre>
<div class="sourceCode" id="cb770"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb770-1"><a href="varモデル.html#cb770-1" tabindex="-1"></a>res2<span class="sc">$</span><span class="fu">summary</span>()</span></code></pre></div>
<pre><code>## --------------------
##     Test summary
## --------------------
## The lag parameter: p = 3
## The Granger causality Index: GCI = 0.313731
## The value of the F-test: 5.40498
## The p_value of the F-test: 0.0029664
## The critical value with 5% of risk:: 2.822</code></pre>
<ul>
<li><p>–&gt; 上の<code>grangertst()</code>の結果と同一</p></li>
<li><p>パッケージ<strong>MTS</strong></p></li>
</ul>
<pre><code>- GrangerTest(): p変量のGranger因果性検定
  - usage: GrangerTest(X,p=1,include.mean=T,locInput=c(1))</code></pre>
<div class="sourceCode" id="cb773"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb773-1"><a href="varモデル.html#cb773-1" tabindex="-1"></a><span class="fu">library</span>(MTS)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;MTS&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:vars&#39;:
## 
##     VAR</code></pre>
<div class="sourceCode" id="cb776"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb776-1"><a href="varモデル.html#cb776-1" tabindex="-1"></a>EggChick <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">egg =</span> ChickEgg[, <span class="st">&quot;egg&quot;</span>], <span class="at">chicken =</span> ChickEgg[, <span class="st">&quot;chicken&quot;</span>])</span>
<span id="cb776-2"><a href="varモデル.html#cb776-2" tabindex="-1"></a>MTS<span class="sc">::</span><span class="fu">GrangerTest</span>(EggChick, <span class="at">p =</span> <span class="dv">3</span>)   <span class="co"># カイ2乗検定 (F値x3 〜 (漸近的に)Chisq(3))</span></span></code></pre></div>
<pre><code>## Number of targeted zero parameters:  3 
## Chi-square test for Granger Causality and p-value:  1.774846 0.620424 
## Constant term: 
## Estimates:  306.1473 133544.6 
## Std.Error:  132.5194 41073.51 
## AR coefficient matrix 
## AR( 1 )-matrix 
##      [,1]  [,2]
## [1,]  1.3 0.000
## [2,] 76.6 0.292
## standard error 
##        [,1]  [,2]
## [1,]  0.143 0.000
## [2,] 25.279 0.184
## AR( 2 )-matrix 
##         [,1]  [,2]
## [1,]  -0.361 0.000
## [2,] -47.078 0.445
## standard error 
##        [,1]  [,2]
## [1,]  0.234 0.000
## [2,] 39.387 0.186
## AR( 3 )-matrix 
##          [,1]    [,2]
## [1,]   0.0042 0.00000
## [2,] -35.9327 0.00407
## standard error 
##        [,1]  [,2]
## [1,]  0.141 0.000
## [2,] 28.538 0.174
##   
## Residuals cov-mtx: 
##            [,1]      [,2]
## [1,]   22800.12   1843210
## [2,] 1843210.37 412998788
##   
## det(SSE) =  6.018998e+12 
## AIC =  29.75928 
## BIC =  30.09077 
## HQ  =  29.88712</code></pre>
<div class="sourceCode" id="cb778"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb778-1"><a href="varモデル.html#cb778-1" tabindex="-1"></a><span class="co"># MTS::GrangerTest(ChickEgg, p = 3)</span></span></code></pre></div>
<ul>
<li>–&gt; 上の<code>grangertst()</code>の結果とやや異なる</li>
</ul>

</div>
</div>
</div>
<div id="補足-分散共分散行列のコレスキー分解" class="section level2 hasAnchor" number="9.5">
<h2><span class="header-section-number">9.5</span> 補足: 分散共分散行列のコレスキー分解<a href="varモデル.html#補足-分散共分散行列のコレスキー分解" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>直交化インパルス応答や予測誤差分散分解では, 事前に外生性の高い順に変数を配置しておく必要がある.
直交化する際には, VAR(<span class="math inline">\(p\)</span>)モデルの撹乱項の分散共分散行列に対してCholeskey分解が利用される.</p>
<ul>
<li>分散共分散行列に対するコレスキー (Choleskey) 分解の計算例
<ul>
<li>以下, 簡単のため, VAR(<span class="math inline">\(p\)</span>)モデルは使わない</li>
</ul></li>
</ul>
<!--
- msci日次収益率データの読み込み
  - データ入手先: https://www.asakura.co.jp/detail.php?book_code=12792 -->
<!-- toを指定しないと, 三市場データの長さが異なる可能性がある.
ow, 日付を月末に揃えるなどすれば, mergeが使えるはずだが... -->
<pre><code>## Loading required package: MASS</code></pre>
<pre><code>## Loading required package: strucchange</code></pre>
<pre><code>## Loading required package: zoo</code></pre>
<pre><code>## 
## Attaching package: &#39;zoo&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     as.Date, as.Date.numeric</code></pre>
<pre><code>## Loading required package: sandwich</code></pre>
<pre><code>## Loading required package: urca</code></pre>
<pre><code>## Loading required package: lmtest</code></pre>
<pre><code>## Loading required package: xts</code></pre>
<pre><code>## Loading required package: TTR</code></pre>
<pre><code>## Registered S3 method overwritten by &#39;quantmod&#39;:
##   method            from
##   as.zoo.data.frame zoo</code></pre>
<pre><code>## ── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
## ✔ dplyr     1.1.4     ✔ readr     2.1.5
## ✔ forcats   1.0.0     ✔ stringr   1.5.1
## ✔ ggplot2   3.5.1     ✔ tibble    3.2.1
## ✔ lubridate 1.9.3     ✔ tidyr     1.3.1
## ✔ purrr     1.0.2     
## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
## ✖ stringr::boundary() masks strucchange::boundary()
## ✖ dplyr::filter()     masks stats::filter()
## ✖ dplyr::first()      masks xts::first()
## ✖ dplyr::lag()        masks stats::lag()
## ✖ dplyr::last()       masks xts::last()
## ✖ dplyr::select()     masks MASS::select()
## ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
<pre><code>##                     us           uk          jp
## 1999-12-31 -0.05224485 -0.100351609  0.03147106
## 2000-01-31 -0.02031300 -0.005743495  0.02125795
## 2000-02-29  0.09232375  0.048174179  0.01875144
## 2000-03-31 -0.03127991 -0.033078382 -0.12354810
## 2000-04-30 -0.02215875  0.005044624 -0.09575560
## 2000-05-31  0.02365163 -0.007370510  0.06395117</code></pre>
<p><img src="094_Chol_files/figure-html/unnamed-chunk-1-1.png" width="672" /></p>
<ul>
<li>分散共分散行列<span class="math inline">\({\bf \Sigma}\)</span>のCholeskey分解
<span class="math display">\[ {\bf \Sigma} = {\bf P}{\bf P&#39;} \]</span>
但し, <span class="math inline">\({\bf P}\)</span>は下三角行列.</li>
</ul>
<p>上で使用した米英日3か国の株価指数データ (S&amp;P500, FTSE, 日経平均)
をここでも使用して実際にCholeskey分解を行ってみよう.</p>
<ul>
<li>米英日の日次収益率に対して分散共分散行列を計算 → Choleskey分解</li>
</ul>
<div class="sourceCode" id="cb792"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb792-1"><a href="varモデル.html#cb792-1" tabindex="-1"></a><span class="co"># アメリカ、イギリス、日本市場</span></span>
<span id="cb792-2"><a href="varモデル.html#cb792-2" tabindex="-1"></a>usukjp <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(mkt<span class="sc">$</span>us, mkt<span class="sc">$</span>uk, mkt<span class="sc">$</span>jp) </span>
<span id="cb792-3"><a href="varモデル.html#cb792-3" tabindex="-1"></a><span class="fu">head</span>(usukjp, <span class="dv">5</span>) </span></code></pre></div>
<pre><code>##                     us           uk          jp
## 1999-12-31 -0.05224485 -0.100351609  0.03147106
## 2000-01-31 -0.02031300 -0.005743495  0.02125795
## 2000-02-29  0.09232375  0.048174179  0.01875144
## 2000-03-31 -0.03127991 -0.033078382 -0.12354810
## 2000-04-30 -0.02215875  0.005044624 -0.09575560</code></pre>
<div class="sourceCode" id="cb794"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb794-1"><a href="varモデル.html#cb794-1" tabindex="-1"></a><span class="co"># 分散共分散行列: Sigma</span></span>
<span id="cb794-2"><a href="varモデル.html#cb794-2" tabindex="-1"></a>cov_usukjp <span class="ot">&lt;-</span> <span class="fu">cov</span>(usukjp) <span class="sc">%&gt;%</span> <span class="fu">print</span>(<span class="at">digits =</span> <span class="dv">4</span>)</span></code></pre></div>
<pre><code>##          us       uk       jp
## us 0.001986 0.001368 0.001585
## uk 0.001368 0.001535 0.001193
## jp 0.001585 0.001193 0.002964</code></pre>
<div class="sourceCode" id="cb796"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb796-1"><a href="varモデル.html#cb796-1" tabindex="-1"></a><span class="co"># Choleskey分解: Sigma = PP&#39;</span></span>
<span id="cb796-2"><a href="varモデル.html#cb796-2" tabindex="-1"></a>P <span class="ot">&lt;-</span> <span class="fu">chol</span>(cov_usukjp) <span class="sc">%&gt;%</span> <span class="fu">t</span>() <span class="sc">%&gt;%</span> <span class="fu">print</span>(<span class="at">digits =</span> <span class="dv">4</span>) <span class="co"># 下三角行列P</span></span></code></pre></div>
<pre><code>##         us       uk      jp
## us 0.04456 0.000000 0.00000
## uk 0.03071 0.024338 0.00000
## jp 0.03557 0.004121 0.04101</code></pre>
<div class="sourceCode" id="cb798"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb798-1"><a href="varモデル.html#cb798-1" tabindex="-1"></a><span class="co"># Sigmaの復元 (確認用)</span></span>
<span id="cb798-2"><a href="varモデル.html#cb798-2" tabindex="-1"></a>P <span class="sc">%*%</span> <span class="fu">t</span>(P) <span class="sc">%&gt;%</span> <span class="fu">print</span>(<span class="at">digits =</span> <span class="dv">4</span>)</span></code></pre></div>
<pre><code>##          us       uk       jp
## us 0.001986 0.001368 0.001585
## uk 0.001368 0.001535 0.001193
## jp 0.001585 0.001193 0.002964</code></pre>
<ul>
<li>米日英の分散共分散行列を計算 → Choleskey分解</li>
</ul>
<div class="sourceCode" id="cb800"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb800-1"><a href="varモデル.html#cb800-1" tabindex="-1"></a><span class="co"># アメリカ、日本, 英国市場</span></span>
<span id="cb800-2"><a href="varモデル.html#cb800-2" tabindex="-1"></a>usjpuk <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(mkt<span class="sc">$</span>us, mkt<span class="sc">$</span>jp, mkt<span class="sc">$</span>uk) </span>
<span id="cb800-3"><a href="varモデル.html#cb800-3" tabindex="-1"></a><span class="fu">head</span>(usjpuk, <span class="dv">5</span>) </span></code></pre></div>
<pre><code>##                     us          jp           uk
## 1999-12-31 -0.05224485  0.03147106 -0.100351609
## 2000-01-31 -0.02031300  0.02125795 -0.005743495
## 2000-02-29  0.09232375  0.01875144  0.048174179
## 2000-03-31 -0.03127991 -0.12354810 -0.033078382
## 2000-04-30 -0.02215875 -0.09575560  0.005044624</code></pre>
<div class="sourceCode" id="cb802"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb802-1"><a href="varモデル.html#cb802-1" tabindex="-1"></a><span class="co"># 分散共分散行列: Sigma</span></span>
<span id="cb802-2"><a href="varモデル.html#cb802-2" tabindex="-1"></a>cov_usjpuk <span class="ot">&lt;-</span> <span class="fu">cov</span>(usjpuk) <span class="sc">%&gt;%</span> <span class="fu">print</span>(<span class="at">digits =</span> <span class="dv">4</span>)</span></code></pre></div>
<pre><code>##          us       jp       uk
## us 0.001986 0.001585 0.001368
## jp 0.001585 0.002964 0.001193
## uk 0.001368 0.001193 0.001535</code></pre>
<div class="sourceCode" id="cb804"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb804-1"><a href="varモデル.html#cb804-1" tabindex="-1"></a><span class="co"># Choleskey分解: Sigma = PP&#39;</span></span>
<span id="cb804-2"><a href="varモデル.html#cb804-2" tabindex="-1"></a>P <span class="ot">&lt;-</span> <span class="fu">chol</span>(cov_usjpuk) <span class="sc">%&gt;%</span> <span class="fu">t</span>() <span class="sc">%&gt;%</span> <span class="fu">print</span>(<span class="at">digits =</span> <span class="dv">4</span>) <span class="co"># 下三角行列P</span></span></code></pre></div>
<pre><code>##         us       jp      uk
## us 0.04456 0.000000 0.00000
## jp 0.03557 0.041214 0.00000
## uk 0.03071 0.002433 0.02422</code></pre>
<div class="sourceCode" id="cb806"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb806-1"><a href="varモデル.html#cb806-1" tabindex="-1"></a><span class="co"># Sigmaの復元 (確認用)</span></span>
<span id="cb806-2"><a href="varモデル.html#cb806-2" tabindex="-1"></a>P <span class="sc">%*%</span> <span class="fu">t</span>(P) <span class="sc">%&gt;%</span> <span class="fu">print</span>(<span class="at">digits =</span> <span class="dv">4</span>)</span></code></pre></div>
<pre><code>##          us       jp       uk
## us 0.001986 0.001585 0.001368
## jp 0.001585 0.002964 0.001193
## uk 0.001368 0.001193 0.001535</code></pre>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="garchモデル.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="共和分分析.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
