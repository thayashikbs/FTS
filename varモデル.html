<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>9 VARモデル | 金融時系列解析</title>
  <meta name="description" content="9 VARモデル | 金融時系列解析" />
  <meta name="generator" content="bookdown 0.35 and GitBook 2.6.7" />

  <meta property="og:title" content="9 VARモデル | 金融時系列解析" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="9 VARモデル | 金融時系列解析" />
  
  
  

<meta name="author" content="林 高樹" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="garchモデル.html"/>
<link rel="next" href="共和分分析誤差修正モデル.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> はじめに</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#時系列モデリング"><i class="fa fa-check"></i><b>1.1</b> 時系列モデリング</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#金融時系列データの特徴"><i class="fa fa-check"></i><b>1.2</b> 金融時系列データの特徴</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#金融時系列データの特徴-みずほ-8411-株価データの例"><i class="fa fa-check"></i>金融時系列データの特徴: みずほ (8411) 株価データの例</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#シミュレーションによるサンプルパス生成"><i class="fa fa-check"></i><b>1.3</b> シミュレーションによるサンプルパス生成</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#rにおける時系列オブジェクトクラスおよび関数の例"><i class="fa fa-check"></i><b>1.4</b> Rにおける時系列オブジェクト・クラスおよび関数の例</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="index.html"><a href="index.html#日付時間データに対するクラス"><i class="fa fa-check"></i><b>1.4.1</b> 日付・時間データに対するクラス</a></li>
<li class="chapter" data-level="1.4.2" data-path="index.html"><a href="index.html#時系列データに対するクラス1-tsクラス"><i class="fa fa-check"></i><b>1.4.2</b> 時系列データに対するクラス(1): tsクラス</a></li>
<li class="chapter" data-level="1.4.3" data-path="index.html"><a href="index.html#時系列データに対するクラス2-zooクラスとxtsクラス"><i class="fa fa-check"></i><b>1.4.3</b> 時系列データに対するクラス(2): zooクラスとxtsクラス</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#時系列データの分解"><i class="fa fa-check"></i><b>1.5</b> 時系列データの分解</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="index.html"><a href="index.html#トレンド抽出-平滑化smoothing"><i class="fa fa-check"></i><b>1.5.1</b> トレンド抽出, 平滑化(smoothing)</a></li>
<li class="chapter" data-level="1.5.2" data-path="index.html"><a href="index.html#時系列の分解"><i class="fa fa-check"></i><b>1.5.2</b> 時系列の分解</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="定常性と自己相関関数.html"><a href="定常性と自己相関関数.html"><i class="fa fa-check"></i><b>2</b> 定常性と自己相関関数</a>
<ul>
<li class="chapter" data-level="2.1" data-path="定常性と自己相関関数.html"><a href="定常性と自己相関関数.html#確率過程の2次特性-平均関数と自己共分散関数"><i class="fa fa-check"></i><b>2.1</b> 確率過程の2次特性: 平均関数と自己共分散関数</a></li>
<li class="chapter" data-level="2.2" data-path="定常性と自己相関関数.html"><a href="定常性と自己相関関数.html#定常性-stationarity"><i class="fa fa-check"></i><b>2.2</b> 定常性 (stationarity)</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="定常性と自己相関関数.html"><a href="定常性と自己相関関数.html#強定常性"><i class="fa fa-check"></i><b>2.2.1</b> 強定常性</a></li>
<li class="chapter" data-level="2.2.2" data-path="定常性と自己相関関数.html"><a href="定常性と自己相関関数.html#弱定常性"><i class="fa fa-check"></i><b>2.2.2</b> 弱定常性</a></li>
<li class="chapter" data-level="2.2.3" data-path="定常性と自己相関関数.html"><a href="定常性と自己相関関数.html#ホワイトノイズ"><i class="fa fa-check"></i><b>2.2.3</b> ホワイトノイズ</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="定常性と自己相関関数.html"><a href="定常性と自己相関関数.html#標本平均と標本自己共分散関数"><i class="fa fa-check"></i><b>2.3</b> 標本平均と標本自己共分散関数</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="定常性と自己相関関数.html"><a href="定常性と自己相関関数.html#アンサンブル平均-vs-標本平均"><i class="fa fa-check"></i><b>2.3.1</b> アンサンブル平均 vs 標本平均</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="定常性と自己相関関数.html"><a href="定常性と自己相関関数.html#標本自己相関関数"><i class="fa fa-check"></i><b>2.4</b> 標本自己相関関数</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="定常性と自己相関関数.html"><a href="定常性と自己相関関数.html#白色ノイズ"><i class="fa fa-check"></i><b>2.4.1</b> 白色ノイズ</a></li>
<li class="chapter" data-level="2.4.2" data-path="定常性と自己相関関数.html"><a href="定常性と自己相関関数.html#ランダムウォーク"><i class="fa fa-check"></i><b>2.4.2</b> ランダムウォーク</a></li>
<li class="chapter" data-level="2.4.3" data-path="定常性と自己相関関数.html"><a href="定常性と自己相関関数.html#非定常成分を含む時系列"><i class="fa fa-check"></i><b>2.4.3</b> 非定常成分を含む時系列</a></li>
<li class="chapter" data-level="2.4.4" data-path="定常性と自己相関関数.html"><a href="定常性と自己相関関数.html#線形時系列モデル"><i class="fa fa-check"></i><b>2.4.4</b> 線形時系列モデル</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="定常性と自己相関関数.html"><a href="定常性と自己相関関数.html#自己相関関数-標本値-vs-理論値"><i class="fa fa-check"></i><b>2.5</b> 自己相関関数 (標本値 vs 理論値)</a>
<ul>
<li class="chapter" data-level="" data-path="定常性と自己相関関数.html"><a href="定常性と自己相関関数.html#ar2-モデル"><i class="fa fa-check"></i>AR(2) モデル</a></li>
<li class="chapter" data-level="2.5.1" data-path="定常性と自己相関関数.html"><a href="定常性と自己相関関数.html#arma11モデル-1"><i class="fa fa-check"></i><b>2.5.1</b> ARMA(1,1)モデル</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="armapqモデル.html"><a href="armapqモデル.html"><i class="fa fa-check"></i><b>3</b> ARMA<span class="math inline">\((p,q)\)</span>モデル</a>
<ul>
<li class="chapter" data-level="3.1" data-path="armapqモデル.html"><a href="armapqモデル.html#armapqモデルとは"><i class="fa fa-check"></i><b>3.1</b> ARMA<span class="math inline">\((p,q)\)</span>モデルとは</a>
<ul>
<li class="chapter" data-level="" data-path="armapqモデル.html"><a href="armapqモデル.html#因果性と反転可能性"><i class="fa fa-check"></i>因果性と反転可能性</a></li>
<li class="chapter" data-level="" data-path="armapqモデル.html"><a href="armapqモデル.html#armapqモデルの意義"><i class="fa fa-check"></i>ARMA<span class="math inline">\((p,q)\)</span>モデルの意義</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="armapqモデル.html"><a href="armapqモデル.html#armapqモデルによる予測"><i class="fa fa-check"></i><b>3.2</b> ARMA<span class="math inline">\((p,q)\)</span>モデルによる予測</a></li>
<li class="chapter" data-level="3.3" data-path="armapqモデル.html"><a href="armapqモデル.html#armapqモデルの推定"><i class="fa fa-check"></i><b>3.3</b> ARMA<span class="math inline">\((p,q)\)</span>モデルの推定</a></li>
<li class="chapter" data-level="3.4" data-path="armapqモデル.html"><a href="armapqモデル.html#armapqモデルの同定-次数の特定"><i class="fa fa-check"></i><b>3.4</b> ARMA<span class="math inline">\((p,q)\)</span>モデルの同定 (次数の特定)</a></li>
<li class="chapter" data-level="3.5" data-path="armapqモデル.html"><a href="armapqモデル.html#rによる実行例"><i class="fa fa-check"></i><b>3.5</b> Rによる実行例</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="armapqモデル.html"><a href="armapqモデル.html#armapqモデルの同定-acfpacfeacfの利用"><i class="fa fa-check"></i><b>3.5.1</b> ARMA<span class="math inline">\((p,q)\)</span>モデルの同定 (ACF/PACF/EACFの利用)</a></li>
<li class="chapter" data-level="3.5.2" data-path="armapqモデル.html"><a href="armapqモデル.html#armapqモデルの推定診断"><i class="fa fa-check"></i><b>3.5.2</b> ARMA<span class="math inline">\((p,q)\)</span>モデルの推定・診断</a></li>
<li class="chapter" data-level="3.5.3" data-path="armapqモデル.html"><a href="armapqモデル.html#パッケージforecastの利用"><i class="fa fa-check"></i><b>3.5.3</b> パッケージ{forecast}の利用</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="armapqモデル.html"><a href="armapqモデル.html#armaモデル-データ分析例-tsay-ch2"><i class="fa fa-check"></i><b>3.6</b> ARMAモデル: データ分析例 (Tsay, Ch2)</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="armapqモデル.html"><a href="armapqモデル.html#標本acf"><i class="fa fa-check"></i><b>3.6.1</b> 標本ACF</a></li>
<li class="chapter" data-level="3.6.2" data-path="armapqモデル.html"><a href="armapqモデル.html#ar-ma-arma-2.42.6"><i class="fa fa-check"></i><b>3.6.2</b> AR, MA, ARMA (2.4–2.6)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="arimaモデルsarimaモデル.html"><a href="arimaモデルsarimaモデル.html"><i class="fa fa-check"></i><b>4</b> ARIMAモデル/SARIMAモデル</a>
<ul>
<li class="chapter" data-level="4.1" data-path="arimaモデルsarimaモデル.html"><a href="arimaモデルsarimaモデル.html#arimapdqモデルとは"><i class="fa fa-check"></i><b>4.1</b> ARIMA<span class="math inline">\((p,d,q)\)</span>モデルとは</a></li>
<li class="chapter" data-level="4.2" data-path="arimaモデルsarimaモデル.html"><a href="arimaモデルsarimaモデル.html#sarimapdqtimes-pdq_sモデル-周期sとは"><i class="fa fa-check"></i><b>4.2</b> SARIMA<span class="math inline">\((p,d,q)\times (P,D,Q)_s\)</span>モデル (周期<span class="math inline">\(s\)</span>)とは</a></li>
<li class="chapter" data-level="4.3" data-path="arimaモデルsarimaモデル.html"><a href="arimaモデルsarimaモデル.html#sarimaモデルのパス発生-sarimaパッケージの利用"><i class="fa fa-check"></i><b>4.3</b> SARIMAモデルのパス発生 ({sarima}パッケージの利用)</a></li>
<li class="chapter" data-level="4.4" data-path="arimaモデルsarimaモデル.html"><a href="arimaモデルsarimaモデル.html#sarimaモデルの推定診断"><i class="fa fa-check"></i><b>4.4</b> SARIMAモデルの推定・診断</a></li>
<li class="chapter" data-level="4.5" data-path="arimaモデルsarimaモデル.html"><a href="arimaモデルsarimaモデル.html#パッケージforecastの利用-1"><i class="fa fa-check"></i><b>4.5</b> パッケージ{forecast}の利用</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="単位根過程と単位根検定.html"><a href="単位根過程と単位根検定.html"><i class="fa fa-check"></i><b>5</b> 単位根過程と単位根検定</a>
<ul>
<li class="chapter" data-level="5.1" data-path="単位根過程と単位根検定.html"><a href="単位根過程と単位根検定.html#単位根過程と見せかけの回帰"><i class="fa fa-check"></i><b>5.1</b> 単位根過程と見せかけの回帰</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="単位根過程と単位根検定.html"><a href="単位根過程と単位根検定.html#単位根過程"><i class="fa fa-check"></i><b>5.1.1</b> 単位根過程</a></li>
<li class="chapter" data-level="5.1.2" data-path="単位根過程と単位根検定.html"><a href="単位根過程と単位根検定.html#見せかけの回帰"><i class="fa fa-check"></i><b>5.1.2</b> 見せかけの回帰</a></li>
<li class="chapter" data-level="5.1.3" data-path="単位根過程と単位根検定.html"><a href="単位根過程と単位根検定.html#見せかけの回帰の判定"><i class="fa fa-check"></i><b>5.1.3</b> 見せかけの回帰の判定</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="単位根過程と単位根検定.html"><a href="単位根過程と単位根検定.html#主な単位根検定法"><i class="fa fa-check"></i><b>5.2</b> 主な単位根検定法</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="単位根過程と単位根検定.html"><a href="単位根過程と単位根検定.html#augmented-dicky-fuller-adf-検定の実行例"><i class="fa fa-check"></i><b>5.2.1</b> Augmented Dicky-Fuller (ADF) 検定の実行例</a></li>
<li class="chapter" data-level="5.2.2" data-path="単位根過程と単位根検定.html"><a href="単位根過程と単位根検定.html#adf検定以外の検定法"><i class="fa fa-check"></i><b>5.2.2</b> ADF検定以外の検定法</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="長期記憶過程.html"><a href="長期記憶過程.html"><i class="fa fa-check"></i><b>6</b> 長期記憶過程</a>
<ul>
<li class="chapter" data-level="6.1" data-path="長期記憶過程.html"><a href="長期記憶過程.html#arfimapdq過程のシミュレーション"><i class="fa fa-check"></i><b>6.1</b> ARFIMA(p,d,q)過程のシミュレーション</a></li>
<li class="chapter" data-level="6.2" data-path="長期記憶過程.html"><a href="長期記憶過程.html#arfima-fractional-gaussian過程のシミュレーション"><i class="fa fa-check"></i><b>6.2</b> ARFIMA, fractional Gaussian過程のシミュレーション</a></li>
<li class="chapter" data-level="6.3" data-path="長期記憶過程.html"><a href="長期記憶過程.html#hurst指数の推定"><i class="fa fa-check"></i><b>6.3</b> Hurst指数の推定</a></li>
<li class="chapter" data-level="6.4" data-path="長期記憶過程.html"><a href="長期記憶過程.html#arfimaモデルの推定"><i class="fa fa-check"></i><b>6.4</b> ARFIMAモデルの推定</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="長期記憶過程.html"><a href="長期記憶過程.html#最尤法"><i class="fa fa-check"></i><b>6.4.1</b> 最尤法</a></li>
<li class="chapter" data-level="6.4.2" data-path="長期記憶過程.html"><a href="長期記憶過程.html#階差次数dの代替的推定法"><i class="fa fa-check"></i><b>6.4.2</b> 階差次数<span class="math inline">\(d\)</span>の代替的推定法</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="長期記憶過程.html"><a href="長期記憶過程.html#arfimaモデル-データ分析例-tsay-2.11-pp.119120"><i class="fa fa-check"></i><b>6.5</b> ARFIMAモデル: データ分析例 (Tsay, 2.11, pp.119–120)</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="レジームスイッチングモデル.html"><a href="レジームスイッチングモデル.html"><i class="fa fa-check"></i><b>7</b> レジーム・スイッチング・モデル</a>
<ul>
<li class="chapter" data-level="7.1" data-path="レジームスイッチングモデル.html"><a href="レジームスイッチングモデル.html#自己相関マルコフスイッチングモデル-msm-ar"><i class="fa fa-check"></i><b>7.1</b> 自己相関マルコフ・スイッチング・モデル (MSM-AR)</a></li>
<li class="chapter" data-level="7.2" data-path="レジームスイッチングモデル.html"><a href="レジームスイッチングモデル.html#msm-arモデルの適合"><i class="fa fa-check"></i><b>7.2</b> MSM-ARモデルの適合</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="garchモデル.html"><a href="garchモデル.html"><i class="fa fa-check"></i><b>8</b> GARCHモデル</a>
<ul>
<li class="chapter" data-level="8.1" data-path="garchモデル.html"><a href="garchモデル.html#garchモデル-1"><i class="fa fa-check"></i><b>8.1</b> GARCHモデル</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="garchモデル.html"><a href="garchモデル.html#garchpqモデルのサンプルパス生成"><i class="fa fa-check"></i><b>8.1.1</b> GARCH(p,q)モデルのサンプルパス生成</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="garchモデル.html"><a href="garchモデル.html#garchモデルの推定"><i class="fa fa-check"></i><b>8.2</b> GARCHモデルの推定</a></li>
<li class="chapter" data-level="8.3" data-path="garchモデル.html"><a href="garchモデル.html#garchモデルのバリエーション"><i class="fa fa-check"></i><b>8.3</b> GARCHモデルのバリエーション</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="garchモデル.html"><a href="garchモデル.html#iarch11"><i class="fa fa-check"></i><b>8.3.1</b> IARCH(1,1)</a></li>
<li class="chapter" data-level="8.3.2" data-path="garchモデル.html"><a href="garchモデル.html#gjr-garch11"><i class="fa fa-check"></i><b>8.3.2</b> GJR-GARCH(1,1)</a></li>
<li class="chapter" data-level="8.3.3" data-path="garchモデル.html"><a href="garchモデル.html#aparch"><i class="fa fa-check"></i><b>8.3.3</b> APARCH</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="garchモデル.html"><a href="garchモデル.html#garchモデル-データ分析例-tsay-ch4"><i class="fa fa-check"></i><b>8.4</b> GARCHモデル: データ分析例 (Tsay, Ch4)</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="garchモデル.html"><a href="garchモデル.html#必要な関数やデータセットの入手"><i class="fa fa-check"></i><b>8.4.1</b> 必要な関数やデータセットの入手</a></li>
<li class="chapter" data-level="8.4.2" data-path="garchモデル.html"><a href="garchモデル.html#integrated-garch-モデル"><i class="fa fa-check"></i><b>8.4.2</b> Integrated GARCH モデル</a></li>
<li class="chapter" data-level="8.4.3" data-path="garchモデル.html"><a href="garchモデル.html#garch-m-モデル"><i class="fa fa-check"></i><b>8.4.3</b> GARCH-M モデル</a></li>
<li class="chapter" data-level="8.4.4" data-path="garchモデル.html"><a href="garchモデル.html#exponential-garch-model"><i class="fa fa-check"></i><b>8.4.4</b> Exponential GARCH Model</a></li>
<li class="chapter" data-level="8.4.5" data-path="garchモデル.html"><a href="garchモデル.html#threshold-garch-モデル"><i class="fa fa-check"></i><b>8.4.5</b> Threshold GARCH モデル</a></li>
<li class="chapter" data-level="8.4.6" data-path="garchモデル.html"><a href="garchモデル.html#asymmetric-power-arch-モデル"><i class="fa fa-check"></i><b>8.4.6</b> Asymmetric Power ARCH モデル</a></li>
<li class="chapter" data-level="8.4.7" data-path="garchモデル.html"><a href="garchモデル.html#nonsymmetric-garch-モデル"><i class="fa fa-check"></i><b>8.4.7</b> Nonsymmetric GARCH モデル</a></li>
<li class="chapter" data-level="8.4.8" data-path="garchモデル.html"><a href="garchモデル.html#代替的アプリーチ間の比較"><i class="fa fa-check"></i><b>8.4.8</b> 代替的アプリーチ間の比較</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="varモデル.html"><a href="varモデル.html"><i class="fa fa-check"></i><b>9</b> VARモデル</a>
<ul>
<li class="chapter" data-level="9.1" data-path="varモデル.html"><a href="varモデル.html#varモデル-1"><i class="fa fa-check"></i><b>9.1</b> VARモデル</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="varモデル.html"><a href="varモデル.html#varpモデルのシミュレーション"><i class="fa fa-check"></i><b>9.1.1</b> VAR(<span class="math inline">\(p\)</span>)モデルのシミュレーション</a></li>
<li class="chapter" data-level="9.1.2" data-path="varモデル.html"><a href="varモデル.html#varpモデルの次数同定"><i class="fa fa-check"></i><b>9.1.2</b> VAR(<span class="math inline">\(p\)</span>)モデルの次数同定</a></li>
<li class="chapter" data-level="9.1.3" data-path="varモデル.html"><a href="varモデル.html#varpモデルの推定"><i class="fa fa-check"></i><b>9.1.3</b> VAR(<span class="math inline">\(p\)</span>)モデルの推定</a></li>
<li class="chapter" data-level="9.1.4" data-path="varモデル.html"><a href="varモデル.html#varpモデル予測"><i class="fa fa-check"></i><b>9.1.4</b> VAR(<span class="math inline">\(p\)</span>)モデル予測</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="varモデル.html"><a href="varモデル.html#var解析"><i class="fa fa-check"></i><b>9.2</b> VAR解析</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="varモデル.html"><a href="varモデル.html#varpモデルの推定復習"><i class="fa fa-check"></i><b>9.2.1</b> VAR(<span class="math inline">\(p\)</span>)モデルの推定(復習)</a></li>
<li class="chapter" data-level="9.2.2" data-path="varモデル.html"><a href="varモデル.html#グレンジャーの因果性検定"><i class="fa fa-check"></i><b>9.2.2</b> グレンジャーの因果性検定</a></li>
<li class="chapter" data-level="9.2.3" data-path="varモデル.html"><a href="varモデル.html#インパルス応答"><i class="fa fa-check"></i><b>9.2.3</b> インパルス応答</a></li>
<li class="chapter" data-level="9.2.4" data-path="varモデル.html"><a href="varモデル.html#予測誤差分散分解-forecast-error-variance-decomposition"><i class="fa fa-check"></i><b>9.2.4</b> 予測誤差分散分解 (forecast error variance decomposition)</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="varモデル.html"><a href="varモデル.html#var解析-データ分析例"><i class="fa fa-check"></i><b>9.3</b> VAR解析 (データ分析例)</a>
<ul>
<li class="chapter" data-level="" data-path="varモデル.html"><a href="varモデル.html#事例1-ソフトバンク9434-vs-ソフトバンクグループ9984"><i class="fa fa-check"></i>事例1: ソフトバンク(9434) vs ソフトバンクグループ(9984)</a></li>
<li class="chapter" data-level="" data-path="varモデル.html"><a href="varモデル.html#事例2-米英日3株式市場-sp500-ftse-日経平均"><i class="fa fa-check"></i>事例2: 米英日3株式市場 (S&amp;P500, FTSE, 日経平均)</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="varモデル.html"><a href="varモデル.html#補足-分散共分散行列のコレスキー分解"><i class="fa fa-check"></i><b>9.4</b> 補足: 分散共分散行列のコレスキー分解</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="共和分分析誤差修正モデル.html"><a href="共和分分析誤差修正モデル.html"><i class="fa fa-check"></i><b>10</b> 共和分分析・誤差修正モデル</a>
<ul>
<li class="chapter" data-level="10.1" data-path="共和分分析誤差修正モデル.html"><a href="共和分分析誤差修正モデル.html#見せかけの回帰-1"><i class="fa fa-check"></i><b>10.1</b> 見せかけの回帰</a>
<ul>
<li class="chapter" data-level="" data-path="共和分分析誤差修正モデル.html"><a href="共和分分析誤差修正モデル.html#durbin-watson検定"><i class="fa fa-check"></i>Durbin-Watson検定</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="共和分分析誤差修正モデル.html"><a href="共和分分析誤差修正モデル.html#共和分検定"><i class="fa fa-check"></i><b>10.2</b> 共和分検定</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="共和分分析誤差修正モデル.html"><a href="共和分分析誤差修正モデル.html#engle-grangerの方法"><i class="fa fa-check"></i><b>10.2.1</b> Engle-Grangerの方法</a></li>
<li class="chapter" data-level="10.2.2" data-path="共和分分析誤差修正モデル.html"><a href="共和分分析誤差修正モデル.html#johansenの方法"><i class="fa fa-check"></i><b>10.2.2</b> Johansenの方法</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="共和分分析誤差修正モデル.html"><a href="共和分分析誤差修正モデル.html#誤差修正モデル-データ分析例-tsay-mts-ch5"><i class="fa fa-check"></i><b>10.3</b> 誤差修正モデル: データ分析例 (Tsay, MTS, Ch5)</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="共和分分析誤差修正モデル.html"><a href="共和分分析誤差修正モデル.html#共和分検定-1"><i class="fa fa-check"></i><b>10.3.1</b> 共和分検定</a></li>
<li class="chapter" data-level="10.3.2" data-path="共和分分析誤差修正モデル.html"><a href="共和分分析誤差修正モデル.html#johansenの方法-johansen-procedure"><i class="fa fa-check"></i><b>10.3.2</b> Johansenの方法 (Johansen-Procedure)</a></li>
<li class="chapter" data-level="10.3.3" data-path="共和分分析誤差修正モデル.html"><a href="共和分分析誤差修正モデル.html#誤差修正モデルecmの推定"><i class="fa fa-check"></i><b>10.3.3</b> 誤差修正モデル(ECM)の推定</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="多変量ボラティリティモデル.html"><a href="多変量ボラティリティモデル.html"><i class="fa fa-check"></i><b>11</b> 多変量ボラティリティ・モデル</a>
<ul>
<li class="chapter" data-level="11.1" data-path="多変量ボラティリティモデル.html"><a href="多変量ボラティリティモデル.html#多変量時系列データの条件付不均一分散性の検定"><i class="fa fa-check"></i><b>11.1</b> 多変量時系列データの条件付不均一分散性の検定</a>
<ul>
<li class="chapter" data-level="" data-path="多変量ボラティリティモデル.html"><a href="多変量ボラティリティモデル.html#分析例"><i class="fa fa-check"></i>分析例</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="多変量ボラティリティモデル.html"><a href="多変量ボラティリティモデル.html#指数加重移動平均法-ewma"><i class="fa fa-check"></i><b>11.2</b> 指数加重移動平均法 (EWMA)</a></li>
<li class="chapter" data-level="11.3" data-path="多変量ボラティリティモデル.html"><a href="多変量ボラティリティモデル.html#bekk1-1モデル"><i class="fa fa-check"></i><b>11.3</b> BEKK(1, 1)モデル</a></li>
<li class="chapter" data-level="11.4" data-path="多変量ボラティリティモデル.html"><a href="多変量ボラティリティモデル.html#cholesky分解を利用したボラティリティ推定"><i class="fa fa-check"></i><b>11.4</b> Cholesky分解を利用したボラティリティ推定</a></li>
<li class="chapter" data-level="11.5" data-path="多変量ボラティリティモデル.html"><a href="多変量ボラティリティモデル.html#dcc-dynamic-conditional-correlation-モデル"><i class="fa fa-check"></i><b>11.5</b> DCC (Dynamic Conditional Correlation) モデル</a>
<ul>
<li class="chapter" data-level="" data-path="多変量ボラティリティモデル.html"><a href="多変量ボラティリティモデル.html#tse-and-tsui-2002-モデル"><i class="fa fa-check"></i>Tse and Tsui (2002) モデル</a></li>
<li class="chapter" data-level="" data-path="多変量ボラティリティモデル.html"><a href="多変量ボラティリティモデル.html#engle-2002-モデル"><i class="fa fa-check"></i>Engle (2002) モデル</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="多変量ボラティリティモデル.html"><a href="多変量ボラティリティモデル.html#go-garchモデル"><i class="fa fa-check"></i><b>11.6</b> Go-GARCHモデル</a></li>
<li class="chapter" data-level="11.7" data-path="多変量ボラティリティモデル.html"><a href="多変量ボラティリティモデル.html#コピュラに基づくアプローチ"><i class="fa fa-check"></i><b>11.7</b> コピュラに基づくアプローチ</a>
<ul>
<li class="chapter" data-level="" data-path="多変量ボラティリティモデル.html"><a href="多変量ボラティリティモデル.html#多変量-t-copula-ボラティリティモデル"><i class="fa fa-check"></i>多変量 t-Copula ボラティリティ・モデル</a></li>
</ul></li>
<li class="chapter" data-level="11.8" data-path="多変量ボラティリティモデル.html"><a href="多変量ボラティリティモデル.html#主成分分析に基づくアプローチ-pvc"><i class="fa fa-check"></i><b>11.8</b> 主成分分析に基づくアプローチ (PVC)</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="高頻度データ分析.html"><a href="高頻度データ分析.html"><i class="fa fa-check"></i><b>12</b> 高頻度データ分析</a>
<ul>
<li class="chapter" data-level="12.1" data-path="高頻度データ分析.html"><a href="高頻度データ分析.html#ボラティリティ推定"><i class="fa fa-check"></i><b>12.1</b> ボラティリティ推定</a>
<ul>
<li class="chapter" data-level="" data-path="高頻度データ分析.html"><a href="高頻度データ分析.html#データセット1-topix指数データ"><i class="fa fa-check"></i>データセット1: TOPIX指数データ</a></li>
<li class="chapter" data-level="" data-path="高頻度データ分析.html"><a href="高頻度データ分析.html#実現ボラティリティの計算"><i class="fa fa-check"></i>実現ボラティリティの計算</a></li>
<li class="chapter" data-level="" data-path="高頻度データ分析.html"><a href="高頻度データ分析.html#parkionsonボラティリティの計算"><i class="fa fa-check"></i>Parkionsonボラティリティの計算</a></li>
<li class="chapter" data-level="" data-path="高頻度データ分析.html"><a href="高頻度データ分析.html#har-rvモデルによる予測"><i class="fa fa-check"></i>HAR-RVモデルによる予測</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="高頻度データ分析.html"><a href="高頻度データ分析.html#共分散相関の推定"><i class="fa fa-check"></i><b>12.2</b> 共分散・相関の推定</a>
<ul>
<li class="chapter" data-level="" data-path="高頻度データ分析.html"><a href="高頻度データ分析.html#データセット2-株価指数先物データ"><i class="fa fa-check"></i>データセット2: 株価指数先物データ</a></li>
<li class="chapter" data-level="" data-path="高頻度データ分析.html"><a href="高頻度データ分析.html#共分散相関の推定-1"><i class="fa fa-check"></i>共分散・相関の推定</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="高頻度データ分析.html"><a href="高頻度データ分析.html#acdモデル"><i class="fa fa-check"></i><b>12.3</b> ACDモデル</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="スペクトル解析.html"><a href="スペクトル解析.html"><i class="fa fa-check"></i><b>13</b> スペクトル解析</a>
<ul>
<li class="chapter" data-level="13.1" data-path="スペクトル解析.html"><a href="スペクトル解析.html#armaモデルのスペクトル密度"><i class="fa fa-check"></i><b>13.1</b> ARMAモデルのスペクトル密度</a></li>
<li class="chapter" data-level="13.2" data-path="スペクトル解析.html"><a href="スペクトル解析.html#周期変動時系列のスペクトル密度"><i class="fa fa-check"></i><b>13.2</b> 周期変動時系列のスペクトル密度</a></li>
<li class="chapter" data-level="13.3" data-path="スペクトル解析.html"><a href="スペクトル解析.html#データ分析例-1"><i class="fa fa-check"></i><b>13.3</b> データ分析例 (1)</a>
<ul>
<li class="chapter" data-level="" data-path="スペクトル解析.html"><a href="スペクトル解析.html#データセット1-sunspots"><i class="fa fa-check"></i>データセット1: sunspots</a></li>
<li class="chapter" data-level="" data-path="スペクトル解析.html"><a href="スペクトル解析.html#データセット2-soi"><i class="fa fa-check"></i>データセット2: SOI</a></li>
<li class="chapter" data-level="" data-path="スペクトル解析.html"><a href="スペクトル解析.html#データセット3-銀行プライムローン金利"><i class="fa fa-check"></i>データセット3: 銀行プライムローン金利</a></li>
<li class="chapter" data-level="" data-path="スペクトル解析.html"><a href="スペクトル解析.html#データセット4-事故死者数"><i class="fa fa-check"></i>データセット4: 事故死者数</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="スペクトル解析.html"><a href="スペクトル解析.html#データ分析例-2"><i class="fa fa-check"></i><b>13.4</b> データ分析例 (2)</a>
<ul>
<li class="chapter" data-level="" data-path="スペクトル解析.html"><a href="スペクトル解析.html#為替水準に対する分解-スペクトル解析"><i class="fa fa-check"></i>為替水準に対する分解 &amp; スペクトル解析</a></li>
<li class="chapter" data-level="" data-path="スペクトル解析.html"><a href="スペクトル解析.html#為替リターンに対する分解-スペクトル解析"><i class="fa fa-check"></i>為替リターンに対する分解 &amp; スペクトル解析</a></li>
</ul></li>
</ul></li>
<li class="appendix"><span><b>Appendix 参考文献</b></span></li>
<li class="chapter" data-level="A" data-path="バブル-生成崩壊-検出.html"><a href="バブル-生成崩壊-検出.html"><i class="fa fa-check"></i><b>A</b> バブル (生成・崩壊) 検出</a>
<ul>
<li class="chapter" data-level="A.1" data-path="バブル-生成崩壊-検出.html"><a href="バブル-生成崩壊-検出.html#検定法に関する最近のレビュー論文"><i class="fa fa-check"></i><b>A.1</b> 検定法に関する最近のレビュー論文</a></li>
<li class="chapter" data-level="A.2" data-path="バブル-生成崩壊-検出.html"><a href="バブル-生成崩壊-検出.html#supreme-adf検定sadf-pwy-2011-generalized-supreme-adf-検定gsadf-psy-2015"><i class="fa fa-check"></i><b>A.2</b> Supreme ADF検定/SADF (PWY, 2011), Generalized supreme ADF 検定/GSADF (PSY, 2015)</a>
<ul>
<li class="chapter" data-level="A.2.1" data-path="バブル-生成崩壊-検出.html"><a href="バブル-生成崩壊-検出.html#数理ファイナンス-jarrow-protterら"><i class="fa fa-check"></i><b>A.2.1</b> 数理ファイナンス (Jarrow, Protterら)</a></li>
<li class="chapter" data-level="A.2.2" data-path="バブル-生成崩壊-検出.html"><a href="バブル-生成崩壊-検出.html#経済物理学-sornetteら"><i class="fa fa-check"></i><b>A.2.2</b> 経済物理学 (Sornetteら)</a></li>
</ul></li>
<li class="chapter" data-level="A.3" data-path="バブル-生成崩壊-検出.html"><a href="バブル-生成崩壊-検出.html#実証分析"><i class="fa fa-check"></i><b>A.3</b> 実証分析</a>
<ul>
<li class="chapter" data-level="" data-path="バブル-生成崩壊-検出.html"><a href="バブル-生成崩壊-検出.html#株式市場の例"><i class="fa fa-check"></i>株式市場の例</a></li>
<li class="chapter" data-level="" data-path="バブル-生成崩壊-検出.html"><a href="バブル-生成崩壊-検出.html#暗号資産市場の例"><i class="fa fa-check"></i>暗号資産市場の例</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="B" data-path="長期記憶過程-1.html"><a href="長期記憶過程-1.html"><i class="fa fa-check"></i><b>B</b> 長期記憶過程</a>
<ul>
<li class="chapter" data-level="B.1" data-path="長期記憶過程-1.html"><a href="長期記憶過程-1.html#理論概説"><i class="fa fa-check"></i><b>B.1</b> 理論・概説</a></li>
<li class="chapter" data-level="B.2" data-path="長期記憶過程-1.html"><a href="長期記憶過程-1.html#株式市場"><i class="fa fa-check"></i><b>B.2</b> 株式市場</a></li>
<li class="chapter" data-level="B.3" data-path="長期記憶過程-1.html"><a href="長期記憶過程-1.html#外国為替市場"><i class="fa fa-check"></i><b>B.3</b> 外国為替市場</a></li>
<li class="chapter" data-level="B.4" data-path="長期記憶過程-1.html"><a href="長期記憶過程-1.html#コモディティ暗号資産"><i class="fa fa-check"></i><b>B.4</b> コモディティ・暗号資産</a></li>
<li class="chapter" data-level="B.5" data-path="長期記憶過程-1.html"><a href="長期記憶過程-1.html#vix"><i class="fa fa-check"></i><b>B.5</b> VIX</a></li>
<li class="chapter" data-level="B.6" data-path="長期記憶過程-1.html"><a href="長期記憶過程-1.html#高頻度データ-ボラティリティ-注文フロー等"><i class="fa fa-check"></i><b>B.6</b> 高頻度データ (ボラティリティ, 注文フロー等)</a></li>
<li class="chapter" data-level="B.7" data-path="長期記憶過程-1.html"><a href="長期記憶過程-1.html#長期記憶性の発生要因-非長期記憶モデルによる近似"><i class="fa fa-check"></i><b>B.7</b> 長期記憶性の発生要因, 非長期記憶モデルによる近似</a></li>
</ul></li>
<li class="chapter" data-level="C" data-path="markov-switching-regime-switchingモデル.html"><a href="markov-switching-regime-switchingモデル.html"><i class="fa fa-check"></i><b>C</b> Markov switching/ regime switchingモデル</a>
<ul>
<li class="chapter" data-level="C.1" data-path="markov-switching-regime-switchingモデル.html"><a href="markov-switching-regime-switchingモデル.html#理論概説-1"><i class="fa fa-check"></i><b>C.1</b> 理論・概説</a></li>
<li class="chapter" data-level="C.2" data-path="markov-switching-regime-switchingモデル.html"><a href="markov-switching-regime-switchingモデル.html#株式市場-1"><i class="fa fa-check"></i><b>C.2</b> 株式市場</a></li>
<li class="chapter" data-level="C.3" data-path="markov-switching-regime-switchingモデル.html"><a href="markov-switching-regime-switchingモデル.html#金利債券市場"><i class="fa fa-check"></i><b>C.3</b> 金利・債券市場</a></li>
<li class="chapter" data-level="C.4" data-path="markov-switching-regime-switchingモデル.html"><a href="markov-switching-regime-switchingモデル.html#外国為替市場-1"><i class="fa fa-check"></i><b>C.4</b> 外国為替市場</a></li>
<li class="chapter" data-level="C.5" data-path="markov-switching-regime-switchingモデル.html"><a href="markov-switching-regime-switchingモデル.html#アセットアロケーション"><i class="fa fa-check"></i><b>C.5</b> アセット・アロケーション</a></li>
</ul></li>
<li class="chapter" data-level="D" data-path="archgarchモデル.html"><a href="archgarchモデル.html"><i class="fa fa-check"></i><b>D</b> ARCH/GARCHモデル</a>
<ul>
<li class="chapter" data-level="D.1" data-path="archgarchモデル.html"><a href="archgarchモデル.html#概説"><i class="fa fa-check"></i><b>D.1</b> 概説</a></li>
<li class="chapter" data-level="D.2" data-path="archgarchモデル.html"><a href="archgarchモデル.html#arch-model"><i class="fa fa-check"></i><b>D.2</b> ARCH model</a></li>
<li class="chapter" data-level="D.3" data-path="archgarchモデル.html"><a href="archgarchモデル.html#garch-model"><i class="fa fa-check"></i><b>D.3</b> GARCH model</a></li>
<li class="chapter" data-level="D.4" data-path="archgarchモデル.html"><a href="archgarchモデル.html#arch-m-model"><i class="fa fa-check"></i><b>D.4</b> ARCH-M Model</a></li>
<li class="chapter" data-level="D.5" data-path="archgarchモデル.html"><a href="archgarchモデル.html#gjr-model"><i class="fa fa-check"></i><b>D.5</b> GJR model</a></li>
<li class="chapter" data-level="D.6" data-path="archgarchモデル.html"><a href="archgarchモデル.html#aparch-model"><i class="fa fa-check"></i><b>D.6</b> APARCH model</a></li>
</ul></li>
<li class="chapter" data-level="E" data-path="共和分-誤差修正モデル.html"><a href="共和分-誤差修正モデル.html"><i class="fa fa-check"></i><b>E</b> 共和分/ 誤差修正モデル</a>
<ul>
<li class="chapter" data-level="E.1" data-path="共和分-誤差修正モデル.html"><a href="共和分-誤差修正モデル.html#株式市場とマクロ変数-国際株式市場間の分析"><i class="fa fa-check"></i><b>E.1</b> 株式市場とマクロ変数, 国際株式市場間の分析</a></li>
<li class="chapter" data-level="E.2" data-path="共和分-誤差修正モデル.html"><a href="共和分-誤差修正モデル.html#個別株式の複数取引所株価間の分析"><i class="fa fa-check"></i><b>E.2</b> 個別株式の複数取引所株価間の分析</a></li>
<li class="chapter" data-level="E.3" data-path="共和分-誤差修正モデル.html"><a href="共和分-誤差修正モデル.html#高頻度データ-bidask価格-の分析"><i class="fa fa-check"></i><b>E.3</b> 高頻度データ (bid/ask価格) の分析</a></li>
<li class="chapter" data-level="E.4" data-path="共和分-誤差修正モデル.html"><a href="共和分-誤差修正モデル.html#統計的アービトラージ-ペアトレード"><i class="fa fa-check"></i><b>E.4</b> 統計的アービトラージ / ペアトレード</a></li>
<li class="chapter" data-level="E.5" data-path="共和分-誤差修正モデル.html"><a href="共和分-誤差修正モデル.html#国際株式市場間のヘッジ"><i class="fa fa-check"></i><b>E.5</b> 国際株式市場間のヘッジ</a></li>
<li class="chapter" data-level="E.6" data-path="共和分-誤差修正モデル.html"><a href="共和分-誤差修正モデル.html#クレジットスプレッド-株式-cds-債券-の分析"><i class="fa fa-check"></i><b>E.6</b> クレジット・スプレッド (株式, CDS, 債券) の分析</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">金融時系列解析</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="varモデル" class="section level1 hasAnchor" number="9">
<h1><span class="header-section-number">9</span> VARモデル<a href="varモデル.html#varモデル" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="varモデル-1" class="section level2 hasAnchor" number="9.1">
<h2><span class="header-section-number">9.1</span> VARモデル<a href="varモデル.html#varモデル-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>以下では, <strong>MTS</strong>パッケージ, <strong>vars</strong>パッケージを利用
<ul>
<li><a href="https://www.rdocumentation.org/packages/MTS/versions/1.0" class="uri">https://www.rdocumentation.org/packages/MTS/versions/1.0</a></li>
<li><a href="https://www.rdocumentation.org/packages/vars/versions/1.5-3" class="uri">https://www.rdocumentation.org/packages/vars/versions/1.5-3</a></li>
</ul></li>
</ul>
<div id="varpモデルのシミュレーション" class="section level3 hasAnchor" number="9.1.1">
<h3><span class="header-section-number">9.1.1</span> VAR(<span class="math inline">\(p\)</span>)モデルのシミュレーション<a href="varモデル.html#varpモデルのシミュレーション" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>MTS::VARMAsim()関数 (VARMA(<span class="math inline">\(p,q\)</span>)モデルのパス生成)</p></li>
<li><p>VAR(2)モデル例:
<span class="math display">\[Y_{1,t}=0.3 + 0.2 Y_{1,t-1} + 0.3 Y_{2,t-1} - 0.5 Y_{1,t-2} (+0 \cdot Y_{2,t-2}) + \epsilon_{1,t}\]</span>
<span class="math display">\[Y_{2,t}=-0.3  -0.6 Y_{1,t-1} + 1.1 Y_{2,t-1} (+0 \cdot Y_{1,t-2}) - 0.6 Y_{2,t-2} + \epsilon_{2,t}\]</span>
<span class="math display">\[ \left[
  \begin{array}{r}
    \epsilon_{1,t} \\ \epsilon_{2,t}
  \end{array}
\right] \sim_{\it i.i.d.} N \Big(\left[
  \begin{array}{r}
    0 \\ 0
  \end{array}
\right], \left[
  \begin{array}{rr}
    4 &amp; 0.8 \\ 0.8 &amp; 1
  \end{array}
\right]\Big) \]</span></p></li>
<li><p>上記VAR(2)モデルのサンプルパスの生成</p></li>
</ul>
<div class="sourceCode" id="cb518"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb518-1"><a href="varモデル.html#cb518-1" tabindex="-1"></a><span class="fu">library</span>(MTS)</span>
<span id="cb518-2"><a href="varモデル.html#cb518-2" tabindex="-1"></a>Nlen <span class="ot">&lt;-</span> <span class="dv">300</span></span>
<span id="cb518-3"><a href="varモデル.html#cb518-3" tabindex="-1"></a>Seedv <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb518-4"><a href="varモデル.html#cb518-4" tabindex="-1"></a><span class="fu">set.seed</span>(Seedv)</span>
<span id="cb518-5"><a href="varモデル.html#cb518-5" tabindex="-1"></a>p0 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.3</span>, <span class="sc">-</span><span class="fl">0.3</span>)              <span class="co"># Phi0 (定数項)</span></span>
<span id="cb518-6"><a href="varモデル.html#cb518-6" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fl">0.2</span>, <span class="sc">-</span><span class="fl">0.6</span>, <span class="fl">0.3</span>, <span class="fl">1.1</span>), <span class="dv">2</span>, <span class="dv">2</span>)  <span class="co"># Phi1 (ラグ1のVAR係数行列)</span></span>
<span id="cb518-7"><a href="varモデル.html#cb518-7" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.5</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="sc">-</span><span class="fl">0.6</span>), <span class="dv">2</span>, <span class="dv">2</span>)         <span class="co"># Phi2 (ラグ2のVAR係数行列)</span></span>
<span id="cb518-8"><a href="varモデル.html#cb518-8" tabindex="-1"></a>Pmat <span class="ot">&lt;-</span> <span class="fu">cbind</span>(p1, p2)                       <span class="co"># VAR係数行列を重ねた行列</span></span>
<span id="cb518-9"><a href="varモデル.html#cb518-9" tabindex="-1"></a>Sig <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">4</span>, <span class="fl">0.8</span>, <span class="fl">0.8</span>, <span class="dv">1</span>), <span class="dv">2</span>, <span class="dv">2</span>)      <span class="co"># イノベーションの分散共分散行列 (正値定符号)</span></span>
<span id="cb518-10"><a href="varモデル.html#cb518-10" tabindex="-1"></a>Pmat; Sig</span>
<span id="cb518-11"><a href="varモデル.html#cb518-11" tabindex="-1"></a><span class="do">##      [,1] [,2] [,3] [,4]</span></span>
<span id="cb518-12"><a href="varモデル.html#cb518-12" tabindex="-1"></a><span class="do">## [1,]  0.2  0.3 -0.5  0.0</span></span>
<span id="cb518-13"><a href="varモデル.html#cb518-13" tabindex="-1"></a><span class="do">## [2,] -0.6  1.1  0.0 -0.6</span></span>
<span id="cb518-14"><a href="varモデル.html#cb518-14" tabindex="-1"></a><span class="do">##      [,1] [,2]</span></span>
<span id="cb518-15"><a href="varモデル.html#cb518-15" tabindex="-1"></a><span class="do">## [1,]  4.0  0.8</span></span>
<span id="cb518-16"><a href="varモデル.html#cb518-16" tabindex="-1"></a><span class="do">## [2,]  0.8  1.0</span></span>
<span id="cb518-17"><a href="varモデル.html#cb518-17" tabindex="-1"></a>ysim <span class="ot">&lt;-</span> <span class="fu">VARMAsim</span>(Nlen, <span class="at">arlags =</span> <span class="dv">2</span>, <span class="at">cnst =</span> p0, <span class="at">phi =</span> Pmat, <span class="at">sigma =</span> Sig)</span>
<span id="cb518-18"><a href="varモデル.html#cb518-18" tabindex="-1"></a>Yt <span class="ot">&lt;-</span> ysim<span class="sc">$</span>series</span>
<span id="cb518-19"><a href="varモデル.html#cb518-19" tabindex="-1"></a><span class="fu">MTSplot</span>(Yt)　<span class="co"># 時系列プロット</span></span></code></pre></div>
<p><img src="090-VAR_files/figure-html/VARsim_12-1.png" width="75%" /></p>
<ul>
<li>生成パス<span class="math inline">\(y_t\)</span>の標本自己共分散行列
<ul>
<li>対角成分: 各成分の自己相関 <span class="math inline">\(\hat{\rho}_1(h), \hat{\rho}_2(h)\)</span></li>
<li>非対角成分: <span class="math inline">\(y^1_t,y^2_t\)</span>間のクロス相関
<ul>
<li>行列の(1,2)成分: <span class="math inline">\(\hat{\rho}_{1,2}(h),\,h\ge0\)</span></li>
<li>行列の(2,1)成分: <span class="math inline">\(\hat{\rho}_{1,2}(h)\equiv\hat{\rho}_{2,1}(-h), \,h\le0\)</span></li>
</ul></li>
</ul></li>
</ul>
<div class="sourceCode" id="cb519"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb519-1"><a href="varモデル.html#cb519-1" tabindex="-1"></a><span class="fu">acf</span>(Yt)　　　<span class="co"># 標本自己共分散行列 (2x2-行列)</span></span></code></pre></div>
<p><img src="090-VAR_files/figure-html/unnamed-chunk-1-1.png" width="75%" /></p>
<div class="sourceCode" id="cb520"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb520-1"><a href="varモデル.html#cb520-1" tabindex="-1"></a><span class="co"># acf()の出力結果の非対角成分の確認</span></span>
<span id="cb520-2"><a href="varモデル.html#cb520-2" tabindex="-1"></a><span class="co"># cor(Y1(t+h), Y2(t))</span></span>
<span id="cb520-3"><a href="varモデル.html#cb520-3" tabindex="-1"></a><span class="co"># h&gt;0</span></span>
<span id="cb520-4"><a href="varモデル.html#cb520-4" tabindex="-1"></a><span class="fu">cor</span>(Yt[<span class="dv">2</span><span class="sc">:</span>Nlen, <span class="dv">1</span>], Yt[<span class="dv">1</span><span class="sc">:</span>(Nlen<span class="dv">-1</span>), <span class="dv">2</span>]) <span class="co"># Y1(t+1) vs Y2(t)</span></span>
<span id="cb520-5"><a href="varモデル.html#cb520-5" tabindex="-1"></a><span class="do">## [1] -0.2491788</span></span>
<span id="cb520-6"><a href="varモデル.html#cb520-6" tabindex="-1"></a><span class="fu">cor</span>(Yt[<span class="dv">3</span><span class="sc">:</span>Nlen, <span class="dv">1</span>], Yt[<span class="dv">1</span><span class="sc">:</span>(Nlen<span class="dv">-2</span>), <span class="dv">2</span>]) <span class="co"># Y1(t+2) vs Y2(t)</span></span>
<span id="cb520-7"><a href="varモデル.html#cb520-7" tabindex="-1"></a><span class="do">## [1] 0.5855889</span></span>
<span id="cb520-8"><a href="varモデル.html#cb520-8" tabindex="-1"></a><span class="co"># h&lt;0</span></span>
<span id="cb520-9"><a href="varモデル.html#cb520-9" tabindex="-1"></a><span class="fu">cor</span>(Yt[<span class="dv">1</span><span class="sc">:</span>(Nlen<span class="dv">-1</span>), <span class="dv">1</span>], Yt[<span class="dv">2</span><span class="sc">:</span>Nlen, <span class="dv">2</span>]) <span class="co"># Y1(t) vs Y2(t+1)</span></span>
<span id="cb520-10"><a href="varモデル.html#cb520-10" tabindex="-1"></a><span class="do">## [1] -0.2269957</span></span>
<span id="cb520-11"><a href="varモデル.html#cb520-11" tabindex="-1"></a><span class="fu">cor</span>(Yt[<span class="dv">1</span><span class="sc">:</span>(Nlen<span class="dv">-2</span>), <span class="dv">1</span>], Yt[<span class="dv">3</span><span class="sc">:</span>Nlen, <span class="dv">2</span>]) <span class="co"># y1(t) vs Y2(t+2)</span></span>
<span id="cb520-12"><a href="varモデル.html#cb520-12" tabindex="-1"></a><span class="do">## [1] 0.2156902</span></span></code></pre></div>
</div>
<div id="varpモデルの次数同定" class="section level3 hasAnchor" number="9.1.2">
<h3><span class="header-section-number">9.1.2</span> VAR(<span class="math inline">\(p\)</span>)モデルの次数同定<a href="varモデル.html#varpモデルの次数同定" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>分析者による最適なラグ次数の選択を支援</li>
</ul>
<pre><code>- MTS::VARorder()関数
  - maxp: ラグ次数の最大値 (デフォルト=13)
  - 出力: BIC, HQ (Hannan and Quinn情報量規準), M(p), p-value (カイ二乗検定統計量 &amp; p値)</code></pre>
<div class="sourceCode" id="cb522"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb522-1"><a href="varモデル.html#cb522-1" tabindex="-1"></a><span class="fu">VARorder</span>(Yt, <span class="at">maxp =</span> <span class="dv">10</span>, <span class="at">output =</span> T)</span>
<span id="cb522-2"><a href="varモデル.html#cb522-2" tabindex="-1"></a><span class="do">## selected order: aic =  2 </span></span>
<span id="cb522-3"><a href="varモデル.html#cb522-3" tabindex="-1"></a><span class="do">## selected order: bic =  2 </span></span>
<span id="cb522-4"><a href="varモデル.html#cb522-4" tabindex="-1"></a><span class="do">## selected order: hq =  2 </span></span>
<span id="cb522-5"><a href="varモデル.html#cb522-5" tabindex="-1"></a><span class="do">## Summary table:  </span></span>
<span id="cb522-6"><a href="varモデル.html#cb522-6" tabindex="-1"></a><span class="do">##        p    AIC    BIC     HQ     M(p) p-value</span></span>
<span id="cb522-7"><a href="varモデル.html#cb522-7" tabindex="-1"></a><span class="do">##  [1,]  0 4.2159 4.2159 4.2159   0.0000  0.0000</span></span>
<span id="cb522-8"><a href="varモデル.html#cb522-8" tabindex="-1"></a><span class="do">##  [2,]  1 3.8924 3.9418 3.9122 100.3170  0.0000</span></span>
<span id="cb522-9"><a href="varモデル.html#cb522-9" tabindex="-1"></a><span class="do">##  [3,]  2 1.5169 1.6157 1.5564 683.4158  0.0000</span></span>
<span id="cb522-10"><a href="varモデル.html#cb522-10" tabindex="-1"></a><span class="do">##  [4,]  3 1.5299 1.6781 1.5892   3.8619  0.4250</span></span>
<span id="cb522-11"><a href="varモデル.html#cb522-11" tabindex="-1"></a><span class="do">##  [5,]  4 1.5434 1.7409 1.6224   3.6978  0.4484</span></span>
<span id="cb522-12"><a href="varモデル.html#cb522-12" tabindex="-1"></a><span class="do">##  [6,]  5 1.5325 1.7794 1.6313  10.4626  0.0333</span></span>
<span id="cb522-13"><a href="varモデル.html#cb522-13" tabindex="-1"></a><span class="do">##  [7,]  6 1.5548 1.8511 1.6734   1.2025  0.8777</span></span>
<span id="cb522-14"><a href="varモデル.html#cb522-14" tabindex="-1"></a><span class="do">##  [8,]  7 1.5575 1.9032 1.6958   6.5850  0.1595</span></span>
<span id="cb522-15"><a href="varモデル.html#cb522-15" tabindex="-1"></a><span class="do">##  [9,]  8 1.5799 1.9750 1.7381   1.1470  0.8867</span></span>
<span id="cb522-16"><a href="varモデル.html#cb522-16" tabindex="-1"></a><span class="do">## [10,]  9 1.5896 2.0340 1.7674   4.6092  0.3298</span></span>
<span id="cb522-17"><a href="varモデル.html#cb522-17" tabindex="-1"></a><span class="do">## [11,] 10 1.6099 2.1037 1.8075   1.7109  0.7887</span></span></code></pre></div>
<pre><code>- vars::VARselect()関数
  - lag.max: ラグ次数の最大値 (デフォルト=10)
  - type: 確定的な(定数・トレンド)項の種類
    &quot;const&quot;(定数項有), &quot;trend&quot;(トレンド有), &quot;both&quot;(定数項・トレンド共有), &quot;none&quot;(両方無)
  - 出力: AIC, HQ, SC (Schwarz情報量規準), FPE (forecast prediction error)</code></pre>
<div class="sourceCode" id="cb524"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb524-1"><a href="varモデル.html#cb524-1" tabindex="-1"></a><span class="fu">library</span>(vars)</span>
<span id="cb524-2"><a href="varモデル.html#cb524-2" tabindex="-1"></a>vars<span class="sc">::</span><span class="fu">VARselect</span>(Yt, <span class="at">lag.max =</span> <span class="dv">10</span>, <span class="at">type =</span> <span class="st">&quot;const&quot;</span>)</span>
<span id="cb524-3"><a href="varモデル.html#cb524-3" tabindex="-1"></a><span class="do">## $selection</span></span>
<span id="cb524-4"><a href="varモデル.html#cb524-4" tabindex="-1"></a><span class="do">## AIC(n)  HQ(n)  SC(n) FPE(n) </span></span>
<span id="cb524-5"><a href="varモデル.html#cb524-5" tabindex="-1"></a><span class="do">##      2      2      2      2 </span></span>
<span id="cb524-6"><a href="varモデル.html#cb524-6" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb524-7"><a href="varモデル.html#cb524-7" tabindex="-1"></a><span class="do">## $criteria</span></span>
<span id="cb524-8"><a href="varモデル.html#cb524-8" tabindex="-1"></a><span class="do">##                1        2        3        4        5        6        7        8</span></span>
<span id="cb524-9"><a href="varモデル.html#cb524-9" tabindex="-1"></a><span class="do">## AIC(n)  3.907125 1.532547 1.546463 1.560866 1.550885 1.574122 1.577719 1.601096</span></span>
<span id="cb524-10"><a href="varモデル.html#cb524-10" tabindex="-1"></a><span class="do">## HQ(n)   3.937546 1.583248 1.617444 1.652128 1.662427 1.705945 1.729823 1.773480</span></span>
<span id="cb524-11"><a href="varモデル.html#cb524-11" tabindex="-1"></a><span class="do">## SC(n)   3.983054 1.659094 1.723629 1.788652 1.829289 1.903146 1.957362 2.031358</span></span>
<span id="cb524-12"><a href="varモデル.html#cb524-12" tabindex="-1"></a><span class="do">## FPE(n) 49.755778 4.629985 4.694921 4.763133 4.715983 4.827081 4.844789 4.959798</span></span>
<span id="cb524-13"><a href="varモデル.html#cb524-13" tabindex="-1"></a><span class="do">##               9       10</span></span>
<span id="cb524-14"><a href="varモデル.html#cb524-14" tabindex="-1"></a><span class="do">## AIC(n) 1.611643 1.632857</span></span>
<span id="cb524-15"><a href="varモデル.html#cb524-15" tabindex="-1"></a><span class="do">## HQ(n)  1.804307 1.845802</span></span>
<span id="cb524-16"><a href="varモデル.html#cb524-16" tabindex="-1"></a><span class="do">## SC(n)  2.092524 2.164357</span></span>
<span id="cb524-17"><a href="varモデル.html#cb524-17" tabindex="-1"></a><span class="do">## FPE(n) 5.012920 5.121076</span></span></code></pre></div>
<!--
"In statistics, the Bayesian information criterion (BIC) or Schwarz information criterion (also SIC, SBC, SBIC) is a criterion for model selection ..." (wiki)
- パッケージ**vars**の用法: https://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=&ved=2ahUKEwjZ5trv742DAxXHr1YBHcPVBrkQFnoECA0QAQ&url=https%3A%2F%2Fwww.researchgate.net%2Fprofile%2FDavid-Booth-7%2Fpost%2FHow_to_select_optimal_lag_between_dependent_variable_and_independent_variables%2Fattachment%2F59d649eb79197b80779a450a%2FAS%253A473055043559424%25401489796519099%2Fdownload%2FVARS_how_to_use.pdf&usg=AOvVaw0WQ5jq3ZBjvAgOHYlLtqv3&opi=89978449
-->
</div>
<div id="varpモデルの推定" class="section level3 hasAnchor" number="9.1.3">
<h3><span class="header-section-number">9.1.3</span> VAR(<span class="math inline">\(p\)</span>)モデルの推定<a href="varモデル.html#varpモデルの推定" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>最小2乗法によるパラメータ推定</li>
</ul>
<pre><code>- MTS::VAR()関数
  - p: ラグ次数
  - include.mean: 平均ベクトルを加える(推定する)か (デフォルト=T)
  - fixed: パラメータに制約を付与する論理値行列. 制約付推定 (主に有意でない推定値の除去) に使用</code></pre>
<div class="sourceCode" id="cb526"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb526-1"><a href="varモデル.html#cb526-1" tabindex="-1"></a>est.VAR1 <span class="ot">&lt;-</span> MTS<span class="sc">::</span><span class="fu">VAR</span>(Yt, <span class="at">p =</span> <span class="dv">2</span>, <span class="at">output =</span> T, <span class="at">include.mean =</span> T, <span class="at">fixed =</span> <span class="cn">NULL</span>) </span>
<span id="cb526-2"><a href="varモデル.html#cb526-2" tabindex="-1"></a><span class="do">## Constant term: </span></span>
<span id="cb526-3"><a href="varモデル.html#cb526-3" tabindex="-1"></a><span class="do">## Estimates:  0.7010694 -0.4390955 </span></span>
<span id="cb526-4"><a href="varモデル.html#cb526-4" tabindex="-1"></a><span class="do">## Std.Error:  0.2935926 0.1458662 </span></span>
<span id="cb526-5"><a href="varモデル.html#cb526-5" tabindex="-1"></a><span class="do">## AR coefficient matrix </span></span>
<span id="cb526-6"><a href="varモデル.html#cb526-6" tabindex="-1"></a><span class="do">## AR( 1 )-matrix </span></span>
<span id="cb526-7"><a href="varモデル.html#cb526-7" tabindex="-1"></a><span class="do">##         [,1]    [,2]</span></span>
<span id="cb526-8"><a href="varモデル.html#cb526-8" tabindex="-1"></a><span class="do">## [1,] -0.0928  0.0954</span></span>
<span id="cb526-9"><a href="varモデル.html#cb526-9" tabindex="-1"></a><span class="do">## [2,] -0.0197 -0.0286</span></span>
<span id="cb526-10"><a href="varモデル.html#cb526-10" tabindex="-1"></a><span class="do">## standard error </span></span>
<span id="cb526-11"><a href="varモデル.html#cb526-11" tabindex="-1"></a><span class="do">##        [,1]   [,2]</span></span>
<span id="cb526-12"><a href="varモデル.html#cb526-12" tabindex="-1"></a><span class="do">## [1,] 0.0575 0.0462</span></span>
<span id="cb526-13"><a href="varモデル.html#cb526-13" tabindex="-1"></a><span class="do">## [2,] 0.0286 0.0230</span></span>
<span id="cb526-14"><a href="varモデル.html#cb526-14" tabindex="-1"></a><span class="do">## AR( 2 )-matrix </span></span>
<span id="cb526-15"><a href="varモデル.html#cb526-15" tabindex="-1"></a><span class="do">##        [,1]  [,2]</span></span>
<span id="cb526-16"><a href="varモデル.html#cb526-16" tabindex="-1"></a><span class="do">## [1,]  0.105 0.402</span></span>
<span id="cb526-17"><a href="varモデル.html#cb526-17" tabindex="-1"></a><span class="do">## [2,] -0.616 1.117</span></span>
<span id="cb526-18"><a href="varモデル.html#cb526-18" tabindex="-1"></a><span class="do">## standard error </span></span>
<span id="cb526-19"><a href="varモデル.html#cb526-19" tabindex="-1"></a><span class="do">##        [,1]   [,2]</span></span>
<span id="cb526-20"><a href="varモデル.html#cb526-20" tabindex="-1"></a><span class="do">## [1,] 0.0575 0.0465</span></span>
<span id="cb526-21"><a href="varモデル.html#cb526-21" tabindex="-1"></a><span class="do">## [2,] 0.0285 0.0231</span></span>
<span id="cb526-22"><a href="varモデル.html#cb526-22" tabindex="-1"></a><span class="do">##   </span></span>
<span id="cb526-23"><a href="varモデル.html#cb526-23" tabindex="-1"></a><span class="do">## Residuals cov-mtx: </span></span>
<span id="cb526-24"><a href="varモデル.html#cb526-24" tabindex="-1"></a><span class="do">##           [,1]      [,2]</span></span>
<span id="cb526-25"><a href="varモデル.html#cb526-25" tabindex="-1"></a><span class="do">## [1,] 4.4990390 0.8786783</span></span>
<span id="cb526-26"><a href="varモデル.html#cb526-26" tabindex="-1"></a><span class="do">## [2,] 0.8786783 1.1105526</span></span>
<span id="cb526-27"><a href="varモデル.html#cb526-27" tabindex="-1"></a><span class="do">##   </span></span>
<span id="cb526-28"><a href="varモデル.html#cb526-28" tabindex="-1"></a><span class="do">## det(SSE) =  4.224344 </span></span>
<span id="cb526-29"><a href="varモデル.html#cb526-29" tabindex="-1"></a><span class="do">## AIC =  1.494197 </span></span>
<span id="cb526-30"><a href="varモデル.html#cb526-30" tabindex="-1"></a><span class="do">## BIC =  1.592965 </span></span>
<span id="cb526-31"><a href="varモデル.html#cb526-31" tabindex="-1"></a><span class="do">## HQ  =  1.533724</span></span></code></pre></div>
<pre><code>- vars::VAR()関数
  - p: ラグ次数
  - type: 確定的な(定数・トレンド)項の種類
    &quot;const&quot;(定数項有), &quot;trend&quot;(トレンド有), &quot;both&quot;(定数項・トレンド共有), &quot;none&quot;(両方無)
  - season: 中心化済の季節性ダミー変数の追加 (frequencyを表す整数を指定)
  - exogen: 外生変数の追加
  - lag.max: ラグ次数の最大値 (ラグ次数選択において)
  - in: 情報量規準 (lag.maxを指定している場合)</code></pre>
<!-- 8/26/22時点: Build Book時, 以下でエラー発生(→解決済)
- Error in match.fun(FUN) : object 'stdev' not found -->
<div class="sourceCode" id="cb528"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb528-1"><a href="varモデル.html#cb528-1" tabindex="-1"></a>est.VAR2 <span class="ot">&lt;-</span> vars<span class="sc">::</span><span class="fu">VAR</span>(Yt, <span class="at">p =</span> <span class="dv">2</span>, <span class="at">type =</span> <span class="st">&quot;const&quot;</span>)    </span>
<span id="cb528-2"><a href="varモデル.html#cb528-2" tabindex="-1"></a><span class="co"># 最小2乗法によるパラメータ推定</span></span>
<span id="cb528-3"><a href="varモデル.html#cb528-3" tabindex="-1"></a><span class="co"># type: &quot;const&quot;(定数項有), trend:(&quot;トレンド有&quot;), &quot;both&quot;, &quot;none&quot;</span></span>
<span id="cb528-4"><a href="varモデル.html#cb528-4" tabindex="-1"></a><span class="fu">summary</span>(est.VAR2)</span>
<span id="cb528-5"><a href="varモデル.html#cb528-5" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb528-6"><a href="varモデル.html#cb528-6" tabindex="-1"></a><span class="do">## VAR Estimation Results:</span></span>
<span id="cb528-7"><a href="varモデル.html#cb528-7" tabindex="-1"></a><span class="do">## ========================= </span></span>
<span id="cb528-8"><a href="varモデル.html#cb528-8" tabindex="-1"></a><span class="do">## Endogenous variables: y1, y2 </span></span>
<span id="cb528-9"><a href="varモデル.html#cb528-9" tabindex="-1"></a><span class="do">## Deterministic variables: const </span></span>
<span id="cb528-10"><a href="varモデル.html#cb528-10" tabindex="-1"></a><span class="do">## Sample size: 298 </span></span>
<span id="cb528-11"><a href="varモデル.html#cb528-11" tabindex="-1"></a><span class="do">## Log Likelihood: -1060.376 </span></span>
<span id="cb528-12"><a href="varモデル.html#cb528-12" tabindex="-1"></a><span class="do">## Roots of the characteristic polynomial:</span></span>
<span id="cb528-13"><a href="varモデル.html#cb528-13" tabindex="-1"></a><span class="do">## 0.9308 0.7541 0.7541 0.6891</span></span>
<span id="cb528-14"><a href="varモデル.html#cb528-14" tabindex="-1"></a><span class="do">## Call:</span></span>
<span id="cb528-15"><a href="varモデル.html#cb528-15" tabindex="-1"></a><span class="do">## vars::VAR(y = Yt, p = 2, type = &quot;const&quot;)</span></span>
<span id="cb528-16"><a href="varモデル.html#cb528-16" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb528-17"><a href="varモデル.html#cb528-17" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb528-18"><a href="varモデル.html#cb528-18" tabindex="-1"></a><span class="do">## Estimation results for equation y1: </span></span>
<span id="cb528-19"><a href="varモデル.html#cb528-19" tabindex="-1"></a><span class="do">## =================================== </span></span>
<span id="cb528-20"><a href="varモデル.html#cb528-20" tabindex="-1"></a><span class="do">## y1 = y1.l1 + y2.l1 + y1.l2 + y2.l2 + const </span></span>
<span id="cb528-21"><a href="varモデル.html#cb528-21" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb528-22"><a href="varモデル.html#cb528-22" tabindex="-1"></a><span class="do">##       Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb528-23"><a href="varモデル.html#cb528-23" tabindex="-1"></a><span class="do">## y1.l1 -0.09285    0.05751  -1.614   0.1075    </span></span>
<span id="cb528-24"><a href="varモデル.html#cb528-24" tabindex="-1"></a><span class="do">## y2.l1  0.09536    0.04624   2.062   0.0401 *  </span></span>
<span id="cb528-25"><a href="varモデル.html#cb528-25" tabindex="-1"></a><span class="do">## y1.l2  0.10498    0.05745   1.827   0.0687 .  </span></span>
<span id="cb528-26"><a href="varモデル.html#cb528-26" tabindex="-1"></a><span class="do">## y2.l2  0.40175    0.04645   8.648 3.49e-16 ***</span></span>
<span id="cb528-27"><a href="varモデル.html#cb528-27" tabindex="-1"></a><span class="do">## const  0.70107    0.29359   2.388   0.0176 *  </span></span>
<span id="cb528-28"><a href="varモデル.html#cb528-28" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb528-29"><a href="varモデル.html#cb528-29" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb528-30"><a href="varモデル.html#cb528-30" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb528-31"><a href="varモデル.html#cb528-31" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb528-32"><a href="varモデル.html#cb528-32" tabindex="-1"></a><span class="do">## Residual standard error: 2.139 on 293 degrees of freedom</span></span>
<span id="cb528-33"><a href="varモデル.html#cb528-33" tabindex="-1"></a><span class="do">## Multiple R-Squared: 0.3636,  Adjusted R-squared: 0.3549 </span></span>
<span id="cb528-34"><a href="varモデル.html#cb528-34" tabindex="-1"></a><span class="do">## F-statistic: 41.86 on 4 and 293 DF,  p-value: &lt; 2.2e-16 </span></span>
<span id="cb528-35"><a href="varモデル.html#cb528-35" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb528-36"><a href="varモデル.html#cb528-36" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb528-37"><a href="varモデル.html#cb528-37" tabindex="-1"></a><span class="do">## Estimation results for equation y2: </span></span>
<span id="cb528-38"><a href="varモデル.html#cb528-38" tabindex="-1"></a><span class="do">## =================================== </span></span>
<span id="cb528-39"><a href="varモデル.html#cb528-39" tabindex="-1"></a><span class="do">## y2 = y1.l1 + y2.l1 + y1.l2 + y2.l2 + const </span></span>
<span id="cb528-40"><a href="varモデル.html#cb528-40" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb528-41"><a href="varモデル.html#cb528-41" tabindex="-1"></a><span class="do">##       Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb528-42"><a href="varモデル.html#cb528-42" tabindex="-1"></a><span class="do">## y1.l1 -0.01967    0.02857  -0.688  0.49185    </span></span>
<span id="cb528-43"><a href="varモデル.html#cb528-43" tabindex="-1"></a><span class="do">## y2.l1 -0.02859    0.02297  -1.244  0.21435    </span></span>
<span id="cb528-44"><a href="varモデル.html#cb528-44" tabindex="-1"></a><span class="do">## y1.l2 -0.61604    0.02854 -21.583  &lt; 2e-16 ***</span></span>
<span id="cb528-45"><a href="varモデル.html#cb528-45" tabindex="-1"></a><span class="do">## y2.l2  1.11695    0.02308  48.395  &lt; 2e-16 ***</span></span>
<span id="cb528-46"><a href="varモデル.html#cb528-46" tabindex="-1"></a><span class="do">## const -0.43910    0.14587  -3.010  0.00284 ** </span></span>
<span id="cb528-47"><a href="varモデル.html#cb528-47" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb528-48"><a href="varモデル.html#cb528-48" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb528-49"><a href="varモデル.html#cb528-49" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb528-50"><a href="varモデル.html#cb528-50" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb528-51"><a href="varモデル.html#cb528-51" tabindex="-1"></a><span class="do">## Residual standard error: 1.063 on 293 degrees of freedom</span></span>
<span id="cb528-52"><a href="varモデル.html#cb528-52" tabindex="-1"></a><span class="do">## Multiple R-Squared: 0.9232,  Adjusted R-squared: 0.9222 </span></span>
<span id="cb528-53"><a href="varモデル.html#cb528-53" tabindex="-1"></a><span class="do">## F-statistic: 880.9 on 4 and 293 DF,  p-value: &lt; 2.2e-16 </span></span>
<span id="cb528-54"><a href="varモデル.html#cb528-54" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb528-55"><a href="varモデル.html#cb528-55" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb528-56"><a href="varモデル.html#cb528-56" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb528-57"><a href="varモデル.html#cb528-57" tabindex="-1"></a><span class="do">## Covariance matrix of residuals:</span></span>
<span id="cb528-58"><a href="varモデル.html#cb528-58" tabindex="-1"></a><span class="do">##        y1     y2</span></span>
<span id="cb528-59"><a href="varモデル.html#cb528-59" tabindex="-1"></a><span class="do">## y1 4.5758 0.8937</span></span>
<span id="cb528-60"><a href="varモデル.html#cb528-60" tabindex="-1"></a><span class="do">## y2 0.8937 1.1295</span></span>
<span id="cb528-61"><a href="varモデル.html#cb528-61" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb528-62"><a href="varモデル.html#cb528-62" tabindex="-1"></a><span class="do">## Correlation matrix of residuals:</span></span>
<span id="cb528-63"><a href="varモデル.html#cb528-63" tabindex="-1"></a><span class="do">##        y1     y2</span></span>
<span id="cb528-64"><a href="varモデル.html#cb528-64" tabindex="-1"></a><span class="do">## y1 1.0000 0.3931</span></span>
<span id="cb528-65"><a href="varモデル.html#cb528-65" tabindex="-1"></a><span class="do">## y2 0.3931 1.0000</span></span></code></pre></div>
</div>
<div id="varpモデル予測" class="section level3 hasAnchor" number="9.1.4">
<h3><span class="header-section-number">9.1.4</span> VAR(<span class="math inline">\(p\)</span>)モデル予測<a href="varモデル.html#varpモデル予測" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<pre><code>- MTS::VARpred()関数
  - h: 予測期間の長さ
  - orig: 予測の起点 (デフォルト=0, 最終のデータ点)
  - Out.level: 出力の詳細のコントロール (T/F)</code></pre>
<div class="sourceCode" id="cb530"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb530-1"><a href="varモデル.html#cb530-1" tabindex="-1"></a>pred.VAR1 <span class="ot">=</span> <span class="fu">VARpred</span>(est.VAR1, <span class="at">h =</span> <span class="dv">20</span>, <span class="at">orig =</span> <span class="dv">0</span>, <span class="at">Out.level =</span> F, <span class="at">output =</span> T)</span>
<span id="cb530-2"><a href="varモデル.html#cb530-2" tabindex="-1"></a><span class="do">## orig  300 </span></span>
<span id="cb530-3"><a href="varモデル.html#cb530-3" tabindex="-1"></a><span class="do">## Forecasts at origin:  300 </span></span>
<span id="cb530-4"><a href="varモデル.html#cb530-4" tabindex="-1"></a><span class="do">##          [,1]   [,2]</span></span>
<span id="cb530-5"><a href="varモデル.html#cb530-5" tabindex="-1"></a><span class="do">##  [1,] -1.6935 -4.659</span></span>
<span id="cb530-6"><a href="varモデル.html#cb530-6" tabindex="-1"></a><span class="do">##  [2,] -1.5588 -2.224</span></span>
<span id="cb530-7"><a href="varモデル.html#cb530-7" tabindex="-1"></a><span class="do">##  [3,] -1.4159 -4.506</span></span>
<span id="cb530-8"><a href="varモデル.html#cb530-8" tabindex="-1"></a><span class="do">##  [4,] -0.6541 -1.806</span></span>
<span id="cb530-9"><a href="varモデル.html#cb530-9" tabindex="-1"></a><span class="do">##  [5,] -1.3692 -4.535</span></span>
<span id="cb530-10"><a href="varモデル.html#cb530-10" tabindex="-1"></a><span class="do">##  [6,] -0.3984 -1.896</span></span>
<span id="cb530-11"><a href="varモデル.html#cb530-11" tabindex="-1"></a><span class="do">##  [7,] -1.4084 -4.599</span></span>
<span id="cb530-12"><a href="varモデル.html#cb530-12" tabindex="-1"></a><span class="do">##  [8,] -0.4105 -2.153</span></span>
<span id="cb530-13"><a href="varモデル.html#cb530-13" tabindex="-1"></a><span class="do">##  [9,] -1.4616 -4.638</span></span>
<span id="cb530-14"><a href="varモデル.html#cb530-14" tabindex="-1"></a><span class="do">## [10,] -0.5135 -2.429</span></span>
<span id="cb530-15"><a href="varモデル.html#cb530-15" tabindex="-1"></a><span class="do">## [11,] -1.4999 -4.640</span></span>
<span id="cb530-16"><a href="varモデル.html#cb530-16" tabindex="-1"></a><span class="do">## [12,] -0.6321 -2.674</span></span>
<span id="cb530-17"><a href="varモデル.html#cb530-17" tabindex="-1"></a><span class="do">## [13,] -1.5169 -4.609</span></span>
<span id="cb530-18"><a href="varモデル.html#cb530-18" tabindex="-1"></a><span class="do">## [14,] -0.7383 -2.875</span></span>
<span id="cb530-19"><a href="varモデル.html#cb530-19" tabindex="-1"></a><span class="do">## [15,] -1.5155 -4.556</span></span>
<span id="cb530-20"><a href="varモデル.html#cb530-20" tabindex="-1"></a><span class="do">## [16,] -0.8252 -3.035</span></span>
<span id="cb530-21"><a href="varモデル.html#cb530-21" tabindex="-1"></a><span class="do">## [17,] -1.5012 -4.491</span></span>
<span id="cb530-22"><a href="varモデル.html#cb530-22" tabindex="-1"></a><span class="do">## [18,] -0.8939 -3.163</span></span>
<span id="cb530-23"><a href="varモデル.html#cb530-23" tabindex="-1"></a><span class="do">## [19,] -1.4795 -4.423</span></span>
<span id="cb530-24"><a href="varモデル.html#cb530-24" tabindex="-1"></a><span class="do">## [20,] -0.9480 -3.266</span></span>
<span id="cb530-25"><a href="varモデル.html#cb530-25" tabindex="-1"></a><span class="do">## Standard Errors of predictions:  </span></span>
<span id="cb530-26"><a href="varモデル.html#cb530-26" tabindex="-1"></a><span class="do">##        [,1]  [,2]</span></span>
<span id="cb530-27"><a href="varモデル.html#cb530-27" tabindex="-1"></a><span class="do">##  [1,] 2.121 1.054</span></span>
<span id="cb530-28"><a href="varモデル.html#cb530-28" tabindex="-1"></a><span class="do">##  [2,] 2.129 1.056</span></span>
<span id="cb530-29"><a href="varモデル.html#cb530-29" tabindex="-1"></a><span class="do">##  [3,] 2.199 1.729</span></span>
<span id="cb530-30"><a href="varモデル.html#cb530-30" tabindex="-1"></a><span class="do">##  [4,] 2.205 1.734</span></span>
<span id="cb530-31"><a href="varモデル.html#cb530-31" tabindex="-1"></a><span class="do">##  [5,] 2.269 2.315</span></span>
<span id="cb530-32"><a href="varモデル.html#cb530-32" tabindex="-1"></a><span class="do">##  [6,] 2.270 2.333</span></span>
<span id="cb530-33"><a href="varモデル.html#cb530-33" tabindex="-1"></a><span class="do">##  [7,] 2.357 2.728</span></span>
<span id="cb530-34"><a href="varモデル.html#cb530-34" tabindex="-1"></a><span class="do">##  [8,] 2.358 2.760</span></span>
<span id="cb530-35"><a href="varモデル.html#cb530-35" tabindex="-1"></a><span class="do">##  [9,] 2.432 3.010</span></span>
<span id="cb530-36"><a href="varモデル.html#cb530-36" tabindex="-1"></a><span class="do">## [10,] 2.435 3.050</span></span>
<span id="cb530-37"><a href="varモデル.html#cb530-37" tabindex="-1"></a><span class="do">## [11,] 2.488 3.207</span></span>
<span id="cb530-38"><a href="varモデル.html#cb530-38" tabindex="-1"></a><span class="do">## [12,] 2.493 3.249</span></span>
<span id="cb530-39"><a href="varモデル.html#cb530-39" tabindex="-1"></a><span class="do">## [13,] 2.528 3.349</span></span>
<span id="cb530-40"><a href="varモデル.html#cb530-40" tabindex="-1"></a><span class="do">## [14,] 2.535 3.388</span></span>
<span id="cb530-41"><a href="varモデル.html#cb530-41" tabindex="-1"></a><span class="do">## [15,] 2.557 3.453</span></span>
<span id="cb530-42"><a href="varモデル.html#cb530-42" tabindex="-1"></a><span class="do">## [16,] 2.564 3.486</span></span>
<span id="cb530-43"><a href="varモデル.html#cb530-43" tabindex="-1"></a><span class="do">## [17,] 2.579 3.530</span></span>
<span id="cb530-44"><a href="varモデル.html#cb530-44" tabindex="-1"></a><span class="do">## [18,] 2.586 3.557</span></span>
<span id="cb530-45"><a href="varモデル.html#cb530-45" tabindex="-1"></a><span class="do">## [19,] 2.596 3.588</span></span>
<span id="cb530-46"><a href="varモデル.html#cb530-46" tabindex="-1"></a><span class="do">## [20,] 2.602 3.609</span></span>
<span id="cb530-47"><a href="varモデル.html#cb530-47" tabindex="-1"></a><span class="do">## Root mean square errors of predictions:  </span></span>
<span id="cb530-48"><a href="varモデル.html#cb530-48" tabindex="-1"></a><span class="do">##        [,1]  [,2]</span></span>
<span id="cb530-49"><a href="varモデル.html#cb530-49" tabindex="-1"></a><span class="do">##  [1,] 2.139 1.063</span></span>
<span id="cb530-50"><a href="varモデル.html#cb530-50" tabindex="-1"></a><span class="do">##  [2,] 2.154 1.061</span></span>
<span id="cb530-51"><a href="varモデル.html#cb530-51" tabindex="-1"></a><span class="do">##  [3,] 2.408 2.994</span></span>
<span id="cb530-52"><a href="varモデル.html#cb530-52" tabindex="-1"></a><span class="do">##  [4,] 2.226 1.751</span></span>
<span id="cb530-53"><a href="varモデル.html#cb530-53" tabindex="-1"></a><span class="do">##  [5,] 2.460 3.586</span></span>
<span id="cb530-54"><a href="varモデル.html#cb530-54" tabindex="-1"></a><span class="do">##  [6,] 2.275 2.391</span></span>
<span id="cb530-55"><a href="varモデル.html#cb530-55" tabindex="-1"></a><span class="do">##  [7,] 2.616 3.717</span></span>
<span id="cb530-56"><a href="varモデル.html#cb530-56" tabindex="-1"></a><span class="do">##  [8,] 2.359 2.859</span></span>
<span id="cb530-57"><a href="varモデル.html#cb530-57" tabindex="-1"></a><span class="do">##  [9,] 2.656 3.698</span></span>
<span id="cb530-58"><a href="varモデル.html#cb530-58" tabindex="-1"></a><span class="do">## [10,] 2.444 3.174</span></span>
<span id="cb530-59"><a href="varモデル.html#cb530-59" tabindex="-1"></a><span class="do">## [11,] 2.649 3.664</span></span>
<span id="cb530-60"><a href="varモデル.html#cb530-60" tabindex="-1"></a><span class="do">## [12,] 2.510 3.378</span></span>
<span id="cb530-61"><a href="varモデル.html#cb530-61" tabindex="-1"></a><span class="do">## [13,] 2.636 3.650</span></span>
<span id="cb530-62"><a href="varモデル.html#cb530-62" tabindex="-1"></a><span class="do">## [14,] 2.557 3.508</span></span>
<span id="cb530-63"><a href="varモデル.html#cb530-63" tabindex="-1"></a><span class="do">## [15,] 2.628 3.653</span></span>
<span id="cb530-64"><a href="varモデル.html#cb530-64" tabindex="-1"></a><span class="do">## [16,] 2.587 3.591</span></span>
<span id="cb530-65"><a href="varモデル.html#cb530-65" tabindex="-1"></a><span class="do">## [17,] 2.626 3.667</span></span>
<span id="cb530-66"><a href="varモデル.html#cb530-66" tabindex="-1"></a><span class="do">## [18,] 2.607 3.643</span></span>
<span id="cb530-67"><a href="varモデル.html#cb530-67" tabindex="-1"></a><span class="do">## [19,] 2.627 3.683</span></span>
<span id="cb530-68"><a href="varモデル.html#cb530-68" tabindex="-1"></a><span class="do">## [20,] 2.620 3.678</span></span></code></pre></div>
<pre><code>- predict()関数 (vars::VARの出力に対して適用)
  - n.ahead: 予測期間の長さ
  - ci: 予測信頼区間</code></pre>
<div class="sourceCode" id="cb532"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb532-1"><a href="varモデル.html#cb532-1" tabindex="-1"></a>pred.VAR2 <span class="ot">=</span> <span class="fu">predict</span>(est.VAR2, <span class="at">n.ahead =</span> <span class="dv">10</span>)</span>
<span id="cb532-2"><a href="varモデル.html#cb532-2" tabindex="-1"></a><span class="fu">plot</span>(pred.VAR2)</span></code></pre></div>
<p><img src="090-VAR_files/figure-html/VApred2_12-1.png" width="75%" /></p>
<div class="sourceCode" id="cb533"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb533-1"><a href="varモデル.html#cb533-1" tabindex="-1"></a>pred.VAR2<span class="sc">$</span>fcst</span>
<span id="cb533-2"><a href="varモデル.html#cb533-2" tabindex="-1"></a><span class="do">## $y1</span></span>
<span id="cb533-3"><a href="varモデル.html#cb533-3" tabindex="-1"></a><span class="do">##             fcst     lower    upper       CI</span></span>
<span id="cb533-4"><a href="varモデル.html#cb533-4" tabindex="-1"></a><span class="do">##  [1,] -1.6935489 -5.886138 2.499040 4.192589</span></span>
<span id="cb533-5"><a href="varモデル.html#cb533-5" tabindex="-1"></a><span class="do">##  [2,] -1.5588289 -5.766916 2.649258 4.208087</span></span>
<span id="cb533-6"><a href="varモデル.html#cb533-6" tabindex="-1"></a><span class="do">##  [3,] -1.4158594 -5.761805 2.930087 4.345946</span></span>
<span id="cb533-7"><a href="varモデル.html#cb533-7" tabindex="-1"></a><span class="do">##  [4,] -0.6541053 -5.012838 3.704628 4.358733</span></span>
<span id="cb533-8"><a href="varモデル.html#cb533-8" tabindex="-1"></a><span class="do">##  [5,] -1.3691744 -5.853357 3.115008 4.484182</span></span>
<span id="cb533-9"><a href="varモデル.html#cb533-9" tabindex="-1"></a><span class="do">##  [6,] -0.3983955 -4.885523 4.088732 4.487127</span></span>
<span id="cb533-10"><a href="varモデル.html#cb533-10" tabindex="-1"></a><span class="do">##  [7,] -1.4084408 -6.067917 3.251035 4.659476</span></span>
<span id="cb533-11"><a href="varモデル.html#cb533-11" tabindex="-1"></a><span class="do">##  [8,] -0.4104564 -5.070912 4.250000 4.660456</span></span>
<span id="cb533-12"><a href="varモデル.html#cb533-12" tabindex="-1"></a><span class="do">##  [9,] -1.4615648 -6.269351 3.346221 4.807786</span></span>
<span id="cb533-13"><a href="varモデル.html#cb533-13" tabindex="-1"></a><span class="do">## [10,] -0.5135316 -5.326625 4.299561 4.813093</span></span>
<span id="cb533-14"><a href="varモデル.html#cb533-14" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb533-15"><a href="varモデル.html#cb533-15" tabindex="-1"></a><span class="do">## $y2</span></span>
<span id="cb533-16"><a href="varモデル.html#cb533-16" tabindex="-1"></a><span class="do">##            fcst      lower       upper       CI</span></span>
<span id="cb533-17"><a href="varモデル.html#cb533-17" tabindex="-1"></a><span class="do">##  [1,] -4.659151  -6.742164 -2.57613758 2.083013</span></span>
<span id="cb533-18"><a href="varモデル.html#cb533-18" tabindex="-1"></a><span class="do">##  [2,] -2.223532  -4.309952 -0.13711248 2.086420</span></span>
<span id="cb533-19"><a href="varモデル.html#cb533-19" tabindex="-1"></a><span class="do">##  [3,] -4.505606  -7.922276 -1.08893531 3.416670</span></span>
<span id="cb533-20"><a href="varモデル.html#cb533-20" tabindex="-1"></a><span class="do">##  [4,] -1.805711  -5.233098  1.62167648 3.427387</span></span>
<span id="cb533-21"><a href="varモデル.html#cb533-21" tabindex="-1"></a><span class="do">##  [5,] -4.534908  -9.110020  0.04020335 4.575112</span></span>
<span id="cb533-22"><a href="varモデル.html#cb533-22" tabindex="-1"></a><span class="do">##  [6,] -1.896451  -6.507997  2.71509585 4.611547</span></span>
<span id="cb533-23"><a href="varモデル.html#cb533-23" tabindex="-1"></a><span class="do">##  [7,] -4.598833  -9.990735  0.79306982 5.391903</span></span>
<span id="cb533-24"><a href="varモデル.html#cb533-24" tabindex="-1"></a><span class="do">##  [8,] -2.152730  -7.607556  3.30209602 5.454826</span></span>
<span id="cb533-25"><a href="varモデル.html#cb533-25" tabindex="-1"></a><span class="do">##  [9,] -4.638479 -10.588832  1.31187382 5.950353</span></span>
<span id="cb533-26"><a href="varモデル.html#cb533-26" tabindex="-1"></a><span class="do">## [10,] -2.429372  -8.458542  3.59979824 6.029170</span></span></code></pre></div>
<!---
  - dumvar: ca.jo()関数においてdumvar引数が, または, VAR()関数においてexogen引数が使われた時に得られた'vec2var'や'varest'クラスのオブジェクトに対する行列
--->
<ul>
<li><strong>MTS</strong>パッケージは, 外生変数有りのVARXモデル, VMAモデル, さらには, 一般のVARMAモデルに対しても, 次数同定, モデル推定, 予測のための関数を用意.</li>
</ul>

</div>
</div>
<div id="var解析" class="section level2 hasAnchor" number="9.2">
<h2><span class="header-section-number">9.2</span> VAR解析<a href="varモデル.html#var解析" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>VARモデルによる変数間の動学的関係性の分析</p>
<ul>
<li>以下, <strong>MTS</strong>パッケージ, <strong>vars</strong>パッケージを利用
<ul>
<li><a href="https://www.rdocumentation.org/packages/MTS/versions/1.0" class="uri">https://www.rdocumentation.org/packages/MTS/versions/1.0</a></li>
<li><a href="https://www.rdocumentation.org/packages/vars/versions/1.5-3" class="uri">https://www.rdocumentation.org/packages/vars/versions/1.5-3</a></li>
</ul></li>
</ul>
<div id="varpモデルの推定復習" class="section level3 hasAnchor" number="9.2.1">
<h3><span class="header-section-number">9.2.1</span> VAR(<span class="math inline">\(p\)</span>)モデルの推定(復習)<a href="varモデル.html#varpモデルの推定復習" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>以下では, シミュレーションデータを使用</li>
<li>MTSパッケージのVARsim関数でパスを生成</li>
<li>varパッケージのVARselect,VAR関数を使って, 次数同定およびモデル推定</li>
</ul>
<p><span class="math display">\[Y_{1,t}=1.0 + 0.6 Y_{1,t-1} + 0.1 Y_{2,t-1} + \epsilon_{1,t}\]</span>
<span class="math display">\[Y_{2,t}=-1.0 +0.5 Y_{1,t-1} + 0.7 Y_{2,t-1} + \epsilon_{2,t}\]</span>
<span class="math display">\[ \left[
    \begin{array}{r}
      \epsilon_{1,t} \\ \epsilon_{2,t}
    \end{array}
  \right] \sim_{\it i.i.d.} N \Big(\left[
    \begin{array}{r}
      0 \\ 0
    \end{array}
  \right], \left[
    \begin{array}{rr}
      4 &amp; 1 \\ 1 &amp; 1
    \end{array}
  \right]\Big) \]</span></p>
<div class="sourceCode" id="cb534"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb534-1"><a href="varモデル.html#cb534-1" tabindex="-1"></a><span class="fu">library</span>(MTS)</span>
<span id="cb534-2"><a href="varモデル.html#cb534-2" tabindex="-1"></a>Nlen <span class="ot">&lt;-</span> <span class="dv">300</span></span>
<span id="cb534-3"><a href="varモデル.html#cb534-3" tabindex="-1"></a>Seedv <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb534-4"><a href="varモデル.html#cb534-4" tabindex="-1"></a><span class="fu">set.seed</span>(Seedv)</span>
<span id="cb534-5"><a href="varモデル.html#cb534-5" tabindex="-1"></a>p0 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>)          <span class="co"># Phi0 (定数項)</span></span>
<span id="cb534-6"><a href="varモデル.html#cb534-6" tabindex="-1"></a>Pmat <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fl">0.6</span>, <span class="fl">0.5</span>, <span class="fl">0.1</span>, <span class="fl">0.7</span>), <span class="dv">2</span>, <span class="dv">2</span>) <span class="co"># Phi1 (ラグ1のVAR係数行列)</span></span>
<span id="cb534-7"><a href="varモデル.html#cb534-7" tabindex="-1"></a>Sig <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>), <span class="dv">2</span>, <span class="dv">2</span>)      <span class="co"># イノベーションの分散共分散行列 (正値定符号)</span></span>
<span id="cb534-8"><a href="varモデル.html#cb534-8" tabindex="-1"></a>Pmat; Sig</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]  0.6  0.1
## [2,]  0.5  0.7</code></pre>
<pre><code>##      [,1] [,2]
## [1,]    4    1
## [2,]    1    1</code></pre>
<div class="sourceCode" id="cb537"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb537-1"><a href="varモデル.html#cb537-1" tabindex="-1"></a>ysim <span class="ot">&lt;-</span> <span class="fu">VARMAsim</span>(Nlen, <span class="at">arlags =</span> <span class="dv">1</span>, <span class="at">cnst =</span> p0, <span class="at">phi =</span> Pmat, <span class="at">sigma =</span> Sig)</span>
<span id="cb537-2"><a href="varモデル.html#cb537-2" tabindex="-1"></a>Yt <span class="ot">&lt;-</span> ysim<span class="sc">$</span>series</span>
<span id="cb537-3"><a href="varモデル.html#cb537-3" tabindex="-1"></a><span class="fu">acf</span>(Yt)　　　<span class="co"># クロス相関</span></span></code></pre></div>
<p><img src="092-VAR2_files/figure-html/VARsim_13-1.png" width="672" /></p>
<div class="sourceCode" id="cb538"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb538-1"><a href="varモデル.html#cb538-1" tabindex="-1"></a><span class="fu">MTSplot</span>(Yt)　<span class="co"># 時系列プロット</span></span></code></pre></div>
<p><img src="092-VAR2_files/figure-html/VARsim_13-2.png" width="672" /></p>
<div id="varpモデルの次数同定-1" class="section level4 unnumbered hasAnchor">
<h4>VAR(<span class="math inline">\(p\)</span>)モデルの次数同定<a href="varモデル.html#varpモデルの次数同定-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li>vars::VARselect()関数</li>
</ul>
<div class="sourceCode" id="cb539"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb539-1"><a href="varモデル.html#cb539-1" tabindex="-1"></a><span class="fu">library</span>(vars)</span></code></pre></div>
<pre><code>## Loading required package: MASS</code></pre>
<pre><code>## Loading required package: strucchange</code></pre>
<pre><code>## Loading required package: zoo</code></pre>
<pre><code>## 
## Attaching package: &#39;zoo&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     as.Date, as.Date.numeric</code></pre>
<pre><code>## Loading required package: sandwich</code></pre>
<pre><code>## Loading required package: urca</code></pre>
<pre><code>## Loading required package: lmtest</code></pre>
<pre><code>## 
## Attaching package: &#39;vars&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:MTS&#39;:
## 
##     VAR</code></pre>
<div class="sourceCode" id="cb550"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb550-1"><a href="varモデル.html#cb550-1" tabindex="-1"></a>Yt <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Y1 =</span> Yt[,<span class="dv">1</span>], <span class="at">Y2 =</span> Yt[,<span class="dv">2</span>])</span>
<span id="cb550-2"><a href="varモデル.html#cb550-2" tabindex="-1"></a><span class="fu">VARselect</span>(Yt, <span class="at">lag.max =</span> <span class="dv">5</span>,  <span class="at">type =</span> <span class="st">&quot;const&quot;</span>)</span></code></pre></div>
<pre><code>## $selection
## AIC(n)  HQ(n)  SC(n) FPE(n) 
##      1      1      1      1 
## 
## $criteria
##               1        2        3        4        5
## AIC(n) 1.417189 1.432965 1.454790 1.471126 1.460469
## HQ(n)  1.447216 1.483011 1.524855 1.561208 1.570570
## SC(n)  1.492178 1.557947 1.629765 1.696094 1.735430
## FPE(n) 4.125512 4.191134 4.283662 4.354299 4.308277</code></pre>
</div>
<div id="varpモデルの推定-1" class="section level4 unnumbered hasAnchor">
<h4>VAR(<span class="math inline">\(p\)</span>)モデルの推定<a href="varモデル.html#varpモデルの推定-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li>vars::VAR()関数</li>
</ul>
<div class="sourceCode" id="cb552"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb552-1"><a href="varモデル.html#cb552-1" tabindex="-1"></a>est_VAR1 <span class="ot">&lt;-</span> vars<span class="sc">::</span><span class="fu">VAR</span>(Yt, <span class="at">p =</span> <span class="dv">1</span>, <span class="at">type =</span> <span class="st">&quot;const&quot;</span>)</span>
<span id="cb552-2"><a href="varモデル.html#cb552-2" tabindex="-1"></a><span class="fu">summary</span>(est_VAR1)</span></code></pre></div>
<pre><code>## 
## VAR Estimation Results:
## ========================= 
## Endogenous variables: Y1, Y2 
## Deterministic variables: const 
## Sample size: 299 
## Log Likelihood: -1051.693 
## Roots of the characteristic polynomial:
## 0.8123 0.3886
## Call:
## vars::VAR(y = Yt, p = 1, type = &quot;const&quot;)
## 
## 
## Estimation results for equation Y1: 
## =================================== 
## Y1 = Y1.l1 + Y2.l1 + const 
## 
##       Estimate Std. Error t value Pr(&gt;|t|)    
## Y1.l1  0.50728    0.06004   8.449 1.35e-15 ***
## Y2.l1  0.07759    0.04514   1.719   0.0866 .  
## const  1.08864    0.17861   6.095 3.40e-09 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## 
## Residual standard error: 2.133 on 296 degrees of freedom
## Multiple R-Squared: 0.3322,  Adjusted R-squared: 0.3277 
## F-statistic: 73.64 on 2 and 296 DF,  p-value: &lt; 2.2e-16 
## 
## 
## Estimation results for equation Y2: 
## =================================== 
## Y2 = Y1.l1 + Y2.l1 + const 
## 
##       Estimate Std. Error t value Pr(&gt;|t|)    
## Y1.l1  0.46669    0.03001   15.55   &lt;2e-16 ***
## Y2.l1  0.69357    0.02256   30.74   &lt;2e-16 ***
## const -0.97716    0.08928  -10.95   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## 
## Residual standard error: 1.066 on 296 degrees of freedom
## Multiple R-Squared: 0.9054,  Adjusted R-squared: 0.9048 
## F-statistic:  1417 on 2 and 296 DF,  p-value: &lt; 2.2e-16 
## 
## 
## 
## Covariance matrix of residuals:
##       Y1    Y2
## Y1 4.551 1.096
## Y2 1.096 1.137
## 
## Correlation matrix of residuals:
##       Y1    Y2
## Y1 1.000 0.482
## Y2 0.482 1.000</code></pre>
<p>上で推定されたVAR(1)モデルを使用して, VARモデルによる変数間の動学的関係性の分析を行う.</p>
</div>
</div>
<div id="グレンジャーの因果性検定" class="section level3 hasAnchor" number="9.2.2">
<h3><span class="header-section-number">9.2.2</span> グレンジャーの因果性検定<a href="varモデル.html#グレンジャーの因果性検定" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<pre><code>- vars::causality()関数
  - x: VAR()関数により生成された&#39;varest&#39;クラスのオブジェクト
  - cause: cause変数 (デフォルトは入力x$yの第1列の変数) 
  - vcov.: 推定係数の共分散行列の指定
  - boot: 棄却点を計算する際にwildブートストラップを使用するか否か(T/F)   
  - boot.runs: boot=TRUEの場合のブートストラップの反復数</code></pre>
<div class="sourceCode" id="cb555"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb555-1"><a href="varモデル.html#cb555-1" tabindex="-1"></a>vars<span class="sc">::</span><span class="fu">causality</span>(est_VAR1, <span class="at">cause =</span> <span class="st">&quot;Y1&quot;</span>) </span></code></pre></div>
<pre><code>## $Granger
## 
##  Granger causality H0: Y1 do not Granger-cause Y2
## 
## data:  VAR object est_VAR1
## F-Test = 241.8, df1 = 1, df2 = 592, p-value &lt; 2.2e-16
## 
## 
## $Instant
## 
##  H0: No instantaneous causality between: Y1 and Y2
## 
## data:  VAR object est_VAR1
## Chi-squared = 56.374, df = 1, p-value = 5.995e-14</code></pre>
<div class="sourceCode" id="cb557"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb557-1"><a href="varモデル.html#cb557-1" tabindex="-1"></a><span class="co"># VAR(1)の推定結果var1を用い, Y1に関するGranger因果性検定</span></span>
<span id="cb557-2"><a href="varモデル.html#cb557-2" tabindex="-1"></a>vars<span class="sc">::</span><span class="fu">causality</span>(est_VAR1, <span class="at">cause =</span> <span class="st">&quot;Y2&quot;</span>) </span></code></pre></div>
<pre><code>## $Granger
## 
##  Granger causality H0: Y2 do not Granger-cause Y1
## 
## data:  VAR object est_VAR1
## F-Test = 2.9555, df1 = 1, df2 = 592, p-value = 0.08611
## 
## 
## $Instant
## 
##  H0: No instantaneous causality between: Y2 and Y1
## 
## data:  VAR object est_VAR1
## Chi-squared = 56.374, df = 1, p-value = 5.995e-14</code></pre>
<div class="sourceCode" id="cb559"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb559-1"><a href="varモデル.html#cb559-1" tabindex="-1"></a><span class="co"># 同, Y2に関するGranger因果性検定</span></span></code></pre></div>
</div>
<div id="インパルス応答" class="section level3 hasAnchor" number="9.2.3">
<h3><span class="header-section-number">9.2.3</span> インパルス応答<a href="varモデル.html#インパルス応答" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="直交インパルス応答" class="section level4 unnumbered hasAnchor">
<h4>直交インパルス応答<a href="varモデル.html#直交インパルス応答" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<pre><code>- vars::irf()関数
  - x: VAR()関数により生成された&#39;varest&#39;クラスのオブジェクト等
  - impulse: インパルス変数 (デフォルト=全変数)    
  - response: 応答変数 (デフォルト=全変数)
  - n.ahead: 将来区間の長さ
  - ortho: 直交インパルス応答か (デフォルト=T) 
  - cumulative: 累積インパルス応答か (デフォルト=F)
  - boot: インパルス応答係数のブートストラップ誤差バンド計算の有無 (T/F)    
  - ci: bootstrap誤差バンドの信頼区間
  - runs: bootstrap回数</code></pre>
<div class="sourceCode" id="cb561"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb561-1"><a href="varモデル.html#cb561-1" tabindex="-1"></a><span class="co"># vars::irf()関数 (ortho = T (デフォルト))</span></span>
<span id="cb561-2"><a href="varモデル.html#cb561-2" tabindex="-1"></a>ip1 <span class="ot">&lt;-</span> vars<span class="sc">::</span><span class="fu">irf</span>(est_VAR1, <span class="at">impulse =</span> <span class="fu">c</span>(<span class="st">&quot;Y1&quot;</span>), <span class="at">response =</span> <span class="fu">c</span>(<span class="st">&quot;Y1&quot;</span>, <span class="st">&quot;Y2&quot;</span>),</span>
<span id="cb561-3"><a href="varモデル.html#cb561-3" tabindex="-1"></a>                 <span class="at">n.ahead =</span> <span class="dv">5</span>, <span class="at">boot =</span> T)</span>
<span id="cb561-4"><a href="varモデル.html#cb561-4" tabindex="-1"></a>ip2 <span class="ot">&lt;-</span> vars<span class="sc">::</span><span class="fu">irf</span>(est_VAR1, <span class="at">impulse =</span> <span class="fu">c</span>(<span class="st">&quot;Y2&quot;</span>), <span class="at">response =</span> <span class="fu">c</span>(<span class="st">&quot;Y1&quot;</span>, <span class="st">&quot;Y2&quot;</span>),</span>
<span id="cb561-5"><a href="varモデル.html#cb561-5" tabindex="-1"></a>                 <span class="at">n.ahead =</span> <span class="dv">5</span>, <span class="at">boot =</span> T)</span>
<span id="cb561-6"><a href="varモデル.html#cb561-6" tabindex="-1"></a><span class="fu">plot</span>(ip1)</span></code></pre></div>
<p><img src="092-VAR2_files/figure-html/VARirf1-1.png" width="672" /></p>
<div class="sourceCode" id="cb562"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb562-1"><a href="varモデル.html#cb562-1" tabindex="-1"></a><span class="fu">plot</span>(ip2)</span></code></pre></div>
<p><img src="092-VAR2_files/figure-html/VARirf1-2.png" width="672" /></p>
<div class="sourceCode" id="cb563"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb563-1"><a href="varモデル.html#cb563-1" tabindex="-1"></a><span class="co"># 破線は信頼区間</span></span>
<span id="cb563-2"><a href="varモデル.html#cb563-2" tabindex="-1"></a><span class="co"># ip1; ip2</span></span></code></pre></div>
</div>
<div id="非直交インパルス応答" class="section level4 unnumbered hasAnchor">
<h4>非直交インパルス応答<a href="varモデル.html#非直交インパルス応答" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb564"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb564-1"><a href="varモデル.html#cb564-1" tabindex="-1"></a><span class="co"># vars::irf()関数 (ortho = F)</span></span>
<span id="cb564-2"><a href="varモデル.html#cb564-2" tabindex="-1"></a>ip1 <span class="ot">&lt;-</span> vars<span class="sc">::</span><span class="fu">irf</span>(est_VAR1, <span class="at">impulse =</span> <span class="fu">c</span>(<span class="st">&quot;Y1&quot;</span>), <span class="at">response =</span> <span class="fu">c</span>(<span class="st">&quot;Y1&quot;</span>, <span class="st">&quot;Y2&quot;</span>), </span>
<span id="cb564-3"><a href="varモデル.html#cb564-3" tabindex="-1"></a>                 <span class="at">ortho =</span> F, <span class="at">n.ahead =</span> <span class="dv">5</span>, <span class="at">boot =</span> T)</span>
<span id="cb564-4"><a href="varモデル.html#cb564-4" tabindex="-1"></a>ip2 <span class="ot">&lt;-</span> vars<span class="sc">::</span><span class="fu">irf</span>(est_VAR1, <span class="at">impulse =</span> <span class="fu">c</span>(<span class="st">&quot;Y2&quot;</span>), <span class="at">response =</span> <span class="fu">c</span>(<span class="st">&quot;Y1&quot;</span>, <span class="st">&quot;Y2&quot;</span>), </span>
<span id="cb564-5"><a href="varモデル.html#cb564-5" tabindex="-1"></a>                 <span class="at">ortho =</span> F, <span class="at">n.ahead =</span> <span class="dv">5</span>, <span class="at">boot =</span> T)</span>
<span id="cb564-6"><a href="varモデル.html#cb564-6" tabindex="-1"></a><span class="fu">plot</span>(ip1)</span></code></pre></div>
<p><img src="092-VAR2_files/figure-html/VARirf2-1.png" width="672" /></p>
<div class="sourceCode" id="cb565"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb565-1"><a href="varモデル.html#cb565-1" tabindex="-1"></a><span class="fu">plot</span>(ip2)</span></code></pre></div>
<p><img src="092-VAR2_files/figure-html/VARirf2-2.png" width="672" /></p>
<div class="sourceCode" id="cb566"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb566-1"><a href="varモデル.html#cb566-1" tabindex="-1"></a><span class="co"># ip1; ip2</span></span></code></pre></div>
<ul>
<li>累積インパルス応答</li>
</ul>
<div class="sourceCode" id="cb567"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb567-1"><a href="varモデル.html#cb567-1" tabindex="-1"></a>ip1_cum <span class="ot">&lt;-</span> vars<span class="sc">::</span><span class="fu">irf</span>(est_VAR1, <span class="at">impulse =</span> <span class="fu">c</span>(<span class="st">&quot;Y1&quot;</span>), <span class="at">response =</span> <span class="fu">c</span>(<span class="st">&quot;Y1&quot;</span>,<span class="st">&quot;Y2&quot;</span>), </span>
<span id="cb567-2"><a href="varモデル.html#cb567-2" tabindex="-1"></a>                     <span class="at">n.ahead =</span> <span class="dv">5</span>, <span class="at">boot =</span> <span class="cn">TRUE</span>, <span class="at">cumulative=</span>T)</span>
<span id="cb567-3"><a href="varモデル.html#cb567-3" tabindex="-1"></a>ip2_cum <span class="ot">&lt;-</span> vars<span class="sc">::</span><span class="fu">irf</span>(est_VAR1, <span class="at">impulse =</span> <span class="fu">c</span>(<span class="st">&quot;Y2&quot;</span>), <span class="at">response =</span> <span class="fu">c</span>(<span class="st">&quot;Y2&quot;</span>,<span class="st">&quot;Y1&quot;</span>), </span>
<span id="cb567-4"><a href="varモデル.html#cb567-4" tabindex="-1"></a>                     <span class="at">n.ahead =</span> <span class="dv">5</span>, <span class="at">boot =</span> <span class="cn">TRUE</span>, <span class="at">cumulative=</span>T)</span>
<span id="cb567-5"><a href="varモデル.html#cb567-5" tabindex="-1"></a><span class="fu">plot</span>(ip1_cum)</span></code></pre></div>
<p><img src="092-VAR2_files/figure-html/VARirf3-1.png" width="672" /></p>
<div class="sourceCode" id="cb568"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb568-1"><a href="varモデル.html#cb568-1" tabindex="-1"></a><span class="fu">plot</span>(ip2_cum)</span></code></pre></div>
<p><img src="092-VAR2_files/figure-html/VARirf3-2.png" width="672" /></p>
</div>
</div>
<div id="予測誤差分散分解-forecast-error-variance-decomposition" class="section level3 hasAnchor" number="9.2.4">
<h3><span class="header-section-number">9.2.4</span> 予測誤差分散分解 (forecast error variance decomposition)<a href="varモデル.html#予測誤差分散分解-forecast-error-variance-decomposition" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<pre><code>- vars::fevd()関数
  - x: VAR()関数により生成された&#39;varest&#39;クラスのオブジェクト等
  - n.ahead: 予測区間の長さ</code></pre>
<ul>
<li>直交化インパルス応答関数を使い, 第<span class="math inline">\(j(=1,2)\)</span>変数の第<span class="math inline">\(k(=1,2)\)</span>変数の<span class="math inline">\(h(=1,\ldots,10)\)</span>先予測誤差分散への寄与を評価</li>
</ul>
<div class="sourceCode" id="cb570"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb570-1"><a href="varモデル.html#cb570-1" tabindex="-1"></a>res_fevd <span class="ot">&lt;-</span> vars<span class="sc">::</span><span class="fu">fevd</span>(est_VAR1, <span class="at">n.ahead =</span> <span class="dv">10</span>)  <span class="co"># 10期先まで評価する</span></span>
<span id="cb570-2"><a href="varモデル.html#cb570-2" tabindex="-1"></a><span class="fu">plot</span>(res_fevd)</span></code></pre></div>
<p><img src="092-VAR2_files/figure-html/VARfevd-1.png" width="672" /></p>

</div>
</div>
<div id="var解析-データ分析例" class="section level2 hasAnchor" number="9.3">
<h2><span class="header-section-number">9.3</span> VAR解析 (データ分析例)<a href="varモデル.html#var解析-データ分析例" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>VARモデルによる変数間の動学的関係性の分析</p>
<div id="事例1-ソフトバンク9434-vs-ソフトバンクグループ9984" class="section level3 unnumbered hasAnchor">
<h3>事例1: ソフトバンク(9434) vs ソフトバンクグループ(9984)<a href="varモデル.html#事例1-ソフトバンク9434-vs-ソフトバンクグループ9984" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>ソフトバンク(9434): 上場日 2018年12月19日</li>
<li>親会社ソフトバンクG (9984)
<ul>
<li>保有比率(%): 66.49 (2019.03), 67.13 (2020.03), 40.86 (2021.03), 40.68 (2022.03), 40.47 (2023.03)</li>
<li>cf. <a href="https://www.buffett-code.com/company/9434/mainshareholder" class="uri">https://www.buffett-code.com/company/9434/mainshareholder</a></li>
</ul></li>
<li>データをYahoo!ファイナンスより入手</li>
</ul>
<div class="sourceCode" id="cb571"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb571-1"><a href="varモデル.html#cb571-1" tabindex="-1"></a><span class="fu">library</span>(quantmod)</span></code></pre></div>
<pre><code>## Loading required package: xts</code></pre>
<pre><code>## Loading required package: zoo</code></pre>
<pre><code>## 
## Attaching package: &#39;zoo&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     as.Date, as.Date.numeric</code></pre>
<pre><code>## Loading required package: TTR</code></pre>
<pre><code>## Registered S3 method overwritten by &#39;quantmod&#39;:
##   method            from
##   as.zoo.data.frame zoo</code></pre>
<div class="sourceCode" id="cb578"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb578-1"><a href="varモデル.html#cb578-1" tabindex="-1"></a>s9984 <span class="ot">&lt;-</span> <span class="fu">getSymbols</span>(<span class="st">&#39;9984.T&#39;</span>, <span class="at">from =</span> <span class="st">&#39;2018-12-19&#39;</span>, <span class="at">auto.assign =</span> <span class="cn">FALSE</span>)</span>
<span id="cb578-2"><a href="varモデル.html#cb578-2" tabindex="-1"></a>s9434 <span class="ot">&lt;-</span> <span class="fu">getSymbols</span>(<span class="st">&#39;9434.T&#39;</span>, <span class="at">from =</span> <span class="st">&#39;2018-12-19&#39;</span>, <span class="at">auto.assign =</span> <span class="cn">FALSE</span>)</span>
<span id="cb578-3"><a href="varモデル.html#cb578-3" tabindex="-1"></a></span>
<span id="cb578-4"><a href="varモデル.html#cb578-4" tabindex="-1"></a>s9984ret <span class="ot">&lt;-</span> <span class="fu">diff</span>(<span class="fu">log</span>(s9984<span class="sc">$</span><span class="st">`</span><span class="at">9984.T.Adjusted</span><span class="st">`</span>))[<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb578-5"><a href="varモデル.html#cb578-5" tabindex="-1"></a>s9434ret <span class="ot">&lt;-</span> <span class="fu">diff</span>(<span class="fu">log</span>(s9434<span class="sc">$</span><span class="st">`</span><span class="at">9434.T.Adjusted</span><span class="st">`</span>))[<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb578-6"><a href="varモデル.html#cb578-6" tabindex="-1"></a>sb <span class="ot">&lt;-</span> <span class="fu">merge.xts</span>(s9984ret, s9434ret, <span class="at">join =</span> <span class="st">&quot;inner&quot;</span>)</span>
<span id="cb578-7"><a href="varモデル.html#cb578-7" tabindex="-1"></a><span class="fu">colnames</span>(sb) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;s9984&quot;</span>, <span class="st">&quot;s9434&quot;</span>)</span></code></pre></div>
<ul>
<li>各変数の単位根検定</li>
</ul>
<div class="sourceCode" id="cb579"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb579-1"><a href="varモデル.html#cb579-1" tabindex="-1"></a><span class="fu">library</span>(fUnitRoots)</span>
<span id="cb579-2"><a href="varモデル.html#cb579-2" tabindex="-1"></a><span class="co">#unitrootTest(s9984, type = &quot;c&quot;, lags = 1)  # type: &quot;nc&quot;, &quot;c&quot;, &quot;ct&quot;</span></span>
<span id="cb579-3"><a href="varモデル.html#cb579-3" tabindex="-1"></a><span class="fu">unitrootTest</span>(s9984ret, <span class="at">type =</span> <span class="st">&quot;c&quot;</span>, <span class="at">lags =</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>## 
## Title:
##  Augmented Dickey-Fuller Test
## 
## Test Results:
##   PARAMETER:
##     Lag Order: 1
##   STATISTIC:
##     DF: -23.9952
##   P VALUE:
##     t: &lt; 2.2e-16 
##     n: 0.004194 
## 
## Description:
##  Wed Jan 24 15:06:16 2024 by user:</code></pre>
<div class="sourceCode" id="cb581"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb581-1"><a href="varモデル.html#cb581-1" tabindex="-1"></a><span class="fu">unitrootTest</span>(s9434ret, <span class="at">type =</span> <span class="st">&quot;c&quot;</span>, <span class="at">lags =</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>## 
## Title:
##  Augmented Dickey-Fuller Test
## 
## Test Results:
##   PARAMETER:
##     Lag Order: 1
##   STATISTIC:
##     DF: -26.5847
##   P VALUE:
##     t: &lt; 2.2e-16 
##     n: 0.002188 
## 
## Description:
##  Wed Jan 24 15:06:16 2024 by user:</code></pre>
<ul>
<li><p>–&gt; 帰無仮説(<span class="math inline">\(\phi_1 = 1\)</span>)を棄却 (単位根なし)</p></li>
<li><p>標本自己共分散行列</p></li>
</ul>
<div class="sourceCode" id="cb583"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb583-1"><a href="varモデル.html#cb583-1" tabindex="-1"></a><span class="fu">acf</span>(sb)</span></code></pre></div>
<p><img src="093-VAR3_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<div id="varモデルの推定" class="section level4 unnumbered hasAnchor">
<h4>VARモデルの推定<a href="varモデル.html#varモデルの推定" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li>以下, パッケージ<strong>vars</strong>を利用</li>
<li>VAR(p)モデルの次数の決定</li>
</ul>
<div class="sourceCode" id="cb584"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb584-1"><a href="varモデル.html#cb584-1" tabindex="-1"></a><span class="fu">library</span>(vars)</span></code></pre></div>
<pre><code>## Loading required package: MASS</code></pre>
<pre><code>## Loading required package: strucchange</code></pre>
<pre><code>## Loading required package: sandwich</code></pre>
<pre><code>## Loading required package: urca</code></pre>
<pre><code>## 
## Attaching package: &#39;urca&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:fUnitRoots&#39;:
## 
##     punitroot, qunitroot, unitrootTable</code></pre>
<pre><code>## Loading required package: lmtest</code></pre>
<div class="sourceCode" id="cb592"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb592-1"><a href="varモデル.html#cb592-1" tabindex="-1"></a>vars<span class="sc">::</span><span class="fu">VARselect</span>(sb, <span class="at">lag.max =</span> <span class="dv">5</span>,  <span class="at">type =</span> <span class="st">&quot;const&quot;</span>)   <span class="co"># &quot;const&quot;(定数項有), trend:(&quot;トレンド有&quot;), &quot;both&quot;, &quot;none&quot;</span></span></code></pre></div>
<pre><code>## $selection
## AIC(n)  HQ(n)  SC(n) FPE(n) 
##      3      1      1      3 
## 
## $criteria
##                    1             2             3             4             5
## AIC(n) -1.643993e+01 -1.644100e+01 -1.644368e+01 -1.643966e+01 -1.643500e+01
## HQ(n)  -1.643058e+01 -1.642541e+01 -1.642185e+01 -1.641160e+01 -1.640070e+01
## SC(n)  -1.641506e+01 -1.639955e+01 -1.638565e+01 -1.636506e+01 -1.634382e+01
## FPE(n)  7.248179e-08  7.240443e-08  7.221057e-08  7.250131e-08  7.283981e-08</code></pre>
<ul>
<li><p>–&gt; AIC, FPEでは3, HQ, SCでは1が最適</p></li>
<li><p>VAR(1)モデルの推定 (OLS推定)</p></li>
</ul>
<div class="sourceCode" id="cb594"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb594-1"><a href="varモデル.html#cb594-1" tabindex="-1"></a>var1 <span class="ot">&lt;-</span> vars<span class="sc">::</span><span class="fu">VAR</span>(sb, <span class="at">p =</span> <span class="dv">1</span>, <span class="at">type =</span> <span class="st">&quot;const&quot;</span>)</span>
<span id="cb594-2"><a href="varモデル.html#cb594-2" tabindex="-1"></a><span class="fu">summary</span>(var1)</span></code></pre></div>
<pre><code>## 
## VAR Estimation Results:
## ========================= 
## Endogenous variables: s9984, s9434 
## Deterministic variables: const 
## Sample size: 1239 
## Log Likelihood: 6664.491 
## Roots of the characteristic polynomial:
## 0.05632 0.03435
## Call:
## vars::VAR(y = sb, p = 1, type = &quot;const&quot;)
## 
## 
## Estimation results for equation s9984: 
## ====================================== 
## s9984 = s9984.l1 + s9434.l1 + const 
## 
##            Estimate Std. Error t value Pr(&gt;|t|)    
## s9984.l1  0.0443309  0.0288383   1.537 0.124495    
## s9434.l1 -0.2614193  0.0773761  -3.379 0.000751 ***
## const     0.0006039  0.0007726   0.782 0.434547    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## 
## Residual standard error: 0.02715 on 1236 degrees of freedom
## Multiple R-Squared: 0.009774,    Adjusted R-squared: 0.008172 
## F-statistic:   6.1 on 2 and 1236 DF,  p-value: 0.002311 
## 
## 
## Estimation results for equation s9434: 
## ====================================== 
## s9434 = s9984.l1 + s9434.l1 + const 
## 
##            Estimate Std. Error t value Pr(&gt;|t|)  
## s9984.l1 -0.0036095  0.0108093  -0.334   0.7385  
## s9434.l1 -0.0223569  0.0290025  -0.771   0.4409  
## const     0.0005887  0.0002896   2.033   0.0423 *
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## 
## Residual standard error: 0.01018 on 1236 degrees of freedom
## Multiple R-Squared: 0.0006796,   Adjusted R-squared: -0.0009375 
## F-statistic: 0.4203 on 2 and 1236 DF,  p-value: 0.657 
## 
## 
## 
## Covariance matrix of residuals:
##           s9984     s9434
## s9984 7.370e-04 5.494e-05
## s9434 5.494e-05 1.035e-04
## 
## Correlation matrix of residuals:
##        s9984  s9434
## s9984 1.0000 0.1989
## s9434 0.1989 1.0000</code></pre>
<ul>
<li>–&gt; 2式とも, 9984_{t-1}の係数, 有意でない. 一方, 9434_{t-1} → 9984_tの係数, 有意</li>
</ul>
</div>
<div id="インパルス応答-1" class="section level4 unnumbered hasAnchor">
<h4>インパルス応答<a href="varモデル.html#インパルス応答-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li><strong>直交化インパルス応答</strong></li>
</ul>
<div class="sourceCode" id="cb596"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb596-1"><a href="varモデル.html#cb596-1" tabindex="-1"></a><span class="co"># s9434 --&gt; 将来のs9434, s9984の変動を調べる</span></span>
<span id="cb596-2"><a href="varモデル.html#cb596-2" tabindex="-1"></a>ip <span class="ot">&lt;-</span> vars<span class="sc">::</span><span class="fu">irf</span>(var1, <span class="at">impulse =</span> <span class="fu">c</span>(<span class="st">&quot;s9434&quot;</span>), <span class="at">response =</span> <span class="fu">c</span>(<span class="st">&quot;s9434&quot;</span>, <span class="st">&quot;s9984&quot;</span>),</span>
<span id="cb596-3"><a href="varモデル.html#cb596-3" tabindex="-1"></a>                <span class="at">n.ahead =</span> <span class="dv">5</span>, <span class="at">boot =</span> <span class="cn">TRUE</span>)</span>
<span id="cb596-4"><a href="varモデル.html#cb596-4" tabindex="-1"></a><span class="co">#ip &lt;- vars::irf(var1, impulse = c(&quot;s9984&quot;), response = c(&quot;s9984&quot;, &quot;s9434&quot;),</span></span>
<span id="cb596-5"><a href="varモデル.html#cb596-5" tabindex="-1"></a><span class="co">#                n.ahead = 5, boot = TRUE)</span></span>
<span id="cb596-6"><a href="varモデル.html#cb596-6" tabindex="-1"></a><span class="co"># ortho = T (デフォルト): 直交化インパルス応答; ortho = F: 非直交化インパルス応答</span></span>
<span id="cb596-7"><a href="varモデル.html#cb596-7" tabindex="-1"></a><span class="co"># boot = T: ブートストラップ法により, 信頼区間計算</span></span>
<span id="cb596-8"><a href="varモデル.html#cb596-8" tabindex="-1"></a><span class="co"># cumulative = T: 累積インパルス応答. デフォルトはF.</span></span>
<span id="cb596-9"><a href="varモデル.html#cb596-9" tabindex="-1"></a><span class="fu">plot</span>(ip)</span></code></pre></div>
<p><img src="093-VAR3_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<div class="sourceCode" id="cb597"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb597-1"><a href="varモデル.html#cb597-1" tabindex="-1"></a><span class="co"># 破線は信頼区間</span></span>
<span id="cb597-2"><a href="varモデル.html#cb597-2" tabindex="-1"></a>ip</span></code></pre></div>
<pre><code>## 
## Impulse response coefficients
## $s9434
##              s9984         s9434
## [1,]  0.000000e+00  9.972457e-03
## [2,] -2.606993e-03 -2.229534e-04
## [3,] -5.728599e-05  1.439456e-05
## [4,] -6.302555e-06 -1.150428e-07
## [5,] -2.493235e-07  2.532124e-08
## [6,] -1.767219e-08  3.338347e-10
## 
## 
## Lower Band, CI= 0.95 
## $s9434
##              s9984         s9434
## [1,]  0.000000e+00  9.243667e-03
## [2,] -4.227766e-03 -7.673726e-04
## [3,] -2.805856e-04 -5.345490e-05
## [4,] -3.198609e-05 -5.805057e-06
## [5,] -3.063645e-06 -1.404994e-08
## [6,] -3.187921e-07 -4.140550e-08
## 
## 
## Upper Band, CI= 0.95 
## $s9434
##              s9984        s9434
## [1,]  0.000000e+00 1.068002e-02
## [2,] -1.490320e-03 2.790879e-04
## [3,]  1.344442e-04 7.718438e-05
## [4,]  1.688873e-05 2.274211e-06
## [5,]  1.567731e-06 5.591217e-07
## [6,]  7.704557e-09 3.968955e-08</code></pre>
<div class="sourceCode" id="cb599"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb599-1"><a href="varモデル.html#cb599-1" tabindex="-1"></a>ip_2 <span class="ot">&lt;-</span> vars<span class="sc">::</span><span class="fu">irf</span>(var1, <span class="at">impulse =</span> <span class="fu">c</span>(<span class="st">&quot;s9984&quot;</span>), <span class="at">response =</span> <span class="fu">c</span>(<span class="st">&quot;s9984&quot;</span>, <span class="st">&quot;s9434&quot;</span>),</span>
<span id="cb599-2"><a href="varモデル.html#cb599-2" tabindex="-1"></a>                <span class="at">n.ahead =</span> <span class="dv">5</span>, <span class="at">boot =</span> <span class="cn">TRUE</span>)</span>
<span id="cb599-3"><a href="varモデル.html#cb599-3" tabindex="-1"></a><span class="fu">plot</span>(ip_2)</span></code></pre></div>
<p><img src="093-VAR3_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<div class="sourceCode" id="cb600"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb600-1"><a href="varモデル.html#cb600-1" tabindex="-1"></a>ip_2</span></code></pre></div>
<pre><code>## 
## Impulse response coefficients
## $s9984
##             s9984         s9434
## [1,] 2.714801e-02  2.023894e-03
## [2,] 6.744104e-04 -1.432395e-04
## [3,] 6.734278e-05  7.680919e-07
## [4,] 2.784572e-06 -2.602477e-07
## [5,] 1.914763e-07 -4.232647e-09
## [6,] 9.594812e-09 -5.965099e-10
## 
## 
## Lower Band, CI= 0.95 
## $s9984
##              s9984         s9434
## [1,]  2.487956e-02  1.067471e-03
## [2,] -6.948885e-04 -6.488540e-04
## [3,] -3.605268e-05 -2.302991e-05
## [4,] -4.962006e-06 -6.702312e-06
## [5,] -9.443443e-08 -4.111642e-07
## [6,] -4.211789e-08 -8.066740e-08
## 
## 
## Upper Band, CI= 0.95 
## $s9984
##             s9984        s9434
## [1,] 2.896762e-02 3.126276e-03
## [2,] 2.366696e-03 3.427981e-04
## [3,] 2.919094e-04 2.875552e-05
## [4,] 2.707422e-05 1.243103e-06
## [5,] 3.105368e-06 2.985240e-07
## [6,] 3.269606e-07 4.607903e-09</code></pre>
<ul>
<li><strong>非直交化インパルス応答</strong></li>
</ul>
<div class="sourceCode" id="cb602"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb602-1"><a href="varモデル.html#cb602-1" tabindex="-1"></a>ip_3 <span class="ot">&lt;-</span> vars<span class="sc">::</span><span class="fu">irf</span>(var1, <span class="at">impulse =</span> <span class="fu">c</span>(<span class="st">&quot;s9434&quot;</span>), <span class="at">response =</span> <span class="fu">c</span>(<span class="st">&quot;s9434&quot;</span>, <span class="st">&quot;s9984&quot;</span>),</span>
<span id="cb602-2"><a href="varモデル.html#cb602-2" tabindex="-1"></a>                  <span class="at">ortho =</span> F, <span class="at">n.ahead =</span> <span class="dv">5</span>, <span class="at">boot =</span> <span class="cn">TRUE</span>)</span>
<span id="cb602-3"><a href="varモデル.html#cb602-3" tabindex="-1"></a><span class="fu">plot</span>(ip_3)</span></code></pre></div>
<p><img src="093-VAR3_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<div class="sourceCode" id="cb603"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb603-1"><a href="varモデル.html#cb603-1" tabindex="-1"></a>ip_3</span></code></pre></div>
<pre><code>## 
## Impulse response coefficients
## $s9434
##              s9984         s9434
## [1,]  0.000000e+00  1.000000e+00
## [2,] -2.614193e-01 -2.235692e-02
## [3,] -5.744421e-03  1.443432e-03
## [4,] -6.319962e-04 -1.153605e-05
## [5,] -2.500121e-05  2.539118e-06
## [6,] -1.772100e-06  3.347568e-08
## 
## 
## Lower Band, CI= 0.95 
## $s9434
##              s9984         s9434
## [1,]  0.000000e+00  1.000000e+00
## [2,] -4.014397e-01 -7.290235e-02
## [3,] -2.165063e-02 -3.129532e-03
## [4,] -3.489975e-03 -5.430288e-04
## [5,] -3.245231e-04 -2.100079e-06
## [6,] -4.601457e-05 -3.934762e-06
## 
## 
## Upper Band, CI= 0.95 
## $s9434
##              s9984        s9434
## [1,]  0.000000e+00 1.000000e+00
## [2,] -8.731931e-02 3.596301e-02
## [3,]  1.444289e-02 7.403383e-03
## [4,]  2.409562e-04 3.542840e-04
## [5,]  1.110974e-04 7.310673e-05
## [6,]  9.599467e-07 4.465115e-06</code></pre>
<ul>
<li><strong>累積インパルス応答</strong></li>
</ul>
<div class="sourceCode" id="cb605"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb605-1"><a href="varモデル.html#cb605-1" tabindex="-1"></a>ip_cum <span class="ot">&lt;-</span> vars<span class="sc">::</span><span class="fu">irf</span>(var1, <span class="at">impulse =</span> <span class="fu">c</span>(<span class="st">&quot;s9434&quot;</span>), <span class="at">response =</span> <span class="fu">c</span>(<span class="st">&quot;s9434&quot;</span>, <span class="st">&quot;s9984&quot;</span>),</span>
<span id="cb605-2"><a href="varモデル.html#cb605-2" tabindex="-1"></a>                    <span class="at">n.ahead =</span> <span class="dv">5</span>, <span class="at">boot =</span> <span class="cn">TRUE</span>, <span class="at">cumulative =</span> T)</span>
<span id="cb605-3"><a href="varモデル.html#cb605-3" tabindex="-1"></a><span class="fu">plot</span>(ip_cum)</span></code></pre></div>
<p><img src="093-VAR3_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
</div>
<div id="grangerの因果性検定" class="section level4 unnumbered hasAnchor">
<h4>Grangerの因果性検定<a href="varモデル.html#grangerの因果性検定" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb606"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb606-1"><a href="varモデル.html#cb606-1" tabindex="-1"></a>vars<span class="sc">::</span><span class="fu">causality</span>(var1, <span class="at">cause =</span> <span class="st">&quot;s9434&quot;</span>)  <span class="co"># VAR(1)の推定結果var1を用い, 9434をcauseとするGranger因果性検定</span></span></code></pre></div>
<pre><code>## $Granger
## 
##  Granger causality H0: s9434 do not Granger-cause s9984
## 
## data:  VAR object var1
## F-Test = 11.415, df1 = 1, df2 = 2472, p-value = 0.00074
## 
## 
## $Instant
## 
##  H0: No instantaneous causality between: s9434 and s9984
## 
## data:  VAR object var1
## Chi-squared = 47.148, df = 1, p-value = 6.582e-12</code></pre>
<ul>
<li>–&gt; 帰無仮説(因果性なし)棄却　→　9434をcauseとするGranger因果性の存在を示唆</li>
</ul>
<div class="sourceCode" id="cb608"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb608-1"><a href="varモデル.html#cb608-1" tabindex="-1"></a>vars<span class="sc">::</span><span class="fu">causality</span>(var1, <span class="at">cause =</span> <span class="st">&quot;s9984&quot;</span>)</span></code></pre></div>
<pre><code>## $Granger
## 
##  Granger causality H0: s9984 do not Granger-cause s9434
## 
## data:  VAR object var1
## F-Test = 0.11151, df1 = 1, df2 = 2472, p-value = 0.7385
## 
## 
## $Instant
## 
##  H0: No instantaneous causality between: s9984 and s9434
## 
## data:  VAR object var1
## Chi-squared = 47.148, df = 1, p-value = 6.582e-12</code></pre>
<ul>
<li>–&gt; 帰無仮説(因果性なし)棄却できず　→　9984をcauseとするGranger因果性存在せず</li>
<li>一方、Grangerの瞬時因果性, 9984, 9434, いずれの方向も棄却できず → 存在を示唆</li>
</ul>
</div>
</div>
<div id="事例2-米英日3株式市場-sp500-ftse-日経平均" class="section level3 unnumbered hasAnchor">
<h3>事例2: 米英日3株式市場 (S&amp;P500, FTSE, 日経平均)<a href="varモデル.html#事例2-米英日3株式市場-sp500-ftse-日経平均" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>データをYahoo!ファイナンスより入手</li>
</ul>
<div class="sourceCode" id="cb610"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb610-1"><a href="varモデル.html#cb610-1" tabindex="-1"></a><span class="fu">library</span>(vars)</span>
<span id="cb610-2"><a href="varモデル.html#cb610-2" tabindex="-1"></a></span>
<span id="cb610-3"><a href="varモデル.html#cb610-3" tabindex="-1"></a>gspc <span class="ot">&lt;-</span> <span class="fu">getSymbols</span>(<span class="st">&#39;^GSPC&#39;</span>, <span class="at">periodicity =</span> <span class="st">&quot;monthly&quot;</span>, <span class="at">from =</span> <span class="st">&#39;1999-12-31&#39;</span>, <span class="at">auto.assign =</span> <span class="cn">FALSE</span>)</span>
<span id="cb610-4"><a href="varモデル.html#cb610-4" tabindex="-1"></a>ftse <span class="ot">&lt;-</span> <span class="fu">getSymbols</span>(<span class="st">&#39;^FTSE&#39;</span>, <span class="at">periodicity =</span> <span class="st">&quot;monthly&quot;</span>, <span class="at">from =</span> <span class="st">&#39;1999-12-31&#39;</span>, <span class="at">auto.assign =</span> <span class="cn">FALSE</span>)</span>
<span id="cb610-5"><a href="varモデル.html#cb610-5" tabindex="-1"></a>n225 <span class="ot">&lt;-</span> <span class="fu">getSymbols</span>(<span class="st">&#39;^N225&#39;</span>, <span class="at">periodicity =</span> <span class="st">&quot;monthly&quot;</span>, <span class="at">from =</span> <span class="st">&#39;1999-12-31&#39;</span>, <span class="at">auto.assign =</span> <span class="cn">FALSE</span>)</span>
<span id="cb610-6"><a href="varモデル.html#cb610-6" tabindex="-1"></a></span>
<span id="cb610-7"><a href="varモデル.html#cb610-7" tabindex="-1"></a>us <span class="ot">&lt;-</span> <span class="fu">diff</span>(<span class="fu">log</span>(gspc<span class="sc">$</span>GSPC.Adjusted))[<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb610-8"><a href="varモデル.html#cb610-8" tabindex="-1"></a>uk <span class="ot">&lt;-</span> <span class="fu">diff</span>(<span class="fu">log</span>(ftse<span class="sc">$</span>FTSE.Adjusted))[<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb610-9"><a href="varモデル.html#cb610-9" tabindex="-1"></a>jp <span class="ot">&lt;-</span> <span class="fu">diff</span>(<span class="fu">log</span>(n225<span class="sc">$</span>N225.Adjusted))[<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb610-10"><a href="varモデル.html#cb610-10" tabindex="-1"></a>mkt <span class="ot">&lt;-</span> <span class="fu">cbind</span>(us, uk, jp)</span>
<span id="cb610-11"><a href="varモデル.html#cb610-11" tabindex="-1"></a></span>
<span id="cb610-12"><a href="varモデル.html#cb610-12" tabindex="-1"></a>idx <span class="ot">&lt;-</span> <span class="fu">complete.cases</span>(mkt) <span class="co"># 欠損値(NA)のあるレコードの除去</span></span>
<span id="cb610-13"><a href="varモデル.html#cb610-13" tabindex="-1"></a>mkt <span class="ot">&lt;-</span> mkt[idx]</span>
<span id="cb610-14"><a href="varモデル.html#cb610-14" tabindex="-1"></a><span class="fu">colnames</span>(mkt) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;us&quot;</span>, <span class="st">&quot;uk&quot;</span>, <span class="st">&quot;jp&quot;</span>)</span>
<span id="cb610-15"><a href="varモデル.html#cb610-15" tabindex="-1"></a></span>
<span id="cb610-16"><a href="varモデル.html#cb610-16" tabindex="-1"></a><span class="co">#plot(cumsum(mkt), type = &quot;l&quot;, col = c(&quot;black&quot;, &quot;blue&quot;, &quot;red&quot;),</span></span>
<span id="cb610-17"><a href="varモデル.html#cb610-17" tabindex="-1"></a><span class="co">#     main = &quot;Market indices: S&amp;P500 (black), FTSE (blue), NK225 (red)&quot;)</span></span></code></pre></div>
<div id="varモデルの推定-1" class="section level4 unnumbered hasAnchor">
<h4>VARモデルの推定<a href="varモデル.html#varモデルの推定-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li>以下, 引き続きパッケージ<strong>vars</strong>を利用</li>
<li>3変量VAR(2)モデルを仮定した場合の推定</li>
</ul>
<div class="sourceCode" id="cb611"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb611-1"><a href="varモデル.html#cb611-1" tabindex="-1"></a>usukjp <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(mkt<span class="sc">$</span>us, mkt<span class="sc">$</span>uk, mkt<span class="sc">$</span>jp)</span>
<span id="cb611-2"><a href="varモデル.html#cb611-2" tabindex="-1"></a><span class="fu">head</span>(usukjp, <span class="dv">5</span>)</span></code></pre></div>
<pre><code>##                     us           uk          jp
## 2000-02-01 -0.02031300 -0.005743495  0.02125795
## 2000-03-01  0.09232375  0.048174179  0.01875144
## 2000-04-01 -0.03127991 -0.033078382 -0.12354810
## 2000-05-01 -0.02215875  0.005044624 -0.09575560
## 2000-06-01  0.02365163 -0.007370510  0.06395117</code></pre>
<div class="sourceCode" id="cb613"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb613-1"><a href="varモデル.html#cb613-1" tabindex="-1"></a>var2usukjp <span class="ot">&lt;-</span> vars<span class="sc">::</span><span class="fu">VAR</span>(usukjp, <span class="at">p =</span> <span class="dv">2</span>, <span class="at">type =</span> <span class="st">&quot;const&quot;</span>)</span>
<span id="cb613-2"><a href="varモデル.html#cb613-2" tabindex="-1"></a><span class="co">#summary(var2usukjp)</span></span>
<span id="cb613-3"><a href="varモデル.html#cb613-3" tabindex="-1"></a></span>
<span id="cb613-4"><a href="varモデル.html#cb613-4" tabindex="-1"></a><span class="co"># 係数推定値 (値のみ）</span></span>
<span id="cb613-5"><a href="varモデル.html#cb613-5" tabindex="-1"></a><span class="fu">coef</span>(var2usukjp)</span></code></pre></div>
<pre><code>## $us
##           Estimate  Std. Error    t value   Pr(&gt;|t|)
## us.l1 -0.090898543 0.107051771 -0.8491083 0.39654902
## uk.l1  0.048142559 0.114018990  0.4222328 0.67318028
## jp.l1  0.105020652 0.065226815  1.6100840 0.10851031
## us.l2 -0.125850056 0.107286278 -1.1730303 0.24178416
## uk.l2  0.015732819 0.114018248  0.1379851 0.89035173
## jp.l2  0.048699966 0.065099587  0.7480841 0.45503954
## const  0.004709118 0.002706083  1.7401970 0.08292705
## 
## $uk
##            Estimate  Std. Error    t value  Pr(&gt;|t|)
## us.l1  0.0881558061 0.093377188  0.9440829 0.3459441
## uk.l1 -0.1472273908 0.099454428 -1.4803503 0.1399081
## jp.l1  0.0742588876 0.056894869  1.3051948 0.1929019
## us.l2 -0.1643953417 0.093581740 -1.7567032 0.0800654
## uk.l2  0.1045477753 0.099453781  1.0512197 0.2940673
## jp.l2 -0.0090419378 0.056783893 -0.1592342 0.8735996
## const  0.0006994127 0.002360413  0.2963094 0.7672142
## 
## $jp
##           Estimate  Std. Error    t value  Pr(&gt;|t|)
## us.l1 -0.030818755 0.131883978 -0.2336808 0.8154042
## uk.l1  0.128181701 0.140467345  0.9125374 0.3622737
## jp.l1  0.065935469 0.080357118  0.8205305 0.4126142
## us.l2 -0.180271383 0.132172883 -1.3639060 0.1736965
## uk.l2  0.066675615 0.140466430  0.4746730 0.6353914
## jp.l2  0.083532106 0.080200378  1.0415426 0.2985255
## const  0.002515688 0.003333798  0.7546012 0.4511248</code></pre>
<div class="sourceCode" id="cb615"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb615-1"><a href="varモデル.html#cb615-1" tabindex="-1"></a><span class="co"># 係数推定値の行列表示 (t値や標準誤差は非表示)</span></span>
<span id="cb615-2"><a href="varモデル.html#cb615-2" tabindex="-1"></a>vars<span class="sc">::</span><span class="fu">Acoef</span>(var2usukjp)     <span class="co"># as a list of matrices</span></span></code></pre></div>
<pre><code>## [[1]]
##          us.l1       uk.l1      jp.l1
## us -0.09089854  0.04814256 0.10502065
## uk  0.08815581 -0.14722739 0.07425889
## jp -0.03081875  0.12818170 0.06593547
## 
## [[2]]
##         us.l2      uk.l2        jp.l2
## us -0.1258501 0.01573282  0.048699966
## uk -0.1643953 0.10454778 -0.009041938
## jp -0.1802714 0.06667562  0.083532106</code></pre>
<div class="sourceCode" id="cb617"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb617-1"><a href="varモデル.html#cb617-1" tabindex="-1"></a>vars<span class="sc">::</span><span class="fu">Bcoef</span>(var2usukjp)     <span class="co"># as a matrix</span></span></code></pre></div>
<pre><code>##          us.l1       uk.l1      jp.l1      us.l2      uk.l2        jp.l2
## us -0.09089854  0.04814256 0.10502065 -0.1258501 0.01573282  0.048699966
## uk  0.08815581 -0.14722739 0.07425889 -0.1643953 0.10454778 -0.009041938
## jp -0.03081875  0.12818170 0.06593547 -0.1802714 0.06667562  0.083532106
##           const
## us 0.0047091176
## uk 0.0006994127
## jp 0.0025156881</code></pre>
<ul>
<li>次数<span class="math inline">\(p\)</span>を選択する場合</li>
<li>VAR()関数によって, 情報量規準により最適な次数を選択
<ul>
<li>最大次数lag.max と採用する情報量規準icを指定</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb619"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb619-1"><a href="varモデル.html#cb619-1" tabindex="-1"></a>varusukjp <span class="ot">&lt;-</span> vars<span class="sc">::</span><span class="fu">VAR</span>(usukjp, <span class="at">type =</span> <span class="st">&quot;const&quot;</span>, <span class="at">lag.max =</span> <span class="dv">5</span>, <span class="at">ic =</span> <span class="st">&quot;AIC&quot;</span>)</span>
<span id="cb619-2"><a href="varモデル.html#cb619-2" tabindex="-1"></a><span class="fu">summary</span>(varusukjp)</span></code></pre></div>
<pre><code>## 
## VAR Estimation Results:
## ========================= 
## Endogenous variables: us, uk, jp 
## Deterministic variables: const 
## Sample size: 287 
## Log Likelihood: 1665.015 
## Roots of the characteristic polynomial:
## 0.2013  0.11 0.1057
## Call:
## vars::VAR(y = usukjp, type = &quot;const&quot;, lag.max = 5, ic = &quot;AIC&quot;)
## 
## 
## Estimation results for equation us: 
## =================================== 
## us = us.l1 + uk.l1 + jp.l1 + const 
## 
##        Estimate Std. Error t value Pr(&gt;|t|)  
## us.l1 -0.085667   0.105734  -0.810   0.4185  
## uk.l1  0.040732   0.111816   0.364   0.7159  
## jp.l1  0.103941   0.064906   1.601   0.1104  
## const  0.004567   0.002676   1.706   0.0891 .
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## 
## Residual standard error: 0.04493 on 283 degrees of freedom
## Multiple R-Squared: 0.01082, Adjusted R-squared: 0.0003306 
## F-statistic: 1.032 on 3 and 283 DF,  p-value: 0.379 
## 
## 
## Estimation results for equation uk: 
## =================================== 
## uk = us.l1 + uk.l1 + jp.l1 + const 
## 
##         Estimate Std. Error t value Pr(&gt;|t|)  
## us.l1  0.1049431  0.0923054   1.137   0.2565  
## uk.l1 -0.1734125  0.0976148  -1.776   0.0767 .
## jp.l1  0.0716409  0.0566630   1.264   0.2072  
## const  0.0001812  0.0023366   0.078   0.9382  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## 
## Residual standard error: 0.03922 on 283 degrees of freedom
## Multiple R-Squared: 0.01708, Adjusted R-squared: 0.006664 
## F-statistic:  1.64 on 3 and 283 DF,  p-value: 0.1804 
## 
## 
## Estimation results for equation jp: 
## =================================== 
## jp = us.l1 + uk.l1 + jp.l1 + const 
## 
##        Estimate Std. Error t value Pr(&gt;|t|)
## us.l1 -0.005737   0.129477  -0.044    0.965
## uk.l1  0.105721   0.136924   0.772    0.441
## jp.l1  0.062151   0.079481   0.782    0.435
## const  0.001936   0.003277   0.591    0.555
## 
## 
## Residual standard error: 0.05502 on 283 degrees of freedom
## Multiple R-Squared: 0.01403, Adjusted R-squared: 0.003578 
## F-statistic: 1.342 on 3 and 283 DF,  p-value: 0.2608 
## 
## 
## 
## Covariance matrix of residuals:
##          us       uk       jp
## us 0.002018 0.001404 0.001628
## uk 0.001404 0.001538 0.001253
## jp 0.001628 0.001253 0.003027
## 
## Correlation matrix of residuals:
##        us     uk     jp
## us 1.0000 0.7967 0.6588
## uk 0.7967 1.0000 0.5806
## jp 0.6588 0.5806 1.0000</code></pre>
<div class="sourceCode" id="cb621"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb621-1"><a href="varモデル.html#cb621-1" tabindex="-1"></a><span class="co"># ic = AIC, HQ, SC, FPE</span></span>
<span id="cb621-2"><a href="varモデル.html#cb621-2" tabindex="-1"></a><span class="co"># HQ: Hannan-Quinn 情報量規準,  FPE: forecast prediction error 規準</span></span></code></pre></div>
<ul>
<li><p>–&gt; <span class="math inline">\(p=1\)</span>を選択</p></li>
<li><p>推定されたVARモデルによる予測</p></li>
</ul>
<div class="sourceCode" id="cb622"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb622-1"><a href="varモデル.html#cb622-1" tabindex="-1"></a><span class="fu">predict</span>(var2usukjp, <span class="at">n.ahead =</span> <span class="dv">10</span>, <span class="at">ci =</span> <span class="fl">0.95</span>)    <span class="co"># 95%区間予測を 10期先まで</span></span></code></pre></div>
<pre><code>## $us
##              fcst       lower      upper         CI
##  [1,] 0.005624242 -0.08215517 0.09340366 0.08777941
##  [2,] 0.005765066 -0.08251720 0.09404734 0.08828227
##  [3,] 0.003707104 -0.08485395 0.09226816 0.08856106
##  [4,] 0.004038195 -0.08452427 0.09260066 0.08856247
##  [5,] 0.004105117 -0.08445804 0.09266828 0.08856316
##  [6,] 0.004151971 -0.08441119 0.09271514 0.08856317
##  [7,] 0.004149753 -0.08441342 0.09271292 0.08856317
##  [8,] 0.004153929 -0.08440924 0.09271710 0.08856317
##  [9,] 0.004153838 -0.08440933 0.09271701 0.08856317
## [10,] 0.004154085 -0.08440909 0.09271726 0.08856317
## 
## $uk
##                fcst       lower      upper         CI
##  [1,]  0.0104454686 -0.06612117 0.08701211 0.07656664
##  [2,] -0.0079088771 -0.08505656 0.06923881 0.07714768
##  [3,]  0.0029379784 -0.07492723 0.08080319 0.07786521
##  [4,] -0.0011392941 -0.07902626 0.07674767 0.07788696
##  [5,]  0.0010377552 -0.07685767 0.07893318 0.07789542
##  [6,]  0.0002574244 -0.07763901 0.07815386 0.07789643
##  [7,]  0.0005911920 -0.07730543 0.07848781 0.07789662
##  [8,]  0.0004565438 -0.07744010 0.07835319 0.07789665
##  [9,]  0.0005105076 -0.07738615 0.07840716 0.07789665
## [10,]  0.0004885750 -0.07740808 0.07838523 0.07789665
## 
## $jp
##               fcst      lower     upper        CI
##  [1,] -0.001907871 -0.1100490 0.1062332 0.1081411
##  [2,]  0.005133879 -0.1037812 0.1140489 0.1089151
##  [3,]  0.001185947 -0.1081508 0.1105227 0.1093368
##  [4,]  0.001718469 -0.1076218 0.1110588 0.1093403
##  [5,]  0.001985179 -0.1073555 0.1113259 0.1093407
##  [6,]  0.001992702 -0.1073480 0.1113334 0.1093407
##  [7,]  0.002047100 -0.1072937 0.1113879 0.1093408
##  [8,]  0.002033691 -0.1073071 0.1113744 0.1093408
##  [9,]  0.002042617 -0.1072981 0.1113834 0.1093408
## [10,]  0.002039275 -0.1073015 0.1113800 0.1093408</code></pre>
</div>
<div id="granger因果性の検定" class="section level4 unnumbered hasAnchor">
<h4>Granger因果性の検定<a href="varモデル.html#granger因果性の検定" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li>日本をcauseとする因果性</li>
</ul>
<div class="sourceCode" id="cb624"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb624-1"><a href="varモデル.html#cb624-1" tabindex="-1"></a>var3usukjp <span class="ot">&lt;-</span> vars<span class="sc">::</span><span class="fu">VAR</span>(usukjp, <span class="at">p =</span> <span class="dv">3</span>, <span class="at">type =</span> <span class="st">&quot;const&quot;</span>)</span>
<span id="cb624-2"><a href="varモデル.html#cb624-2" tabindex="-1"></a><span class="fu">head</span>(var3usukjp<span class="sc">$</span>y)      <span class="co">#</span></span></code></pre></div>
<pre><code>##                     us           uk          jp
## 2000-02-01 -0.02031300 -0.005743495  0.02125795
## 2000-03-01  0.09232375  0.048174179  0.01875144
## 2000-04-01 -0.03127991 -0.033078382 -0.12354810
## 2000-05-01 -0.02215875  0.005044624 -0.09575560
## 2000-06-01  0.02365163 -0.007370510  0.06395117
## 2000-07-01 -0.01647627  0.008297825 -0.10169496</code></pre>
<div class="sourceCode" id="cb626"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb626-1"><a href="varモデル.html#cb626-1" tabindex="-1"></a>vars<span class="sc">::</span><span class="fu">causality</span>(var3usukjp, <span class="at">cause =</span> <span class="st">&quot;jp&quot;</span>) <span class="co"># jp --&gt; us, uk</span></span></code></pre></div>
<pre><code>## $Granger
## 
##  Granger causality H0: jp do not Granger-cause us uk
## 
## data:  VAR object var3usukjp
## F-Test = 0.77736, df1 = 6, df2 = 825, p-value = 0.5878
## 
## 
## $Instant
## 
##  H0: No instantaneous causality between: jp and us uk
## 
## data:  VAR object var3usukjp
## Chi-squared = 87.091, df = 2, p-value &lt; 2.2e-16</code></pre>
<ul>
<li><p>–&gt; Gragnerの意味での因果性なし. 同時因果性あり</p></li>
<li><p>日英をcauseとする因果性</p></li>
</ul>
<div class="sourceCode" id="cb628"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb628-1"><a href="varモデル.html#cb628-1" tabindex="-1"></a>vars<span class="sc">::</span><span class="fu">causality</span>(var3usukjp, <span class="at">cause =</span> <span class="fu">c</span>(<span class="st">&quot;jp&quot;</span>, <span class="st">&quot;uk&quot;</span>))  <span class="co"># jp, uk --&gt; us</span></span></code></pre></div>
<pre><code>## $Granger
## 
##  Granger causality H0: uk jp do not Granger-cause us
## 
## data:  VAR object var3usukjp
## F-Test = 0.60679, df1 = 6, df2 = 825, p-value = 0.7251
## 
## 
## $Instant
## 
##  H0: No instantaneous causality between: uk jp and us
## 
## data:  VAR object var3usukjp
## Chi-squared = 116.62, df = 2, p-value &lt; 2.2e-16</code></pre>
<ul>
<li>–&gt; Grangerの意味での因果性なし. 同時因果性あり</li>
</ul>
<pre><code>- vars::causality()
  - causeを指定なし (デフォルト) では, 第1列の変数がcause
  - K変量VARモデルに対する因果性検定 (対応する係数にゼロ制約を課す)
  - ← 特定の2変量のみの因果性を調べる検定ではない</code></pre>
</div>
<div id="予測誤差分散分解-forecast-error-variance-decomposition-1" class="section level4 unnumbered hasAnchor">
<h4>予測誤差分散分解 (forecast error variance decomposition)<a href="varモデル.html#予測誤差分散分解-forecast-error-variance-decomposition-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li>直交化インパルス応答関数を使い, 第j変数の第k変数のh先予測誤差分散への寄与</li>
</ul>
<div class="sourceCode" id="cb631"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb631-1"><a href="varモデル.html#cb631-1" tabindex="-1"></a><span class="co"># library(vars)</span></span>
<span id="cb631-2"><a href="varモデル.html#cb631-2" tabindex="-1"></a>var3_fevd <span class="ot">&lt;-</span> vars<span class="sc">::</span><span class="fu">fevd</span>(var3usukjp, <span class="at">n.ahead =</span> <span class="dv">10</span>)   <span class="co"># 10期先まで評価する</span></span>
<span id="cb631-3"><a href="varモデル.html#cb631-3" tabindex="-1"></a><span class="fu">plot</span>(var3_fevd)</span>
<span id="cb631-4"><a href="varモデル.html#cb631-4" tabindex="-1"></a></span>
<span id="cb631-5"><a href="varモデル.html#cb631-5" tabindex="-1"></a>varmkt <span class="ot">&lt;-</span> vars<span class="sc">::</span><span class="fu">VAR</span>(mkt, <span class="at">p =</span> <span class="dv">3</span>, <span class="at">type =</span> <span class="st">&quot;const&quot;</span>)</span>
<span id="cb631-6"><a href="varモデル.html#cb631-6" tabindex="-1"></a>varmkt_fevd <span class="ot">&lt;-</span> vars<span class="sc">::</span><span class="fu">fevd</span>(varmkt, <span class="at">n.ahead =</span> <span class="dv">10</span>)     <span class="co"># 10期先まで評価する</span></span>
<span id="cb631-7"><a href="varモデル.html#cb631-7" tabindex="-1"></a><span class="fu">plot</span>(varmkt_fevd)</span></code></pre></div>
<p><img src="093-VAR3_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<ul>
<li>変数の順番の影響の確認</li>
<li>分散分解 (変数の順序入れ替え)</li>
</ul>
<div class="sourceCode" id="cb632"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb632-1"><a href="varモデル.html#cb632-1" tabindex="-1"></a>usjpuk <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(mkt<span class="sc">$</span>us, mkt<span class="sc">$</span>jp, mkt<span class="sc">$</span>uk)</span>
<span id="cb632-2"><a href="varモデル.html#cb632-2" tabindex="-1"></a><span class="fu">cov</span>(usukjp)</span></code></pre></div>
<pre><code>##             us          uk          jp
## us 0.002014229 0.001393846 0.001625483
## uk 0.001393846 0.001543390 0.001241609
## jp 0.001625483 0.001241609 0.003028308</code></pre>
<div class="sourceCode" id="cb634"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb634-1"><a href="varモデル.html#cb634-1" tabindex="-1"></a><span class="fu">cov</span>(usjpuk)</span></code></pre></div>
<pre><code>##             us          jp          uk
## us 0.002014229 0.001625483 0.001393846
## jp 0.001625483 0.003028308 0.001241609
## uk 0.001393846 0.001241609 0.001543390</code></pre>
<div class="sourceCode" id="cb636"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb636-1"><a href="varモデル.html#cb636-1" tabindex="-1"></a>var3usjpuk <span class="ot">&lt;-</span> vars<span class="sc">::</span><span class="fu">VAR</span>(usjpuk, <span class="at">p =</span> <span class="dv">3</span>, <span class="at">type =</span> <span class="st">&quot;const&quot;</span>)</span>
<span id="cb636-2"><a href="varモデル.html#cb636-2" tabindex="-1"></a>var3_fevd_2 <span class="ot">&lt;-</span> vars<span class="sc">::</span><span class="fu">fevd</span>(var3usjpuk, <span class="at">n.ahead =</span> <span class="dv">10</span>)     <span class="co"># 10期先まで評価する</span></span>
<span id="cb636-3"><a href="varモデル.html#cb636-3" tabindex="-1"></a><span class="fu">plot</span>(var3_fevd_2)</span></code></pre></div>
<p><img src="093-VAR3_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
<ul>
<li>直交インパルス応答</li>
<li>米国 → 他市場
<ul>
<li>(米国, 英国, 日本)の順序 vs (米国, 日本, 英国)の順序</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb637"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb637-1"><a href="varモデル.html#cb637-1" tabindex="-1"></a><span class="co"># (us, uk, jp)</span></span>
<span id="cb637-2"><a href="varモデル.html#cb637-2" tabindex="-1"></a>ip1 <span class="ot">&lt;-</span> vars<span class="sc">::</span><span class="fu">irf</span>(var3usukjp, <span class="at">impulse =</span> <span class="fu">c</span>(<span class="st">&quot;us&quot;</span>), <span class="at">n.ahead =</span> <span class="dv">5</span>, <span class="at">boot =</span> <span class="cn">TRUE</span>)</span>
<span id="cb637-3"><a href="varモデル.html#cb637-3" tabindex="-1"></a><span class="co"># ortho = T (デフォルト): 直交化インパルス応答; ortho = F: 非直交化インパルス応答</span></span>
<span id="cb637-4"><a href="varモデル.html#cb637-4" tabindex="-1"></a><span class="co"># boot = T: ブートストラップ法により, 信頼区間計算</span></span>
<span id="cb637-5"><a href="varモデル.html#cb637-5" tabindex="-1"></a><span class="co"># cumulative = T: 累積インパルス応答. デフォルトはF.</span></span>
<span id="cb637-6"><a href="varモデル.html#cb637-6" tabindex="-1"></a><span class="fu">plot</span>(ip1)</span></code></pre></div>
<p><img src="093-VAR3_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
<div class="sourceCode" id="cb638"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb638-1"><a href="varモデル.html#cb638-1" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb638-2"><a href="varモデル.html#cb638-2" tabindex="-1"></a><span class="co"># (us, jp, uk)</span></span>
<span id="cb638-3"><a href="varモデル.html#cb638-3" tabindex="-1"></a>ip2 <span class="ot">&lt;-</span> vars<span class="sc">::</span><span class="fu">irf</span>(var3usjpuk, <span class="at">impulse =</span> <span class="fu">c</span>(<span class="st">&quot;us&quot;</span>), <span class="at">n.ahead =</span> <span class="dv">5</span>, <span class="at">boot =</span> <span class="cn">TRUE</span>)</span>
<span id="cb638-4"><a href="varモデル.html#cb638-4" tabindex="-1"></a><span class="fu">plot</span>(ip2)</span></code></pre></div>
<p><img src="093-VAR3_files/figure-html/unnamed-chunk-20-2.png" width="672" /></p>
<ul>
<li>日本 → 他市場</li>
</ul>
<div class="sourceCode" id="cb639"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb639-1"><a href="varモデル.html#cb639-1" tabindex="-1"></a><span class="co"># (us, uk, jp)</span></span>
<span id="cb639-2"><a href="varモデル.html#cb639-2" tabindex="-1"></a><span class="co">#ip3 &lt;- vars::irf(var3usukjp, impulse = c(&quot;uk&quot;), n.ahead = 5, boot = TRUE)</span></span>
<span id="cb639-3"><a href="varモデル.html#cb639-3" tabindex="-1"></a>ip3 <span class="ot">&lt;-</span> vars<span class="sc">::</span><span class="fu">irf</span>(var3usukjp, <span class="at">impulse =</span> <span class="fu">c</span>(<span class="st">&quot;jp&quot;</span>), <span class="at">n.ahead =</span> <span class="dv">5</span>, <span class="at">boot =</span> <span class="cn">TRUE</span>)</span>
<span id="cb639-4"><a href="varモデル.html#cb639-4" tabindex="-1"></a><span class="fu">plot</span>(ip3)</span></code></pre></div>
<p><img src="093-VAR3_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
<div class="sourceCode" id="cb640"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb640-1"><a href="varモデル.html#cb640-1" tabindex="-1"></a><span class="co"># (us, jp, uk)</span></span>
<span id="cb640-2"><a href="varモデル.html#cb640-2" tabindex="-1"></a>ip4 <span class="ot">&lt;-</span> vars<span class="sc">::</span><span class="fu">irf</span>(var3usjpuk, <span class="at">impulse =</span> <span class="fu">c</span>(<span class="st">&quot;jp&quot;</span>), <span class="at">n.ahead =</span> <span class="dv">5</span>, <span class="at">boot =</span> <span class="cn">TRUE</span>)</span>
<span id="cb640-3"><a href="varモデル.html#cb640-3" tabindex="-1"></a><span class="fu">plot</span>(ip4)</span></code></pre></div>
<p><img src="093-VAR3_files/figure-html/unnamed-chunk-21-2.png" width="672" /></p>
<ul>
<li>確認: Choleski分解: <span class="math inline">\(\Sigma = P P&#39;\)</span></li>
</ul>
<div class="sourceCode" id="cb641"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb641-1"><a href="varモデル.html#cb641-1" tabindex="-1"></a><span class="co">#chol(cov(usjpuk))  # 上三角行列P&#39;</span></span>
<span id="cb641-2"><a href="varモデル.html#cb641-2" tabindex="-1"></a><span class="co"># (us, uk, jp)</span></span>
<span id="cb641-3"><a href="varモデル.html#cb641-3" tabindex="-1"></a><span class="fu">t</span>(<span class="fu">chol</span>(<span class="fu">cov</span>(usukjp)))    <span class="co"># 下三角行列P&#39;</span></span></code></pre></div>
<pre><code>##            us          uk         jp
## us 0.04488016 0.000000000 0.00000000
## uk 0.03105707 0.024059264 0.00000000
## jp 0.03621830 0.004853605 0.04114589</code></pre>
<div class="sourceCode" id="cb643"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb643-1"><a href="varモデル.html#cb643-1" tabindex="-1"></a><span class="co"># (us, jp, uk)</span></span>
<span id="cb643-2"><a href="varモデル.html#cb643-2" tabindex="-1"></a><span class="fu">t</span>(<span class="fu">chol</span>(<span class="fu">cov</span>(usjpuk)))    <span class="co"># 下三角行列P&#39;</span></span></code></pre></div>
<pre><code>##            us         jp        uk
## us 0.04488016 0.00000000 0.0000000
## jp 0.03621830 0.04143117 0.0000000
## uk 0.03105707 0.00281851 0.0238936</code></pre>
<ul>
<li>(参考) Tsay氏作成パッケージMTS</li>
</ul>
<div class="sourceCode" id="cb645"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb645-1"><a href="varモデル.html#cb645-1" tabindex="-1"></a><span class="fu">library</span>(MTS)    <span class="co"># &#39;vars&#39;との同時使用は避ける (VAR()関数が重複)</span></span>
<span id="cb645-2"><a href="varモデル.html#cb645-2" tabindex="-1"></a>var3 <span class="ot">&lt;-</span> MTS<span class="sc">::</span><span class="fu">VAR</span>(usukjp, <span class="at">p =</span> <span class="dv">3</span>) <span class="co"># include.mean = T (デフォルト), VAR係数の最小2乗推定</span></span>
<span id="cb645-3"><a href="varモデル.html#cb645-3" tabindex="-1"></a>MTS<span class="sc">::</span><span class="fu">GrangerTest</span>(usukjp, <span class="at">p =</span> <span class="dv">3</span>) <span class="co"># include.mean = T (デフォルト)</span></span>
<span id="cb645-4"><a href="varモデル.html#cb645-4" tabindex="-1"></a>MTS<span class="sc">::</span><span class="fu">VARMAirf</span>(<span class="at">Phi =</span> var3<span class="sc">$</span>Phi, <span class="at">Sigma =</span> var3<span class="sc">$</span>Sigma)       <span class="co"># Theta = NULL (デフォルト): VMA係数行列</span></span></code></pre></div>
</div>
<div id="その他-granger因果性検定の関数" class="section level4 unnumbered hasAnchor">
<h4>その他: Granger因果性検定の関数<a href="varモデル.html#その他-granger因果性検定の関数" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li>パッケージ<strong>lmtest</strong></li>
</ul>
<pre><code>- grangertest(): 2変量間のGranger因果性検定
  - usage: grangertest(x, y, order = 1, na.action = na.omit, ...)</code></pre>
<div class="sourceCode" id="cb647"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb647-1"><a href="varモデル.html#cb647-1" tabindex="-1"></a><span class="co">#library(lmtest)</span></span>
<span id="cb647-2"><a href="varモデル.html#cb647-2" tabindex="-1"></a><span class="fu">data</span>(ChickEgg)  <span class="co"># mts, tsクラス</span></span>
<span id="cb647-3"><a href="varモデル.html#cb647-3" tabindex="-1"></a><span class="fu">plot</span>(ChickEgg)</span></code></pre></div>
<p><img src="093-VAR3_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
<div class="sourceCode" id="cb648"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb648-1"><a href="varモデル.html#cb648-1" tabindex="-1"></a>lmtest<span class="sc">::</span><span class="fu">grangertest</span>(egg <span class="sc">~</span> chicken, <span class="at">order =</span> <span class="dv">3</span>, <span class="at">data =</span> ChickEgg)  <span class="co"># → 有意でない</span></span></code></pre></div>
<pre><code>## Granger causality test
## 
## Model 1: egg ~ Lags(egg, 1:3) + Lags(chicken, 1:3)
## Model 2: egg ~ Lags(egg, 1:3)
##   Res.Df Df      F Pr(&gt;F)
## 1     44                 
## 2     47 -3 0.5916 0.6238</code></pre>
<div class="sourceCode" id="cb650"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb650-1"><a href="varモデル.html#cb650-1" tabindex="-1"></a>lmtest<span class="sc">::</span><span class="fu">grangertest</span>(chicken <span class="sc">~</span> egg, <span class="at">order =</span> <span class="dv">3</span>, <span class="at">data =</span> ChickEgg)  <span class="co"># → 有意(1%)</span></span></code></pre></div>
<pre><code>## Granger causality test
## 
## Model 1: chicken ~ Lags(chicken, 1:3) + Lags(egg, 1:3)
## Model 2: chicken ~ Lags(chicken, 1:3)
##   Res.Df Df     F   Pr(&gt;F)   
## 1     44                     
## 2     47 -3 5.405 0.002966 **
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb652"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb652-1"><a href="varモデル.html#cb652-1" tabindex="-1"></a><span class="fu">ccf</span>(ChickEgg[, <span class="st">&quot;chicken&quot;</span>], ChickEgg[, <span class="st">&quot;egg&quot;</span>])       <span class="co"># 1: chicken, 2: egg</span></span></code></pre></div>
<p><img src="093-VAR3_files/figure-html/unnamed-chunk-24-2.png" width="672" /></p>
<ul>
<li>パッケージ<strong>NlinTS</strong>: 非線形時系列解析, 因果性検出</li>
</ul>
<pre><code>- causality.test(): 2変量間のGranger因果性検定
  - usage: causality.test(ts1, ts2, lag, diff = FALSE)</code></pre>
<div class="sourceCode" id="cb654"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb654-1"><a href="varモデル.html#cb654-1" tabindex="-1"></a><span class="fu">library</span> (NlinTS)        <span class="co"># 非線形時系列解析, 因果性検出. causality.test()</span></span></code></pre></div>
<pre><code>## Loading required package: Rcpp</code></pre>
<div class="sourceCode" id="cb656"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb656-1"><a href="varモデル.html#cb656-1" tabindex="-1"></a>res1 <span class="ot">&lt;-</span> NlinTS<span class="sc">::</span><span class="fu">causality.test</span>(ChickEgg[, <span class="st">&quot;egg&quot;</span>], ChickEgg[, <span class="st">&quot;chicken&quot;</span>], <span class="at">lag =</span> <span class="dv">3</span>)</span>
<span id="cb656-2"><a href="varモデル.html#cb656-2" tabindex="-1"></a>res2 <span class="ot">&lt;-</span> NlinTS<span class="sc">::</span><span class="fu">causality.test</span>(ChickEgg[, <span class="st">&quot;chicken&quot;</span>], ChickEgg[, <span class="st">&quot;egg&quot;</span>], <span class="at">lag =</span> <span class="dv">3</span>)</span>
<span id="cb656-3"><a href="varモデル.html#cb656-3" tabindex="-1"></a>res1<span class="sc">$</span><span class="fu">summary</span>()</span></code></pre></div>
<pre><code>## --------------------
##     Test summary
## --------------------
## The lag parameter: p = 3
## The Granger causality Index: GCI = 0.0395451
## The value of the F-test: 0.591615
## The p_value of the F-test: 0.623786
## The critical value with 5% of risk:: 2.822</code></pre>
<div class="sourceCode" id="cb658"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb658-1"><a href="varモデル.html#cb658-1" tabindex="-1"></a>res2<span class="sc">$</span><span class="fu">summary</span>()</span></code></pre></div>
<pre><code>## --------------------
##     Test summary
## --------------------
## The lag parameter: p = 3
## The Granger causality Index: GCI = 0.313731
## The value of the F-test: 5.40498
## The p_value of the F-test: 0.0029664
## The critical value with 5% of risk:: 2.822</code></pre>
<ul>
<li><p>–&gt; 上のgrangertst()の結果と同一</p></li>
<li><p>パッケージ<strong>MTS</strong></p></li>
</ul>
<pre><code>- GrangerTest(): p変量のGranger因果性検定
  - usage: GrangerTest(X,p=1,include.mean=T,locInput=c(1))</code></pre>
<div class="sourceCode" id="cb661"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb661-1"><a href="varモデル.html#cb661-1" tabindex="-1"></a><span class="fu">library</span>(MTS)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;MTS&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:vars&#39;:
## 
##     VAR</code></pre>
<pre><code>## The following object is masked from &#39;package:TTR&#39;:
## 
##     VMA</code></pre>
<div class="sourceCode" id="cb665"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb665-1"><a href="varモデル.html#cb665-1" tabindex="-1"></a>EggChick <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">egg =</span> ChickEgg[, <span class="st">&quot;egg&quot;</span>], <span class="at">chicken =</span> ChickEgg[, <span class="st">&quot;chicken&quot;</span>])</span>
<span id="cb665-2"><a href="varモデル.html#cb665-2" tabindex="-1"></a>MTS<span class="sc">::</span><span class="fu">GrangerTest</span>(EggChick, <span class="at">p =</span> <span class="dv">3</span>)   <span class="co"># カイ2乗検定 (F値x3 〜 (漸近的に)Chisq(3))</span></span></code></pre></div>
<pre><code>## Number of targeted zero parameters:  3 
## Chi-square test for Granger Causality and p-value:  1.774846 0.620424 
## Constant term: 
## Estimates:  306.1473 133544.6 
## Std.Error:  132.5194 41073.51 
## AR coefficient matrix 
## AR( 1 )-matrix 
##      [,1]  [,2]
## [1,]  1.3 0.000
## [2,] 76.6 0.292
## standard error 
##        [,1]  [,2]
## [1,]  0.143 0.000
## [2,] 25.279 0.184
## AR( 2 )-matrix 
##         [,1]  [,2]
## [1,]  -0.361 0.000
## [2,] -47.078 0.445
## standard error 
##        [,1]  [,2]
## [1,]  0.234 0.000
## [2,] 39.387 0.186
## AR( 3 )-matrix 
##          [,1]    [,2]
## [1,]   0.0042 0.00000
## [2,] -35.9327 0.00407
## standard error 
##        [,1]  [,2]
## [1,]  0.141 0.000
## [2,] 28.538 0.174
##   
## Residuals cov-mtx: 
##            [,1]      [,2]
## [1,]   22800.12   1843210
## [2,] 1843210.37 412998788
##   
## det(SSE) =  6.018998e+12 
## AIC =  29.75928 
## BIC =  30.09077 
## HQ  =  29.88712</code></pre>
<div class="sourceCode" id="cb667"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb667-1"><a href="varモデル.html#cb667-1" tabindex="-1"></a><span class="co"># MTS::GrangerTest(ChickEgg, p = 3)</span></span></code></pre></div>
<ul>
<li>–&gt; 上のgrangertst()の結果とやや異なる</li>
</ul>

</div>
</div>
</div>
<div id="補足-分散共分散行列のコレスキー分解" class="section level2 hasAnchor" number="9.4">
<h2><span class="header-section-number">9.4</span> 補足: 分散共分散行列のコレスキー分解<a href="varモデル.html#補足-分散共分散行列のコレスキー分解" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>直交化インパルス応答や予測誤差分散分解では, 事前に外生性の高い順に変数を配置しておく必要がある.
直交化する際には, VAR(p)モデルの撹乱項の分散共分散行列に対してCholeskey分解が利用される.</p>
<ul>
<li>分散共分散行列に対するコレスキー (Choleskey) 分解の計算例
<ul>
<li>以下, 簡単のため, VAR(p)モデルは使わない</li>
</ul></li>
</ul>
<!--
- msci日次収益率データの読み込み
  - データ入手先: https://www.asakura.co.jp/detail.php?book_code=12792 -->
<div class="sourceCode" id="cb668"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb668-1"><a href="varモデル.html#cb668-1" tabindex="-1"></a><span class="fu">library</span>(vars)</span></code></pre></div>
<pre><code>## Loading required package: MASS</code></pre>
<pre><code>## Loading required package: strucchange</code></pre>
<pre><code>## Loading required package: zoo</code></pre>
<pre><code>## 
## Attaching package: &#39;zoo&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     as.Date, as.Date.numeric</code></pre>
<pre><code>## Loading required package: sandwich</code></pre>
<pre><code>## Loading required package: urca</code></pre>
<pre><code>## Loading required package: lmtest</code></pre>
<div class="sourceCode" id="cb677"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb677-1"><a href="varモデル.html#cb677-1" tabindex="-1"></a><span class="fu">library</span>(quantmod)</span></code></pre></div>
<pre><code>## Loading required package: xts</code></pre>
<pre><code>## Loading required package: TTR</code></pre>
<pre><code>## Registered S3 method overwritten by &#39;quantmod&#39;:
##   method            from
##   as.zoo.data.frame zoo</code></pre>
<div class="sourceCode" id="cb681"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb681-1"><a href="varモデル.html#cb681-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div>
<pre><code>## ── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
## ✔ dplyr     1.1.2     ✔ readr     2.1.4
## ✔ forcats   1.0.0     ✔ stringr   1.5.0
## ✔ ggplot2   3.4.2     ✔ tibble    3.2.1
## ✔ lubridate 1.9.2     ✔ tidyr     1.3.0
## ✔ purrr     1.0.2</code></pre>
<pre><code>## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
## ✖ stringr::boundary() masks strucchange::boundary()
## ✖ dplyr::filter()     masks stats::filter()
## ✖ dplyr::first()      masks xts::first()
## ✖ dplyr::lag()        masks stats::lag()
## ✖ dplyr::last()       masks xts::last()
## ✖ dplyr::select()     masks MASS::select()
## ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
<div class="sourceCode" id="cb684"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb684-1"><a href="varモデル.html#cb684-1" tabindex="-1"></a>gspc <span class="ot">&lt;-</span> <span class="fu">getSymbols</span>(<span class="st">&#39;^GSPC&#39;</span>, <span class="at">periodicity =</span> <span class="st">&quot;monthly&quot;</span>, <span class="at">from =</span> <span class="st">&#39;1999-12-31&#39;</span>, <span class="at">auto.assign =</span> <span class="cn">FALSE</span>)</span>
<span id="cb684-2"><a href="varモデル.html#cb684-2" tabindex="-1"></a>ftse <span class="ot">&lt;-</span> <span class="fu">getSymbols</span>(<span class="st">&#39;^FTSE&#39;</span>, <span class="at">periodicity =</span> <span class="st">&quot;monthly&quot;</span>, <span class="at">from =</span> <span class="st">&#39;1999-12-31&#39;</span>, <span class="at">auto.assign =</span> <span class="cn">FALSE</span>)</span>
<span id="cb684-3"><a href="varモデル.html#cb684-3" tabindex="-1"></a>n225 <span class="ot">&lt;-</span> <span class="fu">getSymbols</span>(<span class="st">&#39;^N225&#39;</span>, <span class="at">periodicity =</span> <span class="st">&quot;monthly&quot;</span>, <span class="at">from =</span> <span class="st">&#39;1999-12-31&#39;</span>, <span class="at">auto.assign =</span> <span class="cn">FALSE</span>)</span>
<span id="cb684-4"><a href="varモデル.html#cb684-4" tabindex="-1"></a></span>
<span id="cb684-5"><a href="varモデル.html#cb684-5" tabindex="-1"></a>us <span class="ot">&lt;-</span> <span class="fu">diff</span>(<span class="fu">log</span>(gspc<span class="sc">$</span>GSPC.Adjusted))[<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb684-6"><a href="varモデル.html#cb684-6" tabindex="-1"></a>uk <span class="ot">&lt;-</span> <span class="fu">diff</span>(<span class="fu">log</span>(ftse<span class="sc">$</span>FTSE.Adjusted))[<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb684-7"><a href="varモデル.html#cb684-7" tabindex="-1"></a>jp <span class="ot">&lt;-</span> <span class="fu">diff</span>(<span class="fu">log</span>(n225<span class="sc">$</span>N225.Adjusted))[<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb684-8"><a href="varモデル.html#cb684-8" tabindex="-1"></a>mkt <span class="ot">&lt;-</span> <span class="fu">merge.xts</span>(us, uk, jp, <span class="at">all =</span> T)</span>
<span id="cb684-9"><a href="varモデル.html#cb684-9" tabindex="-1"></a></span>
<span id="cb684-10"><a href="varモデル.html#cb684-10" tabindex="-1"></a>idx <span class="ot">&lt;-</span> <span class="fu">complete.cases</span>(mkt) <span class="co"># 欠損値(NA)のあるレコードの除去</span></span>
<span id="cb684-11"><a href="varモデル.html#cb684-11" tabindex="-1"></a>mkt <span class="ot">&lt;-</span> mkt[idx]</span>
<span id="cb684-12"><a href="varモデル.html#cb684-12" tabindex="-1"></a><span class="fu">colnames</span>(mkt) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;us&quot;</span>, <span class="st">&quot;uk&quot;</span>, <span class="st">&quot;jp&quot;</span>)</span>
<span id="cb684-13"><a href="varモデル.html#cb684-13" tabindex="-1"></a></span>
<span id="cb684-14"><a href="varモデル.html#cb684-14" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">cumsum</span>(mkt), <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>),</span>
<span id="cb684-15"><a href="varモデル.html#cb684-15" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Market indices: S&amp;P500 (black), FTSE (blue), NK225 (red)&quot;</span>)</span></code></pre></div>
<p><img src="094_Chol_files/figure-html/unnamed-chunk-1-1.png" width="672" /></p>
<ul>
<li><p>分散共分散行列<span class="math inline">\({\bf \Sigma}\)</span>のCholeskey分解
<span class="math display">\[ {\bf \Sigma} = {\bf P}{\bf P&#39;} \]</span>
但し, <span class="math inline">\({\bf P}\)</span>は下三角行列.</p></li>
<li><p>米英日の日次収益率に対して分散共分散行列を計算 → Choleskey分解</p></li>
</ul>
<div class="sourceCode" id="cb685"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb685-1"><a href="varモデル.html#cb685-1" tabindex="-1"></a><span class="co"># アメリカ、イギリス、日本市場</span></span>
<span id="cb685-2"><a href="varモデル.html#cb685-2" tabindex="-1"></a>usukjp <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(mkt<span class="sc">$</span>us, mkt<span class="sc">$</span>uk, mkt<span class="sc">$</span>jp) </span>
<span id="cb685-3"><a href="varモデル.html#cb685-3" tabindex="-1"></a><span class="fu">head</span>(usukjp, <span class="dv">5</span>) </span></code></pre></div>
<pre><code>##                     us           uk          jp
## 2000-02-01 -0.02031300 -0.005743495  0.02125795
## 2000-03-01  0.09232375  0.048174179  0.01875144
## 2000-04-01 -0.03127991 -0.033078382 -0.12354810
## 2000-05-01 -0.02215875  0.005044624 -0.09575560
## 2000-06-01  0.02365163 -0.007370510  0.06395117</code></pre>
<div class="sourceCode" id="cb687"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb687-1"><a href="varモデル.html#cb687-1" tabindex="-1"></a><span class="co"># 分散共分散行列: Sigma</span></span>
<span id="cb687-2"><a href="varモデル.html#cb687-2" tabindex="-1"></a>cov_usukjp <span class="ot">&lt;-</span> <span class="fu">cov</span>(usukjp) <span class="sc">%&gt;%</span> <span class="fu">print</span>(<span class="at">digits =</span> <span class="dv">4</span>)</span></code></pre></div>
<pre><code>##          us       uk       jp
## us 0.002014 0.001394 0.001625
## uk 0.001394 0.001543 0.001242
## jp 0.001625 0.001242 0.003028</code></pre>
<div class="sourceCode" id="cb689"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb689-1"><a href="varモデル.html#cb689-1" tabindex="-1"></a><span class="co"># Choleskey分解: Sigma = PP&#39;</span></span>
<span id="cb689-2"><a href="varモデル.html#cb689-2" tabindex="-1"></a>P <span class="ot">&lt;-</span> <span class="fu">chol</span>(cov_usukjp) <span class="sc">%&gt;%</span> <span class="fu">t</span>() <span class="sc">%&gt;%</span> <span class="fu">print</span>(<span class="at">digits =</span> <span class="dv">4</span>) <span class="co"># 下三角行列P</span></span></code></pre></div>
<pre><code>##         us       uk      jp
## us 0.04488 0.000000 0.00000
## uk 0.03106 0.024059 0.00000
## jp 0.03622 0.004854 0.04115</code></pre>
<div class="sourceCode" id="cb691"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb691-1"><a href="varモデル.html#cb691-1" tabindex="-1"></a><span class="co"># Sigmaの復元 (確認用)</span></span>
<span id="cb691-2"><a href="varモデル.html#cb691-2" tabindex="-1"></a>P <span class="sc">%*%</span> <span class="fu">t</span>(P) <span class="sc">%&gt;%</span> <span class="fu">print</span>(<span class="at">digits =</span> <span class="dv">4</span>)</span></code></pre></div>
<pre><code>##          us       uk       jp
## us 0.002014 0.001394 0.001625
## uk 0.001394 0.001543 0.001242
## jp 0.001625 0.001242 0.003028</code></pre>
<ul>
<li>米日英の分散共分散行列を計算 → Choleskey分解</li>
</ul>
<div class="sourceCode" id="cb693"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb693-1"><a href="varモデル.html#cb693-1" tabindex="-1"></a><span class="co"># アメリカ、日本, 英国市場</span></span>
<span id="cb693-2"><a href="varモデル.html#cb693-2" tabindex="-1"></a>usjpuk <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(mkt<span class="sc">$</span>us, mkt<span class="sc">$</span>jp, mkt<span class="sc">$</span>uk) </span>
<span id="cb693-3"><a href="varモデル.html#cb693-3" tabindex="-1"></a><span class="fu">head</span>(usjpuk, <span class="dv">5</span>) </span></code></pre></div>
<pre><code>##                     us          jp           uk
## 2000-02-01 -0.02031300  0.02125795 -0.005743495
## 2000-03-01  0.09232375  0.01875144  0.048174179
## 2000-04-01 -0.03127991 -0.12354810 -0.033078382
## 2000-05-01 -0.02215875 -0.09575560  0.005044624
## 2000-06-01  0.02365163  0.06395117 -0.007370510</code></pre>
<div class="sourceCode" id="cb695"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb695-1"><a href="varモデル.html#cb695-1" tabindex="-1"></a><span class="co"># 分散共分散行列: Sigma</span></span>
<span id="cb695-2"><a href="varモデル.html#cb695-2" tabindex="-1"></a>cov_usjpuk <span class="ot">&lt;-</span> <span class="fu">cov</span>(usjpuk) <span class="sc">%&gt;%</span> <span class="fu">print</span>(<span class="at">digits =</span> <span class="dv">4</span>)</span></code></pre></div>
<pre><code>##          us       jp       uk
## us 0.002014 0.001625 0.001394
## jp 0.001625 0.003028 0.001242
## uk 0.001394 0.001242 0.001543</code></pre>
<div class="sourceCode" id="cb697"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb697-1"><a href="varモデル.html#cb697-1" tabindex="-1"></a><span class="co"># Choleskey分解: Sigma = PP&#39;</span></span>
<span id="cb697-2"><a href="varモデル.html#cb697-2" tabindex="-1"></a>P <span class="ot">&lt;-</span> <span class="fu">chol</span>(cov_usjpuk) <span class="sc">%&gt;%</span> <span class="fu">t</span>() <span class="sc">%&gt;%</span> <span class="fu">print</span>(<span class="at">digits =</span> <span class="dv">4</span>) <span class="co"># 下三角行列P</span></span></code></pre></div>
<pre><code>##         us       jp      uk
## us 0.04488 0.000000 0.00000
## jp 0.03622 0.041431 0.00000
## uk 0.03106 0.002819 0.02389</code></pre>
<div class="sourceCode" id="cb699"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb699-1"><a href="varモデル.html#cb699-1" tabindex="-1"></a><span class="co"># Sigmaの復元 (確認用)</span></span>
<span id="cb699-2"><a href="varモデル.html#cb699-2" tabindex="-1"></a>P <span class="sc">%*%</span> <span class="fu">t</span>(P) <span class="sc">%&gt;%</span> <span class="fu">print</span>(<span class="at">digits =</span> <span class="dv">4</span>)</span></code></pre></div>
<pre><code>##          us       jp       uk
## us 0.002014 0.001625 0.001394
## jp 0.001625 0.003028 0.001242
## uk 0.001394 0.001242 0.001543</code></pre>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="garchモデル.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="共和分分析誤差修正モデル.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
