<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>8 GARCHモデル | 金融時系列解析</title>
  <meta name="description" content="8 GARCHモデル | 金融時系列解析" />
  <meta name="generator" content="bookdown 0.40 and GitBook 2.6.7" />

  <meta property="og:title" content="8 GARCHモデル | 金融時系列解析" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="8 GARCHモデル | 金融時系列解析" />
  
  
  

<meta name="author" content="林 高樹" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="レジームスイッチングモデル.html"/>
<link rel="next" href="varモデル.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> はじめに</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#時系列モデリング"><i class="fa fa-check"></i><b>1.1</b> 時系列モデリング</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#金融時系列データの特徴"><i class="fa fa-check"></i><b>1.2</b> 金融時系列データの特徴</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#金融時系列データの特徴-みずほ-8411-株価データの例"><i class="fa fa-check"></i>金融時系列データの特徴: みずほ (8411) 株価データの例</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#シミュレーションによるサンプルパス生成"><i class="fa fa-check"></i><b>1.3</b> シミュレーションによるサンプルパス生成</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#rにおける時系列オブジェクトクラスおよび関数の例"><i class="fa fa-check"></i><b>1.4</b> Rにおける時系列オブジェクト・クラスおよび関数の例</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="index.html"><a href="index.html#日付時間データに対するクラス"><i class="fa fa-check"></i><b>1.4.1</b> 日付・時間データに対するクラス</a></li>
<li class="chapter" data-level="1.4.2" data-path="index.html"><a href="index.html#時系列データに対するクラス1-tsクラス"><i class="fa fa-check"></i><b>1.4.2</b> 時系列データに対するクラス(1): tsクラス</a></li>
<li class="chapter" data-level="1.4.3" data-path="index.html"><a href="index.html#時系列データに対するクラス2-zooクラスとxtsクラス"><i class="fa fa-check"></i><b>1.4.3</b> 時系列データに対するクラス(2): zooクラスとxtsクラス</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#時系列データの分解"><i class="fa fa-check"></i><b>1.5</b> 時系列データの分解</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="index.html"><a href="index.html#トレンド抽出-平滑化-smoothing"><i class="fa fa-check"></i><b>1.5.1</b> トレンド抽出, 平滑化 (smoothing)</a></li>
<li class="chapter" data-level="1.5.2" data-path="index.html"><a href="index.html#分解モデル"><i class="fa fa-check"></i><b>1.5.2</b> 分解モデル</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="定常性と自己相関関数.html"><a href="定常性と自己相関関数.html"><i class="fa fa-check"></i><b>2</b> 定常性と自己相関関数</a>
<ul>
<li class="chapter" data-level="2.1" data-path="定常性と自己相関関数.html"><a href="定常性と自己相関関数.html#確率過程の2次特性-平均関数と自己共分散関数"><i class="fa fa-check"></i><b>2.1</b> 確率過程の2次特性: 平均関数と自己共分散関数</a></li>
<li class="chapter" data-level="2.2" data-path="定常性と自己相関関数.html"><a href="定常性と自己相関関数.html#定常性-stationarity"><i class="fa fa-check"></i><b>2.2</b> 定常性 (stationarity)</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="定常性と自己相関関数.html"><a href="定常性と自己相関関数.html#強定常性"><i class="fa fa-check"></i><b>2.2.1</b> 強定常性</a></li>
<li class="chapter" data-level="2.2.2" data-path="定常性と自己相関関数.html"><a href="定常性と自己相関関数.html#弱定常性"><i class="fa fa-check"></i><b>2.2.2</b> 弱定常性</a></li>
<li class="chapter" data-level="2.2.3" data-path="定常性と自己相関関数.html"><a href="定常性と自己相関関数.html#ホワイトノイズ"><i class="fa fa-check"></i><b>2.2.3</b> ホワイトノイズ</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="定常性と自己相関関数.html"><a href="定常性と自己相関関数.html#標本平均と標本自己共分散関数"><i class="fa fa-check"></i><b>2.3</b> 標本平均と標本自己共分散関数</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="定常性と自己相関関数.html"><a href="定常性と自己相関関数.html#アンサンブル平均-vs-標本平均"><i class="fa fa-check"></i><b>2.3.1</b> アンサンブル平均 vs 標本平均</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="定常性と自己相関関数.html"><a href="定常性と自己相関関数.html#r操作-標本acf"><i class="fa fa-check"></i><b>2.4</b> R操作: 標本ACF</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="定常性と自己相関関数.html"><a href="定常性と自己相関関数.html#白色ノイズ"><i class="fa fa-check"></i><b>2.4.1</b> 白色ノイズ</a></li>
<li class="chapter" data-level="2.4.2" data-path="定常性と自己相関関数.html"><a href="定常性と自己相関関数.html#ランダムウォーク"><i class="fa fa-check"></i><b>2.4.2</b> ランダムウォーク</a></li>
<li class="chapter" data-level="2.4.3" data-path="定常性と自己相関関数.html"><a href="定常性と自己相関関数.html#非定常成分を含む時系列"><i class="fa fa-check"></i><b>2.4.3</b> 非定常成分を含む時系列</a></li>
<li class="chapter" data-level="2.4.4" data-path="定常性と自己相関関数.html"><a href="定常性と自己相関関数.html#線形定常時系列モデル"><i class="fa fa-check"></i><b>2.4.4</b> 線形・定常時系列モデル</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="定常性と自己相関関数.html"><a href="定常性と自己相関関数.html#母acf-vs-標本acf"><i class="fa fa-check"></i><b>2.5</b> 母ACF vs 標本ACF</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="armapqモデル.html"><a href="armapqモデル.html"><i class="fa fa-check"></i><b>3</b> ARMA<span class="math inline">\((p,q)\)</span>モデル</a>
<ul>
<li class="chapter" data-level="3.1" data-path="armapqモデル.html"><a href="armapqモデル.html#armapqモデルとは"><i class="fa fa-check"></i><b>3.1</b> ARMA<span class="math inline">\((p,q)\)</span>モデルとは</a>
<ul>
<li class="chapter" data-level="" data-path="armapqモデル.html"><a href="armapqモデル.html#因果性と反転可能性"><i class="fa fa-check"></i>因果性と反転可能性</a></li>
<li class="chapter" data-level="" data-path="armapqモデル.html"><a href="armapqモデル.html#armapqモデルの意義"><i class="fa fa-check"></i>ARMA<span class="math inline">\((p,q)\)</span>モデルの意義</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="armapqモデル.html"><a href="armapqモデル.html#armapqモデルによる予測"><i class="fa fa-check"></i><b>3.2</b> ARMA<span class="math inline">\((p,q)\)</span>モデルによる予測</a></li>
<li class="chapter" data-level="3.3" data-path="armapqモデル.html"><a href="armapqモデル.html#armapqモデルの推定"><i class="fa fa-check"></i><b>3.3</b> ARMA<span class="math inline">\((p,q)\)</span>モデルの推定</a></li>
<li class="chapter" data-level="3.4" data-path="armapqモデル.html"><a href="armapqモデル.html#armapqモデルの同定-次数の特定"><i class="fa fa-check"></i><b>3.4</b> ARMA<span class="math inline">\((p,q)\)</span>モデルの同定 (次数の特定)</a></li>
<li class="chapter" data-level="3.5" data-path="armapqモデル.html"><a href="armapqモデル.html#r操作"><i class="fa fa-check"></i><b>3.5</b> R操作</a>
<ul>
<li class="chapter" data-level="" data-path="armapqモデル.html"><a href="armapqモデル.html#armapqモデルの同定-acfpacfeacfの利用"><i class="fa fa-check"></i>ARMA<span class="math inline">\((p,q)\)</span>モデルの同定 (ACF/PACF/EACFの利用)</a></li>
<li class="chapter" data-level="" data-path="armapqモデル.html"><a href="armapqモデル.html#armapqモデルの推定診断"><i class="fa fa-check"></i>ARMA<span class="math inline">\((p,q)\)</span>モデルの推定・診断</a></li>
<li class="chapter" data-level="" data-path="armapqモデル.html"><a href="armapqモデル.html#パッケージforecastの利用"><i class="fa fa-check"></i>パッケージ{forecast}の利用</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="armapqモデル.html"><a href="armapqモデル.html#データ分析例-tsay-ch2より"><i class="fa fa-check"></i><b>3.6</b> データ分析例 (Tsay, Ch2より)</a>
<ul>
<li class="chapter" data-level="" data-path="armapqモデル.html"><a href="armapqモデル.html#標本acf"><i class="fa fa-check"></i>標本ACF</a></li>
<li class="chapter" data-level="" data-path="armapqモデル.html"><a href="armapqモデル.html#ar-ma-arma-2.42.6"><i class="fa fa-check"></i>AR, MA, ARMA (2.4–2.6)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="arimasarimaモデル.html"><a href="arimasarimaモデル.html"><i class="fa fa-check"></i><b>4</b> ARIMA/SARIMAモデル</a>
<ul>
<li class="chapter" data-level="4.1" data-path="arimasarimaモデル.html"><a href="arimasarimaモデル.html#arimapdqモデルとは"><i class="fa fa-check"></i><b>4.1</b> ARIMA<span class="math inline">\((p,d,q)\)</span>モデルとは</a></li>
<li class="chapter" data-level="4.2" data-path="arimasarimaモデル.html"><a href="arimasarimaモデル.html#sarimapdqtimes-pdq_sモデル-周期sとは"><i class="fa fa-check"></i><b>4.2</b> SARIMA<span class="math inline">\((p,d,q)\times (P,D,Q)_s\)</span>モデル (周期<span class="math inline">\(s\)</span>)とは</a></li>
<li class="chapter" data-level="4.3" data-path="arimasarimaモデル.html"><a href="arimasarimaモデル.html#sarimaモデルのパス生成-パッケージsarimaの利用"><i class="fa fa-check"></i><b>4.3</b> SARIMAモデルのパス生成: パッケージ<strong>sarima</strong>の利用</a></li>
<li class="chapter" data-level="4.4" data-path="arimasarimaモデル.html"><a href="arimasarimaモデル.html#sarimaモデルの推定診断"><i class="fa fa-check"></i><b>4.4</b> SARIMAモデルの推定・診断</a>
<ul>
<li class="chapter" data-level="" data-path="arimasarimaモデル.html"><a href="arimasarimaモデル.html#パッケージforecastの利用-1"><i class="fa fa-check"></i>パッケージ<strong>forecast</strong>の利用</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="arimasarimaモデル.html"><a href="arimasarimaモデル.html#データ分析例"><i class="fa fa-check"></i><b>4.5</b> データ分析例</a>
<ul>
<li class="chapter" data-level="" data-path="arimasarimaモデル.html"><a href="arimasarimaモデル.html#データセット-bonds"><i class="fa fa-check"></i>データセット: bonds</a></li>
<li class="chapter" data-level="" data-path="arimasarimaモデル.html"><a href="arimasarimaモデル.html#データセット-airpassengers"><i class="fa fa-check"></i>データセット: AirPassengers</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="arimasarimaモデル.html"><a href="arimasarimaモデル.html#外生的トレンドがあるケース"><i class="fa fa-check"></i><b>4.6</b> 外生的トレンドがあるケース</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="確率的トレンドと単位根検定.html"><a href="確率的トレンドと単位根検定.html"><i class="fa fa-check"></i><b>5</b> 確率的トレンドと単位根検定</a>
<ul>
<li class="chapter" data-level="5.1" data-path="確率的トレンドと単位根検定.html"><a href="確率的トレンドと単位根検定.html#確率的トレンド-vs-確定的トレンド"><i class="fa fa-check"></i><b>5.1</b> 確率的トレンド vs 確定的トレンド</a></li>
<li class="chapter" data-level="5.2" data-path="確率的トレンドと単位根検定.html"><a href="確率的トレンドと単位根検定.html#単位根過程と見せかけの回帰"><i class="fa fa-check"></i><b>5.2</b> 単位根過程と見せかけの回帰</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="確率的トレンドと単位根検定.html"><a href="確率的トレンドと単位根検定.html#単位根過程"><i class="fa fa-check"></i><b>5.2.1</b> 単位根過程</a></li>
<li class="chapter" data-level="5.2.2" data-path="確率的トレンドと単位根検定.html"><a href="確率的トレンドと単位根検定.html#見せかけの回帰"><i class="fa fa-check"></i><b>5.2.2</b> 見せかけの回帰</a></li>
<li class="chapter" data-level="5.2.3" data-path="確率的トレンドと単位根検定.html"><a href="確率的トレンドと単位根検定.html#見せかけの回帰の判定"><i class="fa fa-check"></i><b>5.2.3</b> 見せかけの回帰の判定</a></li>
<li class="chapter" data-level="5.2.4" data-path="確率的トレンドと単位根検定.html"><a href="確率的トレンドと単位根検定.html#rで実行可能な主な単位根検定法"><i class="fa fa-check"></i><b>5.2.4</b> Rで実行可能な主な単位根検定法</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="確率的トレンドと単位根検定.html"><a href="確率的トレンドと単位根検定.html#augmented-dicky-fuller-adf-検定"><i class="fa fa-check"></i><b>5.3</b> Augmented Dicky-Fuller (ADF) 検定</a>
<ul>
<li class="chapter" data-level="" data-path="確率的トレンドと単位根検定.html"><a href="確率的トレンドと単位根検定.html#パッケージfunitroots"><i class="fa fa-check"></i>パッケージ<strong>fUnitRoots</strong></a></li>
<li class="chapter" data-level="" data-path="確率的トレンドと単位根検定.html"><a href="確率的トレンドと単位根検定.html#パッケージtseries"><i class="fa fa-check"></i>パッケージ<strong>tseries</strong></a></li>
<li class="chapter" data-level="" data-path="確率的トレンドと単位根検定.html"><a href="確率的トレンドと単位根検定.html#パッケージurca"><i class="fa fa-check"></i>パッケージ<strong>urca</strong></a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="確率的トレンドと単位根検定.html"><a href="確率的トレンドと単位根検定.html#adf検定以外の検定法"><i class="fa fa-check"></i><b>5.4</b> ADF検定以外の検定法</a>
<ul>
<li class="chapter" data-level="" data-path="確率的トレンドと単位根検定.html"><a href="確率的トレンドと単位根検定.html#phillips-perron-pp-検定"><i class="fa fa-check"></i>Phillips-Perron (PP) 検定</a></li>
<li class="chapter" data-level="" data-path="確率的トレンドと単位根検定.html"><a href="確率的トレンドと単位根検定.html#kwiatkowski-phillips-schmidt-shin-kpss-検定"><i class="fa fa-check"></i>Kwiatkowski-Phillips-Schmidt-Shin (KPSS) 検定</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="長期記憶過程.html"><a href="長期記憶過程.html"><i class="fa fa-check"></i><b>6</b> 長期記憶過程</a>
<ul>
<li class="chapter" data-level="6.1" data-path="長期記憶過程.html"><a href="長期記憶過程.html#長期記憶過程のシミュレーション"><i class="fa fa-check"></i><b>6.1</b> 長期記憶過程のシミュレーション</a>
<ul>
<li class="chapter" data-level="" data-path="長期記憶過程.html"><a href="長期記憶過程.html#パッケージfracdiffの利用"><i class="fa fa-check"></i>パッケージ<strong>fracdiff</strong>の利用</a></li>
<li class="chapter" data-level="" data-path="長期記憶過程.html"><a href="長期記憶過程.html#パッケージlongmemoの利用"><i class="fa fa-check"></i>パッケージ<strong>longmemo</strong>の利用</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="長期記憶過程.html"><a href="長期記憶過程.html#hurst指数の推定"><i class="fa fa-check"></i><b>6.2</b> Hurst指数の推定</a>
<ul>
<li class="chapter" data-level="" data-path="長期記憶過程.html"><a href="長期記憶過程.html#パッケージpracmaの利用"><i class="fa fa-check"></i>パッケージ<strong>pracma</strong>の利用</a></li>
<li class="chapter" data-level="" data-path="長期記憶過程.html"><a href="長期記憶過程.html#パッケージfractalの利用"><i class="fa fa-check"></i>パッケージ<strong>fractal</strong>の利用</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="長期記憶過程.html"><a href="長期記憶過程.html#arfimaモデルの推定"><i class="fa fa-check"></i><b>6.3</b> ARFIMAモデルの推定</a>
<ul>
<li class="chapter" data-level="" data-path="長期記憶過程.html"><a href="長期記憶過程.html#パッケージfracdiffの利用-1"><i class="fa fa-check"></i>パッケージ<strong>fracdiff</strong>の利用</a></li>
<li class="chapter" data-level="" data-path="長期記憶過程.html"><a href="長期記憶過程.html#パッケージnsarfimaの利用"><i class="fa fa-check"></i>パッケージ<strong>nsarfima</strong>の利用</a></li>
<li class="chapter" data-level="" data-path="長期記憶過程.html"><a href="長期記憶過程.html#階差次数dの代替的推定法"><i class="fa fa-check"></i>階差次数<span class="math inline">\(d\)</span>の代替的推定法</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="長期記憶過程.html"><a href="長期記憶過程.html#arfimaモデル-データ分析例-1"><i class="fa fa-check"></i><b>6.4</b> ARFIMAモデル: データ分析例 (1)</a></li>
<li class="chapter" data-level="6.5" data-path="長期記憶過程.html"><a href="長期記憶過程.html#arfimaモデル-データ分析例-2"><i class="fa fa-check"></i><b>6.5</b> ARFIMAモデル: データ分析例 (2)</a>
<ul>
<li class="chapter" data-level="" data-path="長期記憶過程.html"><a href="長期記憶過程.html#最適なarfimaモデルの選択および推定"><i class="fa fa-check"></i>最適なARFIMAモデルの選択および推定</a></li>
<li class="chapter" data-level="" data-path="長期記憶過程.html"><a href="長期記憶過程.html#arfimaモデルによる外挿予測"><i class="fa fa-check"></i>ARFIMAモデルによる外挿予測</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="レジームスイッチングモデル.html"><a href="レジームスイッチングモデル.html"><i class="fa fa-check"></i><b>7</b> レジーム・スイッチング・モデル</a>
<ul>
<li class="chapter" data-level="7.1" data-path="レジームスイッチングモデル.html"><a href="レジームスイッチングモデル.html#自己回帰マルコフスイッチングモデル-msm-ar"><i class="fa fa-check"></i><b>7.1</b> 自己回帰マルコフ・スイッチング・モデル (MSM-AR)</a></li>
<li class="chapter" data-level="7.2" data-path="レジームスイッチングモデル.html"><a href="レジームスイッチングモデル.html#msm-arモデルの適合"><i class="fa fa-check"></i><b>7.2</b> MSM-ARモデルの適合</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="garchモデル.html"><a href="garchモデル.html"><i class="fa fa-check"></i><b>8</b> GARCHモデル</a>
<ul>
<li class="chapter" data-level="8.1" data-path="garchモデル.html"><a href="garchモデル.html#収益率データとarch効果"><i class="fa fa-check"></i><b>8.1</b> 収益率データとARCH効果</a></li>
<li class="chapter" data-level="8.2" data-path="garchモデル.html"><a href="garchモデル.html#archgarchモデル"><i class="fa fa-check"></i><b>8.2</b> ARCH/GARCHモデル</a>
<ul>
<li class="chapter" data-level="" data-path="garchモデル.html"><a href="garchモデル.html#garchpqモデル"><i class="fa fa-check"></i>GARCH(p,q)モデル</a></li>
<li class="chapter" data-level="" data-path="garchモデル.html"><a href="garchモデル.html#garchモデリング"><i class="fa fa-check"></i>GARCHモデリング</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="garchモデル.html"><a href="garchモデル.html#archgarchモデルのシミュレーション"><i class="fa fa-check"></i><b>8.3</b> ARCH/GARCHモデルのシミュレーション</a>
<ul>
<li class="chapter" data-level="" data-path="garchモデル.html"><a href="garchモデル.html#パッケージfgarchの利用"><i class="fa fa-check"></i>パッケージ<strong>fGarch</strong>の利用</a></li>
<li class="chapter" data-level="" data-path="garchモデル.html"><a href="garchモデル.html#archpモデル"><i class="fa fa-check"></i>ARCH(p)モデル</a></li>
<li class="chapter" data-level="" data-path="garchモデル.html"><a href="garchモデル.html#garchpqモデル-1"><i class="fa fa-check"></i>GARCH(p,q)モデル</a></li>
<li class="chapter" data-level="" data-path="garchモデル.html"><a href="garchモデル.html#armapq-garchpqモデル"><i class="fa fa-check"></i>ARMA(p’,q’)-GARCH(p,q)モデル</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="garchモデル.html"><a href="garchモデル.html#archgarchモデルの適合"><i class="fa fa-check"></i><b>8.4</b> ARCH/GARCHモデルの適合</a>
<ul>
<li class="chapter" data-level="" data-path="garchモデル.html"><a href="garchモデル.html#パッケージrugarchの利用"><i class="fa fa-check"></i>パッケージ<strong>rugarch</strong>の利用</a></li>
<li class="chapter" data-level="" data-path="garchモデル.html"><a href="garchモデル.html#iarch11"><i class="fa fa-check"></i>IARCH(1,1)</a></li>
<li class="chapter" data-level="" data-path="garchモデル.html"><a href="garchモデル.html#gjr-garch11"><i class="fa fa-check"></i>GJR-GARCH(1,1)</a></li>
<li class="chapter" data-level="" data-path="garchモデル.html"><a href="garchモデル.html#aparch"><i class="fa fa-check"></i>APARCH</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="garchモデル.html"><a href="garchモデル.html#garchモデル-データ分析例-tsay-ch4"><i class="fa fa-check"></i><b>8.5</b> GARCHモデル: データ分析例 (Tsay, Ch4)</a>
<ul>
<li class="chapter" data-level="" data-path="garchモデル.html"><a href="garchモデル.html#必要な関数やデータセットの入手"><i class="fa fa-check"></i>必要な関数やデータセットの入手</a></li>
<li class="chapter" data-level="" data-path="garchモデル.html"><a href="garchモデル.html#integrated-garch-モデル"><i class="fa fa-check"></i>Integrated GARCH モデル</a></li>
<li class="chapter" data-level="" data-path="garchモデル.html"><a href="garchモデル.html#garch-m-モデル"><i class="fa fa-check"></i>GARCH-M モデル</a></li>
<li class="chapter" data-level="" data-path="garchモデル.html"><a href="garchモデル.html#exponential-garch-model"><i class="fa fa-check"></i>Exponential GARCH Model</a></li>
<li class="chapter" data-level="" data-path="garchモデル.html"><a href="garchモデル.html#threshold-garch-モデル"><i class="fa fa-check"></i>Threshold GARCH モデル</a></li>
<li class="chapter" data-level="" data-path="garchモデル.html"><a href="garchモデル.html#asymmetric-power-arch-モデル"><i class="fa fa-check"></i>Asymmetric Power ARCH モデル</a></li>
<li class="chapter" data-level="" data-path="garchモデル.html"><a href="garchモデル.html#nonsymmetric-garch-モデル"><i class="fa fa-check"></i>Nonsymmetric GARCH モデル</a></li>
<li class="chapter" data-level="" data-path="garchモデル.html"><a href="garchモデル.html#代替的アプリーチ間の比較"><i class="fa fa-check"></i>代替的アプリーチ間の比較</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="varモデル.html"><a href="varモデル.html"><i class="fa fa-check"></i><b>9</b> VARモデル</a>
<ul>
<li class="chapter" data-level="9.1" data-path="varモデル.html"><a href="varモデル.html#varpモデルのシミュレーション"><i class="fa fa-check"></i><b>9.1</b> VAR(<span class="math inline">\(p\)</span>)モデルのシミュレーション</a>
<ul>
<li class="chapter" data-level="" data-path="varモデル.html"><a href="varモデル.html#パッケージmts-varsの利用"><i class="fa fa-check"></i>パッケージ<strong>MTS</strong>, <strong>vars</strong>の利用</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="varモデル.html"><a href="varモデル.html#varpモデルの構築"><i class="fa fa-check"></i><b>9.2</b> VAR(<span class="math inline">\(p\)</span>)モデルの構築</a>
<ul>
<li class="chapter" data-level="" data-path="varモデル.html"><a href="varモデル.html#varpモデルの次数同定"><i class="fa fa-check"></i>VAR(<span class="math inline">\(p\)</span>)モデルの次数同定</a></li>
<li class="chapter" data-level="" data-path="varモデル.html"><a href="varモデル.html#varpモデルの推定"><i class="fa fa-check"></i>VAR(<span class="math inline">\(p\)</span>)モデルの推定</a></li>
<li class="chapter" data-level="" data-path="varモデル.html"><a href="varモデル.html#varpモデル予測"><i class="fa fa-check"></i>VAR(<span class="math inline">\(p\)</span>)モデル予測</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="varモデル.html"><a href="varモデル.html#var解析"><i class="fa fa-check"></i><b>9.3</b> VAR解析</a>
<ul>
<li class="chapter" data-level="" data-path="varモデル.html"><a href="varモデル.html#varp-モデルの構築-復習"><i class="fa fa-check"></i>VAR(<span class="math inline">\(p\)</span>) モデルの構築 (復習)</a></li>
<li class="chapter" data-level="" data-path="varモデル.html"><a href="varモデル.html#グレンジャーの因果性検定"><i class="fa fa-check"></i>グレンジャーの因果性検定</a></li>
<li class="chapter" data-level="" data-path="varモデル.html"><a href="varモデル.html#インパルス応答"><i class="fa fa-check"></i>インパルス応答</a></li>
<li class="chapter" data-level="" data-path="varモデル.html"><a href="varモデル.html#予測誤差分散分解-forecast-error-variance-decomposition"><i class="fa fa-check"></i>予測誤差分散分解 (forecast error variance decomposition)</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="varモデル.html"><a href="varモデル.html#var解析-データ分析例"><i class="fa fa-check"></i><b>9.4</b> VAR解析 (データ分析例)</a>
<ul>
<li class="chapter" data-level="" data-path="varモデル.html"><a href="varモデル.html#事例1-ソフトバンク9434-vs-ソフトバンクグループ9984"><i class="fa fa-check"></i>事例1: ソフトバンク(9434) vs ソフトバンクグループ(9984)</a></li>
<li class="chapter" data-level="" data-path="varモデル.html"><a href="varモデル.html#事例2-米英日3株式市場-sp500-ftse-日経平均"><i class="fa fa-check"></i>事例2: 米英日3株式市場 (S&amp;P500, FTSE, 日経平均)</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="varモデル.html"><a href="varモデル.html#補足-分散共分散行列のコレスキー分解"><i class="fa fa-check"></i><b>9.5</b> 補足: 分散共分散行列のコレスキー分解</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="共和分分析.html"><a href="共和分分析.html"><i class="fa fa-check"></i><b>10</b> 共和分分析</a>
<ul>
<li class="chapter" data-level="10.1" data-path="共和分分析.html"><a href="共和分分析.html#見せかけの回帰-再掲"><i class="fa fa-check"></i><b>10.1</b> 見せかけの回帰 (再掲)</a>
<ul>
<li class="chapter" data-level="" data-path="共和分分析.html"><a href="共和分分析.html#durbin-watson検定"><i class="fa fa-check"></i>Durbin-Watson検定</a></li>
<li class="chapter" data-level="" data-path="共和分分析.html"><a href="共和分分析.html#rで実行可能な主な単位根検定法-1"><i class="fa fa-check"></i>Rで実行可能な主な単位根検定法</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="共和分分析.html"><a href="共和分分析.html#共和分分析-1"><i class="fa fa-check"></i><b>10.2</b> 共和分分析</a>
<ul>
<li class="chapter" data-level="" data-path="共和分分析.html"><a href="共和分分析.html#englegrangerの方法-philips-ouliaris検定"><i class="fa fa-check"></i>Engle–Grangerの方法 (Philips-Ouliaris検定)</a></li>
<li class="chapter" data-level="" data-path="共和分分析.html"><a href="共和分分析.html#johansenの方法"><i class="fa fa-check"></i>Johansenの方法</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="共和分分析.html"><a href="共和分分析.html#誤差修正モデル-データ分析例-tsay-mts-ch5"><i class="fa fa-check"></i><b>10.3</b> 誤差修正モデル: データ分析例 (Tsay, MTS, Ch5)</a>
<ul>
<li class="chapter" data-level="" data-path="共和分分析.html"><a href="共和分分析.html#共和分検定"><i class="fa fa-check"></i>共和分検定</a></li>
<li class="chapter" data-level="" data-path="共和分分析.html"><a href="共和分分析.html#johansenの方法-1"><i class="fa fa-check"></i>Johansenの方法</a></li>
<li class="chapter" data-level="" data-path="共和分分析.html"><a href="共和分分析.html#誤差修正モデル-ecm-の推定"><i class="fa fa-check"></i>誤差修正モデル (ECM) の推定</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="多変量ボラティリティモデル.html"><a href="多変量ボラティリティモデル.html"><i class="fa fa-check"></i><b>11</b> 多変量ボラティリティ・モデル</a>
<ul>
<li class="chapter" data-level="11.1" data-path="多変量ボラティリティモデル.html"><a href="多変量ボラティリティモデル.html#ボラティリティスピルオーバー-volatility-spillover"><i class="fa fa-check"></i><b>11.1</b> ボラティリティ・スピルオーバー (volatility spillover)</a></li>
<li class="chapter" data-level="11.2" data-path="多変量ボラティリティモデル.html"><a href="多変量ボラティリティモデル.html#多変量garchモデル-データ分析例-tsay-mts-ch.7"><i class="fa fa-check"></i><b>11.2</b> 多変量GARCHモデル: データ分析例 (Tsay, MTS, Ch.7)</a>
<ul>
<li class="chapter" data-level="" data-path="多変量ボラティリティモデル.html"><a href="多変量ボラティリティモデル.html#多変量時系列データの条件付不均一分散性の検定"><i class="fa fa-check"></i>多変量時系列データの条件付不均一分散性の検定</a></li>
<li class="chapter" data-level="" data-path="多変量ボラティリティモデル.html"><a href="多変量ボラティリティモデル.html#指数加重移動平均法-ewma"><i class="fa fa-check"></i>指数加重移動平均法 (EWMA)</a></li>
<li class="chapter" data-level="" data-path="多変量ボラティリティモデル.html"><a href="多変量ボラティリティモデル.html#bekk1-1モデル"><i class="fa fa-check"></i>BEKK(1, 1)モデル</a></li>
<li class="chapter" data-level="" data-path="多変量ボラティリティモデル.html"><a href="多変量ボラティリティモデル.html#cholesky分解を利用したボラティリティモデリングおよび推定"><i class="fa fa-check"></i>Cholesky分解を利用したボラティリティ・モデリングおよび推定</a></li>
<li class="chapter" data-level="" data-path="多変量ボラティリティモデル.html"><a href="多変量ボラティリティモデル.html#dcc-dynamic-conditional-correlation-モデル"><i class="fa fa-check"></i>DCC (Dynamic Conditional Correlation) モデル</a></li>
<li class="chapter" data-level="" data-path="多変量ボラティリティモデル.html"><a href="多変量ボラティリティモデル.html#go-garchモデル"><i class="fa fa-check"></i>GO-GARCHモデル</a></li>
<li class="chapter" data-level="" data-path="多変量ボラティリティモデル.html"><a href="多変量ボラティリティモデル.html#コピュラに基づくアプローチ"><i class="fa fa-check"></i>コピュラに基づくアプローチ</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="動的線形モデル.html"><a href="動的線形モデル.html"><i class="fa fa-check"></i><b>12</b> 動的線形モデル</a>
<ul>
<li class="chapter" data-level="12.1" data-path="動的線形モデル.html"><a href="動的線形モデル.html#局所水準-local-level-モデル"><i class="fa fa-check"></i><b>12.1</b> 局所水準 (local level) モデル</a>
<ul>
<li class="chapter" data-level="" data-path="動的線形モデル.html"><a href="動的線形モデル.html#フィルタリング"><i class="fa fa-check"></i>フィルタリング</a></li>
<li class="chapter" data-level="" data-path="動的線形モデル.html"><a href="動的線形モデル.html#スムージング-平滑化"><i class="fa fa-check"></i>スムージング (平滑化)</a></li>
<li class="chapter" data-level="" data-path="動的線形モデル.html"><a href="動的線形モデル.html#状態予測"><i class="fa fa-check"></i>状態予測</a></li>
<li class="chapter" data-level="" data-path="動的線形モデル.html"><a href="動的線形モデル.html#モデル診断-1"><i class="fa fa-check"></i>モデル診断</a></li>
<li class="chapter" data-level="" data-path="動的線形モデル.html"><a href="動的線形モデル.html#モデルパラメータの推定"><i class="fa fa-check"></i>モデル・パラメータの推定</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="動的線形モデル.html"><a href="動的線形モデル.html#local-level-plus-seasonal-componentモデル"><i class="fa fa-check"></i><b>12.2</b> local level plus seasonal componentモデル</a>
<ul>
<li class="chapter" data-level="" data-path="動的線形モデル.html"><a href="動的線形モデル.html#状態予測-1"><i class="fa fa-check"></i>状態予測</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="動的線形モデル.html"><a href="動的線形モデル.html#動的回帰モデル"><i class="fa fa-check"></i><b>12.3</b> 動的回帰モデル</a>
<ul>
<li class="chapter" data-level="" data-path="動的線形モデル.html"><a href="動的線形モデル.html#スムージング"><i class="fa fa-check"></i>スムージング</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="動的線形モデル.html"><a href="動的線形モデル.html#sur-seemingly-unrelated-regression-モデル-3.3.3"><i class="fa fa-check"></i><b>12.4</b> SUR (Seemingly Unrelated Regression) モデル (3.3.3)</a>
<ul>
<li class="chapter" data-level="" data-path="動的線形モデル.html"><a href="動的線形モデル.html#参考文献"><i class="fa fa-check"></i>参考文献</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="高頻度データ分析.html"><a href="高頻度データ分析.html"><i class="fa fa-check"></i><b>13</b> 高頻度データ分析</a>
<ul>
<li class="chapter" data-level="13.1" data-path="高頻度データ分析.html"><a href="高頻度データ分析.html#ボラティリティ推定"><i class="fa fa-check"></i><b>13.1</b> ボラティリティ推定</a>
<ul>
<li class="chapter" data-level="" data-path="高頻度データ分析.html"><a href="高頻度データ分析.html#データセット1-topix指数データ"><i class="fa fa-check"></i>データセット1: TOPIX指数データ</a></li>
<li class="chapter" data-level="" data-path="高頻度データ分析.html"><a href="高頻度データ分析.html#実現ボラティリティの計算"><i class="fa fa-check"></i>実現ボラティリティの計算</a></li>
<li class="chapter" data-level="" data-path="高頻度データ分析.html"><a href="高頻度データ分析.html#parkinsonボラティリティの計算"><i class="fa fa-check"></i>Parkinsonボラティリティの計算</a></li>
<li class="chapter" data-level="" data-path="高頻度データ分析.html"><a href="高頻度データ分析.html#har-rvモデルによる予測"><i class="fa fa-check"></i>HAR-RVモデルによる予測</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="高頻度データ分析.html"><a href="高頻度データ分析.html#共分散相関の推定"><i class="fa fa-check"></i><b>13.2</b> 共分散・相関の推定</a>
<ul>
<li class="chapter" data-level="" data-path="高頻度データ分析.html"><a href="高頻度データ分析.html#データセット2-株価指数先物データ"><i class="fa fa-check"></i>データセット2: 株価指数先物データ</a></li>
<li class="chapter" data-level="" data-path="高頻度データ分析.html"><a href="高頻度データ分析.html#共分散相関の推定-1"><i class="fa fa-check"></i>共分散・相関の推定</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="高頻度データ分析.html"><a href="高頻度データ分析.html#acdモデル"><i class="fa fa-check"></i><b>13.3</b> ACDモデル</a>
<ul>
<li class="chapter" data-level="" data-path="高頻度データ分析.html"><a href="高頻度データ分析.html#補足-等間隔データを作成するための方法"><i class="fa fa-check"></i>補足: 等間隔データを作成するための方法</a></li>
</ul></li>
</ul></li>
<li class="appendix"><span><b>Appendix 参考文献</b></span></li>
<li class="chapter" data-level="A" data-path="バブル-生成崩壊-検出.html"><a href="バブル-生成崩壊-検出.html"><i class="fa fa-check"></i><b>A</b> バブル (生成・崩壊) 検出</a>
<ul>
<li class="chapter" data-level="A.1" data-path="バブル-生成崩壊-検出.html"><a href="バブル-生成崩壊-検出.html#検定法に関する最近のレビュー論文"><i class="fa fa-check"></i><b>A.1</b> 検定法に関する最近のレビュー論文</a></li>
<li class="chapter" data-level="A.2" data-path="バブル-生成崩壊-検出.html"><a href="バブル-生成崩壊-検出.html#supreme-adf検定sadf-pwy-2011-generalized-supreme-adf-検定gsadf-psy-2015"><i class="fa fa-check"></i><b>A.2</b> Supreme ADF検定/SADF (PWY, 2011), Generalized supreme ADF 検定/GSADF (PSY, 2015)</a>
<ul>
<li class="chapter" data-level="A.2.1" data-path="バブル-生成崩壊-検出.html"><a href="バブル-生成崩壊-検出.html#数理ファイナンス-jarrow-protterら"><i class="fa fa-check"></i><b>A.2.1</b> 数理ファイナンス (Jarrow, Protterら)</a></li>
<li class="chapter" data-level="A.2.2" data-path="バブル-生成崩壊-検出.html"><a href="バブル-生成崩壊-検出.html#経済物理学-sornetteら"><i class="fa fa-check"></i><b>A.2.2</b> 経済物理学 (Sornetteら)</a></li>
</ul></li>
<li class="chapter" data-level="A.3" data-path="バブル-生成崩壊-検出.html"><a href="バブル-生成崩壊-検出.html#実証分析"><i class="fa fa-check"></i><b>A.3</b> 実証分析</a>
<ul>
<li class="chapter" data-level="" data-path="バブル-生成崩壊-検出.html"><a href="バブル-生成崩壊-検出.html#株式市場の例"><i class="fa fa-check"></i>株式市場の例</a></li>
<li class="chapter" data-level="" data-path="バブル-生成崩壊-検出.html"><a href="バブル-生成崩壊-検出.html#暗号資産市場の例"><i class="fa fa-check"></i>暗号資産市場の例</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="B" data-path="長期記憶過程-1.html"><a href="長期記憶過程-1.html"><i class="fa fa-check"></i><b>B</b> 長期記憶過程</a>
<ul>
<li class="chapter" data-level="B.1" data-path="長期記憶過程-1.html"><a href="長期記憶過程-1.html#理論概説"><i class="fa fa-check"></i><b>B.1</b> 理論・概説</a></li>
<li class="chapter" data-level="B.2" data-path="長期記憶過程-1.html"><a href="長期記憶過程-1.html#株式市場"><i class="fa fa-check"></i><b>B.2</b> 株式市場</a></li>
<li class="chapter" data-level="B.3" data-path="長期記憶過程-1.html"><a href="長期記憶過程-1.html#外国為替市場"><i class="fa fa-check"></i><b>B.3</b> 外国為替市場</a></li>
<li class="chapter" data-level="B.4" data-path="長期記憶過程-1.html"><a href="長期記憶過程-1.html#コモディティ暗号資産"><i class="fa fa-check"></i><b>B.4</b> コモディティ・暗号資産</a></li>
<li class="chapter" data-level="B.5" data-path="長期記憶過程-1.html"><a href="長期記憶過程-1.html#vix"><i class="fa fa-check"></i><b>B.5</b> VIX</a></li>
<li class="chapter" data-level="B.6" data-path="長期記憶過程-1.html"><a href="長期記憶過程-1.html#高頻度データ-ボラティリティ-注文フロー等"><i class="fa fa-check"></i><b>B.6</b> 高頻度データ (ボラティリティ, 注文フロー等)</a></li>
<li class="chapter" data-level="B.7" data-path="長期記憶過程-1.html"><a href="長期記憶過程-1.html#長期記憶性の発生要因-非長期記憶モデルによる近似"><i class="fa fa-check"></i><b>B.7</b> 長期記憶性の発生要因, 非長期記憶モデルによる近似</a></li>
</ul></li>
<li class="chapter" data-level="C" data-path="markov-switching-regime-switchingモデル.html"><a href="markov-switching-regime-switchingモデル.html"><i class="fa fa-check"></i><b>C</b> Markov switching/ regime switchingモデル</a>
<ul>
<li class="chapter" data-level="C.1" data-path="markov-switching-regime-switchingモデル.html"><a href="markov-switching-regime-switchingモデル.html#理論概説-1"><i class="fa fa-check"></i><b>C.1</b> 理論・概説</a></li>
<li class="chapter" data-level="C.2" data-path="markov-switching-regime-switchingモデル.html"><a href="markov-switching-regime-switchingモデル.html#株式市場-1"><i class="fa fa-check"></i><b>C.2</b> 株式市場</a></li>
<li class="chapter" data-level="C.3" data-path="markov-switching-regime-switchingモデル.html"><a href="markov-switching-regime-switchingモデル.html#金利債券市場"><i class="fa fa-check"></i><b>C.3</b> 金利・債券市場</a></li>
<li class="chapter" data-level="C.4" data-path="markov-switching-regime-switchingモデル.html"><a href="markov-switching-regime-switchingモデル.html#外国為替市場-1"><i class="fa fa-check"></i><b>C.4</b> 外国為替市場</a></li>
<li class="chapter" data-level="C.5" data-path="markov-switching-regime-switchingモデル.html"><a href="markov-switching-regime-switchingモデル.html#アセットアロケーション"><i class="fa fa-check"></i><b>C.5</b> アセット・アロケーション</a></li>
</ul></li>
<li class="chapter" data-level="D" data-path="archgarchモデル-1.html"><a href="archgarchモデル-1.html"><i class="fa fa-check"></i><b>D</b> ARCH/GARCHモデル</a>
<ul>
<li class="chapter" data-level="D.1" data-path="archgarchモデル-1.html"><a href="archgarchモデル-1.html#概説"><i class="fa fa-check"></i><b>D.1</b> 概説</a></li>
<li class="chapter" data-level="D.2" data-path="archgarchモデル-1.html"><a href="archgarchモデル-1.html#arch-model"><i class="fa fa-check"></i><b>D.2</b> ARCH model</a></li>
<li class="chapter" data-level="D.3" data-path="archgarchモデル-1.html"><a href="archgarchモデル-1.html#garch-model"><i class="fa fa-check"></i><b>D.3</b> GARCH model</a></li>
<li class="chapter" data-level="D.4" data-path="archgarchモデル-1.html"><a href="archgarchモデル-1.html#arch-m-model"><i class="fa fa-check"></i><b>D.4</b> ARCH-M Model</a></li>
<li class="chapter" data-level="D.5" data-path="archgarchモデル-1.html"><a href="archgarchモデル-1.html#gjr-model"><i class="fa fa-check"></i><b>D.5</b> GJR model</a></li>
<li class="chapter" data-level="D.6" data-path="archgarchモデル-1.html"><a href="archgarchモデル-1.html#aparch-model"><i class="fa fa-check"></i><b>D.6</b> APARCH model</a></li>
</ul></li>
<li class="chapter" data-level="E" data-path="共和分-誤差修正モデル.html"><a href="共和分-誤差修正モデル.html"><i class="fa fa-check"></i><b>E</b> 共和分/ 誤差修正モデル</a>
<ul>
<li class="chapter" data-level="E.1" data-path="共和分-誤差修正モデル.html"><a href="共和分-誤差修正モデル.html#株式市場とマクロ変数-国際株式市場間の分析"><i class="fa fa-check"></i><b>E.1</b> 株式市場とマクロ変数, 国際株式市場間の分析</a></li>
<li class="chapter" data-level="E.2" data-path="共和分-誤差修正モデル.html"><a href="共和分-誤差修正モデル.html#個別株式の複数取引所株価間の分析"><i class="fa fa-check"></i><b>E.2</b> 個別株式の複数取引所株価間の分析</a></li>
<li class="chapter" data-level="E.3" data-path="共和分-誤差修正モデル.html"><a href="共和分-誤差修正モデル.html#高頻度データ-bidask価格-の分析"><i class="fa fa-check"></i><b>E.3</b> 高頻度データ (bid/ask価格) の分析</a></li>
<li class="chapter" data-level="E.4" data-path="共和分-誤差修正モデル.html"><a href="共和分-誤差修正モデル.html#統計的アービトラージ-ペアトレード"><i class="fa fa-check"></i><b>E.4</b> 統計的アービトラージ / ペアトレード</a></li>
<li class="chapter" data-level="E.5" data-path="共和分-誤差修正モデル.html"><a href="共和分-誤差修正モデル.html#国際株式市場間のヘッジ"><i class="fa fa-check"></i><b>E.5</b> 国際株式市場間のヘッジ</a></li>
<li class="chapter" data-level="E.6" data-path="共和分-誤差修正モデル.html"><a href="共和分-誤差修正モデル.html#クレジットスプレッド-株式-cds-債券-の分析"><i class="fa fa-check"></i><b>E.6</b> クレジット・スプレッド (株式, CDS, 債券) の分析</a></li>
</ul></li>
<li class="chapter" data-level="F" data-path="今後の学習のために.html"><a href="今後の学習のために.html"><i class="fa fa-check"></i><b>F</b> 今後の学習のために</a>
<ul>
<li class="chapter" data-level="F.1" data-path="今後の学習のために.html"><a href="今後の学習のために.html#ai機械学習と時系列解析"><i class="fa fa-check"></i><b>F.1</b> AI/機械学習と時系列解析</a></li>
<li class="chapter" data-level="F.2" data-path="今後の学習のために.html"><a href="今後の学習のために.html#カテゴリーデータや整数値データ等に対する時系列解析"><i class="fa fa-check"></i><b>F.2</b> カテゴリーデータや整数値データ等に対する時系列解析</a></li>
<li class="chapter" data-level="F.3" data-path="今後の学習のために.html"><a href="今後の学習のために.html#状態空間モデル動的線形モデル"><i class="fa fa-check"></i><b>F.3</b> 状態空間モデル・動的線形モデル</a></li>
<li class="chapter" data-level="F.4" data-path="今後の学習のために.html"><a href="今後の学習のために.html#その他"><i class="fa fa-check"></i><b>F.4</b> その他</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">金融時系列解析</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="garchモデル" class="section level1 hasAnchor" number="8">
<h1><span class="header-section-number">8</span> GARCHモデル<a href="garchモデル.html#garchモデル" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="収益率データとarch効果" class="section level2 hasAnchor" number="8.1">
<h2><span class="header-section-number">8.1</span> 収益率データとARCH効果<a href="garchモデル.html#収益率データとarch効果" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>みずほFG (8411) の日次データを使って,
ボラティリティ・クラスタリング (volatility clustering) 現象を確認する.</p>
<div class="sourceCode" id="cb490"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb490-1"><a href="garchモデル.html#cb490-1" tabindex="-1"></a><span class="fu">library</span>(quantmod)</span></code></pre></div>
<pre><code>## Loading required package: xts</code></pre>
<pre><code>## Loading required package: zoo</code></pre>
<pre><code>## 
## Attaching package: &#39;zoo&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     as.Date, as.Date.numeric</code></pre>
<pre><code>## Loading required package: TTR</code></pre>
<pre><code>## Registered S3 method overwritten by &#39;quantmod&#39;:
##   method            from
##   as.zoo.data.frame zoo</code></pre>
<div class="sourceCode" id="cb497"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb497-1"><a href="garchモデル.html#cb497-1" tabindex="-1"></a><span class="co"># みずほフィナンシャルグループのデータを取得</span></span>
<span id="cb497-2"><a href="garchモデル.html#cb497-2" tabindex="-1"></a><span class="fu">getSymbols</span>(<span class="st">&quot;8411.T&quot;</span>, <span class="at">src =</span> <span class="st">&quot;yahoo&quot;</span>, <span class="at">from =</span> <span class="st">&quot;2003-03-01&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;8411.T&quot;</code></pre>
<div class="sourceCode" id="cb499"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb499-1"><a href="garchモデル.html#cb499-1" tabindex="-1"></a><span class="co"># availability, 200303〜</span></span>
<span id="cb499-2"><a href="garchモデル.html#cb499-2" tabindex="-1"></a><span class="co"># 結果の確認</span></span>
<span id="cb499-3"><a href="garchモデル.html#cb499-3" tabindex="-1"></a><span class="co"># head(`8411.T`, 3)</span></span></code></pre></div>
<!--





-->
<ul>
<li>日次収益率の計算 (2020年4月1日–2024年3月31日)</li>
<li>時系列プロット</li>
</ul>
<div class="sourceCode" id="cb500"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb500-1"><a href="garchモデル.html#cb500-1" tabindex="-1"></a>mizuho_close <span class="ot">&lt;-</span> <span class="fu">Ad</span>(<span class="st">`</span><span class="at">8411.T</span><span class="st">`</span>) <span class="co"># 2003/3/12--</span></span>
<span id="cb500-2"><a href="garchモデル.html#cb500-2" tabindex="-1"></a>mizuho_ret <span class="ot">&lt;-</span> <span class="fu">diff</span>(<span class="fu">log</span>(mizuho_close))   <span class="co"># Adjusted price</span></span>
<span id="cb500-3"><a href="garchモデル.html#cb500-3" tabindex="-1"></a></span>
<span id="cb500-4"><a href="garchモデル.html#cb500-4" tabindex="-1"></a>x <span class="ot">&lt;-</span> mizuho_ret[<span class="st">&quot;2020-04-01/2024-03-31&quot;</span>]</span>
<span id="cb500-5"><a href="garchモデル.html#cb500-5" tabindex="-1"></a>tlen <span class="ot">=</span> <span class="fu">nrow</span>(x)</span>
<span id="cb500-6"><a href="garchモデル.html#cb500-6" tabindex="-1"></a><span class="fu">plot</span>(x)</span></code></pre></div>
<p><img src="070-GARCH_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<div class="sourceCode" id="cb501"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb501-1"><a href="garchモデル.html#cb501-1" tabindex="-1"></a><span class="co"># 日次収益率の自己相関</span></span>
<span id="cb501-2"><a href="garchモデル.html#cb501-2" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb501-3"><a href="garchモデル.html#cb501-3" tabindex="-1"></a><span class="fu">acf</span>(x, <span class="at">main =</span> <span class="st">&quot;return&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;h&quot;</span>, <span class="at">na.action =</span> na.pass)</span>
<span id="cb501-4"><a href="garchモデル.html#cb501-4" tabindex="-1"></a><span class="co"># 日次収益率2乗の自己相関</span></span>
<span id="cb501-5"><a href="garchモデル.html#cb501-5" tabindex="-1"></a><span class="fu">acf</span>(x <span class="sc">^</span> <span class="dv">2</span>, <span class="at">main =</span> <span class="st">&quot;return^2&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;h&quot;</span>, <span class="at">na.action =</span> na.pass)</span>
<span id="cb501-6"><a href="garchモデル.html#cb501-6" tabindex="-1"></a><span class="co"># 日次絶対収益率の自己相関</span></span>
<span id="cb501-7"><a href="garchモデル.html#cb501-7" tabindex="-1"></a><span class="fu">acf</span>(<span class="fu">abs</span>(x), <span class="at">main =</span> <span class="st">&quot;abs(return)&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;h&quot;</span>, <span class="at">na.action =</span> na.pass)</span></code></pre></div>
<p><img src="070-GARCH_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<p>収益率系列は自己相関が小さくおおむね
白色ノイズの性質を示している一方,
2乗収益率や絶対収益率は, 非ゼロの
自己相関を持った時系列であることが分かる.</p>
<p>ボラティリティには持続性, すなわち,
一旦市場のボラティリティが多くなると
暫くそのような状態が続き, 反対に, ボラティリティが
低下すると暫くそれが続く性質のあることが,
経験的に知られている.</p>
<p>所与の収益率系列データに対して,
このようなボラティリティ・クラスタリング現象は,
2乗収益率の自己相関構造 (「ARCH効果」) の有無を調べることで定量的に評価することができる.</p>
<p>そして, 金融市場における収益率系列において一般的に観察されるボラティリティ・クラスタリング現象を記述する時系列モデルのクラスとしてEngle (82) によって提案されたのが「ARCHモデル」である.</p>
<p>ARCHは, Autoregressive Conditional Heteroskedasticity (自己回帰条件付不均一分散性)
の略であり, ARCHモデルを提案したRobert Engleは
その功績に対して2003年にノーベル経済学賞を受賞した.</p>
<p>Tsayの作成したパッケージ<strong>MTS</strong>内に,
ARCH効果を検定する関数<code>archTest()</code>が
また, <strong>FTS</strong>には, <code>ArchTest()</code>が
用意されている.</p>
<p>ARCH/GARCHモデルに関するパッケージは
たくさんあるので, どのパッケージのどの関数を
使用しているのか注意を払う必要がある.</p>
<ul>
<li><strong>Rコーディング上のヒント</strong>: 異なるパッケージが同一の名前を持つ関数を持っている
ことがあり, それが原因で, コード作成者が意図した
R関数とは異なる別の関数が呼び出され,
エラーとなってしまうことがある.
これを未然に防ぐためには,
「パッケージ名::関数名」(例, <code>fGarch::volatility()</code>)
のシンタックスによってRにどのパッケージ内のR関数かを明示的に指示すると良い.</li>
</ul>
<div class="sourceCode" id="cb502"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb502-1"><a href="garchモデル.html#cb502-1" tabindex="-1"></a><span class="co"># 例. ラグ$p=5$を指定した場合</span></span>
<span id="cb502-2"><a href="garchモデル.html#cb502-2" tabindex="-1"></a><span class="co"># パッケージ**MTS**使用</span></span>
<span id="cb502-3"><a href="garchモデル.html#cb502-3" tabindex="-1"></a><span class="fu">library</span>(MTS)  <span class="co"># archTest()</span></span>
<span id="cb502-4"><a href="garchモデル.html#cb502-4" tabindex="-1"></a><span class="fu">archTest</span>(<span class="fu">as.numeric</span>(<span class="fu">na.omit</span>(x) <span class="sc">-</span> <span class="fu">mean</span>(x, <span class="at">na.rm =</span> T)), <span class="at">lag =</span> <span class="dv">5</span>) <span class="co"># MTS内</span></span></code></pre></div>
<pre><code>## Q(m) of squared series(LM test):  
## Test statistic:  72.23488  p-value:  3.508305e-14 
## Rank-based Test:  
## Test statistic:  29.86461  p-value:  1.568167e-05</code></pre>
<div class="sourceCode" id="cb504"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb504-1"><a href="garchモデル.html#cb504-1" tabindex="-1"></a><span class="co"># archTest(as.numeric(na.omit(x)), lag = 5) # MTS内</span></span></code></pre></div>
<p>注) archTest()は, NAを受け付けない. また, 数値ベクトル化して与える必要</p>
<div class="sourceCode" id="cb505"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb505-1"><a href="garchモデル.html#cb505-1" tabindex="-1"></a><span class="co"># パッケージ**FTS**使用</span></span>
<span id="cb505-2"><a href="garchモデル.html#cb505-2" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;FinTS&quot;</span>)  <span class="co"># ArchTest()</span></span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;FinTS&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:MTS&#39;:
## 
##     apca</code></pre>
<div class="sourceCode" id="cb508"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb508-1"><a href="garchモデル.html#cb508-1" tabindex="-1"></a><span class="fu">ArchTest</span>(x, <span class="at">lags =</span> <span class="dv">5</span>, <span class="at">demean =</span> <span class="cn">TRUE</span>) <span class="co"># FinTS内</span></span></code></pre></div>
<pre><code>## 
##  ARCH LM-test; Null hypothesis: no ARCH effects
## 
## data:  x
## Chi-squared = 53.339, df = 5, p-value = 2.866e-10</code></pre>
<div class="sourceCode" id="cb510"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb510-1"><a href="garchモデル.html#cb510-1" tabindex="-1"></a><span class="co"># ArchTest(x, lags = 5, demean = FALSE) # FinTS</span></span></code></pre></div>
</div>
<div id="archgarchモデル" class="section level2 hasAnchor" number="8.2">
<h2><span class="header-section-number">8.2</span> ARCH/GARCHモデル<a href="garchモデル.html#archgarchモデル" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>GARCH（Generalized ARCH）モデルは, Bollerslev (86)
によって提案されたARCH(<span class="math inline">\(p\)</span>) モデルを一般化した
モデルクラスである. ボラティリティ方程式の右辺に<span class="math inline">\(u_t\)</span>のラグ項 (ARCH項) しか持たないARCH(<span class="math inline">\(p\)</span>)
に対して, <span class="math inline">\(\sigma_t^2\)</span>のラグ項 (GARCH項) を導入することで,
記述力を持ちながら, パラメータ数の少ない (倹約的な) モデルを実現できる.</p>
<p>実践上は, <span class="math inline">\(p=1,q=1\)</span>がごく一般的であり, 時々, <span class="math inline">\(p=2\)</span> や <span class="math inline">\(q=2\)</span> が取られる程度である.</p>
<div id="garchpqモデル" class="section level3 unnumbered hasAnchor">
<h3>GARCH(p,q)モデル<a href="garchモデル.html#garchpqモデル" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>ボラティリティ方程式
<span class="math display">\[ \sigma_t^2=\omega+\alpha_1 u_{t-1}^2+\cdots+\alpha_p u_{t-p}^2+\beta_1 \sigma_{t-1}^2+\cdots+\beta_q \sigma_{t-q}^2\]</span></p>
<ul>
<li>上式内で, 係数<span class="math inline">\(\alpha_i\)</span>が掛かっている項を<strong>ARCH項</strong>,
係数<span class="math inline">\(\beta_j\)</span>が掛かっている項を<strong>GARCH項</strong>と呼ぶ.</li>
<li>文献では, ARCH項の次数は<span class="math inline">\(q\)</span>, GARCH項の次数は<span class="math inline">\(p\)</span>が
使われることもあり, その時には, GARCHモデルはGARCH(<span class="math inline">\(q,p\)</span>),
GARCH項を持たない (純粋な) ARCHモデルはARCH(<span class="math inline">\(q\)</span>)と表記される.</li>
</ul>
<!-- 以下追加: 120824 -->
</div>
<div id="garchモデリング" class="section level3 unnumbered hasAnchor">
<h3>GARCHモデリング<a href="garchモデル.html#garchモデリング" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>GARCH（Generalized ARCH）モデルの標準的な構築手順は以下の通りである.</p>
<div id="平均収益率のモデル化-arch効果の有無の確認" class="section level4 unnumbered hasAnchor">
<h4>1. 平均収益率のモデル化 &amp; ARCH効果の有無の確認<a href="garchモデル.html#平均収益率のモデル化-arch効果の有無の確認" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>前処理・探索的分析</strong></p>
<ul>
<li>資産価格データを収益率系列に変換する<br />
</li>
<li>収益率<span class="math inline">\(r_t\)</span>の時系列プロットより, 平均的傾向に時間変動や特定のパターンがあるかを確認する</li>
<li>時系列プロットの目視により, ボラティリティの時間変化 (不均一分散性) やクラスタリング等のパターンの有無を確認する</li>
</ul>
<p><strong>平均収益率のモデリング</strong></p>
<ul>
<li>平均収益率のモデルとしてARMAモデル, あるいはその他のモデルを特定し (暫定的に) 適合する
(例えば, Tsayにて解説されている”Two-Pass推定法” (p.210): ARCH効果を無視して平均収益率のモデルを推定)</li>
</ul>
<p><strong>ARCH効果の検定</strong></p>
<ul>
<li>得られた (暫定的な) 残差<span class="math inline">\(\tilde{u}_t=r_t - \hat{\mu}_t\)</span>に対して, ARCH効果の検定 (Lagrange Multiplier検定) を行い有無を確認</li>
<li>→ ARCH(<span class="math inline">\(p\)</span>)モデルを採用する場合, PACFにより適切なラグ次数<span class="math inline">\(p\)</span>を同定</li>
<li>ARCH効果が確認されれば, GARCHモデルの構築 (ステップ2) へと進む</li>
</ul>
</div>
<div id="ボラティリティモデルの特定-仕様の設定-スペシフィケーション" class="section level4 unnumbered hasAnchor">
<h4>2. ボラティリティ・モデルの特定 (仕様の設定, スペシフィケーション)<a href="garchモデル.html#ボラティリティモデルの特定-仕様の設定-スペシフィケーション" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>分散方程式 (条件付分散<span class="math inline">\(\sigma_t^2\)</span>のモデル構造) を特定する</p>
<ul>
<li>GARCH(<span class="math inline">\(p,q\)</span>)構造の特定</li>
<li>デフォルトは, GARCH(<span class="math inline">\(1,1\)</span>). 必要に応じて, GARCH(<span class="math inline">\(2,1\)</span>)やGARCH(<span class="math inline">\(1,2\)</span>)も検討</li>
<li>標準化誤差項<span class="math inline">\(\epsilon_t\)</span>の従う分布の特定
<ul>
<li>デフォルトは, 標準正規分布<span class="math inline">\(N(0,1)\)</span></li>
</ul></li>
<li>必要に応じたバリエーションの検討. 非対称性, レバレッジ効果, 長期記憶性が見られる場合, EGARCH, GJR-GARCH, FIGARCHなどのファミリーを検討</li>
</ul>
</div>
<div id="モデル適合とモデル選択" class="section level4 unnumbered hasAnchor">
<h4>3. モデル適合とモデル選択<a href="garchモデル.html#モデル適合とモデル選択" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>ステップ2で特定したモデルを収益率データに適合させる. 複数の候補モデルがあれば, その中で最良のモデルを選択する</p>
<ul>
<li><p>最尤推定（MLE）によりパラメータ(例, GARCH(1,1)の場合, <span class="math inline">\((\omega,\alpha_1, \beta_1)\)</span>)を推定する</p></li>
<li><p>標準的には, ボラティリティ方程式のパラメータだけでなく,
平均方程式のパラメータも同時に推定する (R関数の引数として指定)</p></li>
<li><p>複数の候補モデルがあれば, その中から最良のGARCHモデルを選択する</p>
<ul>
<li>情報量基準 (AICc, BIC等)</li>
<li>尤度比検定: 入れ子構造を持つモデルを比較し、追加パラメータがモデル適合性を改善するかを確認</li>
<li>※ ここで一つに絞り込まずにボラティリティ予測の精度比較で選択することも可 (ステップ5)</li>
</ul></li>
</ul>
</div>
<div id="モデル診断" class="section level4 unnumbered hasAnchor">
<h4>4. モデル診断<a href="garchモデル.html#モデル診断" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>適合モデルの (標準化済) 残差系列<span class="math inline">\(\{\tilde{\epsilon}_t=\frac{\tilde{u}_t}{\hat{\sigma}_t}\}\)</span>を用いて, モデル診断を行う</p>
<ul>
<li>残差系列に自己相関 (系列従属性) が残っていないか
<ul>
<li><span class="math inline">\(\{\tilde{\epsilon}_t\}\)</span>の自己相関の有無 (残差プロット, ACF/PACFのコレログラム, Ljung-Box検定等)</li>
<li><span class="math inline">\(\{\tilde{\epsilon}_t^2\}\)</span>の自己相関の有無 (残差プロット, ACF/PACFのコレログラム, Ljung-Box検定等)</li>
</ul></li>
<li>残差<span class="math inline">\(\epsilon_t\)</span>に関する分布の仮定が適切だったか
<ul>
<li><span class="math inline">\(\{\tilde{\epsilon}_t\}\)</span>の正規性 (Q-Qプロット, Jarque-Bera検定, Shapiro-Wilk検定, Kolmogorov-Smirnov検定等)</li>
</ul></li>
<li>→ 残差に有意な自己相関が残る場合には, モデルの改良を試みる (ステップ2へ戻る)
<ul>
<li>GARCH(<span class="math inline">\(p,q\)</span>)の次数を上げる(<span class="math inline">\(p,q\le2\)</span>)</li>
<li><span class="math inline">\(\epsilon_t\)</span>の分布の仮定を変更する</li>
<li>別のGARCHファミリーを試みる</li>
<li>外生変数の導入も検討する</li>
</ul></li>
</ul>
</div>
<div id="ボラティリティ予測" class="section level4 unnumbered hasAnchor">
<h4>5. ボラティリティ予測<a href="garchモデル.html#ボラティリティ予測" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>得られた適合GARCHモデルを用いてボラティリティ予測を行う</p>
<ul>
<li>複数のGARCHモデルで予測を行う場合, パフォーマンスを比較する (MSE, MAE等)</li>
</ul>
</div>
<div id="モデルの見直し改良" class="section level4 unnumbered hasAnchor">
<h4>6. モデルの見直し・改良<a href="garchモデル.html#モデルの見直し改良" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>モデル診断が好ましくない結果となった場合や予測精度が不十分な場合などの場合は, モデルの特定 (ステップ2, または, ステップ1)に戻る</p>
<!-- 以上追加: 120824 -->
</div>
</div>
</div>
<div id="archgarchモデルのシミュレーション" class="section level2 hasAnchor" number="8.3">
<h2><span class="header-section-number">8.3</span> ARCH/GARCHモデルのシミュレーション<a href="garchモデル.html#archgarchモデルのシミュレーション" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="パッケージfgarchの利用" class="section level3 unnumbered hasAnchor">
<h3>パッケージ<strong>fGarch</strong>の利用<a href="garchモデル.html#パッケージfgarchの利用" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>参考: <a href="https://www.rdocumentation.org/packages/fGarch/versions/3042.83.2/topics/garchSim" class="uri">https://www.rdocumentation.org/packages/fGarch/versions/3042.83.2/topics/garchSim</a></p></li>
<li><p>ボラティリティ方程式 <span class="math display">\[ \sigma_t^2=\omega+\alpha_1 u_{t-1}^2+\cdots+\alpha_p u_{t-p}^2+\beta_1 \sigma_{t-1}^2+\cdots+\beta_q \sigma_{t-q}^2\]</span></p></li>
</ul>
<pre><code>garchSpec()
- model: 以下のパラメータをリスト要素して指定:
  - omega: (分散方程式の) 定数項 (alpha0) (デフォルトは1e-6)
  - alpha: (同) ARCH項ベクトル (デフォルトは0.1, 次数p=1)
  - beta: GARCH項ベクトル (デフォルトは0,8, q=1)
- cond.dist: &quot;norm&quot;, &quot;ged&quot;, &quot;std&quot;, &quot;snorm&quot;, &quot;sged&quot;, (デフォルトは&quot;norm&quot;)</code></pre>
</div>
<div id="archpモデル" class="section level3 unnumbered hasAnchor">
<h3>ARCH(p)モデル<a href="garchモデル.html#archpモデル" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>パラメータ設定例
<ul>
<li>ボラティリティ方程式 (<span class="math inline">\(p=2, q=0\)</span>): <span class="math inline">\(\omega=10^{-6}\)</span> (デフォルト), <span class="math inline">\(\alpha_1=0.5, \alpha_2=0.1\)</span></li>
</ul></li>
</ul>
<div class="sourceCode" id="cb512"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb512-1"><a href="garchモデル.html#cb512-1" tabindex="-1"></a>seedv <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb512-2"><a href="garchモデル.html#cb512-2" tabindex="-1"></a>tlen <span class="ot">&lt;-</span> <span class="dv">300</span></span>
<span id="cb512-3"><a href="garchモデル.html#cb512-3" tabindex="-1"></a><span class="fu">library</span>(fGarch)</span></code></pre></div>
<pre><code>## NOTE: Packages &#39;fBasics&#39;, &#39;timeDate&#39;, and &#39;timeSeries&#39; are no longer
## attached to the search() path when &#39;fGarch&#39; is attached.
## 
## If needed attach them yourself in your R script by e.g.,
##         require(&quot;timeSeries&quot;)</code></pre>
<pre><code>## 
## Attaching package: &#39;fGarch&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:TTR&#39;:
## 
##     volatility</code></pre>
<div class="sourceCode" id="cb516"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb516-1"><a href="garchモデル.html#cb516-1" tabindex="-1"></a><span class="co"># ARCH(2) - use default omega and specify alpha, set beta=0!</span></span>
<span id="cb516-2"><a href="garchモデル.html#cb516-2" tabindex="-1"></a>spec <span class="ot">&lt;-</span> <span class="fu">garchSpec</span>(<span class="at">model =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.1</span>), <span class="at">beta =</span> <span class="dv">0</span>))</span>
<span id="cb516-3"><a href="garchモデル.html#cb516-3" tabindex="-1"></a><span class="fu">set.seed</span>(seedv)</span>
<span id="cb516-4"><a href="garchモデル.html#cb516-4" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">garchSim</span>(spec, <span class="at">n =</span> tlen)</span>
<span id="cb516-5"><a href="garchモデル.html#cb516-5" tabindex="-1"></a><span class="fu">plot</span>(x)</span></code></pre></div>
<p><img src="070-GARCH_files/figure-html/ARCH2-1.png" width="672" /></p>
<div class="sourceCode" id="cb517"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb517-1"><a href="garchモデル.html#cb517-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb517-2"><a href="garchモデル.html#cb517-2" tabindex="-1"></a><span class="fu">acf</span>(x); <span class="fu">pacf</span>(x)</span></code></pre></div>
<p><img src="070-GARCH_files/figure-html/ARCH2-2.png" width="672" /></p>
<div class="sourceCode" id="cb518"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb518-1"><a href="garchモデル.html#cb518-1" tabindex="-1"></a><span class="fu">acf</span>(x <span class="sc">^</span> <span class="dv">2</span>); <span class="fu">pacf</span>(x <span class="sc">^</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="070-GARCH_files/figure-html/ARCH2-3.png" width="672" /></p>
<div class="sourceCode" id="cb519"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb519-1"><a href="garchモデル.html#cb519-1" tabindex="-1"></a><span class="fu">acf</span>(<span class="fu">abs</span>(x)); <span class="fu">pacf</span>(<span class="fu">abs</span>(x))</span></code></pre></div>
<p><img src="070-GARCH_files/figure-html/ARCH2-4.png" width="672" /></p>
</div>
<div id="garchpqモデル-1" class="section level3 unnumbered hasAnchor">
<h3>GARCH(p,q)モデル<a href="garchモデル.html#garchpqモデル-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>パラメータ設定例
<ul>
<li>ボラティリティ方程式 (次数<span class="math inline">\(p=2,q=1\)</span>): <span class="math inline">\(\omega=10^{-6}\)</span>(デフォルト), <span class="math inline">\(\alpha_1=0.5, \alpha_2=0.1, \beta_1=0.35\)</span></li>
</ul></li>
</ul>
<div class="sourceCode" id="cb520"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb520-1"><a href="garchモデル.html#cb520-1" tabindex="-1"></a>spec <span class="ot">&lt;-</span> <span class="fu">garchSpec</span>(<span class="at">model =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.1</span>), <span class="at">beta =</span> <span class="fl">0.35</span>))</span>
<span id="cb520-2"><a href="garchモデル.html#cb520-2" tabindex="-1"></a><span class="fu">set.seed</span>(seedv)</span>
<span id="cb520-3"><a href="garchモデル.html#cb520-3" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">garchSim</span>(spec, <span class="at">n =</span> tlen)</span>
<span id="cb520-4"><a href="garchモデル.html#cb520-4" tabindex="-1"></a><span class="fu">plot</span>(x)</span></code></pre></div>
<p><img src="070-GARCH_files/figure-html/GARCH1.1-1.png" width="672" /></p>
<div class="sourceCode" id="cb521"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb521-1"><a href="garchモデル.html#cb521-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb521-2"><a href="garchモデル.html#cb521-2" tabindex="-1"></a><span class="fu">acf</span>(x); <span class="fu">pacf</span>(x)</span></code></pre></div>
<p><img src="070-GARCH_files/figure-html/GARCH1.1-2.png" width="672" /></p>
<div class="sourceCode" id="cb522"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb522-1"><a href="garchモデル.html#cb522-1" tabindex="-1"></a><span class="fu">acf</span>(x <span class="sc">^</span> <span class="dv">2</span>); <span class="fu">pacf</span>(x <span class="sc">^</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="070-GARCH_files/figure-html/GARCH1.1-3.png" width="672" /></p>
<div class="sourceCode" id="cb523"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb523-1"><a href="garchモデル.html#cb523-1" tabindex="-1"></a><span class="fu">acf</span>(<span class="fu">abs</span>(x)); <span class="fu">pacf</span>(<span class="fu">abs</span>(x))</span></code></pre></div>
<p><img src="070-GARCH_files/figure-html/GARCH1.1-4.png" width="672" /></p>
</div>
<div id="armapq-garchpqモデル" class="section level3 unnumbered hasAnchor">
<h3>ARMA(p’,q’)-GARCH(p,q)モデル<a href="garchモデル.html#armapq-garchpqモデル" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>パラメータ設定例
<ul>
<li>平均方程式 (<span class="math inline">\(p&#39;=1,q&#39;=2\)</span>): <span class="math inline">\(\phi_1=0.7,\theta_1=0.3,\theta_2=-0.3\)</span></li>
<li>ボラティリティ方程式 (<span class="math inline">\(p=1,q=1\)</span>): <span class="math inline">\(\omega=10^{-6}\)</span>(デフォルト), <span class="math inline">\(\alpha_1=0.5, \alpha_2=0.1, \beta_1=0.35\)</span></li>
</ul></li>
</ul>
<div class="sourceCode" id="cb524"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb524-1"><a href="garchモデル.html#cb524-1" tabindex="-1"></a>spec <span class="ot">&lt;-</span> <span class="fu">garchSpec</span>(<span class="at">model =</span> <span class="fu">list</span>(<span class="at">ar =</span> <span class="fl">0.7</span>, <span class="at">ma =</span> <span class="fu">c</span>(<span class="fl">0.3</span>, <span class="sc">-</span><span class="fl">0.3</span>), </span>
<span id="cb524-2"><a href="garchモデル.html#cb524-2" tabindex="-1"></a>                               <span class="at">alpha =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.1</span>), <span class="at">beta =</span> <span class="fl">0.35</span>))</span>
<span id="cb524-3"><a href="garchモデル.html#cb524-3" tabindex="-1"></a><span class="fu">set.seed</span>(seedv)</span>
<span id="cb524-4"><a href="garchモデル.html#cb524-4" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">garchSim</span>(spec, <span class="at">n =</span> tlen)</span>
<span id="cb524-5"><a href="garchモデル.html#cb524-5" tabindex="-1"></a><span class="fu">plot</span>(x)</span></code></pre></div>
<p><img src="070-GARCH_files/figure-html/ARMA1.2_GARCH1.1-1.png" width="672" /></p>
<div class="sourceCode" id="cb525"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb525-1"><a href="garchモデル.html#cb525-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb525-2"><a href="garchモデル.html#cb525-2" tabindex="-1"></a><span class="fu">acf</span>(x); <span class="fu">pacf</span>(x)</span></code></pre></div>
<p><img src="070-GARCH_files/figure-html/ARMA1.2_GARCH1.1-2.png" width="672" /></p>
<div class="sourceCode" id="cb526"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb526-1"><a href="garchモデル.html#cb526-1" tabindex="-1"></a><span class="fu">acf</span>(x <span class="sc">^</span> <span class="dv">2</span>); <span class="fu">pacf</span>(x <span class="sc">^</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="070-GARCH_files/figure-html/ARMA1.2_GARCH1.1-3.png" width="672" /></p>
<div class="sourceCode" id="cb527"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb527-1"><a href="garchモデル.html#cb527-1" tabindex="-1"></a><span class="fu">acf</span>(<span class="fu">abs</span>(x)); <span class="fu">pacf</span>(<span class="fu">abs</span>(x))</span></code></pre></div>
<p><img src="070-GARCH_files/figure-html/ARMA1.2_GARCH1.1-4.png" width="672" /></p>
</div>
</div>
<div id="archgarchモデルの適合" class="section level2 hasAnchor" number="8.4">
<h2><span class="header-section-number">8.4</span> ARCH/GARCHモデルの適合<a href="garchモデル.html#archgarchモデルの適合" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>先に作成したみずほFG (8411) の日次収益率データセットを使い,
ARCH/GARCHモデリングを行う.</p>
<ul>
<li>garchFit関数: 1変量ARMA-GARCHモデルを適合
<ul>
<li>最尤法</li>
<li>ARMAおよびGARCHのモデル次数を引数に与える (デフォルト, GARCH(1,1))</li>
</ul></li>
</ul>
<p>モデルがうまくデータに適合していれば,
得られる (標準済) 残差系列は, おおよそ
i.i.dの (正規分布に) 近い挙動をすることが期待される.
この性質を使うことでモデルの診断を行うことができる.</p>
<ul>
<li><p>ARCH効果の検定
ここでは, パッケージ<strong>FinTS</strong>に含まれる関数<code>ArchTest()</code>を使用する.</p>
<ul>
<li>例. ラグ<span class="math inline">\(p=5\)</span>を指定した場合</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb528"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb528-1"><a href="garchモデル.html#cb528-1" tabindex="-1"></a><span class="co"># パッケージ**MTS**使用</span></span>
<span id="cb528-2"><a href="garchモデル.html#cb528-2" tabindex="-1"></a><span class="co"># library(MTS)  # archTest()</span></span>
<span id="cb528-3"><a href="garchモデル.html#cb528-3" tabindex="-1"></a><span class="co"># archTest(as.numeric(na.omit(x)), lag = 5) # MTS内</span></span>
<span id="cb528-4"><a href="garchモデル.html#cb528-4" tabindex="-1"></a><span class="co"># パッケージ**FinTS**使用</span></span>
<span id="cb528-5"><a href="garchモデル.html#cb528-5" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;FinTS&quot;</span>)  <span class="co"># ArchTest()</span></span>
<span id="cb528-6"><a href="garchモデル.html#cb528-6" tabindex="-1"></a><span class="fu">ArchTest</span>(x, <span class="at">lags =</span> <span class="dv">5</span>, <span class="at">demean =</span> <span class="cn">TRUE</span>) <span class="co"># FinTS内</span></span></code></pre></div>
<pre><code>## 
##  ARCH LM-test; Null hypothesis: no ARCH effects
## 
## data:  x
## Chi-squared = 164.89, df = 5, p-value &lt; 2.2e-16</code></pre>
<p>→ 帰無仮説 (<span class="math inline">\(\alpha_1=  \ldots=\alpha_{5}=0\)</span>) を棄却</p>
<ul>
<li>例. ARCH(5)モデルの適合</li>
</ul>
<div class="sourceCode" id="cb530"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb530-1"><a href="garchモデル.html#cb530-1" tabindex="-1"></a>fit_ARCH <span class="ot">&lt;-</span> <span class="fu">garchFit</span>(<span class="at">formula =</span> <span class="sc">~</span> <span class="fu">garch</span>(<span class="dv">5</span>, <span class="dv">0</span>), <span class="at">data =</span> x,</span>
<span id="cb530-2"><a href="garchモデル.html#cb530-2" tabindex="-1"></a>                     <span class="at">trace =</span> <span class="cn">FALSE</span>, <span class="at">include.mean =</span> <span class="cn">TRUE</span>) <span class="co"># fGarch</span></span></code></pre></div>
<pre><code>## Warning in sqrt(diag(fit$cvar)): NaNs produced</code></pre>
<div class="sourceCode" id="cb532"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb532-1"><a href="garchモデル.html#cb532-1" tabindex="-1"></a><span class="fu">summary</span>(fit_ARCH)</span></code></pre></div>
<pre><code>## 
## Title:
##  GARCH Modelling 
## 
## Call:
##  garchFit(formula = ~garch(5, 0), data = x, include.mean = TRUE, 
##     trace = FALSE) 
## 
## Mean and Variance Equation:
##  data ~ garch(5, 0)
## &lt;environment: 0x7fda7d12d788&gt;
##  [data = x]
## 
## Conditional Distribution:
##  norm 
## 
## Coefficient(s):
##         mu       omega      alpha1      alpha2      alpha3      alpha4  
## 6.6138e-04  4.4052e-06  5.6620e-01  1.7058e-01  1.0000e-08  1.3281e-01  
##     alpha5  
## 1.0000e-08  
## 
## Std. Errors:
##  based on Hessian 
## 
## Error Analysis:
##         Estimate  Std. Error  t value Pr(&gt;|t|)    
## mu     6.614e-04   2.660e-04    2.487   0.0129 *  
## omega  4.405e-06   1.106e-06    3.982 6.83e-05 ***
## alpha1 5.662e-01   1.098e-01    5.159 2.48e-07 ***
## alpha2 1.706e-01   7.584e-02    2.249   0.0245 *  
## alpha3 1.000e-08   5.446e-02    0.000   1.0000    
## alpha4 1.328e-01   6.695e-02    1.984   0.0473 *  
## alpha5 1.000e-08         NaN      NaN      NaN    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Log Likelihood:
##  1223.356    normalized:  4.077854 
## 
## Description:
##  Sun Feb  2 15:36:10 2025 by user:  
## 
## 
## Standardised Residuals Tests:
##                                   Statistic      p-Value
##  Jarque-Bera Test   R    Chi^2   18.4174411 0.0001001621
##  Shapiro-Wilk Test  R    W        0.9886304 0.0189144275
##  Ljung-Box Test     R    Q(10)  149.7077699 0.0000000000
##  Ljung-Box Test     R    Q(15)  156.9174141 0.0000000000
##  Ljung-Box Test     R    Q(20)  158.0863034 0.0000000000
##  Ljung-Box Test     R^2  Q(10)   11.2902884 0.3353536452
##  Ljung-Box Test     R^2  Q(15)   12.9595175 0.6054248986
##  Ljung-Box Test     R^2  Q(20)   18.3437965 0.5647719502
##  LM Arch Test       R    TR^2    12.1603947 0.4328856806
## 
## Information Criterion Statistics:
##       AIC       BIC       SIC      HQIC 
## -8.109042 -8.022621 -8.110098 -8.074456</code></pre>
<div class="sourceCode" id="cb534"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb534-1"><a href="garchモデル.html#cb534-1" tabindex="-1"></a>resd <span class="ot">=</span> <span class="fu">residuals</span>(fit_ARCH, <span class="at">standardize =</span> T) <span class="co"># fGarch</span></span>
<span id="cb534-2"><a href="garchモデル.html#cb534-2" tabindex="-1"></a><span class="fu">ts.plot</span>(resd)</span></code></pre></div>
<p><img src="070-GARCH_files/figure-html/est.3-1.png" width="672" /></p>
<p>残差系列の2乗の偏自己相関を見ることで,
残差系列<code>resd</code>にARCH効果が残っているかを確かめることができる.
(すなわち, AR(<span class="math inline">\(p\)</span>)モデルの偏自己相関は,
ラグ<span class="math inline">\(p\)</span>にて切断が起こるという性質を利用する)</p>
<div class="sourceCode" id="cb535"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb535-1"><a href="garchモデル.html#cb535-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb535-2"><a href="garchモデル.html#cb535-2" tabindex="-1"></a><span class="fu">acf</span>(resd); <span class="fu">pacf</span>(resd <span class="sc">^</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="070-GARCH_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<div class="sourceCode" id="cb536"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb536-1"><a href="garchモデル.html#cb536-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb536-2"><a href="garchモデル.html#cb536-2" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb536-3"><a href="garchモデル.html#cb536-3" tabindex="-1"></a><span class="fu">tsdiag</span>(fit_ARCH)</span></code></pre></div>
<pre><code>## Please install package &#39;goftest&#39; for additional tests</code></pre>
<p><img src="070-GARCH_files/figure-html/unnamed-chunk-9-2.png" width="672" /></p>
<div class="sourceCode" id="cb538"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb538-1"><a href="garchモデル.html#cb538-1" tabindex="-1"></a><span class="co"># ArchTest(resd, lags = 5, demean = T)</span></span></code></pre></div>
<ul>
<li>例. GARCH(1,1)モデルの適合</li>
</ul>
<div class="sourceCode" id="cb539"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb539-1"><a href="garchモデル.html#cb539-1" tabindex="-1"></a>fit_GARCH <span class="ot">&lt;-</span> <span class="fu">garchFit</span>(<span class="at">formula =</span> <span class="sc">~</span> <span class="fu">garch</span>(<span class="dv">1</span>, <span class="dv">1</span>), <span class="at">data =</span> x,</span>
<span id="cb539-2"><a href="garchモデル.html#cb539-2" tabindex="-1"></a>                      <span class="at">trace =</span> <span class="cn">FALSE</span>, <span class="at">include.mean =</span> <span class="cn">TRUE</span>) <span class="co"># fGarch</span></span>
<span id="cb539-3"><a href="garchモデル.html#cb539-3" tabindex="-1"></a><span class="fu">summary</span>(fit_GARCH)</span></code></pre></div>
<pre><code>## 
## Title:
##  GARCH Modelling 
## 
## Call:
##  garchFit(formula = ~garch(1, 1), data = x, include.mean = TRUE, 
##     trace = FALSE) 
## 
## Mean and Variance Equation:
##  data ~ garch(1, 1)
## &lt;environment: 0x7fda675bbd28&gt;
##  [data = x]
## 
## Conditional Distribution:
##  norm 
## 
## Coefficient(s):
##         mu       omega      alpha1       beta1  
## 5.5059e-04  4.2320e-06  6.0121e-01  2.5190e-01  
## 
## Std. Errors:
##  based on Hessian 
## 
## Error Analysis:
##         Estimate  Std. Error  t value Pr(&gt;|t|)    
## mu     5.506e-04   2.895e-04    1.902 0.057218 .  
## omega  4.232e-06   1.222e-06    3.462 0.000536 ***
## alpha1 6.012e-01   1.083e-01    5.550 2.86e-08 ***
## beta1  2.519e-01   8.526e-02    2.954 0.003132 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Log Likelihood:
##  1223.751    normalized:  4.079169 
## 
## Description:
##  Sun Feb  2 15:36:10 2025 by user:  
## 
## 
## Standardised Residuals Tests:
##                                   Statistic      p-Value
##  Jarque-Bera Test   R    Chi^2   54.1300902 1.761147e-12
##  Shapiro-Wilk Test  R    W        0.9814896 6.392272e-04
##  Ljung-Box Test     R    Q(10)  144.3970498 0.000000e+00
##  Ljung-Box Test     R    Q(15)  152.2310820 0.000000e+00
##  Ljung-Box Test     R    Q(20)  153.8042641 0.000000e+00
##  Ljung-Box Test     R^2  Q(10)    7.7493638 6.533037e-01
##  Ljung-Box Test     R^2  Q(15)    9.6087572 8.436022e-01
##  Ljung-Box Test     R^2  Q(20)   13.0794732 8.739482e-01
##  LM Arch Test       R    TR^2     8.2115410 7.683883e-01
## 
## Information Criterion Statistics:
##       AIC       BIC       SIC      HQIC 
## -8.131670 -8.082287 -8.132020 -8.111907</code></pre>
<div class="sourceCode" id="cb541"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb541-1"><a href="garchモデル.html#cb541-1" tabindex="-1"></a><span class="fu">coef</span>(fit_GARCH)</span></code></pre></div>
<pre><code>##           mu        omega       alpha1        beta1 
## 5.505948e-04 4.231971e-06 6.012138e-01 2.518998e-01</code></pre>
<div class="sourceCode" id="cb543"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb543-1"><a href="garchモデル.html#cb543-1" tabindex="-1"></a>resd <span class="ot">&lt;-</span> <span class="fu">residuals</span>(fit_GARCH, <span class="at">standardize =</span> T)  <span class="co"># 標準化残差</span></span>
<span id="cb543-2"><a href="garchモデル.html#cb543-2" tabindex="-1"></a><span class="fu">tail</span>(resd, <span class="dv">10</span>)</span></code></pre></div>
<pre><code>##  [1] -0.86077681 -0.97468295 -0.41946506 -0.84915092 -0.78191126 -0.39765003
##  [7]  0.06257979  1.46594118  0.36737687  0.79955945</code></pre>
<div class="sourceCode" id="cb545"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb545-1"><a href="garchモデル.html#cb545-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfcol =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb545-2"><a href="garchモデル.html#cb545-2" tabindex="-1"></a><span class="fu">ts.plot</span>(resd)</span></code></pre></div>
<p><img src="070-GARCH_files/figure-html/est.4-1.png" width="672" /></p>
<div class="sourceCode" id="cb546"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb546-1"><a href="garchモデル.html#cb546-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb546-2"><a href="garchモデル.html#cb546-2" tabindex="-1"></a><span class="fu">acf</span>(resd); <span class="fu">pacf</span>(resd <span class="sc">^</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="070-GARCH_files/figure-html/est.4-2.png" width="672" /></p>
<div class="sourceCode" id="cb547"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb547-1"><a href="garchモデル.html#cb547-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb547-2"><a href="garchモデル.html#cb547-2" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb547-3"><a href="garchモデル.html#cb547-3" tabindex="-1"></a><span class="fu">tsdiag</span>(fit_GARCH)</span></code></pre></div>
<pre><code>## Please install package &#39;goftest&#39; for additional tests</code></pre>
<p><img src="070-GARCH_files/figure-html/est.4-3.png" width="672" /></p>
<ul>
<li>→ ARCHより若干改善? 非正規性残る → 更なる改善の余地有り
<ul>
<li>Tsay, Ch.4を参照のこと</li>
</ul></li>
<li>ボラティリティ推定値 (内挿予測)</li>
</ul>
<div class="sourceCode" id="cb549"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb549-1"><a href="garchモデル.html#cb549-1" tabindex="-1"></a><span class="co"># ボラティリティ推定値</span></span>
<span id="cb549-2"><a href="garchモデル.html#cb549-2" tabindex="-1"></a>vola <span class="ot">&lt;-</span> fGarch<span class="sc">::</span><span class="fu">volatility</span>(fit_GARCH)  <span class="co"># 標準偏差表示, fGarch</span></span>
<span id="cb549-3"><a href="garchモデル.html#cb549-3" tabindex="-1"></a><span class="fu">tail</span>(vola, <span class="dv">10</span>)</span></code></pre></div>
<pre><code>##  [1] 0.002761729 0.003090444 0.003477479 0.002925302 0.003177623 0.003238359
##  [7] 0.002805460 0.002496619 0.003722264 0.002974284</code></pre>
<div class="sourceCode" id="cb551"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb551-1"><a href="garchモデル.html#cb551-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfcol =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>))</span>
<span id="cb551-2"><a href="garchモデル.html#cb551-2" tabindex="-1"></a><span class="fu">ts.plot</span>(x); <span class="fu">ts.plot</span>(vola)</span></code></pre></div>
<p><img src="070-GARCH_files/figure-html/est.5-1.png" width="672" /></p>
<div class="sourceCode" id="cb552"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb552-1"><a href="garchモデル.html#cb552-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span></code></pre></div>
<ul>
<li><span class="math inline">\(l\)</span>期先予測 (外挿予測)</li>
</ul>
<div class="sourceCode" id="cb553"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb553-1"><a href="garchモデル.html#cb553-1" tabindex="-1"></a><span class="co"># n.ahead(=20)期先予測</span></span>
<span id="cb553-2"><a href="garchモデル.html#cb553-2" tabindex="-1"></a><span class="co"># nx:表示する観測データ数</span></span>
<span id="cb553-3"><a href="garchモデル.html#cb553-3" tabindex="-1"></a><span class="co"># 収益率系列xの予測 (&amp; 95%信頼区間)</span></span>
<span id="cb553-4"><a href="garchモデル.html#cb553-4" tabindex="-1"></a>x_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit_GARCH, <span class="at">n.ahead =</span> <span class="dv">20</span>, <span class="at">plot =</span> <span class="cn">TRUE</span>, <span class="at">conf =</span> .<span class="dv">95</span>, <span class="at">nx =</span> <span class="dv">300</span>)</span></code></pre></div>
<p><img src="070-GARCH_files/figure-html/est.6-1.png" width="672" /></p>
<div class="sourceCode" id="cb554"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb554-1"><a href="garchモデル.html#cb554-1" tabindex="-1"></a><span class="co"># ボラティリティのl期先予測値 (標準偏差表示)</span></span>
<span id="cb554-2"><a href="garchモデル.html#cb554-2" tabindex="-1"></a>(v_pred <span class="ot">&lt;-</span> x_pred[, <span class="st">&quot;standardDeviation&quot;</span>])</span></code></pre></div>
<pre><code>##  [1] 0.003140143 0.003555854 0.003875412 0.004128527 0.004332789 0.004499725
##  [7] 0.004637393 0.004751687 0.004847063 0.004926971 0.004994130 0.005050719
## [13] 0.005098500 0.005138911 0.005173136 0.005202157 0.005226787 0.005247708
## [19] 0.005265490 0.005280613</code></pre>
<div class="sourceCode" id="cb556"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb556-1"><a href="garchモデル.html#cb556-1" tabindex="-1"></a><span class="co"># プロット (実績値&amp;予測値)</span></span>
<span id="cb556-2"><a href="garchモデル.html#cb556-2" tabindex="-1"></a>v_pred <span class="ot">&lt;-</span> <span class="fu">c</span>(vola[(tlen <span class="sc">-</span> <span class="dv">99</span>)<span class="sc">:</span>tlen], v_pred) <span class="co">#; length(v_pred)</span></span>
<span id="cb556-3"><a href="garchモデル.html#cb556-3" tabindex="-1"></a><span class="fu">plot</span>(v_pred, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;vola&quot;</span>); <span class="fu">abline</span>(<span class="at">v =</span> <span class="dv">101</span>, <span class="at">col =</span> <span class="st">&quot;orange&quot;</span>, <span class="at">lty =</span> <span class="st">&quot;dotted&quot;</span>)</span></code></pre></div>
<p><img src="070-GARCH_files/figure-html/est.6-2.png" width="672" /></p>
<ul>
<li>GARCH(1,1)モデルの<span class="math inline">\(l\)</span>-期先ボラティリティ予測値
<ul>
<li><span class="math inline">\(T\)</span>: データ期間 (モデル推定に使用) の最終時点 (予測の起点)</li>
<li><span class="math inline">\(u_T, \sigma_T^2\)</span>: モデル適合による時点<span class="math inline">\(T\)</span>における推定値 (所与)</li>
<li><span class="math inline">\(l=1\)</span>のケース: <span class="math display">\[\sigma_T^2 (1) = \omega + \alpha_1 u_T^2 + \beta_1 \sigma_T^2\]</span></li>
<li><span class="math inline">\(l\ge2\)</span>のケース: <span class="math display">\[\sigma_T^2 (l) = \omega \frac{1-(\alpha_1 + \beta_1)^{l-1}}{1-(\alpha_1 + \beta_1)} + (\alpha_1 + \beta_1)^{l-1} \sigma_T^2 (1)\]</span></li>
<li>参考: Tsay, pp.200-201</li>
</ul></li>
</ul>
<p>次に, みずほFGのデータセットに対して,
代替パッケージ<strong>rugarch</strong>を使用した
GARCHモデルの適合, および予測の例を示す.
<strong>rugarch</strong>の使い方については,
この後で紹介する.</p>
<div class="sourceCode" id="cb557"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb557-1"><a href="garchモデル.html#cb557-1" tabindex="-1"></a><span class="fu">library</span>(rugarch)</span></code></pre></div>
<pre><code>## Loading required package: parallel</code></pre>
<pre><code>## 
## Attaching package: &#39;rugarch&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:stats&#39;:
## 
##     sigma</code></pre>
<div class="sourceCode" id="cb561"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb561-1"><a href="garchモデル.html#cb561-1" tabindex="-1"></a><span class="co"># モデルの特定: GARCH(1,1)を指定</span></span>
<span id="cb561-2"><a href="garchモデル.html#cb561-2" tabindex="-1"></a>spec <span class="ot">&lt;-</span> <span class="fu">ugarchspec</span>(<span class="at">variance.model =</span> <span class="fu">list</span>(<span class="at">garchOrder =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>)))</span>
<span id="cb561-3"><a href="garchモデル.html#cb561-3" tabindex="-1"></a><span class="co"># モデルの適合</span></span>
<span id="cb561-4"><a href="garchモデル.html#cb561-4" tabindex="-1"></a>fit_GARCH <span class="ot">&lt;-</span> <span class="fu">ugarchfit</span>(<span class="at">data =</span> x, <span class="at">spec =</span> spec)</span>
<span id="cb561-5"><a href="garchモデル.html#cb561-5" tabindex="-1"></a><span class="co">#  収益率系列, ボラティリティの予測 (→ x_predに2系列を格納)</span></span>
<span id="cb561-6"><a href="garchモデル.html#cb561-6" tabindex="-1"></a>(x_pred <span class="ot">&lt;-</span> <span class="fu">ugarchforecast</span>(<span class="at">fitORspec =</span> fit_GARCH, <span class="at">n.ahead =</span> <span class="dv">20</span>))</span></code></pre></div>
<pre><code>## 
## *------------------------------------*
## *       GARCH Model Forecast         *
## *------------------------------------*
## Model: sGARCH
## Horizon: 20
## Roll Steps: 0
## Out of Sample: 0
## 
## 0-roll forecast [T0=2025-02-01]:
##         Series    Sigma
## T+1  3.651e-03 0.003180
## T+2  1.854e-03 0.003277
## T+3  9.630e-04 0.003367
## T+4  5.210e-04 0.003453
## T+5  3.018e-04 0.003533
## T+6  1.931e-04 0.003609
## T+7  1.392e-04 0.003682
## T+8  1.125e-04 0.003750
## T+9  9.922e-05 0.003815
## T+10 9.264e-05 0.003877
## T+11 8.938e-05 0.003937
## T+12 8.776e-05 0.003993
## T+13 8.696e-05 0.004047
## T+14 8.656e-05 0.004098
## T+15 8.636e-05 0.004147
## T+16 8.626e-05 0.004194
## T+17 8.622e-05 0.004239
## T+18 8.619e-05 0.004282
## T+19 8.618e-05 0.004323
## T+20 8.617e-05 0.004363</code></pre>
<div class="sourceCode" id="cb563"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb563-1"><a href="garchモデル.html#cb563-1" tabindex="-1"></a><span class="co"># 別々に表示</span></span>
<span id="cb563-2"><a href="garchモデル.html#cb563-2" tabindex="-1"></a><span class="co"># 収益率系列の予測値</span></span>
<span id="cb563-3"><a href="garchモデル.html#cb563-3" tabindex="-1"></a><span class="co"># fitted(x_pred)</span></span>
<span id="cb563-4"><a href="garchモデル.html#cb563-4" tabindex="-1"></a><span class="co"># x_pred@forecast$seriesFor  # 同</span></span>
<span id="cb563-5"><a href="garchモデル.html#cb563-5" tabindex="-1"></a><span class="co"># ボラティリティ(条件付標準偏差)の予測値</span></span>
<span id="cb563-6"><a href="garchモデル.html#cb563-6" tabindex="-1"></a><span class="fu">sigma</span>(x_pred)             </span></code></pre></div>
<pre><code>##       2025-02-01
## T+1  0.003180478
## T+2  0.003276718
## T+3  0.003367218
## T+4  0.003452526
## T+5  0.003533106
## T+6  0.003609360
## T+7  0.003681637
## T+8  0.003750244
## T+9  0.003815451
## T+10 0.003877500
## T+11 0.003936604
## T+12 0.003992959
## T+13 0.004046739
## T+14 0.004098102
## T+15 0.004147194
## T+16 0.004194146
## T+17 0.004239080
## T+18 0.004282108
## T+19 0.004323332
## T+20 0.004362848</code></pre>
<div class="sourceCode" id="cb565"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb565-1"><a href="garchモデル.html#cb565-1" tabindex="-1"></a><span class="co"># x_pred@forecast$sigmaFor # 同</span></span></code></pre></div>
<div class="sourceCode" id="cb566"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb566-1"><a href="garchモデル.html#cb566-1" tabindex="-1"></a><span class="co"># plot(x_pred)</span></span>
<span id="cb566-2"><a href="garchモデル.html#cb566-2" tabindex="-1"></a>fGarch<span class="sc">::</span><span class="fu">plot</span>(x_pred, <span class="at">which =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="070-GARCH_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<div class="sourceCode" id="cb567"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb567-1"><a href="garchモデル.html#cb567-1" tabindex="-1"></a><span class="co"># plot(x_pred, which = 2)</span></span>
<span id="cb567-2"><a href="garchモデル.html#cb567-2" tabindex="-1"></a><span class="fu">plot</span>(x_pred, <span class="at">which =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="070-GARCH_files/figure-html/unnamed-chunk-10-2.png" width="672" /></p>
<div class="sourceCode" id="cb568"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb568-1"><a href="garchモデル.html#cb568-1" tabindex="-1"></a><span class="co"># plot(x_pred, which = 4)</span></span></code></pre></div>
<p>注) <code>rugarch::rugarchforecast()</code>の出力<code>x_pred</code>に対するプロットと, 先の<code>fGarch::predict()</code>の出力<code>x_pred</code>とは異なる.</p>

<div id="パッケージrugarchの利用" class="section level3 unnumbered hasAnchor">
<h3>パッケージ<strong>rugarch</strong>の利用<a href="garchモデル.html#パッケージrugarchの利用" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<pre><code>- ugarchspec(): 一変量GARCHモデルの特定 (specification)
  - modelの選択肢: “sGARCH”, “fGARCH”, “eGARCH”, “gjrGARCH”, “apARCH”, “iGARCH”, “csGARCH”
  - submodelの選択肢(model=“fGARCH”の場合): “GARCH”, “TGARCH”, “AVGARCH”, “NGARCH”, “NAGARCH”, “APARCH”, “GJRGARCH”, “ALL- GARCH”.
  - distribution.mpdel(イノベーションに用いる条件付確率密度)の選択肢: &quot;norm&quot;, &quot;snorm&quot;(skew-normal), &quot;std&quot;(student t), &quot;sstd&quot;(skew-student), &quot;ged&quot;(generalized error), &quot;sged&quot;(skew-ged), &quot;nig&quot;(normal inverse gaussian), &quot;ghyp&quot;(Generalized Hyperbolic), &quot;jsu&quot;(Johnson&#39;s SU).
- ugarchfit(): 一変量GARCHモデルの適合
  - solverの選択肢: “nlminb”, “solnp”, “lbfgs”, “gosolnp”, “nloptr” or “hybrid”
- 注): 本パッケージでは, &quot;NAGARCH (Nonlinear Asymmetric GARCH)&quot;, &quot;NGARCH (Nonlinear GARCH)&quot;である. Tsay, 4.12で紹介されているEngle and Ng (1993)の&quot;NGARCH (Nonsymmetric GARCH)&quot;は, 前者に対応する.  </code></pre>
<ul>
<li><p><a href="https://www.rdocumentation.org/packages/rugarch/versions/1.4-4" class="uri">https://www.rdocumentation.org/packages/rugarch/versions/1.4-4</a></p></li>
<li><p>データセット: spyreal</p></li>
</ul>
<pre><code>- SPDR Standard and Poors 500 Open-Close Daily Return and Realized Kernel Volatility
  - SPDR(スパイダー) S\&amp;P500インデックス: 始値-終値(open-close)収益率, 実現カーネル(realized kernel)ボラティリティ.
  - 期間: 2002-01-02 〜 2008-08-29
  - Reference: Hansen, P. R., Huang, Z., and Shek, H. H. (2012). Realized GARCH: a joint model for returns and realized measures of volatility. Journal of Applied Econometrics, 27(6), 877–906.</code></pre>
<div class="sourceCode" id="cb571"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb571-1"><a href="garchモデル.html#cb571-1" tabindex="-1"></a><span class="fu">library</span>(rugarch)</span></code></pre></div>
<pre><code>## Loading required package: parallel</code></pre>
<pre><code>## 
## Attaching package: &#39;rugarch&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:stats&#39;:
## 
##     sigma</code></pre>
<div class="sourceCode" id="cb575"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb575-1"><a href="garchモデル.html#cb575-1" tabindex="-1"></a><span class="fu">data</span>(spyreal)</span>
<span id="cb575-2"><a href="garchモデル.html#cb575-2" tabindex="-1"></a><span class="fu">head</span>(spyreal)</span></code></pre></div>
<pre><code>##                   SPY_OC      SPY_RK
## 2002-01-02  0.0051151007 0.010044750
## 2002-01-03  0.0101514981 0.005342828
## 2002-01-04  0.0009369278 0.007978535
## 2002-01-07 -0.0097245499 0.005772834
## 2002-01-08 -0.0033463500 0.006452759
## 2002-01-09 -0.0078317023 0.007684824</code></pre>
</div>
<div id="iarch11" class="section level3 unnumbered hasAnchor">
<h3>IARCH(1,1)<a href="garchモデル.html#iarch11" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb577"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb577-1"><a href="garchモデル.html#cb577-1" tabindex="-1"></a>spec1 <span class="ot">&lt;-</span> <span class="fu">ugarchspec</span>(</span>
<span id="cb577-2"><a href="garchモデル.html#cb577-2" tabindex="-1"></a>        <span class="at">variance.model =</span> <span class="fu">list</span>(<span class="at">model =</span> <span class="st">&quot;iGARCH&quot;</span>, <span class="at">garchOrder =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>)), </span>
<span id="cb577-3"><a href="garchモデル.html#cb577-3" tabindex="-1"></a>        <span class="at">mean.model =</span> <span class="fu">list</span>(<span class="at">armaOrder =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="at">include.mean =</span> <span class="cn">TRUE</span>),  </span>
<span id="cb577-4"><a href="garchモデル.html#cb577-4" tabindex="-1"></a>        <span class="at">distribution.model =</span> <span class="st">&quot;norm&quot;</span>, <span class="at">fixed.pars =</span> <span class="fu">list</span>(<span class="at">omega =</span> <span class="dv">0</span>))</span>
<span id="cb577-5"><a href="garchモデル.html#cb577-5" tabindex="-1"></a><span class="co"># 平均方程式にARMA(1,1)の場合: mean.model=list(armaOrder = c(1, 1)</span></span>
<span id="cb577-6"><a href="garchモデル.html#cb577-6" tabindex="-1"></a>mod_igarch <span class="ot">&lt;-</span> <span class="fu">ugarchfit</span>(<span class="at">spec =</span> spec1, <span class="at">data =</span> spyreal[, <span class="dv">1</span>], <span class="at">solver =</span> <span class="st">&#39;hybrid&#39;</span>)</span>
<span id="cb577-7"><a href="garchモデル.html#cb577-7" tabindex="-1"></a>mod_igarch</span></code></pre></div>
<pre><code>## 
## *---------------------------------*
## *          GARCH Model Fit        *
## *---------------------------------*
## 
## Conditional Variance Dynamics    
## -----------------------------------
## GARCH Model  : iGARCH(1,1)
## Mean Model   : ARFIMA(0,0,0)
## Distribution : norm 
## 
## Optimal Parameters
## ------------------------------------
##         Estimate  Std. Error  t value Pr(&gt;|t|)
## mu     -0.000028    0.000177 -0.15908   0.8736
## omega   0.000000          NA       NA       NA
## alpha1  0.043186    0.006677  6.46763   0.0000
## beta1   0.956814          NA       NA       NA
## 
## Robust Standard Errors:
##         Estimate  Std. Error  t value Pr(&gt;|t|)
## mu     -0.000028    0.000212 -0.13345 0.893837
## omega   0.000000          NA       NA       NA
## alpha1  0.043186    0.010296  4.19426 0.000027
## beta1   0.956814          NA       NA       NA
## 
## LogLikelihood : 5630.331 
## 
## Information Criteria
## ------------------------------------
##                     
## Akaike       -6.7730
## Bayes        -6.7664
## Shibata      -6.7730
## Hannan-Quinn -6.7705
## 
## Weighted Ljung-Box Test on Standardized Residuals
## ------------------------------------
##                         statistic  p-value
## Lag[1]                      5.478 0.019252
## Lag[2*(p+q)+(p+q)-1][2]     8.207 0.005702
## Lag[4*(p+q)+(p+q)-1][5]    10.148 0.008436
## d.o.f=0
## H0 : No serial correlation
## 
## Weighted Ljung-Box Test on Standardized Squared Residuals
## ------------------------------------
##                         statistic p-value
## Lag[1]                    0.07751  0.7807
## Lag[2*(p+q)+(p+q)-1][5]   0.87182  0.8880
## Lag[4*(p+q)+(p+q)-1][9]   1.85043  0.9221
## d.o.f=2
## 
## Weighted ARCH LM Tests
## ------------------------------------
##             Statistic Shape Scale P-Value
## ARCH Lag[3]    0.9841 0.500 2.000  0.3212
## ARCH Lag[5]    1.3879 1.440 1.667  0.6223
## ARCH Lag[7]    2.0139 2.315 1.543  0.7144
## 
## Nyblom stability test
## ------------------------------------
## Joint Statistic:  0.1404
## Individual Statistics:              
## mu     0.02297
## alpha1 0.08852
## 
## Asymptotic Critical Values (10% 5% 1%)
## Joint Statistic:          0.61 0.749 1.07
## Individual Statistic:     0.35 0.47 0.75
## 
## Sign Bias Test
## ------------------------------------
##                    t-value   prob sig
## Sign Bias          1.24939 0.2117    
## Negative Sign Bias 0.07504 0.9402    
## Positive Sign Bias 0.78467 0.4328    
## Joint Effect       5.84998 0.1191    
## 
## 
## Adjusted Pearson Goodness-of-Fit Test:
## ------------------------------------
##   group statistic p-value(g-1)
## 1    20     40.09    0.0031807
## 2    30     58.61    0.0009158
## 3    40     63.78    0.0073916
## 4    50     83.13    0.0016808
## 
## 
## Elapsed time : 0.04465389</code></pre>
</div>
<div id="gjr-garch11" class="section level3 unnumbered hasAnchor">
<h3>GJR-GARCH(1,1)<a href="garchモデル.html#gjr-garch11" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb579"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb579-1"><a href="garchモデル.html#cb579-1" tabindex="-1"></a>spec2 <span class="ot">&lt;-</span> <span class="fu">ugarchspec</span>(</span>
<span id="cb579-2"><a href="garchモデル.html#cb579-2" tabindex="-1"></a>        <span class="at">variance.model =</span> <span class="fu">list</span>(<span class="at">model =</span> <span class="st">&quot;gjrGARCH&quot;</span>, <span class="at">garchOrder =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>)), </span>
<span id="cb579-3"><a href="garchモデル.html#cb579-3" tabindex="-1"></a>        <span class="at">mean.model =</span> <span class="fu">list</span>(<span class="at">armaOrder =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="at">include.mean =</span> <span class="cn">TRUE</span>),  </span>
<span id="cb579-4"><a href="garchモデル.html#cb579-4" tabindex="-1"></a>        <span class="at">distribution.model =</span> <span class="st">&quot;norm&quot;</span>)</span>
<span id="cb579-5"><a href="garchモデル.html#cb579-5" tabindex="-1"></a>mod_gjr <span class="ot">&lt;-</span> <span class="fu">ugarchfit</span>(<span class="at">spec =</span> spec2, <span class="at">data =</span> spyreal[, <span class="dv">1</span>], <span class="at">solver =</span> <span class="st">&#39;hybrid&#39;</span>)</span>
<span id="cb579-6"><a href="garchモデル.html#cb579-6" tabindex="-1"></a>mod_gjr</span></code></pre></div>
<pre><code>## 
## *---------------------------------*
## *          GARCH Model Fit        *
## *---------------------------------*
## 
## Conditional Variance Dynamics    
## -----------------------------------
## GARCH Model  : gjrGARCH(1,1)
## Mean Model   : ARFIMA(0,0,0)
## Distribution : norm 
## 
## Optimal Parameters
## ------------------------------------
##         Estimate  Std. Error    t value Pr(&gt;|t|)
## mu     -0.000235    0.000166  -1.411053  0.15823
## omega   0.000001    0.000001   1.071143  0.28410
## alpha1  0.000002    0.001539   0.001406  0.99888
## beta1   0.946143    0.009444 100.187823  0.00000
## gamma1  0.090960    0.015266   5.958395  0.00000
## 
## Robust Standard Errors:
##         Estimate  Std. Error   t value Pr(&gt;|t|)
## mu     -0.000235    0.000398 -0.590360 0.554949
## omega   0.000001    0.000003  0.176179 0.860154
## alpha1  0.000002    0.067915  0.000032 0.999975
## beta1   0.946143    0.079995 11.827460 0.000000
## gamma1  0.090960    0.024653  3.689603 0.000225
## 
## LogLikelihood : 5665.739 
## 
## Information Criteria
## ------------------------------------
##                     
## Akaike       -6.8120
## Bayes        -6.7957
## Shibata      -6.8120
## Hannan-Quinn -6.8059
## 
## Weighted Ljung-Box Test on Standardized Residuals
## ------------------------------------
##                         statistic  p-value
## Lag[1]                      5.697 0.016992
## Lag[2*(p+q)+(p+q)-1][2]     7.484 0.008868
## Lag[4*(p+q)+(p+q)-1][5]     8.806 0.018530
## d.o.f=0
## H0 : No serial correlation
## 
## Weighted Ljung-Box Test on Standardized Squared Residuals
## ------------------------------------
##                         statistic p-value
## Lag[1]                      3.883 0.04878
## Lag[2*(p+q)+(p+q)-1][5]     5.237 0.13523
## Lag[4*(p+q)+(p+q)-1][9]     6.736 0.22230
## d.o.f=2
## 
## Weighted ARCH LM Tests
## ------------------------------------
##             Statistic Shape Scale P-Value
## ARCH Lag[3]    0.1657 0.500 2.000  0.6840
## ARCH Lag[5]    0.4472 1.440 1.667  0.8991
## ARCH Lag[7]    1.9375 2.315 1.543  0.7306
## 
## Nyblom stability test
## ------------------------------------
## Joint Statistic:  292.4044
## Individual Statistics:               
## mu      0.04325
## omega  55.95654
## alpha1  0.22056
## beta1   0.17936
## gamma1  0.19937
## 
## Asymptotic Critical Values (10% 5% 1%)
## Joint Statistic:          1.28 1.47 1.88
## Individual Statistic:     0.35 0.47 0.75
## 
## Sign Bias Test
## ------------------------------------
##                    t-value   prob sig
## Sign Bias           0.9606 0.3369    
## Negative Sign Bias  0.8427 0.3995    
## Positive Sign Bias  0.6544 0.5130    
## Joint Effect        2.4782 0.4792    
## 
## 
## Adjusted Pearson Goodness-of-Fit Test:
## ------------------------------------
##   group statistic p-value(g-1)
## 1    20     37.13     0.007635
## 2    30     53.67     0.003532
## 3    40     68.35     0.002521
## 4    50     83.07     0.001704
## 
## 
## Elapsed time : 0.3069692</code></pre>
</div>
<div id="aparch" class="section level3 unnumbered hasAnchor">
<h3>APARCH<a href="garchモデル.html#aparch" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb581"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb581-1"><a href="garchモデル.html#cb581-1" tabindex="-1"></a>spec3 <span class="ot">&lt;-</span> <span class="fu">ugarchspec</span>(</span>
<span id="cb581-2"><a href="garchモデル.html#cb581-2" tabindex="-1"></a>        <span class="at">variance.model =</span> <span class="fu">list</span>(<span class="at">model =</span> <span class="st">&quot;apARCH&quot;</span>, <span class="at">garchOrder =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>)), </span>
<span id="cb581-3"><a href="garchモデル.html#cb581-3" tabindex="-1"></a>        <span class="at">mean.model =</span> <span class="fu">list</span>(<span class="at">armaOrder =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="at">include.mean =</span> <span class="cn">TRUE</span>),  </span>
<span id="cb581-4"><a href="garchモデル.html#cb581-4" tabindex="-1"></a>        <span class="at">distribution.model =</span> <span class="st">&quot;std&quot;</span>)</span>
<span id="cb581-5"><a href="garchモデル.html#cb581-5" tabindex="-1"></a><span class="co">#   一般誤差分布使用の場合: distribution.model=&quot;ged&quot;)</span></span>
<span id="cb581-6"><a href="garchモデル.html#cb581-6" tabindex="-1"></a>mod_aparch <span class="ot">&lt;-</span> <span class="fu">ugarchfit</span>(<span class="at">spec =</span> spec3, <span class="at">data =</span> spyreal[, <span class="dv">1</span>], <span class="at">solver =</span> <span class="st">&#39;hybrid&#39;</span>)</span>
<span id="cb581-7"><a href="garchモデル.html#cb581-7" tabindex="-1"></a>mod_aparch</span></code></pre></div>
<pre><code>## 
## *---------------------------------*
## *          GARCH Model Fit        *
## *---------------------------------*
## 
## Conditional Variance Dynamics    
## -----------------------------------
## GARCH Model  : apARCH(1,1)
## Mean Model   : ARFIMA(0,0,0)
## Distribution : std 
## 
## Optimal Parameters
## ------------------------------------
##         Estimate  Std. Error    t value Pr(&gt;|t|)
## mu     -0.000125    0.000172   -0.72626 0.467678
## omega   0.000027    0.000031    0.86936 0.384649
## alpha1  0.041622    0.011955    3.48160 0.000498
## beta1   0.951146    0.008248  115.31753 0.000000
## gamma1  1.000000    0.000714 1400.04148 0.000000
## delta   1.225721    0.094589   12.95835 0.000000
## shape  15.206355    4.917006    3.09260 0.001984
## 
## Robust Standard Errors:
##         Estimate  Std. Error  t value Pr(&gt;|t|)
## mu     -0.000125         NaN      NaN      NaN
## omega   0.000027         NaN      NaN      NaN
## alpha1  0.041622         NaN      NaN      NaN
## beta1   0.951146         NaN      NaN      NaN
## gamma1  1.000000         NaN      NaN      NaN
## delta   1.225721         NaN      NaN      NaN
## shape  15.206355         NaN      NaN      NaN
## 
## LogLikelihood : 5675.851 
## 
## Information Criteria
## ------------------------------------
##                     
## Akaike       -6.8217
## Bayes        -6.7989
## Shibata      -6.8218
## Hannan-Quinn -6.8133
## 
## Weighted Ljung-Box Test on Standardized Residuals
## ------------------------------------
##                         statistic  p-value
## Lag[1]                      5.898 0.015161
## Lag[2*(p+q)+(p+q)-1][2]     7.943 0.006698
## Lag[4*(p+q)+(p+q)-1][5]     9.442 0.012785
## d.o.f=0
## H0 : No serial correlation
## 
## Weighted Ljung-Box Test on Standardized Squared Residuals
## ------------------------------------
##                         statistic p-value
## Lag[1]                      4.404 0.03586
## Lag[2*(p+q)+(p+q)-1][5]     5.695 0.10604
## Lag[4*(p+q)+(p+q)-1][9]     7.270 0.17759
## d.o.f=2
## 
## Weighted ARCH LM Tests
## ------------------------------------
##             Statistic Shape Scale P-Value
## ARCH Lag[3]   0.03823 0.500 2.000  0.8450
## ARCH Lag[5]   0.17666 1.440 1.667  0.9709
## ARCH Lag[7]   1.85878 2.315 1.543  0.7472
## 
## Nyblom stability test
## ------------------------------------
## Joint Statistic:  NaN
## Individual Statistics:              
## mu     0.06111
## omega  0.10186
## alpha1 0.19435
## beta1  0.19353
## gamma1     NaN
## delta  0.12352
## shape  0.59089
## 
## Asymptotic Critical Values (10% 5% 1%)
## Joint Statistic:          1.69 1.9 2.35
## Individual Statistic:     0.35 0.47 0.75
## 
## Sign Bias Test
## ------------------------------------
##                    t-value   prob sig
## Sign Bias           0.9885 0.3230    
## Negative Sign Bias  1.4529 0.1465    
## Positive Sign Bias  0.8097 0.4183    
## Joint Effect        3.4462 0.3278    
## 
## 
## Adjusted Pearson Goodness-of-Fit Test:
## ------------------------------------
##   group statistic p-value(g-1)
## 1    20     29.36     0.060532
## 2    30     41.10     0.067430
## 3    40     46.69     0.185786
## 4    50     82.04     0.002153
## 
## 
## Elapsed time : 1.366688</code></pre>
<ul>
<li>係数の推定値</li>
</ul>
<div class="sourceCode" id="cb583"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb583-1"><a href="garchモデル.html#cb583-1" tabindex="-1"></a><span class="fu">coef</span>(mod_aparch)</span></code></pre></div>
<pre><code>##            mu         omega        alpha1         beta1        gamma1 
## -1.251883e-04  2.669367e-05  4.162211e-02  9.511461e-01  1.000000e+00 
##         delta         shape 
##  1.225721e+00  1.520636e+01</code></pre>
<div class="sourceCode" id="cb585"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb585-1"><a href="garchモデル.html#cb585-1" tabindex="-1"></a><span class="co"># infocriteria(mod_aparch)[&quot;Akaike&quot;,]</span></span>
<span id="cb585-2"><a href="garchモデル.html#cb585-2" tabindex="-1"></a><span class="fu">infocriteria</span>(mod_aparch)</span></code></pre></div>
<pre><code>##                       
## Akaike       -6.821722
## Bayes        -6.798912
## Shibata      -6.821758
## Hannan-Quinn -6.813268</code></pre>
<ul>
<li>推定されたボラティリティ系列</li>
</ul>
<div class="sourceCode" id="cb587"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb587-1"><a href="garchモデル.html#cb587-1" tabindex="-1"></a><span class="co"># dat &lt;- spyreal[, 1]</span></span>
<span id="cb587-2"><a href="garchモデル.html#cb587-2" tabindex="-1"></a>dat <span class="ot">&lt;-</span> spyreal</span>
<span id="cb587-3"><a href="garchモデル.html#cb587-3" tabindex="-1"></a>dat<span class="sc">$</span>GARCH <span class="ot">&lt;-</span> <span class="fu">sigma</span>(mod_aparch)</span></code></pre></div>
<ul>
<li>プロット</li>
</ul>
<div class="sourceCode" id="cb588"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb588-1"><a href="garchモデル.html#cb588-1" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb588-2"><a href="garchモデル.html#cb588-2" tabindex="-1"></a><span class="fu">library</span>(xts)        <span class="co">#library(zoo)</span></span>
<span id="cb588-3"><a href="garchモデル.html#cb588-3" tabindex="-1"></a><span class="fu">autoplot</span>(dat)       <span class="co"># 時系列プロット</span></span>
<span id="cb588-4"><a href="garchモデル.html#cb588-4" tabindex="-1"></a><span class="co"># ボラティリティ推定値同士の比較</span></span>
<span id="cb588-5"><a href="garchモデル.html#cb588-5" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">as.vector</span>(<span class="fu">sqrt</span>(dat<span class="sc">$</span>SPY_RK)), <span class="fu">as.vector</span>(dat<span class="sc">$</span>GARCH))</span>
<span id="cb588-6"><a href="garchモデル.html#cb588-6" tabindex="-1"></a><span class="co"># plot(as.vector(dat$SPY_RK), as.vector(dat$GARCH))     </span></span></code></pre></div>
<ul>
<li>Bootstrap法に基づく予測
<ul>
<li>GARCHモデルによるn期先予測には2種類の不確実性: 予測確率分布に起因するもの &amp; パラメータ推定誤差に起因するもの.</li>
<li>Bootstrap法: 適合GARCHモデルの経験分布よりイノベーションをリサンプルすることで, 将来の時系列(series)と標準偏差(sigma)を生成.</li>
<li>“full”法(Pascual et al (2006)): パラメータのシミュレーション分布を発生させることで, パラメータ不確実性を考慮(実行時間がかかる).</li>
<li>“partial”法: 分布の不確実性のみ考慮</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb589"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb589-1"><a href="garchモデル.html#cb589-1" tabindex="-1"></a>dat_pred <span class="ot">&lt;-</span> <span class="fu">ugarchboot</span>(mod_aparch, <span class="at">n.ahead =</span> <span class="dv">30</span>, <span class="at">method =</span> <span class="st">&quot;Partial&quot;</span>)</span>
<span id="cb589-2"><a href="garchモデル.html#cb589-2" tabindex="-1"></a><span class="co"># plot(dat_pred, which = &quot;all&quot;)</span></span>
<span id="cb589-3"><a href="garchモデル.html#cb589-3" tabindex="-1"></a><span class="co"># 時系列(収益率)</span></span>
<span id="cb589-4"><a href="garchモデル.html#cb589-4" tabindex="-1"></a><span class="fu">plot</span>(dat_pred, <span class="at">which =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="072-GARCH-2_files/figure-html/aparch-5-1.png" width="672" /></p>
<div class="sourceCode" id="cb590"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb590-1"><a href="garchモデル.html#cb590-1" tabindex="-1"></a><span class="co"># 標準偏差(ボラティリティ)</span></span>
<span id="cb590-2"><a href="garchモデル.html#cb590-2" tabindex="-1"></a><span class="fu">plot</span>(dat_pred, <span class="at">which =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="072-GARCH-2_files/figure-html/aparch-5-2.png" width="672" /></p>
<div class="sourceCode" id="cb591"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb591-1"><a href="garchモデル.html#cb591-1" tabindex="-1"></a><span class="co"># which=1は, &quot;full&quot;法のみ (Parameter Density Plots生成)</span></span>
<span id="cb591-2"><a href="garchモデル.html#cb591-2" tabindex="-1"></a>dat_pred</span></code></pre></div>
<pre><code>## 
## *-----------------------------------*
## *     GARCH Bootstrap Forecast      *
## *-----------------------------------*
## Model : apARCH
## n.ahead : 30
## Bootstrap method:  partial
## Date (T[0]): 2008-08-29
## 
## Series (summary):
##            min      q.25      mean     q.75      max forecast[analytic]
## t+1  -0.028889 -0.005931 -0.000029 0.006394 0.033217          -0.000125
## t+2  -0.034391 -0.006618  0.000156 0.006866 0.035030          -0.000125
## t+3  -0.028137 -0.005622  0.000498 0.006237 0.029206          -0.000125
## t+4  -0.025283 -0.007711 -0.000508 0.005629 0.033215          -0.000125
## t+5  -0.049987 -0.006300 -0.000217 0.006522 0.038031          -0.000125
## t+6  -0.035585 -0.006500 -0.000812 0.004534 0.029474          -0.000125
## t+7  -0.045162 -0.007255 -0.000800 0.005244 0.034877          -0.000125
## t+8  -0.041687 -0.006459 -0.000480 0.006009 0.031051          -0.000125
## t+9  -0.031049 -0.005176  0.000751 0.007022 0.037387          -0.000125
## t+10 -0.036920 -0.006902 -0.000327 0.006093 0.034371          -0.000125
## .....................
## 
## Sigma (summary):
##           min    q0.25     mean    q0.75      max forecast[analytic]
## t+1  0.010004 0.010004 0.010004 0.010004 0.010004           0.010004
## t+2  0.009665 0.009665 0.009975 0.010074 0.012500           0.009985
## t+3  0.009341 0.009341 0.009958 0.010281 0.014877           0.009967
## t+4  0.009030 0.009157 0.009881 0.010299 0.014338           0.009948
## t+5  0.008732 0.009093 0.009871 0.010413 0.013958           0.009930
## t+6  0.008446 0.008978 0.009873 0.010458 0.017329           0.009912
## t+7  0.008173 0.008932 0.009868 0.010448 0.017745           0.009895
## t+8  0.007910 0.008910 0.009881 0.010499 0.017089           0.009877
## t+9  0.007659 0.008795 0.009886 0.010603 0.017519           0.009860
## t+10 0.007418 0.008698 0.009839 0.010660 0.016872           0.009842
## .....................</code></pre>

</div>
</div>
<div id="garchモデル-データ分析例-tsay-ch4" class="section level2 hasAnchor" number="8.5">
<h2><span class="header-section-number">8.5</span> GARCHモデル: データ分析例 (Tsay, Ch4)<a href="garchモデル.html#garchモデル-データ分析例-tsay-ch4" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>出所: <a href="http://faculty.chicagobooth.edu/ruey.tsay/teaching/introTS/" class="uri">http://faculty.chicagobooth.edu/ruey.tsay/teaching/introTS/</a> (一部改変)</li>
</ul>
<!-- # GARCHモデル(3) -->
<!---
TH(120923): Tsay教科書から乖離するが, web一般公開するなら,
関数は別のパッケージのものに変えた方が良い
出来れば, 分析データセットも!
再現性, Tsayのホームページから直接読み込む?
######################################################
>> 出所: Tsay, Ch4より抜粋（適宜, 補足説明挿入, または修正)
>> 出所: http://faculty.chicagobooth.edu/ruey.tsay/teaching/introTS/
######################################################
--->
<!---
cf. RRRR, pp.123-124, p.91
###### library(foreign)
###### Reading and writing data stored by some versions of 'Epi Info', 'Minitab', 'S', 'SAS', 'SPSS', 'Stata', 'Systat', 'Weka', and for reading and writing some 'dBase' files.
--->
<div id="必要な関数やデータセットの入手" class="section level3 unnumbered hasAnchor">
<h3>必要な関数やデータセットの入手<a href="garchモデル.html#必要な関数やデータセットの入手" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>教科書ホームページからのRコードへの直接の読み込みの方法</li>
</ul>
<div class="sourceCode" id="cb593"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb593-1"><a href="garchモデル.html#cb593-1" tabindex="-1"></a><span class="co"># 教科書著者(Tsay)の関数</span></span>
<span id="cb593-2"><a href="garchモデル.html#cb593-2" tabindex="-1"></a>fctns <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;igarch.r&quot;</span>, <span class="st">&quot;garchm.r&quot;</span>, <span class="st">&quot;egarch.r&quot;</span>, <span class="st">&quot;ngarch.r&quot;</span>, <span class="st">&quot;tgarch11.r&quot;</span>, <span class="st">&quot;vold2m.r&quot;</span>)</span>
<span id="cb593-3"><a href="garchモデル.html#cb593-3" tabindex="-1"></a>url_home <span class="ot">&lt;-</span> <span class="st">&quot;https://faculty.chicagobooth.edu/-/media/faculty/ruey-s-tsay/teaching/introts/&quot;</span></span>
<span id="cb593-4"><a href="garchモデル.html#cb593-4" tabindex="-1"></a><span class="cf">for</span> (fct <span class="cf">in</span> fctns) {</span>
<span id="cb593-5"><a href="garchモデル.html#cb593-5" tabindex="-1"></a>  url_tmp <span class="ot">&lt;-</span> <span class="fu">file.path</span>(url_home, fct)</span>
<span id="cb593-6"><a href="garchモデル.html#cb593-6" tabindex="-1"></a>  <span class="fu">source</span>(url_tmp)</span>
<span id="cb593-7"><a href="garchモデル.html#cb593-7" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb594"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb594-1"><a href="garchモデル.html#cb594-1" tabindex="-1"></a><span class="co"># データセット</span></span>
<span id="cb594-2"><a href="garchモデル.html#cb594-2" tabindex="-1"></a><span class="co"># 単一テキストファイルの入手</span></span>
<span id="cb594-3"><a href="garchモデル.html#cb594-3" tabindex="-1"></a><span class="co"># library(rio)</span></span>
<span id="cb594-4"><a href="garchモデル.html#cb594-4" tabindex="-1"></a><span class="co"># url_tmp &lt;- &quot;https://faculty.chicagobooth.edu/-/media/faculty/ruey-s-tsay/teaching/introts/d-spy-0111.txt&quot;</span></span>
<span id="cb594-5"><a href="garchモデル.html#cb594-5" tabindex="-1"></a><span class="co"># rio::import(url_tmp)</span></span>
<span id="cb594-6"><a href="garchモデル.html#cb594-6" tabindex="-1"></a></span>
<span id="cb594-7"><a href="garchモデル.html#cb594-7" tabindex="-1"></a><span class="co"># 複数データセットの入った圧縮フォルダ(*.zip)からのデータセット入手</span></span>
<span id="cb594-8"><a href="garchモデル.html#cb594-8" tabindex="-1"></a>url_tmp <span class="ot">&lt;-</span> <span class="st">&quot;https://faculty.chicagobooth.edu/-/media/faculty/ruey-s-tsay/teaching/introts/ch4data.zip&quot;</span></span>
<span id="cb594-9"><a href="garchモデル.html#cb594-9" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> <span class="fu">tempfile</span>()</span>
<span id="cb594-10"><a href="garchモデル.html#cb594-10" tabindex="-1"></a>tmp2 <span class="ot">&lt;-</span> <span class="fu">tempfile</span>()</span>
<span id="cb594-11"><a href="garchモデル.html#cb594-11" tabindex="-1"></a><span class="fu">download.file</span>(url_tmp, tmp)</span>
<span id="cb594-12"><a href="garchモデル.html#cb594-12" tabindex="-1"></a><span class="fu">unzip</span>(tmp, <span class="at">exdir =</span> tmp2)</span>
<span id="cb594-13"><a href="garchモデル.html#cb594-13" tabindex="-1"></a><span class="fu">dir</span>(tmp2, <span class="at">recursive =</span> T)</span>
<span id="cb594-14"><a href="garchモデル.html#cb594-14" tabindex="-1"></a><span class="do">## [1] &quot;d-pg-0111.txt&quot;    &quot;d-sp58010.txt&quot;    &quot;d-spy-0111.txt&quot;   &quot;d-useu9910.txt&quot;  </span></span>
<span id="cb594-15"><a href="garchモデル.html#cb594-15" tabindex="-1"></a><span class="do">## [5] &quot;m-ibmsp6709.txt&quot;  &quot;m-intcsp7309.txt&quot; &quot;m-ko-6111.txt&quot;    &quot;m-sp56710.txt&quot;</span></span>
<span id="cb594-16"><a href="garchモデル.html#cb594-16" tabindex="-1"></a><span class="fu">setwd</span>(tmp2)</span>
<span id="cb594-17"><a href="garchモデル.html#cb594-17" tabindex="-1"></a><span class="fu">unlink</span>(tmp)</span></code></pre></div>
<!-- 12/13/24
Tsay作成のIgarch.R関数内のfilter()が誤動作. 優先順位を変える必要
find("filter")
> find("filter")
[1] "package:dplyr" "package:stats"
-->
</div>
<div id="integrated-garch-モデル" class="section level3 unnumbered hasAnchor">
<h3>Integrated GARCH モデル<a href="garchモデル.html#integrated-garch-モデル" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Tsay 4.7, pp.211–212</li>
</ul>
<pre><code>Igarch(): Estimation of a Gaussian IGARCH(1,1) model.
- Igarch(rtn, include.mean = F, volcnt = F)
  - rtn: return series
  - include.mean: flag for the constant in the mean equation.
  - volcnt: flag for the constant term of the volatility equation.</code></pre>
<div class="sourceCode" id="cb596"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb596-1"><a href="garchモデル.html#cb596-1" tabindex="-1"></a><span class="co"># source(&quot;Igarch.R&quot;)</span></span>
<span id="cb596-2"><a href="garchモデル.html#cb596-2" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb596-3"><a href="garchモデル.html#cb596-3" tabindex="-1"></a>da <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">&quot;m-intcsp7309.txt&quot;</span>, <span class="at">header =</span> T)</span>
<span id="cb596-4"><a href="garchモデル.html#cb596-4" tabindex="-1"></a><span class="fu">head</span>(da)                        <span class="co"># monthly returns of Intel &amp; S&amp;P, Jan73--Dec09</span></span>
<span id="cb596-5"><a href="garchモデル.html#cb596-5" tabindex="-1"></a><span class="do">##       date      intc        sp</span></span>
<span id="cb596-6"><a href="garchモデル.html#cb596-6" tabindex="-1"></a><span class="do">## 1 19730131  0.010050 -0.017111</span></span>
<span id="cb596-7"><a href="garchモデル.html#cb596-7" tabindex="-1"></a><span class="do">## 2 19730228 -0.139303 -0.037490</span></span>
<span id="cb596-8"><a href="garchモデル.html#cb596-8" tabindex="-1"></a><span class="do">## 3 19730330  0.069364 -0.001433</span></span>
<span id="cb596-9"><a href="garchモデル.html#cb596-9" tabindex="-1"></a><span class="do">## 4 19730430  0.086486 -0.040800</span></span>
<span id="cb596-10"><a href="garchモデル.html#cb596-10" tabindex="-1"></a><span class="do">## 5 19730531 -0.104478 -0.018884</span></span>
<span id="cb596-11"><a href="garchモデル.html#cb596-11" tabindex="-1"></a><span class="do">## 6 19730629  0.133333 -0.006575</span></span>
<span id="cb596-12"><a href="garchモデル.html#cb596-12" tabindex="-1"></a>intc <span class="ot">&lt;-</span> <span class="fu">log</span>(da<span class="sc">$</span>intc <span class="sc">+</span> <span class="dv">1</span>)        <span class="co"># monthly log-returns of Intel</span></span></code></pre></div>
<div class="sourceCode" id="cb597"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb597-1"><a href="garchモデル.html#cb597-1" tabindex="-1"></a><span class="co"># mm &lt;- Igarch(intc, include.mean = T, volcnt = T)  # --&gt; エラー</span></span>
<span id="cb597-2"><a href="garchモデル.html#cb597-2" tabindex="-1"></a><span class="co"># mm &lt;- Igarch(intc, include.mean = T)  # --&gt; mu, beta</span></span>
<span id="cb597-3"><a href="garchモデル.html#cb597-3" tabindex="-1"></a><span class="co"># mm &lt;- Igarch(intc, volcnt = T)        # --&gt; omega, beta</span></span>
<span id="cb597-4"><a href="garchモデル.html#cb597-4" tabindex="-1"></a>mm <span class="ot">&lt;-</span> <span class="fu">Igarch</span>(intc)  <span class="co"># --&gt; beta</span></span>
<span id="cb597-5"><a href="garchモデル.html#cb597-5" tabindex="-1"></a><span class="do">## Estimates:  0.9217433 </span></span>
<span id="cb597-6"><a href="garchモデル.html#cb597-6" tabindex="-1"></a><span class="do">## Maximized log-likehood:  -301.412 </span></span>
<span id="cb597-7"><a href="garchモデル.html#cb597-7" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb597-8"><a href="garchモデル.html#cb597-8" tabindex="-1"></a><span class="do">## Coefficient(s):</span></span>
<span id="cb597-9"><a href="garchモデル.html#cb597-9" tabindex="-1"></a><span class="do">##       Estimate  Std. Error  t value   Pr(&gt;|t|)    </span></span>
<span id="cb597-10"><a href="garchモデル.html#cb597-10" tabindex="-1"></a><span class="do">## beta 0.9217433   0.0155534  59.2633 &lt; 2.22e-16 ***</span></span>
<span id="cb597-11"><a href="garchモデル.html#cb597-11" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb597-12"><a href="garchモデル.html#cb597-12" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb597-13"><a href="garchモデル.html#cb597-13" tabindex="-1"></a><span class="fu">names</span>(mm)</span>
<span id="cb597-14"><a href="garchモデル.html#cb597-14" tabindex="-1"></a><span class="do">## [1] &quot;par&quot;        &quot;volatility&quot;</span></span>
<span id="cb597-15"><a href="garchモデル.html#cb597-15" tabindex="-1"></a>mm<span class="sc">$</span>par  <span class="co"># --&gt; beta</span></span>
<span id="cb597-16"><a href="garchモデル.html#cb597-16" tabindex="-1"></a><span class="do">##      beta </span></span>
<span id="cb597-17"><a href="garchモデル.html#cb597-17" tabindex="-1"></a><span class="do">## 0.9217433</span></span>
<span id="cb597-18"><a href="garchモデル.html#cb597-18" tabindex="-1"></a><span class="fu">head</span>(mm<span class="sc">$</span>volatility)</span>
<span id="cb597-19"><a href="garchモデル.html#cb597-19" tabindex="-1"></a><span class="do">## [1] 0.1275742 0.1225127 0.1248833 0.1213562 0.1187993 0.1181597</span></span></code></pre></div>
<div class="sourceCode" id="cb598"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb598-1"><a href="garchモデル.html#cb598-1" tabindex="-1"></a><span class="fu">summary</span>(mm)</span>
<span id="cb598-2"><a href="garchモデル.html#cb598-2" tabindex="-1"></a><span class="do">##            Length Class  Mode   </span></span>
<span id="cb598-3"><a href="garchモデル.html#cb598-3" tabindex="-1"></a><span class="do">## par          1    -none- numeric</span></span>
<span id="cb598-4"><a href="garchモデル.html#cb598-4" tabindex="-1"></a><span class="do">## volatility 444    ts     numeric</span></span></code></pre></div>
<ul>
<li>–&gt; 教科書の記載と出力が相違(??)</li>
</ul>
<div class="sourceCode" id="cb599"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb599-1"><a href="garchモデル.html#cb599-1" tabindex="-1"></a><span class="fu">plot</span>(mm<span class="sc">$</span>vola)</span></code></pre></div>
<p><img src="074-GARCH-3_files/figure-html/unnamed-chunk-8-1.png" width="75%" /></p>
</div>
<div id="garch-m-モデル" class="section level3 unnumbered hasAnchor">
<h3>GARCH-M モデル<a href="garchモデル.html#garch-m-モデル" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Tsay 4.8, pp.213–214</li>
</ul>
<pre><code>garchM(): Estimation of a Gaussian GARCH(1, 1)-M model.
- The program uses GARCH(1, 1) results as initial values.
- garchM(rtn, type = 1)
  - rtn: return series
  - type = 1 for Variance-in-mean
  -      = 2 for volatility-in-mean
  -      = 3 for log(variance)-in-mean</code></pre>
<div class="sourceCode" id="cb601"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb601-1"><a href="garchモデル.html#cb601-1" tabindex="-1"></a><span class="co"># source(&quot;garchM.R&quot;) # Compile the script</span></span>
<span id="cb601-2"><a href="garchモデル.html#cb601-2" tabindex="-1"></a>y <span class="ot">&lt;-</span> intc <span class="sc">*</span> <span class="dv">100</span>  <span class="co"># Intel stock returns in percentages</span></span>
<span id="cb601-3"><a href="garchモデル.html#cb601-3" tabindex="-1"></a><span class="fu">garchM</span>(y)</span>
<span id="cb601-4"><a href="garchモデル.html#cb601-4" tabindex="-1"></a><span class="do">## Maximized log-likehood:  -1731.983 </span></span>
<span id="cb601-5"><a href="garchモデル.html#cb601-5" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb601-6"><a href="garchモデル.html#cb601-6" tabindex="-1"></a><span class="do">## Coefficient(s):</span></span>
<span id="cb601-7"><a href="garchモデル.html#cb601-7" tabindex="-1"></a><span class="do">##         Estimate  Std. Error  t value   Pr(&gt;|t|)    </span></span>
<span id="cb601-8"><a href="garchモデル.html#cb601-8" tabindex="-1"></a><span class="do">## mu    0.07760802  1.31934294  0.05882  0.9530929    </span></span>
<span id="cb601-9"><a href="garchモデル.html#cb601-9" tabindex="-1"></a><span class="do">## gamma 0.00794321  0.00917955  0.86532  0.3868654    </span></span>
<span id="cb601-10"><a href="garchモデル.html#cb601-10" tabindex="-1"></a><span class="do">## omega 9.45891744  3.94046506  2.40046  0.0163746 *  </span></span>
<span id="cb601-11"><a href="garchモデル.html#cb601-11" tabindex="-1"></a><span class="do">## alpha 0.08761597  0.02673485  3.27722  0.0010483 ** </span></span>
<span id="cb601-12"><a href="garchモデル.html#cb601-12" tabindex="-1"></a><span class="do">## beta  0.84933814  0.03948593 21.50989 &lt; 2.22e-16 ***</span></span>
<span id="cb601-13"><a href="garchモデル.html#cb601-13" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb601-14"><a href="garchモデル.html#cb601-14" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<ul>
<li>–&gt; 教科書の記載と出力が相違(??)
<ul>
<li>リスクプレミアム(gamma), 有意でない</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb602"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb602-1"><a href="garchモデル.html#cb602-1" tabindex="-1"></a><span class="fu">garchM</span>(y, <span class="at">type =</span> <span class="dv">2</span>)</span>
<span id="cb602-2"><a href="garchモデル.html#cb602-2" tabindex="-1"></a><span class="fu">garchM</span>(y, <span class="at">type =</span> <span class="dv">3</span>)</span>
<span id="cb602-3"><a href="garchモデル.html#cb602-3" tabindex="-1"></a><span class="do">## 注: (最適化にnlminb()使用) 実行時間かかる</span></span></code></pre></div>
<ul>
<li>–&gt; 通常のGARCH(1,1)へ
<ul>
<li>#&gt; library(fGarch)</li>
<li>#&gt; fGarch::garchFit(~ garch(1, 1), data = y, trace = F)</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb603"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb603-1"><a href="garchモデル.html#cb603-1" tabindex="-1"></a><span class="co"># sp5 &lt;- scan(file = &quot;sp500.txt&quot;)   # &lt;-- データ無. 誤植?</span></span>
<span id="cb603-2"><a href="garchモデル.html#cb603-2" tabindex="-1"></a>da <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">&quot;m-intcsp7309.txt&quot;</span>, <span class="at">header =</span> T)</span>
<span id="cb603-3"><a href="garchモデル.html#cb603-3" tabindex="-1"></a><span class="co"># &lt;-- 代わりに使用. --&gt; 教科書と結果が異なる</span></span>
<span id="cb603-4"><a href="garchモデル.html#cb603-4" tabindex="-1"></a><span class="co"># head(da)                      # monthly returns of Intel &amp; S&amp;P, Jan73--Dec09</span></span>
<span id="cb603-5"><a href="garchモデル.html#cb603-5" tabindex="-1"></a><span class="co"># da &lt;- read.table(&quot;m-ibmsp-2611.txt&quot;, header = T)</span></span>
<span id="cb603-6"><a href="garchモデル.html#cb603-6" tabindex="-1"></a><span class="co"># da &lt;- da[da$data&lt; = 20091231, ]</span></span>
<span id="cb603-7"><a href="garchモデル.html#cb603-7" tabindex="-1"></a><span class="co"># head(da)                      # monthly returns of IBM &amp; S&amp;P, Jan26--Sep11</span></span>
<span id="cb603-8"><a href="garchモデル.html#cb603-8" tabindex="-1"></a>sp5 <span class="ot">&lt;-</span> <span class="fu">log</span>(da<span class="sc">$</span>sp <span class="sc">+</span> <span class="dv">1</span>)       <span class="co"># monthly log-returns of S&amp;P</span></span>
<span id="cb603-9"><a href="garchモデル.html#cb603-9" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb603-10"><a href="garchモデル.html#cb603-10" tabindex="-1"></a><span class="fu">library</span>(fGarch)</span>
<span id="cb603-11"><a href="garchモデル.html#cb603-11" tabindex="-1"></a>sp5 <span class="ot">&lt;-</span> sp5 <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb603-12"><a href="garchモデル.html#cb603-12" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> fGarch<span class="sc">::</span><span class="fu">garchFit</span>(<span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> <span class="fu">garch</span>(<span class="dv">1</span>, <span class="dv">1</span>), <span class="at">data =</span> sp5, <span class="at">trace =</span> F)</span>
<span id="cb603-13"><a href="garchモデル.html#cb603-13" tabindex="-1"></a><span class="fu">summary</span>(m2)</span>
<span id="cb603-14"><a href="garchモデル.html#cb603-14" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb603-15"><a href="garchモデル.html#cb603-15" tabindex="-1"></a><span class="do">## Title:</span></span>
<span id="cb603-16"><a href="garchモデル.html#cb603-16" tabindex="-1"></a><span class="do">##  GARCH Modelling </span></span>
<span id="cb603-17"><a href="garchモデル.html#cb603-17" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb603-18"><a href="garchモデル.html#cb603-18" tabindex="-1"></a><span class="do">## Call:</span></span>
<span id="cb603-19"><a href="garchモデル.html#cb603-19" tabindex="-1"></a><span class="do">##  fGarch::garchFit(formula = ~1 + garch(1, 1), data = sp5, trace = F) </span></span>
<span id="cb603-20"><a href="garchモデル.html#cb603-20" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb603-21"><a href="garchモデル.html#cb603-21" tabindex="-1"></a><span class="do">## Mean and Variance Equation:</span></span>
<span id="cb603-22"><a href="garchモデル.html#cb603-22" tabindex="-1"></a><span class="do">##  data ~ 1 + garch(1, 1)</span></span>
<span id="cb603-23"><a href="garchモデル.html#cb603-23" tabindex="-1"></a><span class="do">## &lt;environment: 0x7fb403a2cbe8&gt;</span></span>
<span id="cb603-24"><a href="garchモデル.html#cb603-24" tabindex="-1"></a><span class="do">##  [data = sp5]</span></span>
<span id="cb603-25"><a href="garchモデル.html#cb603-25" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb603-26"><a href="garchモデル.html#cb603-26" tabindex="-1"></a><span class="do">## Conditional Distribution:</span></span>
<span id="cb603-27"><a href="garchモデル.html#cb603-27" tabindex="-1"></a><span class="do">##  norm </span></span>
<span id="cb603-28"><a href="garchモデル.html#cb603-28" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb603-29"><a href="garchモデル.html#cb603-29" tabindex="-1"></a><span class="do">## Coefficient(s):</span></span>
<span id="cb603-30"><a href="garchモデル.html#cb603-30" tabindex="-1"></a><span class="do">##      mu    omega   alpha1    beta1  </span></span>
<span id="cb603-31"><a href="garchモデル.html#cb603-31" tabindex="-1"></a><span class="do">## 0.56091  0.72752  0.11733  0.85910  </span></span>
<span id="cb603-32"><a href="garchモデル.html#cb603-32" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb603-33"><a href="garchモデル.html#cb603-33" tabindex="-1"></a><span class="do">## Std. Errors:</span></span>
<span id="cb603-34"><a href="garchモデル.html#cb603-34" tabindex="-1"></a><span class="do">##  based on Hessian </span></span>
<span id="cb603-35"><a href="garchモデル.html#cb603-35" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb603-36"><a href="garchモデル.html#cb603-36" tabindex="-1"></a><span class="do">## Error Analysis:</span></span>
<span id="cb603-37"><a href="garchモデル.html#cb603-37" tabindex="-1"></a><span class="do">##         Estimate  Std. Error  t value Pr(&gt;|t|)    </span></span>
<span id="cb603-38"><a href="garchモデル.html#cb603-38" tabindex="-1"></a><span class="do">## mu       0.56091     0.18951    2.960 0.003078 ** </span></span>
<span id="cb603-39"><a href="garchモデル.html#cb603-39" tabindex="-1"></a><span class="do">## omega    0.72752     0.45322    1.605 0.108447    </span></span>
<span id="cb603-40"><a href="garchモデル.html#cb603-40" tabindex="-1"></a><span class="do">## alpha1   0.11733     0.03157    3.717 0.000202 ***</span></span>
<span id="cb603-41"><a href="garchモデル.html#cb603-41" tabindex="-1"></a><span class="do">## beta1    0.85910     0.03023   28.415  &lt; 2e-16 ***</span></span>
<span id="cb603-42"><a href="garchモデル.html#cb603-42" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb603-43"><a href="garchモデル.html#cb603-43" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb603-44"><a href="garchモデル.html#cb603-44" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb603-45"><a href="garchモデル.html#cb603-45" tabindex="-1"></a><span class="do">## Log Likelihood:</span></span>
<span id="cb603-46"><a href="garchモデル.html#cb603-46" tabindex="-1"></a><span class="do">##  -1289.671    normalized:  -2.904663 </span></span>
<span id="cb603-47"><a href="garchモデル.html#cb603-47" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb603-48"><a href="garchモデル.html#cb603-48" tabindex="-1"></a><span class="do">## Description:</span></span>
<span id="cb603-49"><a href="garchモデル.html#cb603-49" tabindex="-1"></a><span class="do">##  Sun Feb  2 15:36:26 2025 by user:  </span></span>
<span id="cb603-50"><a href="garchモデル.html#cb603-50" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb603-51"><a href="garchモデル.html#cb603-51" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb603-52"><a href="garchモデル.html#cb603-52" tabindex="-1"></a><span class="do">## Standardised Residuals Tests:</span></span>
<span id="cb603-53"><a href="garchモデル.html#cb603-53" tabindex="-1"></a><span class="do">##                                   Statistic      p-Value</span></span>
<span id="cb603-54"><a href="garchモデル.html#cb603-54" tabindex="-1"></a><span class="do">##  Jarque-Bera Test   R    Chi^2  175.7288595 0.000000e+00</span></span>
<span id="cb603-55"><a href="garchモデル.html#cb603-55" tabindex="-1"></a><span class="do">##  Shapiro-Wilk Test  R    W        0.9655541 1.058946e-08</span></span>
<span id="cb603-56"><a href="garchモデル.html#cb603-56" tabindex="-1"></a><span class="do">##  Ljung-Box Test     R    Q(10)   10.2148009 4.218546e-01</span></span>
<span id="cb603-57"><a href="garchモデル.html#cb603-57" tabindex="-1"></a><span class="do">##  Ljung-Box Test     R    Q(15)   12.7646774 6.204685e-01</span></span>
<span id="cb603-58"><a href="garchモデル.html#cb603-58" tabindex="-1"></a><span class="do">##  Ljung-Box Test     R    Q(20)   15.3249363 7.575226e-01</span></span>
<span id="cb603-59"><a href="garchモデル.html#cb603-59" tabindex="-1"></a><span class="do">##  Ljung-Box Test     R^2  Q(10)    5.0820118 8.856326e-01</span></span>
<span id="cb603-60"><a href="garchモデル.html#cb603-60" tabindex="-1"></a><span class="do">##  Ljung-Box Test     R^2  Q(15)    6.7788883 9.634974e-01</span></span>
<span id="cb603-61"><a href="garchモデル.html#cb603-61" tabindex="-1"></a><span class="do">##  Ljung-Box Test     R^2  Q(20)    7.6653472 9.938604e-01</span></span>
<span id="cb603-62"><a href="garchモデル.html#cb603-62" tabindex="-1"></a><span class="do">##  LM Arch Test       R    TR^2     5.2952187 9.473846e-01</span></span>
<span id="cb603-63"><a href="garchモデル.html#cb603-63" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb603-64"><a href="garchモデル.html#cb603-64" tabindex="-1"></a><span class="do">## Information Criterion Statistics:</span></span>
<span id="cb603-65"><a href="garchモデル.html#cb603-65" tabindex="-1"></a><span class="do">##      AIC      BIC      SIC     HQIC </span></span>
<span id="cb603-66"><a href="garchモデル.html#cb603-66" tabindex="-1"></a><span class="do">## 5.827345 5.864244 5.827184 5.841896</span></span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Estimate</th>
<th align="right">Std. Error</th>
<th align="right">t value</th>
<th align="right">Pr(&gt;|t|)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">mu</td>
<td align="right">0.5609132</td>
<td align="right">0.1895067</td>
<td align="right">2.959859</td>
<td align="right">0.0030778</td>
</tr>
<tr class="even">
<td align="left">omega</td>
<td align="right">0.7275158</td>
<td align="right">0.4532207</td>
<td align="right">1.605213</td>
<td align="right">0.1084469</td>
</tr>
<tr class="odd">
<td align="left">alpha1</td>
<td align="right">0.1173334</td>
<td align="right">0.0315668</td>
<td align="right">3.716989</td>
<td align="right">0.0002016</td>
</tr>
<tr class="even">
<td align="left">beta1</td>
<td align="right">0.8590999</td>
<td align="right">0.0302342</td>
<td align="right">28.414854</td>
<td align="right">0.0000000</td>
</tr>
</tbody>
</table>
<ul>
<li>–&gt; GARCH(1,1), <span class="math inline">\(\alpha_1,\beta_1\)</span>とも (5%) 有意.</li>
</ul>
<div class="sourceCode" id="cb604"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb604-1"><a href="garchモデル.html#cb604-1" tabindex="-1"></a><span class="fu">plot</span>(m2, <span class="at">which =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">13</span>)</span></code></pre></div>
<p><img src="074-GARCH-3_files/figure-html/unnamed-chunk-13-1.png" width="75%" /><img src="074-GARCH-3_files/figure-html/unnamed-chunk-13-2.png" width="75%" /><img src="074-GARCH-3_files/figure-html/unnamed-chunk-13-3.png" width="75%" /><img src="074-GARCH-3_files/figure-html/unnamed-chunk-13-4.png" width="75%" /><img src="074-GARCH-3_files/figure-html/unnamed-chunk-13-5.png" width="75%" /><img src="074-GARCH-3_files/figure-html/unnamed-chunk-13-6.png" width="75%" /><img src="074-GARCH-3_files/figure-html/unnamed-chunk-13-7.png" width="75%" /><img src="074-GARCH-3_files/figure-html/unnamed-chunk-13-8.png" width="75%" /><img src="074-GARCH-3_files/figure-html/unnamed-chunk-13-9.png" width="75%" /><img src="074-GARCH-3_files/figure-html/unnamed-chunk-13-10.png" width="75%" /><img src="074-GARCH-3_files/figure-html/unnamed-chunk-13-11.png" width="75%" /><img src="074-GARCH-3_files/figure-html/unnamed-chunk-13-12.png" width="75%" /><img src="074-GARCH-3_files/figure-html/unnamed-chunk-13-13.png" width="75%" /></p>
<ul>
<li>–&gt; モデル診断, 正規性を除き, データによく適合</li>
</ul>
<div class="sourceCode" id="cb605"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb605-1"><a href="garchモデル.html#cb605-1" tabindex="-1"></a><span class="fu">garchM</span>(sp5)</span>
<span id="cb605-2"><a href="garchモデル.html#cb605-2" tabindex="-1"></a><span class="do">## Maximized log-likehood:  -1289.449 </span></span>
<span id="cb605-3"><a href="garchモデル.html#cb605-3" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb605-4"><a href="garchモデル.html#cb605-4" tabindex="-1"></a><span class="do">## Coefficient(s):</span></span>
<span id="cb605-5"><a href="garchモデル.html#cb605-5" tabindex="-1"></a><span class="do">##        Estimate  Std. Error  t value   Pr(&gt;|t|)    </span></span>
<span id="cb605-6"><a href="garchモデル.html#cb605-6" tabindex="-1"></a><span class="do">## mu    0.3467741   0.3848943  0.90096  0.3676100    </span></span>
<span id="cb605-7"><a href="garchモデル.html#cb605-7" tabindex="-1"></a><span class="do">## gamma 0.0122469   0.0188778  0.64875  0.5165031    </span></span>
<span id="cb605-8"><a href="garchモデル.html#cb605-8" tabindex="-1"></a><span class="do">## omega 0.7612141   0.4796034  1.58717  0.1124732    </span></span>
<span id="cb605-9"><a href="garchモデル.html#cb605-9" tabindex="-1"></a><span class="do">## alpha 0.1163726   0.0317726  3.66267  0.0002496 ***</span></span>
<span id="cb605-10"><a href="garchモデル.html#cb605-10" tabindex="-1"></a><span class="do">## beta  0.8581959   0.0308425 27.82515 &lt; 2.22e-16 ***</span></span>
<span id="cb605-11"><a href="garchモデル.html#cb605-11" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb605-12"><a href="garchモデル.html#cb605-12" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<ul>
<li>–&gt; リスクプレミアム (gamma), 有意でない (5%水準)
<ul>
<li>–&gt; GARCH(1,1)を選択せよ</li>
</ul></li>
</ul>
</div>
<div id="exponential-garch-model" class="section level3 unnumbered hasAnchor">
<h3>Exponential GARCH Model<a href="garchモデル.html#exponential-garch-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Tsay 4.9, pp.218–220</li>
</ul>
<pre><code>Egarch(): Estimation of an EGARCH(1, 1) model. Assume normal innovations
- Egarch(rtn)</code></pre>
<div class="sourceCode" id="cb607"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb607-1"><a href="garchモデル.html#cb607-1" tabindex="-1"></a><span class="co"># source(&quot;Egarch.R&quot;) # Compile R script</span></span>
<span id="cb607-2"><a href="garchモデル.html#cb607-2" tabindex="-1"></a>da <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">&quot;m-ibmsp6709.txt&quot;</span>, <span class="at">header =</span> T) <span class="co"># Load data</span></span>
<span id="cb607-3"><a href="garchモデル.html#cb607-3" tabindex="-1"></a><span class="fu">dim</span>(da) <span class="co"># Check sample size of the data</span></span>
<span id="cb607-4"><a href="garchモデル.html#cb607-4" tabindex="-1"></a><span class="do">## [1] 516   3</span></span>
<span id="cb607-5"><a href="garchモデル.html#cb607-5" tabindex="-1"></a>ibm <span class="ot">&lt;-</span> <span class="fu">log</span>(da<span class="sc">$</span>ibm <span class="sc">+</span> <span class="dv">1</span>) <span class="co"># Take log transformation</span></span>
<span id="cb607-6"><a href="garchモデル.html#cb607-6" tabindex="-1"></a><span class="fu">Box.test</span>(ibm, <span class="at">lag =</span> <span class="dv">12</span>, <span class="at">type =</span> <span class="st">&#39;Ljung&#39;</span>) <span class="co"># Check serial correlations</span></span>
<span id="cb607-7"><a href="garchモデル.html#cb607-7" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb607-8"><a href="garchモデル.html#cb607-8" tabindex="-1"></a><span class="do">##  Box-Ljung test</span></span>
<span id="cb607-9"><a href="garchモデル.html#cb607-9" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb607-10"><a href="garchモデル.html#cb607-10" tabindex="-1"></a><span class="do">## data:  ibm</span></span>
<span id="cb607-11"><a href="garchモデル.html#cb607-11" tabindex="-1"></a><span class="do">## X-squared = 7.4042, df = 12, p-value = 0.8298</span></span>
<span id="cb607-12"><a href="garchモデル.html#cb607-12" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">Egarch</span>(ibm) <span class="co"># Model fitting</span></span>
<span id="cb607-13"><a href="garchモデル.html#cb607-13" tabindex="-1"></a><span class="do">##   </span></span>
<span id="cb607-14"><a href="garchモデル.html#cb607-14" tabindex="-1"></a><span class="do">## Estimation results of EGARCH(1,1) model: </span></span>
<span id="cb607-15"><a href="garchモデル.html#cb607-15" tabindex="-1"></a><span class="do">## estimates:  0.006732389 -0.5983263 0.217603 -0.4243245 0.92015 </span></span>
<span id="cb607-16"><a href="garchモデル.html#cb607-16" tabindex="-1"></a><span class="do">## std.errors:  0.002877666 0.2349172 0.05916528 0.1683064 0.0388656 </span></span>
<span id="cb607-17"><a href="garchモデル.html#cb607-17" tabindex="-1"></a><span class="do">## t-ratio:  2.339531 -2.546967 3.677882 -2.521144 23.67518</span></span>
<span id="cb607-18"><a href="garchモデル.html#cb607-18" tabindex="-1"></a><span class="fu">names</span>(m1)</span>
<span id="cb607-19"><a href="garchモデル.html#cb607-19" tabindex="-1"></a><span class="do">## [1] &quot;residuals&quot;  &quot;volatility&quot;</span></span></code></pre></div>
<ul>
<li>上記出力の見方:
<ul>
<li>Estimation results of EGARCH(1, 1) model:</li>
<li>estimates: 0.006732389 -0.5983263 0.217603 -0.4243245 0.92015</li>
<li>std.errors: 0.002877666 0.2349172 0.05916528 0.1683064 0.0388656</li>
<li>t-ratio: 2.339531 -2.546967 3.677882 -2.521144 23.67518</li>
<li>&lt;– mu, omega, alpha1, gamma1, beta1の順に出力</li>
<li>–&gt; 値が教科書(p.220)と若干相違</li>
</ul></li>
<li>モデル診断</li>
</ul>
<div class="sourceCode" id="cb608"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb608-1"><a href="garchモデル.html#cb608-1" tabindex="-1"></a>stresi <span class="ot">&lt;-</span> m1<span class="sc">$</span>residuals<span class="sc">/</span>m1<span class="sc">$</span>volatility <span class="co"># Obtain standardized residuals</span></span>
<span id="cb608-2"><a href="garchモデル.html#cb608-2" tabindex="-1"></a>tdx <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">516</span>)<span class="sc">/</span><span class="dv">12</span> <span class="sc">+</span> <span class="dv">1967</span> <span class="co"># Compute time index</span></span>
<span id="cb608-3"><a href="garchモデル.html#cb608-3" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfcol =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>)) <span class="co"># Plotting</span></span>
<span id="cb608-4"><a href="garchモデル.html#cb608-4" tabindex="-1"></a><span class="fu">plot</span>(tdx, ibm, <span class="at">xlab =</span> <span class="st">&#39;year&#39;</span>, <span class="at">ylab =</span> <span class="st">&#39;logrtn&#39;</span>, <span class="at">type =</span> <span class="st">&#39;l&#39;</span>)</span>
<span id="cb608-5"><a href="garchモデル.html#cb608-5" tabindex="-1"></a><span class="fu">plot</span>(tdx, stresi, <span class="at">xlab =</span> <span class="st">&#39;year&#39;</span>, <span class="at">ylab =</span> <span class="st">&#39;stresi&#39;</span>, <span class="at">type =</span> <span class="st">&#39;l&#39;</span>)</span></code></pre></div>
<p><img src="074-GARCH-3_files/figure-html/unnamed-chunk-16-1.png" width="75%" /></p>
<div class="sourceCode" id="cb609"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb609-1"><a href="garchモデル.html#cb609-1" tabindex="-1"></a><span class="fu">Box.test</span>(stresi, <span class="at">lag =</span> <span class="dv">10</span>, <span class="at">type =</span> <span class="st">&#39;Ljung&#39;</span>) <span class="co"># Model checking</span></span>
<span id="cb609-2"><a href="garchモデル.html#cb609-2" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb609-3"><a href="garchモデル.html#cb609-3" tabindex="-1"></a><span class="do">##  Box-Ljung test</span></span>
<span id="cb609-4"><a href="garchモデル.html#cb609-4" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb609-5"><a href="garchモデル.html#cb609-5" tabindex="-1"></a><span class="do">## data:  stresi</span></span>
<span id="cb609-6"><a href="garchモデル.html#cb609-6" tabindex="-1"></a><span class="do">## X-squared = 5.2866, df = 10, p-value = 0.8712</span></span>
<span id="cb609-7"><a href="garchモデル.html#cb609-7" tabindex="-1"></a><span class="fu">Box.test</span>(stresi, <span class="at">lag =</span> <span class="dv">20</span>, <span class="at">type =</span> <span class="st">&#39;Ljung&#39;</span>)</span>
<span id="cb609-8"><a href="garchモデル.html#cb609-8" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb609-9"><a href="garchモデル.html#cb609-9" tabindex="-1"></a><span class="do">##  Box-Ljung test</span></span>
<span id="cb609-10"><a href="garchモデル.html#cb609-10" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb609-11"><a href="garchモデル.html#cb609-11" tabindex="-1"></a><span class="do">## data:  stresi</span></span>
<span id="cb609-12"><a href="garchモデル.html#cb609-12" tabindex="-1"></a><span class="do">## X-squared = 20.983, df = 20, p-value = 0.3981</span></span>
<span id="cb609-13"><a href="garchモデル.html#cb609-13" tabindex="-1"></a><span class="fu">Box.test</span>(stresi<span class="sc">^</span><span class="dv">2</span>, <span class="at">lag =</span> <span class="dv">10</span>, <span class="at">type =</span> <span class="st">&#39;Ljung&#39;</span>)</span>
<span id="cb609-14"><a href="garchモデル.html#cb609-14" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb609-15"><a href="garchモデル.html#cb609-15" tabindex="-1"></a><span class="do">##  Box-Ljung test</span></span>
<span id="cb609-16"><a href="garchモデル.html#cb609-16" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb609-17"><a href="garchモデル.html#cb609-17" tabindex="-1"></a><span class="do">## data:  stresi^2</span></span>
<span id="cb609-18"><a href="garchモデル.html#cb609-18" tabindex="-1"></a><span class="do">## X-squared = 5.0469, df = 10, p-value = 0.888</span></span>
<span id="cb609-19"><a href="garchモデル.html#cb609-19" tabindex="-1"></a><span class="fu">Box.test</span>(stresi<span class="sc">^</span><span class="dv">2</span>, <span class="at">lag =</span> <span class="dv">20</span>, <span class="at">type =</span> <span class="st">&#39;Ljung&#39;</span>)</span>
<span id="cb609-20"><a href="garchモデル.html#cb609-20" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb609-21"><a href="garchモデル.html#cb609-21" tabindex="-1"></a><span class="do">##  Box-Ljung test</span></span>
<span id="cb609-22"><a href="garchモデル.html#cb609-22" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb609-23"><a href="garchモデル.html#cb609-23" tabindex="-1"></a><span class="do">## data:  stresi^2</span></span>
<span id="cb609-24"><a href="garchモデル.html#cb609-24" tabindex="-1"></a><span class="do">## X-squared = 14.261, df = 20, p-value = 0.817</span></span></code></pre></div>
<ul>
<li>–&gt; Tsay, “The model fits the data reasonably well.”</li>
</ul>
</div>
<div id="threshold-garch-モデル" class="section level3 unnumbered hasAnchor">
<h3>Threshold GARCH モデル<a href="garchモデル.html#threshold-garch-モデル" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Tsay 4.10, pp.222–223</li>
</ul>
<pre><code>Tgarch(): Estimation of TGARCH(1, 1) model with Gaussian or Student-t innovations
- Tgarch11(x, cond.dist = &quot;norm&quot;)</code></pre>
<div class="sourceCode" id="cb611"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb611-1"><a href="garchモデル.html#cb611-1" tabindex="-1"></a>da <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">&quot;d-useu9910.txt&quot;</span>, <span class="at">header =</span> T)       <span class="co"># daily USD/EUR, Jan/4/99--Aug/20/10</span></span>
<span id="cb611-2"><a href="garchモデル.html#cb611-2" tabindex="-1"></a>fx <span class="ot">&lt;-</span> <span class="fu">log</span>(da<span class="sc">$</span>rate)</span>
<span id="cb611-3"><a href="garchモデル.html#cb611-3" tabindex="-1"></a>eu <span class="ot">&lt;-</span> <span class="fu">diff</span>(fx) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb611-4"><a href="garchモデル.html#cb611-4" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb611-5"><a href="garchモデル.html#cb611-5" tabindex="-1"></a><span class="co"># source(&#39;Tgarch11.R&#39;)</span></span>
<span id="cb611-6"><a href="garchモデル.html#cb611-6" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">Tgarch11</span>(eu)</span>
<span id="cb611-7"><a href="garchモデル.html#cb611-7" tabindex="-1"></a><span class="do">## Log likelihood at MLEs:  </span></span>
<span id="cb611-8"><a href="garchモデル.html#cb611-8" tabindex="-1"></a><span class="do">## [1] -2731.832</span></span>
<span id="cb611-9"><a href="garchモデル.html#cb611-9" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb611-10"><a href="garchモデル.html#cb611-10" tabindex="-1"></a><span class="do">## Coefficient(s):</span></span>
<span id="cb611-11"><a href="garchモデル.html#cb611-11" tabindex="-1"></a><span class="do">##          Estimate  Std. Error   t value   Pr(&gt;|t|)    </span></span>
<span id="cb611-12"><a href="garchモデル.html#cb611-12" tabindex="-1"></a><span class="do">## mu    0.012241535 0.010729902   1.14088   0.253920    </span></span>
<span id="cb611-13"><a href="garchモデル.html#cb611-13" tabindex="-1"></a><span class="do">## omega 0.001275041 0.000618464   2.06163   0.039243 *  </span></span>
<span id="cb611-14"><a href="garchモデル.html#cb611-14" tabindex="-1"></a><span class="do">## alpha 0.022347042 0.005249432   4.25704 2.0715e-05 ***</span></span>
<span id="cb611-15"><a href="garchモデル.html#cb611-15" tabindex="-1"></a><span class="do">## gam1  0.012516447 0.007062540   1.77223   0.076356 .  </span></span>
<span id="cb611-16"><a href="garchモデル.html#cb611-16" tabindex="-1"></a><span class="do">## beta  0.968720385 0.004357859 222.29275 &lt; 2.22e-16 ***</span></span>
<span id="cb611-17"><a href="garchモデル.html#cb611-17" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb611-18"><a href="garchモデル.html#cb611-18" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<ul>
<li>–&gt; muは有意でない
<ul>
<li>volatility方程式の係数は有意</li>
<li>特に, レバレッジ効果 (H0: gamma&lt;=0, H1: gamma&gt;0)は(片側) 5%で有意. t=1.772, p=0.038.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb612"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb612-1"><a href="garchモデル.html#cb612-1" tabindex="-1"></a><span class="co"># モデル診断</span></span>
<span id="cb612-2"><a href="garchモデル.html#cb612-2" tabindex="-1"></a><span class="fu">names</span>(m1)</span>
<span id="cb612-3"><a href="garchモデル.html#cb612-3" tabindex="-1"></a><span class="do">## [1] &quot;residuals&quot;  &quot;volatility&quot; &quot;par&quot;</span></span>
<span id="cb612-4"><a href="garchモデル.html#cb612-4" tabindex="-1"></a>at <span class="ot">&lt;-</span> m1<span class="sc">$</span>residuals</span>
<span id="cb612-5"><a href="garchモデル.html#cb612-5" tabindex="-1"></a>sigt <span class="ot">&lt;-</span> m1<span class="sc">$</span>volatility</span>
<span id="cb612-6"><a href="garchモデル.html#cb612-6" tabindex="-1"></a>resi <span class="ot">&lt;-</span> at<span class="sc">/</span>sigt</span>
<span id="cb612-7"><a href="garchモデル.html#cb612-7" tabindex="-1"></a><span class="fu">Box.test</span>(resi, <span class="at">lag =</span> <span class="dv">10</span>, <span class="at">type =</span> <span class="st">&#39;Ljung&#39;</span>)</span>
<span id="cb612-8"><a href="garchモデル.html#cb612-8" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb612-9"><a href="garchモデル.html#cb612-9" tabindex="-1"></a><span class="do">##  Box-Ljung test</span></span>
<span id="cb612-10"><a href="garchモデル.html#cb612-10" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb612-11"><a href="garchモデル.html#cb612-11" tabindex="-1"></a><span class="do">## data:  resi</span></span>
<span id="cb612-12"><a href="garchモデル.html#cb612-12" tabindex="-1"></a><span class="do">## X-squared = 13.382, df = 10, p-value = 0.2031</span></span>
<span id="cb612-13"><a href="garchモデル.html#cb612-13" tabindex="-1"></a><span class="fu">Box.test</span>(resi, <span class="at">lag =</span> <span class="dv">20</span>, <span class="at">type =</span> <span class="st">&#39;Ljung&#39;</span>)</span>
<span id="cb612-14"><a href="garchモデル.html#cb612-14" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb612-15"><a href="garchモデル.html#cb612-15" tabindex="-1"></a><span class="do">##  Box-Ljung test</span></span>
<span id="cb612-16"><a href="garchモデル.html#cb612-16" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb612-17"><a href="garchモデル.html#cb612-17" tabindex="-1"></a><span class="do">## data:  resi</span></span>
<span id="cb612-18"><a href="garchモデル.html#cb612-18" tabindex="-1"></a><span class="do">## X-squared = 22.873, df = 20, p-value = 0.2951</span></span>
<span id="cb612-19"><a href="garchモデル.html#cb612-19" tabindex="-1"></a><span class="fu">Box.test</span>(resi <span class="sc">^</span> <span class="dv">2</span>, <span class="at">lag =</span> <span class="dv">10</span>, <span class="at">type =</span> <span class="st">&#39;Ljung&#39;</span>)</span>
<span id="cb612-20"><a href="garchモデル.html#cb612-20" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb612-21"><a href="garchモデル.html#cb612-21" tabindex="-1"></a><span class="do">##  Box-Ljung test</span></span>
<span id="cb612-22"><a href="garchモデル.html#cb612-22" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb612-23"><a href="garchモデル.html#cb612-23" tabindex="-1"></a><span class="do">## data:  resi^2</span></span>
<span id="cb612-24"><a href="garchモデル.html#cb612-24" tabindex="-1"></a><span class="do">## X-squared = 12.893, df = 10, p-value = 0.2297</span></span>
<span id="cb612-25"><a href="garchモデル.html#cb612-25" tabindex="-1"></a><span class="fu">Box.test</span>(resi <span class="sc">^</span> <span class="dv">2</span>, <span class="at">lag =</span> <span class="dv">20</span>, <span class="at">type =</span> <span class="st">&#39;Ljung&#39;</span>)</span>
<span id="cb612-26"><a href="garchモデル.html#cb612-26" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb612-27"><a href="garchモデル.html#cb612-27" tabindex="-1"></a><span class="do">##  Box-Ljung test</span></span>
<span id="cb612-28"><a href="garchモデル.html#cb612-28" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb612-29"><a href="garchモデル.html#cb612-29" tabindex="-1"></a><span class="do">## data:  resi^2</span></span>
<span id="cb612-30"><a href="garchモデル.html#cb612-30" tabindex="-1"></a><span class="do">## X-squared = 27.23, df = 20, p-value = 0.1289</span></span></code></pre></div>
<div class="sourceCode" id="cb613"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb613-1"><a href="garchモデル.html#cb613-1" tabindex="-1"></a><span class="co"># 追加</span></span>
<span id="cb613-2"><a href="garchモデル.html#cb613-2" tabindex="-1"></a><span class="fu">plot</span>(sigt, <span class="at">xlab =</span> <span class="st">&#39;year&#39;</span>, <span class="at">ylab =</span> <span class="st">&#39;volatility&#39;</span>, <span class="at">type =</span> <span class="st">&#39;l&#39;</span>)</span></code></pre></div>
<p><img src="074-GARCH-3_files/figure-html/unnamed-chunk-19-1.png" width="75%" /></p>
<div class="sourceCode" id="cb614"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb614-1"><a href="garchモデル.html#cb614-1" tabindex="-1"></a><span class="fu">plot</span>(resi, <span class="at">xlab =</span> <span class="st">&#39;year&#39;</span>, <span class="at">ylab =</span> <span class="st">&#39;residuals&#39;</span>, <span class="at">type =</span> <span class="st">&#39;l&#39;</span>)</span></code></pre></div>
<p><img src="074-GARCH-3_files/figure-html/unnamed-chunk-19-2.png" width="75%" /></p>
<ul>
<li>→ 残差プロット, heavy tailの存在?</li>
</ul>
</div>
<div id="asymmetric-power-arch-モデル" class="section level3 unnumbered hasAnchor">
<h3>Asymmetric Power ARCH モデル<a href="garchモデル.html#asymmetric-power-arch-モデル" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Tsay 4.11, pp.224–225</li>
</ul>
<div class="sourceCode" id="cb615"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb615-1"><a href="garchモデル.html#cb615-1" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> fGarch<span class="sc">::</span><span class="fu">garchFit</span>(<span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> <span class="fu">aparch</span>(<span class="dv">1</span>, <span class="dv">1</span>), <span class="at">data =</span> eu, <span class="at">trace =</span> F)</span>
<span id="cb615-2"><a href="garchモデル.html#cb615-2" tabindex="-1"></a><span class="fu">summary</span>(m1)</span>
<span id="cb615-3"><a href="garchモデル.html#cb615-3" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb615-4"><a href="garchモデル.html#cb615-4" tabindex="-1"></a><span class="do">## Title:</span></span>
<span id="cb615-5"><a href="garchモデル.html#cb615-5" tabindex="-1"></a><span class="do">##  GARCH Modelling </span></span>
<span id="cb615-6"><a href="garchモデル.html#cb615-6" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb615-7"><a href="garchモデル.html#cb615-7" tabindex="-1"></a><span class="do">## Call:</span></span>
<span id="cb615-8"><a href="garchモデル.html#cb615-8" tabindex="-1"></a><span class="do">##  fGarch::garchFit(formula = ~1 + aparch(1, 1), data = eu, trace = F) </span></span>
<span id="cb615-9"><a href="garchモデル.html#cb615-9" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb615-10"><a href="garchモデル.html#cb615-10" tabindex="-1"></a><span class="do">## Mean and Variance Equation:</span></span>
<span id="cb615-11"><a href="garchモデル.html#cb615-11" tabindex="-1"></a><span class="do">##  data ~ 1 + aparch(1, 1)</span></span>
<span id="cb615-12"><a href="garchモデル.html#cb615-12" tabindex="-1"></a><span class="do">## &lt;environment: 0x7fb403cb1e10&gt;</span></span>
<span id="cb615-13"><a href="garchモデル.html#cb615-13" tabindex="-1"></a><span class="do">##  [data = eu]</span></span>
<span id="cb615-14"><a href="garchモデル.html#cb615-14" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb615-15"><a href="garchモデル.html#cb615-15" tabindex="-1"></a><span class="do">## Conditional Distribution:</span></span>
<span id="cb615-16"><a href="garchモデル.html#cb615-16" tabindex="-1"></a><span class="do">##  norm </span></span>
<span id="cb615-17"><a href="garchモデル.html#cb615-17" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb615-18"><a href="garchモデル.html#cb615-18" tabindex="-1"></a><span class="do">## Coefficient(s):</span></span>
<span id="cb615-19"><a href="garchモデル.html#cb615-19" tabindex="-1"></a><span class="do">##        mu      omega     alpha1     gamma1      beta1      delta  </span></span>
<span id="cb615-20"><a href="garchモデル.html#cb615-20" tabindex="-1"></a><span class="do">## 0.0127648  0.0015919  0.0313679  0.1135340  0.9689156  1.6743133  </span></span>
<span id="cb615-21"><a href="garchモデル.html#cb615-21" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb615-22"><a href="garchモデル.html#cb615-22" tabindex="-1"></a><span class="do">## Std. Errors:</span></span>
<span id="cb615-23"><a href="garchモデル.html#cb615-23" tabindex="-1"></a><span class="do">##  based on Hessian </span></span>
<span id="cb615-24"><a href="garchモデル.html#cb615-24" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb615-25"><a href="garchモデル.html#cb615-25" tabindex="-1"></a><span class="do">## Error Analysis:</span></span>
<span id="cb615-26"><a href="garchモデル.html#cb615-26" tabindex="-1"></a><span class="do">##         Estimate  Std. Error  t value Pr(&gt;|t|)    </span></span>
<span id="cb615-27"><a href="garchモデル.html#cb615-27" tabindex="-1"></a><span class="do">## mu     0.0127648   0.0107626    1.186   0.2356    </span></span>
<span id="cb615-28"><a href="garchモデル.html#cb615-28" tabindex="-1"></a><span class="do">## omega  0.0015919   0.0007226    2.203   0.0276 *  </span></span>
<span id="cb615-29"><a href="garchモデル.html#cb615-29" tabindex="-1"></a><span class="do">## alpha1 0.0313679   0.0053350    5.880 4.11e-09 ***</span></span>
<span id="cb615-30"><a href="garchモデル.html#cb615-30" tabindex="-1"></a><span class="do">## gamma1 0.1135340   0.0711910    1.595   0.1108    </span></span>
<span id="cb615-31"><a href="garchモデル.html#cb615-31" tabindex="-1"></a><span class="do">## beta1  0.9689156   0.0038405  252.292  &lt; 2e-16 ***</span></span>
<span id="cb615-32"><a href="garchモデル.html#cb615-32" tabindex="-1"></a><span class="do">## delta  1.6743133   0.4057134    4.127 3.68e-05 ***</span></span>
<span id="cb615-33"><a href="garchモデル.html#cb615-33" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb615-34"><a href="garchモデル.html#cb615-34" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb615-35"><a href="garchモデル.html#cb615-35" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb615-36"><a href="garchモデル.html#cb615-36" tabindex="-1"></a><span class="do">## Log Likelihood:</span></span>
<span id="cb615-37"><a href="garchモデル.html#cb615-37" tabindex="-1"></a><span class="do">##  -2731.172    normalized:  -0.9324587 </span></span>
<span id="cb615-38"><a href="garchモデル.html#cb615-38" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb615-39"><a href="garchモデル.html#cb615-39" tabindex="-1"></a><span class="do">## Description:</span></span>
<span id="cb615-40"><a href="garchモデル.html#cb615-40" tabindex="-1"></a><span class="do">##  Sun Feb  2 15:36:32 2025 by user:  </span></span>
<span id="cb615-41"><a href="garchモデル.html#cb615-41" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb615-42"><a href="garchモデル.html#cb615-42" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb615-43"><a href="garchモデル.html#cb615-43" tabindex="-1"></a><span class="do">## Standardised Residuals Tests:</span></span>
<span id="cb615-44"><a href="garchモデル.html#cb615-44" tabindex="-1"></a><span class="do">##                                  Statistic      p-Value</span></span>
<span id="cb615-45"><a href="garchモデル.html#cb615-45" tabindex="-1"></a><span class="do">##  Jarque-Bera Test   R    Chi^2  50.2052325 1.253353e-11</span></span>
<span id="cb615-46"><a href="garchモデル.html#cb615-46" tabindex="-1"></a><span class="do">##  Shapiro-Wilk Test  R    W       0.9956711 1.608396e-07</span></span>
<span id="cb615-47"><a href="garchモデル.html#cb615-47" tabindex="-1"></a><span class="do">##  Ljung-Box Test     R    Q(10)  13.3768866 2.033562e-01</span></span>
<span id="cb615-48"><a href="garchモデル.html#cb615-48" tabindex="-1"></a><span class="do">##  Ljung-Box Test     R    Q(15)  20.1963422 1.645295e-01</span></span>
<span id="cb615-49"><a href="garchモデル.html#cb615-49" tabindex="-1"></a><span class="do">##  Ljung-Box Test     R    Q(20)  22.8473601 2.963515e-01</span></span>
<span id="cb615-50"><a href="garchモデル.html#cb615-50" tabindex="-1"></a><span class="do">##  Ljung-Box Test     R^2  Q(10)  13.1560992 2.150747e-01</span></span>
<span id="cb615-51"><a href="garchモデル.html#cb615-51" tabindex="-1"></a><span class="do">##  Ljung-Box Test     R^2  Q(15)  16.5800767 3.445805e-01</span></span>
<span id="cb615-52"><a href="garchモデル.html#cb615-52" tabindex="-1"></a><span class="do">##  Ljung-Box Test     R^2  Q(20)  27.4488519 1.231016e-01</span></span>
<span id="cb615-53"><a href="garchモデル.html#cb615-53" tabindex="-1"></a><span class="do">##  LM Arch Test       R    TR^2   14.3573756 2.784714e-01</span></span>
<span id="cb615-54"><a href="garchモデル.html#cb615-54" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb615-55"><a href="garchモデル.html#cb615-55" tabindex="-1"></a><span class="do">## Information Criterion Statistics:</span></span>
<span id="cb615-56"><a href="garchモデル.html#cb615-56" tabindex="-1"></a><span class="do">##      AIC      BIC      SIC     HQIC </span></span>
<span id="cb615-57"><a href="garchモデル.html#cb615-57" tabindex="-1"></a><span class="do">## 1.869014 1.881269 1.869006 1.873428</span></span>
<span id="cb615-58"><a href="garchモデル.html#cb615-58" tabindex="-1"></a>m1</span>
<span id="cb615-59"><a href="garchモデル.html#cb615-59" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb615-60"><a href="garchモデル.html#cb615-60" tabindex="-1"></a><span class="do">## Title:</span></span>
<span id="cb615-61"><a href="garchモデル.html#cb615-61" tabindex="-1"></a><span class="do">##  GARCH Modelling </span></span>
<span id="cb615-62"><a href="garchモデル.html#cb615-62" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb615-63"><a href="garchモデル.html#cb615-63" tabindex="-1"></a><span class="do">## Call:</span></span>
<span id="cb615-64"><a href="garchモデル.html#cb615-64" tabindex="-1"></a><span class="do">##  fGarch::garchFit(formula = ~1 + aparch(1, 1), data = eu, trace = F) </span></span>
<span id="cb615-65"><a href="garchモデル.html#cb615-65" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb615-66"><a href="garchモデル.html#cb615-66" tabindex="-1"></a><span class="do">## Mean and Variance Equation:</span></span>
<span id="cb615-67"><a href="garchモデル.html#cb615-67" tabindex="-1"></a><span class="do">##  data ~ 1 + aparch(1, 1)</span></span>
<span id="cb615-68"><a href="garchモデル.html#cb615-68" tabindex="-1"></a><span class="do">## &lt;environment: 0x7fb403cb1e10&gt;</span></span>
<span id="cb615-69"><a href="garchモデル.html#cb615-69" tabindex="-1"></a><span class="do">##  [data = eu]</span></span>
<span id="cb615-70"><a href="garchモデル.html#cb615-70" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb615-71"><a href="garchモデル.html#cb615-71" tabindex="-1"></a><span class="do">## Conditional Distribution:</span></span>
<span id="cb615-72"><a href="garchモデル.html#cb615-72" tabindex="-1"></a><span class="do">##  norm </span></span>
<span id="cb615-73"><a href="garchモデル.html#cb615-73" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb615-74"><a href="garchモデル.html#cb615-74" tabindex="-1"></a><span class="do">## Coefficient(s):</span></span>
<span id="cb615-75"><a href="garchモデル.html#cb615-75" tabindex="-1"></a><span class="do">##        mu      omega     alpha1     gamma1      beta1      delta  </span></span>
<span id="cb615-76"><a href="garchモデル.html#cb615-76" tabindex="-1"></a><span class="do">## 0.0127648  0.0015919  0.0313679  0.1135340  0.9689156  1.6743133  </span></span>
<span id="cb615-77"><a href="garchモデル.html#cb615-77" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb615-78"><a href="garchモデル.html#cb615-78" tabindex="-1"></a><span class="do">## Std. Errors:</span></span>
<span id="cb615-79"><a href="garchモデル.html#cb615-79" tabindex="-1"></a><span class="do">##  based on Hessian </span></span>
<span id="cb615-80"><a href="garchモデル.html#cb615-80" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb615-81"><a href="garchモデル.html#cb615-81" tabindex="-1"></a><span class="do">## Error Analysis:</span></span>
<span id="cb615-82"><a href="garchモデル.html#cb615-82" tabindex="-1"></a><span class="do">##         Estimate  Std. Error  t value Pr(&gt;|t|)    </span></span>
<span id="cb615-83"><a href="garchモデル.html#cb615-83" tabindex="-1"></a><span class="do">## mu     0.0127648   0.0107626    1.186   0.2356    </span></span>
<span id="cb615-84"><a href="garchモデル.html#cb615-84" tabindex="-1"></a><span class="do">## omega  0.0015919   0.0007226    2.203   0.0276 *  </span></span>
<span id="cb615-85"><a href="garchモデル.html#cb615-85" tabindex="-1"></a><span class="do">## alpha1 0.0313679   0.0053350    5.880 4.11e-09 ***</span></span>
<span id="cb615-86"><a href="garchモデル.html#cb615-86" tabindex="-1"></a><span class="do">## gamma1 0.1135340   0.0711910    1.595   0.1108    </span></span>
<span id="cb615-87"><a href="garchモデル.html#cb615-87" tabindex="-1"></a><span class="do">## beta1  0.9689156   0.0038405  252.292  &lt; 2e-16 ***</span></span>
<span id="cb615-88"><a href="garchモデル.html#cb615-88" tabindex="-1"></a><span class="do">## delta  1.6743133   0.4057134    4.127 3.68e-05 ***</span></span>
<span id="cb615-89"><a href="garchモデル.html#cb615-89" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb615-90"><a href="garchモデル.html#cb615-90" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb615-91"><a href="garchモデル.html#cb615-91" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb615-92"><a href="garchモデル.html#cb615-92" tabindex="-1"></a><span class="do">## Log Likelihood:</span></span>
<span id="cb615-93"><a href="garchモデル.html#cb615-93" tabindex="-1"></a><span class="do">##  -2731.172    normalized:  -0.9324587 </span></span>
<span id="cb615-94"><a href="garchモデル.html#cb615-94" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb615-95"><a href="garchモデル.html#cb615-95" tabindex="-1"></a><span class="do">## Description:</span></span>
<span id="cb615-96"><a href="garchモデル.html#cb615-96" tabindex="-1"></a><span class="do">##  Sun Feb  2 15:36:32 2025 by user:</span></span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Estimate</th>
<th align="right">Std. Error</th>
<th align="right">t value</th>
<th align="right">Pr(&gt;|t|)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">mu</td>
<td align="right">0.0127648</td>
<td align="right">0.0107626</td>
<td align="right">1.186040</td>
<td align="right">0.2356064</td>
</tr>
<tr class="even">
<td align="left">omega</td>
<td align="right">0.0015919</td>
<td align="right">0.0007226</td>
<td align="right">2.203005</td>
<td align="right">0.0275944</td>
</tr>
<tr class="odd">
<td align="left">alpha1</td>
<td align="right">0.0313679</td>
<td align="right">0.0053350</td>
<td align="right">5.879659</td>
<td align="right">0.0000000</td>
</tr>
<tr class="even">
<td align="left">gamma1</td>
<td align="right">0.1135340</td>
<td align="right">0.0711910</td>
<td align="right">1.594779</td>
<td align="right">0.1107618</td>
</tr>
<tr class="odd">
<td align="left">beta1</td>
<td align="right">0.9689156</td>
<td align="right">0.0038405</td>
<td align="right">252.291949</td>
<td align="right">0.0000000</td>
</tr>
<tr class="even">
<td align="left">delta</td>
<td align="right">1.6743133</td>
<td align="right">0.4057134</td>
<td align="right">4.126837</td>
<td align="right">0.0000368</td>
</tr>
</tbody>
</table>
<ul>
<li>–&gt; モデル診断, データに良く適合.</li>
<li>delta = 1.67の解釈難.</li>
<li>–&gt; delta = 2とは、有意に乖離していない(標準誤差0.406)</li>
<li>–&gt; delta = 2 (TGARCH(1, 1))でも良い?</li>
</ul>
<div class="sourceCode" id="cb616"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb616-1"><a href="garchモデル.html#cb616-1" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> fGarch<span class="sc">::</span><span class="fu">garchFit</span>(<span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> <span class="fu">aparch</span>(<span class="dv">1</span>, <span class="dv">1</span>), <span class="at">data =</span> eu, <span class="at">delta =</span> <span class="dv">2</span>, <span class="at">include.delta =</span> F, <span class="at">trace =</span> F)</span>
<span id="cb616-2"><a href="garchモデル.html#cb616-2" tabindex="-1"></a><span class="fu">summary</span>(m2)</span>
<span id="cb616-3"><a href="garchモデル.html#cb616-3" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb616-4"><a href="garchモデル.html#cb616-4" tabindex="-1"></a><span class="do">## Title:</span></span>
<span id="cb616-5"><a href="garchモデル.html#cb616-5" tabindex="-1"></a><span class="do">##  GARCH Modelling </span></span>
<span id="cb616-6"><a href="garchモデル.html#cb616-6" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb616-7"><a href="garchモデル.html#cb616-7" tabindex="-1"></a><span class="do">## Call:</span></span>
<span id="cb616-8"><a href="garchモデル.html#cb616-8" tabindex="-1"></a><span class="do">##  fGarch::garchFit(formula = ~1 + aparch(1, 1), data = eu, delta = 2, </span></span>
<span id="cb616-9"><a href="garchモデル.html#cb616-9" tabindex="-1"></a><span class="do">##     include.delta = F, trace = F) </span></span>
<span id="cb616-10"><a href="garchモデル.html#cb616-10" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb616-11"><a href="garchモデル.html#cb616-11" tabindex="-1"></a><span class="do">## Mean and Variance Equation:</span></span>
<span id="cb616-12"><a href="garchモデル.html#cb616-12" tabindex="-1"></a><span class="do">##  data ~ 1 + aparch(1, 1)</span></span>
<span id="cb616-13"><a href="garchモデル.html#cb616-13" tabindex="-1"></a><span class="do">## &lt;environment: 0x7fb403b404e8&gt;</span></span>
<span id="cb616-14"><a href="garchモデル.html#cb616-14" tabindex="-1"></a><span class="do">##  [data = eu]</span></span>
<span id="cb616-15"><a href="garchモデル.html#cb616-15" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb616-16"><a href="garchモデル.html#cb616-16" tabindex="-1"></a><span class="do">## Conditional Distribution:</span></span>
<span id="cb616-17"><a href="garchモデル.html#cb616-17" tabindex="-1"></a><span class="do">##  norm </span></span>
<span id="cb616-18"><a href="garchモデル.html#cb616-18" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb616-19"><a href="garchモデル.html#cb616-19" tabindex="-1"></a><span class="do">## Coefficient(s):</span></span>
<span id="cb616-20"><a href="garchモデル.html#cb616-20" tabindex="-1"></a><span class="do">##        mu      omega     alpha1     gamma1      beta1  </span></span>
<span id="cb616-21"><a href="garchモデル.html#cb616-21" tabindex="-1"></a><span class="do">## 0.0122646  0.0012745  0.0282723  0.1100243  0.9687115  </span></span>
<span id="cb616-22"><a href="garchモデル.html#cb616-22" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb616-23"><a href="garchモデル.html#cb616-23" tabindex="-1"></a><span class="do">## Std. Errors:</span></span>
<span id="cb616-24"><a href="garchモデル.html#cb616-24" tabindex="-1"></a><span class="do">##  based on Hessian </span></span>
<span id="cb616-25"><a href="garchモデル.html#cb616-25" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb616-26"><a href="garchモデル.html#cb616-26" tabindex="-1"></a><span class="do">## Error Analysis:</span></span>
<span id="cb616-27"><a href="garchモデル.html#cb616-27" tabindex="-1"></a><span class="do">##         Estimate  Std. Error  t value Pr(&gt;|t|)    </span></span>
<span id="cb616-28"><a href="garchモデル.html#cb616-28" tabindex="-1"></a><span class="do">## mu     0.0122646   0.0107289    1.143   0.2530    </span></span>
<span id="cb616-29"><a href="garchモデル.html#cb616-29" tabindex="-1"></a><span class="do">## omega  0.0012745   0.0005752    2.216   0.0267 *  </span></span>
<span id="cb616-30"><a href="garchモデル.html#cb616-30" tabindex="-1"></a><span class="do">## alpha1 0.0282723   0.0038637    7.317 2.53e-13 ***</span></span>
<span id="cb616-31"><a href="garchモデル.html#cb616-31" tabindex="-1"></a><span class="do">## gamma1 0.1100243   0.0649051    1.695   0.0900 .  </span></span>
<span id="cb616-32"><a href="garchモデル.html#cb616-32" tabindex="-1"></a><span class="do">## beta1  0.9687115   0.0039421  245.735  &lt; 2e-16 ***</span></span>
<span id="cb616-33"><a href="garchモデル.html#cb616-33" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb616-34"><a href="garchモデル.html#cb616-34" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb616-35"><a href="garchモデル.html#cb616-35" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb616-36"><a href="garchモデル.html#cb616-36" tabindex="-1"></a><span class="do">## Log Likelihood:</span></span>
<span id="cb616-37"><a href="garchモデル.html#cb616-37" tabindex="-1"></a><span class="do">##  -2731.85    normalized:  -0.9326902 </span></span>
<span id="cb616-38"><a href="garchモデル.html#cb616-38" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb616-39"><a href="garchモデル.html#cb616-39" tabindex="-1"></a><span class="do">## Description:</span></span>
<span id="cb616-40"><a href="garchモデル.html#cb616-40" tabindex="-1"></a><span class="do">##  Sun Feb  2 15:36:32 2025 by user:  </span></span>
<span id="cb616-41"><a href="garchモデル.html#cb616-41" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb616-42"><a href="garchモデル.html#cb616-42" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb616-43"><a href="garchモデル.html#cb616-43" tabindex="-1"></a><span class="do">## Standardised Residuals Tests:</span></span>
<span id="cb616-44"><a href="garchモデル.html#cb616-44" tabindex="-1"></a><span class="do">##                                  Statistic      p-Value</span></span>
<span id="cb616-45"><a href="garchモデル.html#cb616-45" tabindex="-1"></a><span class="do">##  Jarque-Bera Test   R    Chi^2  49.9767578 1.405032e-11</span></span>
<span id="cb616-46"><a href="garchモデル.html#cb616-46" tabindex="-1"></a><span class="do">##  Shapiro-Wilk Test  R    W       0.9956803 1.655882e-07</span></span>
<span id="cb616-47"><a href="garchモデル.html#cb616-47" tabindex="-1"></a><span class="do">##  Ljung-Box Test     R    Q(10)  13.3828472 2.030469e-01</span></span>
<span id="cb616-48"><a href="garchモデル.html#cb616-48" tabindex="-1"></a><span class="do">##  Ljung-Box Test     R    Q(15)  20.2983334 1.607845e-01</span></span>
<span id="cb616-49"><a href="garchモデル.html#cb616-49" tabindex="-1"></a><span class="do">##  Ljung-Box Test     R    Q(20)  22.8726510 2.950908e-01</span></span>
<span id="cb616-50"><a href="garchモデル.html#cb616-50" tabindex="-1"></a><span class="do">##  Ljung-Box Test     R^2  Q(10)  12.8958521 2.295533e-01</span></span>
<span id="cb616-51"><a href="garchモデル.html#cb616-51" tabindex="-1"></a><span class="do">##  Ljung-Box Test     R^2  Q(15)  16.5528786 3.462878e-01</span></span>
<span id="cb616-52"><a href="garchモデル.html#cb616-52" tabindex="-1"></a><span class="do">##  Ljung-Box Test     R^2  Q(20)  27.2403595 1.286361e-01</span></span>
<span id="cb616-53"><a href="garchモデル.html#cb616-53" tabindex="-1"></a><span class="do">##  LM Arch Test       R    TR^2   14.2966096 2.821698e-01</span></span>
<span id="cb616-54"><a href="garchモデル.html#cb616-54" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb616-55"><a href="garchモデル.html#cb616-55" tabindex="-1"></a><span class="do">## Information Criterion Statistics:</span></span>
<span id="cb616-56"><a href="garchモデル.html#cb616-56" tabindex="-1"></a><span class="do">##      AIC      BIC      SIC     HQIC </span></span>
<span id="cb616-57"><a href="garchモデル.html#cb616-57" tabindex="-1"></a><span class="do">## 1.868795 1.879007 1.868789 1.872472</span></span>
<span id="cb616-58"><a href="garchモデル.html#cb616-58" tabindex="-1"></a><span class="fu">plot</span>(m2, <span class="at">which =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">13</span>)</span></code></pre></div>
<p><img src="074-GARCH-3_files/figure-html/APARCH_2-1.png" width="75%" /><img src="074-GARCH-3_files/figure-html/APARCH_2-2.png" width="75%" /><img src="074-GARCH-3_files/figure-html/APARCH_2-3.png" width="75%" /><img src="074-GARCH-3_files/figure-html/APARCH_2-4.png" width="75%" /><img src="074-GARCH-3_files/figure-html/APARCH_2-5.png" width="75%" /><img src="074-GARCH-3_files/figure-html/APARCH_2-6.png" width="75%" /><img src="074-GARCH-3_files/figure-html/APARCH_2-7.png" width="75%" /><img src="074-GARCH-3_files/figure-html/APARCH_2-8.png" width="75%" /><img src="074-GARCH-3_files/figure-html/APARCH_2-9.png" width="75%" /><img src="074-GARCH-3_files/figure-html/APARCH_2-10.png" width="75%" /><img src="074-GARCH-3_files/figure-html/APARCH_2-11.png" width="75%" /><img src="074-GARCH-3_files/figure-html/APARCH_2-12.png" width="75%" /><img src="074-GARCH-3_files/figure-html/APARCH_2-13.png" width="75%" /></p>
<div class="sourceCode" id="cb617"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb617-1"><a href="garchモデル.html#cb617-1" tabindex="-1"></a>m2</span>
<span id="cb617-2"><a href="garchモデル.html#cb617-2" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb617-3"><a href="garchモデル.html#cb617-3" tabindex="-1"></a><span class="do">## Title:</span></span>
<span id="cb617-4"><a href="garchモデル.html#cb617-4" tabindex="-1"></a><span class="do">##  GARCH Modelling </span></span>
<span id="cb617-5"><a href="garchモデル.html#cb617-5" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb617-6"><a href="garchモデル.html#cb617-6" tabindex="-1"></a><span class="do">## Call:</span></span>
<span id="cb617-7"><a href="garchモデル.html#cb617-7" tabindex="-1"></a><span class="do">##  fGarch::garchFit(formula = ~1 + aparch(1, 1), data = eu, delta = 2, </span></span>
<span id="cb617-8"><a href="garchモデル.html#cb617-8" tabindex="-1"></a><span class="do">##     include.delta = F, trace = F) </span></span>
<span id="cb617-9"><a href="garchモデル.html#cb617-9" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb617-10"><a href="garchモデル.html#cb617-10" tabindex="-1"></a><span class="do">## Mean and Variance Equation:</span></span>
<span id="cb617-11"><a href="garchモデル.html#cb617-11" tabindex="-1"></a><span class="do">##  data ~ 1 + aparch(1, 1)</span></span>
<span id="cb617-12"><a href="garchモデル.html#cb617-12" tabindex="-1"></a><span class="do">## &lt;environment: 0x7fb403b404e8&gt;</span></span>
<span id="cb617-13"><a href="garchモデル.html#cb617-13" tabindex="-1"></a><span class="do">##  [data = eu]</span></span>
<span id="cb617-14"><a href="garchモデル.html#cb617-14" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb617-15"><a href="garchモデル.html#cb617-15" tabindex="-1"></a><span class="do">## Conditional Distribution:</span></span>
<span id="cb617-16"><a href="garchモデル.html#cb617-16" tabindex="-1"></a><span class="do">##  norm </span></span>
<span id="cb617-17"><a href="garchモデル.html#cb617-17" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb617-18"><a href="garchモデル.html#cb617-18" tabindex="-1"></a><span class="do">## Coefficient(s):</span></span>
<span id="cb617-19"><a href="garchモデル.html#cb617-19" tabindex="-1"></a><span class="do">##        mu      omega     alpha1     gamma1      beta1  </span></span>
<span id="cb617-20"><a href="garchモデル.html#cb617-20" tabindex="-1"></a><span class="do">## 0.0122646  0.0012745  0.0282723  0.1100243  0.9687115  </span></span>
<span id="cb617-21"><a href="garchモデル.html#cb617-21" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb617-22"><a href="garchモデル.html#cb617-22" tabindex="-1"></a><span class="do">## Std. Errors:</span></span>
<span id="cb617-23"><a href="garchモデル.html#cb617-23" tabindex="-1"></a><span class="do">##  based on Hessian </span></span>
<span id="cb617-24"><a href="garchモデル.html#cb617-24" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb617-25"><a href="garchモデル.html#cb617-25" tabindex="-1"></a><span class="do">## Error Analysis:</span></span>
<span id="cb617-26"><a href="garchモデル.html#cb617-26" tabindex="-1"></a><span class="do">##         Estimate  Std. Error  t value Pr(&gt;|t|)    </span></span>
<span id="cb617-27"><a href="garchモデル.html#cb617-27" tabindex="-1"></a><span class="do">## mu     0.0122646   0.0107289    1.143   0.2530    </span></span>
<span id="cb617-28"><a href="garchモデル.html#cb617-28" tabindex="-1"></a><span class="do">## omega  0.0012745   0.0005752    2.216   0.0267 *  </span></span>
<span id="cb617-29"><a href="garchモデル.html#cb617-29" tabindex="-1"></a><span class="do">## alpha1 0.0282723   0.0038637    7.317 2.53e-13 ***</span></span>
<span id="cb617-30"><a href="garchモデル.html#cb617-30" tabindex="-1"></a><span class="do">## gamma1 0.1100243   0.0649051    1.695   0.0900 .  </span></span>
<span id="cb617-31"><a href="garchモデル.html#cb617-31" tabindex="-1"></a><span class="do">## beta1  0.9687115   0.0039421  245.735  &lt; 2e-16 ***</span></span>
<span id="cb617-32"><a href="garchモデル.html#cb617-32" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb617-33"><a href="garchモデル.html#cb617-33" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb617-34"><a href="garchモデル.html#cb617-34" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb617-35"><a href="garchモデル.html#cb617-35" tabindex="-1"></a><span class="do">## Log Likelihood:</span></span>
<span id="cb617-36"><a href="garchモデル.html#cb617-36" tabindex="-1"></a><span class="do">##  -2731.85    normalized:  -0.9326902 </span></span>
<span id="cb617-37"><a href="garchモデル.html#cb617-37" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb617-38"><a href="garchモデル.html#cb617-38" tabindex="-1"></a><span class="do">## Description:</span></span>
<span id="cb617-39"><a href="garchモデル.html#cb617-39" tabindex="-1"></a><span class="do">##  Sun Feb  2 15:36:32 2025 by user:</span></span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Estimate</th>
<th align="right">Std. Error</th>
<th align="right">t value</th>
<th align="right">Pr(&gt;|t|)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">mu</td>
<td align="right">0.0122646</td>
<td align="right">0.0107289</td>
<td align="right">1.143135</td>
<td align="right">0.2529826</td>
</tr>
<tr class="even">
<td align="left">omega</td>
<td align="right">0.0012745</td>
<td align="right">0.0005752</td>
<td align="right">2.215693</td>
<td align="right">0.0267125</td>
</tr>
<tr class="odd">
<td align="left">alpha1</td>
<td align="right">0.0282723</td>
<td align="right">0.0038637</td>
<td align="right">7.317482</td>
<td align="right">0.0000000</td>
</tr>
<tr class="even">
<td align="left">gamma1</td>
<td align="right">0.1100243</td>
<td align="right">0.0649051</td>
<td align="right">1.695156</td>
<td align="right">0.0900458</td>
</tr>
<tr class="odd">
<td align="left">beta1</td>
<td align="right">0.9687115</td>
<td align="right">0.0039421</td>
<td align="right">245.735451</td>
<td align="right">0.0000000</td>
</tr>
</tbody>
</table>
<ul>
<li>–&gt; m1と結果類似</li>
</ul>
</div>
<div id="nonsymmetric-garch-モデル" class="section level3 unnumbered hasAnchor">
<h3>Nonsymmetric GARCH モデル<a href="garchモデル.html#nonsymmetric-garch-モデル" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Tsay 4.12, pp.227–228</li>
</ul>
<pre><code>Ngarch(): Estimation of a non-symmertic GARCH, NGARCH(1, 1), model.
- Assume normal innovations
- Ngarch(rtn)</code></pre>
<div class="sourceCode" id="cb619"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb619-1"><a href="garchモデル.html#cb619-1" tabindex="-1"></a>da <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">&quot;d-useu9910.txt&quot;</span>, <span class="at">header =</span> T)</span>
<span id="cb619-2"><a href="garchモデル.html#cb619-2" tabindex="-1"></a>fx <span class="ot">&lt;-</span> <span class="fu">log</span>(da<span class="sc">$</span>rate)</span>
<span id="cb619-3"><a href="garchモデル.html#cb619-3" tabindex="-1"></a>eu <span class="ot">&lt;-</span> <span class="fu">diff</span>(fx) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb619-4"><a href="garchモデル.html#cb619-4" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb619-5"><a href="garchモデル.html#cb619-5" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;Ngarch.R&quot;</span>)</span>
<span id="cb619-6"><a href="garchモデル.html#cb619-6" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">Ngarch</span>(eu)</span>
<span id="cb619-7"><a href="garchモデル.html#cb619-7" tabindex="-1"></a><span class="do">##   </span></span>
<span id="cb619-8"><a href="garchモデル.html#cb619-8" tabindex="-1"></a><span class="do">## Estimation results of NGARCH(1,1) model: </span></span>
<span id="cb619-9"><a href="garchモデル.html#cb619-9" tabindex="-1"></a><span class="do">## estimates:  -0.001094043 0.002366721 0.9618047 0.02118565 0.7309616 </span></span>
<span id="cb619-10"><a href="garchモデル.html#cb619-10" tabindex="-1"></a><span class="do">## std.errors:  0.01080893 0.000580552 0.006045803 0.003604727 0.2501548 </span></span>
<span id="cb619-11"><a href="garchモデル.html#cb619-11" tabindex="-1"></a><span class="do">## t-ratio:  -0.1012166 4.076674 159.0863 5.877186 2.922037</span></span>
<span id="cb619-12"><a href="garchモデル.html#cb619-12" tabindex="-1"></a>res <span class="ot">&lt;-</span> m1<span class="sc">$</span>residuals</span>
<span id="cb619-13"><a href="garchモデル.html#cb619-13" tabindex="-1"></a>vol <span class="ot">&lt;-</span> m1<span class="sc">$</span>volatility</span>
<span id="cb619-14"><a href="garchモデル.html#cb619-14" tabindex="-1"></a>resi <span class="ot">&lt;-</span> res <span class="sc">/</span> vol</span>
<span id="cb619-15"><a href="garchモデル.html#cb619-15" tabindex="-1"></a><span class="fu">Box.test</span>(resi, <span class="at">lag =</span> <span class="dv">10</span>, <span class="at">type =</span> <span class="st">&#39;Ljung&#39;</span>)</span>
<span id="cb619-16"><a href="garchモデル.html#cb619-16" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb619-17"><a href="garchモデル.html#cb619-17" tabindex="-1"></a><span class="do">##  Box-Ljung test</span></span>
<span id="cb619-18"><a href="garchモデル.html#cb619-18" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb619-19"><a href="garchモデル.html#cb619-19" tabindex="-1"></a><span class="do">## data:  resi</span></span>
<span id="cb619-20"><a href="garchモデル.html#cb619-20" tabindex="-1"></a><span class="do">## X-squared = 14.776, df = 10, p-value = 0.1404</span></span>
<span id="cb619-21"><a href="garchモデル.html#cb619-21" tabindex="-1"></a><span class="fu">Box.test</span>(resi<span class="sc">^</span><span class="dv">2</span>, <span class="at">lag =</span> <span class="dv">10</span>, <span class="at">type =</span> <span class="st">&#39;Ljung&#39;</span>)</span>
<span id="cb619-22"><a href="garchモデル.html#cb619-22" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb619-23"><a href="garchモデル.html#cb619-23" tabindex="-1"></a><span class="do">##  Box-Ljung test</span></span>
<span id="cb619-24"><a href="garchモデル.html#cb619-24" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb619-25"><a href="garchモデル.html#cb619-25" tabindex="-1"></a><span class="do">## data:  resi^2</span></span>
<span id="cb619-26"><a href="garchモデル.html#cb619-26" tabindex="-1"></a><span class="do">## X-squared = 12.943, df = 10, p-value = 0.2269</span></span>
<span id="cb619-27"><a href="garchモデル.html#cb619-27" tabindex="-1"></a><span class="co"># Estimation results of NGARCH(1, 1) model:</span></span>
<span id="cb619-28"><a href="garchモデル.html#cb619-28" tabindex="-1"></a><span class="co"># estimates: -0.001094043 0.002366721 0.9618047 0.02118565 0.7309616</span></span>
<span id="cb619-29"><a href="garchモデル.html#cb619-29" tabindex="-1"></a><span class="co"># std.errors: 0.01080893 0.000580552 0.006045803 0.003604727 0.2501548</span></span>
<span id="cb619-30"><a href="garchモデル.html#cb619-30" tabindex="-1"></a><span class="co"># t-ratio: -0.1012166 4.076674 159.0863 5.877186 2.922037</span></span>
<span id="cb619-31"><a href="garchモデル.html#cb619-31" tabindex="-1"></a><span class="co"># &lt;-- mu, beta0, beta1, beta2, thetaの順</span></span></code></pre></div>
<ul>
<li>–&gt; muを除いて(5%)有意
<ul>
<li>特に, レバレッジ効果(theta), t=2.92で(5%)有意</li>
<li>–&gt; 上記TGARCH(1, 1)の結果と同様</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb620"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb620-1"><a href="garchモデル.html#cb620-1" tabindex="-1"></a><span class="co"># 追加</span></span>
<span id="cb620-2"><a href="garchモデル.html#cb620-2" tabindex="-1"></a><span class="fu">plot</span>(vol, <span class="at">xlab =</span> <span class="st">&#39;year&#39;</span>, <span class="at">ylab =</span> <span class="st">&#39;volatility&#39;</span>, <span class="at">type =</span> <span class="st">&#39;l&#39;</span>)</span></code></pre></div>
<p><img src="074-GARCH-3_files/figure-html/unnamed-chunk-23-1.png" width="75%" /></p>
<div class="sourceCode" id="cb621"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb621-1"><a href="garchモデル.html#cb621-1" tabindex="-1"></a><span class="fu">plot</span>(resi, <span class="at">xlab =</span> <span class="st">&#39;year&#39;</span>, <span class="at">ylab =</span> <span class="st">&#39;residuals&#39;</span>, <span class="at">type =</span> <span class="st">&#39;l&#39;</span>)</span></code></pre></div>
<p><img src="074-GARCH-3_files/figure-html/unnamed-chunk-23-2.png" width="75%" /></p>
<ul>
<li>→ 両モデルは, 類似のvolatility推定値</li>
</ul>
</div>
<div id="代替的アプリーチ間の比較" class="section level3 unnumbered hasAnchor">
<h3>代替的アプリーチ間の比較<a href="garchモデル.html#代替的アプリーチ間の比較" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Tsay 4.15.1, pp.234–235</li>
</ul>
<div id="日次データから月次ボラティリティの推定" class="section level4 unnumbered hasAnchor">
<h4>(日次データから)月次ボラティリティの推定<a href="garchモデル.html#日次データから月次ボラティリティの推定" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li>“ルートT・ルール”の適用</li>
</ul>
<div class="sourceCode" id="cb622"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb622-1"><a href="garchモデル.html#cb622-1" tabindex="-1"></a>da <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">&quot;d-sp58010.txt&quot;</span>, <span class="at">header =</span> T)</span>
<span id="cb622-2"><a href="garchモデル.html#cb622-2" tabindex="-1"></a>x <span class="ot">&lt;-</span> da[, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="dv">9</span>)]</span>
<span id="cb622-3"><a href="garchモデル.html#cb622-3" tabindex="-1"></a><span class="fu">dim</span>(x)</span>
<span id="cb622-4"><a href="garchモデル.html#cb622-4" tabindex="-1"></a><span class="do">## [1] 7737    4</span></span></code></pre></div>
<ul>
<li>方法1: 日次対数収益率使用 (white noiseを仮定)
<!--  - 不偏分散 + "ルートT・ルール"(!) --></li>
</ul>
<div class="sourceCode" id="cb623"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb623-1"><a href="garchモデル.html#cb623-1" tabindex="-1"></a><span class="co"># source(&quot;vold2m.R&quot;) ## Compile the script</span></span>
<span id="cb623-2"><a href="garchモデル.html#cb623-2" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">vold2m</span>(x)</span>
<span id="cb623-3"><a href="garchモデル.html#cb623-3" tabindex="-1"></a><span class="fu">names</span>(m1)</span>
<span id="cb623-4"><a href="garchモデル.html#cb623-4" tabindex="-1"></a><span class="do">## [1] &quot;volatility&quot; &quot;ndays&quot;</span></span>
<span id="cb623-5"><a href="garchモデル.html#cb623-5" tabindex="-1"></a>v1 <span class="ot">&lt;-</span> m1<span class="sc">$</span>volatility</span>
<span id="cb623-6"><a href="garchモデル.html#cb623-6" tabindex="-1"></a>cnt <span class="ot">&lt;-</span> m1<span class="sc">$</span>ndays</span>
<span id="cb623-7"><a href="garchモデル.html#cb623-7" tabindex="-1"></a>cnt[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb623-8"><a href="garchモデル.html#cb623-8" tabindex="-1"></a><span class="do">## [1] 20 20 21 21 21</span></span></code></pre></div>
<ul>
<li>方法2: 日次対数収益率使用 (MA過程を仮定)</li>
</ul>
<div class="sourceCode" id="cb624"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb624-1"><a href="garchモデル.html#cb624-1" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">vold2m</span>(x, <span class="at">ma =</span> <span class="dv">1</span>) <span class="co"># Use MA(1) dependence</span></span>
<span id="cb624-2"><a href="garchモデル.html#cb624-2" tabindex="-1"></a><span class="fu">names</span>(m2)</span>
<span id="cb624-3"><a href="garchモデル.html#cb624-3" tabindex="-1"></a><span class="do">## [1] &quot;volatility&quot; &quot;ndays&quot;</span></span>
<span id="cb624-4"><a href="garchモデル.html#cb624-4" tabindex="-1"></a>v2 <span class="ot">&lt;-</span> m2<span class="sc">$</span>volatility</span></code></pre></div>
</div>
<div id="月次データの使用" class="section level4 unnumbered hasAnchor">
<h4>月次データの使用<a href="garchモデル.html#月次データの使用" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb625"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb625-1"><a href="garchモデル.html#cb625-1" tabindex="-1"></a>da1 <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">&quot;m-sp56710.txt&quot;</span>, <span class="at">header =</span> T)</span>
<span id="cb625-2"><a href="garchモデル.html#cb625-2" tabindex="-1"></a>sp <span class="ot">&lt;-</span> <span class="fu">log</span>(da1[, <span class="dv">9</span>])</span>
<span id="cb625-3"><a href="garchモデル.html#cb625-3" tabindex="-1"></a>sp5 <span class="ot">&lt;-</span> <span class="fu">diff</span>(sp)</span></code></pre></div>
<ul>
<li>方法3: GARCH(1,1)を月次対数収益率に適用</li>
</ul>
<div class="sourceCode" id="cb626"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb626-1"><a href="garchモデル.html#cb626-1" tabindex="-1"></a><span class="co"># library(fGarch)</span></span>
<span id="cb626-2"><a href="garchモデル.html#cb626-2" tabindex="-1"></a>m3 <span class="ot">&lt;-</span> fGarch<span class="sc">::</span><span class="fu">garchFit</span>(<span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> <span class="fu">garch</span>(<span class="dv">1</span>, <span class="dv">1</span>), <span class="at">data =</span> sp5, <span class="at">trace =</span> F)</span>
<span id="cb626-3"><a href="garchモデル.html#cb626-3" tabindex="-1"></a><span class="fu">summary</span>(m3)</span>
<span id="cb626-4"><a href="garchモデル.html#cb626-4" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb626-5"><a href="garchモデル.html#cb626-5" tabindex="-1"></a><span class="do">## Title:</span></span>
<span id="cb626-6"><a href="garchモデル.html#cb626-6" tabindex="-1"></a><span class="do">##  GARCH Modelling </span></span>
<span id="cb626-7"><a href="garchモデル.html#cb626-7" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb626-8"><a href="garchモデル.html#cb626-8" tabindex="-1"></a><span class="do">## Call:</span></span>
<span id="cb626-9"><a href="garchモデル.html#cb626-9" tabindex="-1"></a><span class="do">##  fGarch::garchFit(formula = ~1 + garch(1, 1), data = sp5, trace = F) </span></span>
<span id="cb626-10"><a href="garchモデル.html#cb626-10" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb626-11"><a href="garchモデル.html#cb626-11" tabindex="-1"></a><span class="do">## Mean and Variance Equation:</span></span>
<span id="cb626-12"><a href="garchモデル.html#cb626-12" tabindex="-1"></a><span class="do">##  data ~ 1 + garch(1, 1)</span></span>
<span id="cb626-13"><a href="garchモデル.html#cb626-13" tabindex="-1"></a><span class="do">## &lt;environment: 0x7fb4018bb668&gt;</span></span>
<span id="cb626-14"><a href="garchモデル.html#cb626-14" tabindex="-1"></a><span class="do">##  [data = sp5]</span></span>
<span id="cb626-15"><a href="garchモデル.html#cb626-15" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb626-16"><a href="garchモデル.html#cb626-16" tabindex="-1"></a><span class="do">## Conditional Distribution:</span></span>
<span id="cb626-17"><a href="garchモデル.html#cb626-17" tabindex="-1"></a><span class="do">##  norm </span></span>
<span id="cb626-18"><a href="garchモデル.html#cb626-18" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb626-19"><a href="garchモデル.html#cb626-19" tabindex="-1"></a><span class="do">## Coefficient(s):</span></span>
<span id="cb626-20"><a href="garchモデル.html#cb626-20" tabindex="-1"></a><span class="do">##         mu       omega      alpha1       beta1  </span></span>
<span id="cb626-21"><a href="garchモデル.html#cb626-21" tabindex="-1"></a><span class="do">## 5.3471e-03  9.3263e-05  1.1422e-01  8.4864e-01  </span></span>
<span id="cb626-22"><a href="garchモデル.html#cb626-22" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb626-23"><a href="garchモデル.html#cb626-23" tabindex="-1"></a><span class="do">## Std. Errors:</span></span>
<span id="cb626-24"><a href="garchモデル.html#cb626-24" tabindex="-1"></a><span class="do">##  based on Hessian </span></span>
<span id="cb626-25"><a href="garchモデル.html#cb626-25" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb626-26"><a href="garchモデル.html#cb626-26" tabindex="-1"></a><span class="do">## Error Analysis:</span></span>
<span id="cb626-27"><a href="garchモデル.html#cb626-27" tabindex="-1"></a><span class="do">##         Estimate  Std. Error  t value Pr(&gt;|t|)    </span></span>
<span id="cb626-28"><a href="garchモデル.html#cb626-28" tabindex="-1"></a><span class="do">## mu     5.347e-03   1.742e-03    3.069 0.002149 ** </span></span>
<span id="cb626-29"><a href="garchモデル.html#cb626-29" tabindex="-1"></a><span class="do">## omega  9.326e-05   4.859e-05    1.919 0.054942 .  </span></span>
<span id="cb626-30"><a href="garchモデル.html#cb626-30" tabindex="-1"></a><span class="do">## alpha1 1.142e-01   3.003e-02    3.804 0.000142 ***</span></span>
<span id="cb626-31"><a href="garchモデル.html#cb626-31" tabindex="-1"></a><span class="do">## beta1  8.486e-01   3.186e-02   26.634  &lt; 2e-16 ***</span></span>
<span id="cb626-32"><a href="garchモデル.html#cb626-32" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb626-33"><a href="garchモデル.html#cb626-33" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb626-34"><a href="garchモデル.html#cb626-34" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb626-35"><a href="garchモデル.html#cb626-35" tabindex="-1"></a><span class="do">## Log Likelihood:</span></span>
<span id="cb626-36"><a href="garchモデル.html#cb626-36" tabindex="-1"></a><span class="do">##  899.7817    normalized:  1.717141 </span></span>
<span id="cb626-37"><a href="garchモデル.html#cb626-37" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb626-38"><a href="garchモデル.html#cb626-38" tabindex="-1"></a><span class="do">## Description:</span></span>
<span id="cb626-39"><a href="garchモデル.html#cb626-39" tabindex="-1"></a><span class="do">##  Sun Feb  2 15:36:53 2025 by user:  </span></span>
<span id="cb626-40"><a href="garchモデル.html#cb626-40" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb626-41"><a href="garchモデル.html#cb626-41" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb626-42"><a href="garchモデル.html#cb626-42" tabindex="-1"></a><span class="do">## Standardised Residuals Tests:</span></span>
<span id="cb626-43"><a href="garchモデル.html#cb626-43" tabindex="-1"></a><span class="do">##                                   Statistic      p-Value</span></span>
<span id="cb626-44"><a href="garchモデル.html#cb626-44" tabindex="-1"></a><span class="do">##  Jarque-Bera Test   R    Chi^2  172.5211020 0.000000e+00</span></span>
<span id="cb626-45"><a href="garchモデル.html#cb626-45" tabindex="-1"></a><span class="do">##  Shapiro-Wilk Test  R    W        0.9690782 4.639274e-09</span></span>
<span id="cb626-46"><a href="garchモデル.html#cb626-46" tabindex="-1"></a><span class="do">##  Ljung-Box Test     R    Q(10)   11.1732915 3.441774e-01</span></span>
<span id="cb626-47"><a href="garchモデル.html#cb626-47" tabindex="-1"></a><span class="do">##  Ljung-Box Test     R    Q(15)   15.4509983 4.194449e-01</span></span>
<span id="cb626-48"><a href="garchモデル.html#cb626-48" tabindex="-1"></a><span class="do">##  Ljung-Box Test     R    Q(20)   17.5646909 6.160600e-01</span></span>
<span id="cb626-49"><a href="garchモデル.html#cb626-49" tabindex="-1"></a><span class="do">##  Ljung-Box Test     R^2  Q(10)    5.4667953 8.578981e-01</span></span>
<span id="cb626-50"><a href="garchモデル.html#cb626-50" tabindex="-1"></a><span class="do">##  Ljung-Box Test     R^2  Q(15)    7.0315432 9.567685e-01</span></span>
<span id="cb626-51"><a href="garchモデル.html#cb626-51" tabindex="-1"></a><span class="do">##  Ljung-Box Test     R^2  Q(20)    8.2004251 9.904566e-01</span></span>
<span id="cb626-52"><a href="garchモデル.html#cb626-52" tabindex="-1"></a><span class="do">##  LM Arch Test       R    TR^2     5.6298797 9.335791e-01</span></span>
<span id="cb626-53"><a href="garchモデル.html#cb626-53" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb626-54"><a href="garchモデル.html#cb626-54" tabindex="-1"></a><span class="do">## Information Criterion Statistics:</span></span>
<span id="cb626-55"><a href="garchモデル.html#cb626-55" tabindex="-1"></a><span class="do">##       AIC       BIC       SIC      HQIC </span></span>
<span id="cb626-56"><a href="garchモデル.html#cb626-56" tabindex="-1"></a><span class="do">## -3.419014 -3.386484 -3.419129 -3.406275</span></span>
<span id="cb626-57"><a href="garchモデル.html#cb626-57" tabindex="-1"></a>v3 <span class="ot">&lt;-</span> fGarch<span class="sc">::</span><span class="fu">volatility</span>(m3)</span>
<span id="cb626-58"><a href="garchモデル.html#cb626-58" tabindex="-1"></a>v3 <span class="ot">&lt;-</span> v3[<span class="dv">158</span><span class="sc">:</span><span class="dv">524</span>]</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Estimate</th>
<th align="right">Std. Error</th>
<th align="right">t value</th>
<th align="right">Pr(&gt;|t|)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">mu</td>
<td align="right">0.0053471</td>
<td align="right">0.0017424</td>
<td align="right">3.068779</td>
<td align="right">0.0021494</td>
</tr>
<tr class="even">
<td align="left">omega</td>
<td align="right">0.0000933</td>
<td align="right">0.0000486</td>
<td align="right">1.919333</td>
<td align="right">0.0549423</td>
</tr>
<tr class="odd">
<td align="left">alpha1</td>
<td align="right">0.1142231</td>
<td align="right">0.0300281</td>
<td align="right">3.803878</td>
<td align="right">0.0001424</td>
</tr>
<tr class="even">
<td align="left">beta1</td>
<td align="right">0.8486414</td>
<td align="right">0.0318635</td>
<td align="right">26.633651</td>
<td align="right">0.0000000</td>
</tr>
</tbody>
</table>
<ul>
<li>3つの方法の比較</li>
</ul>
<div class="sourceCode" id="cb627"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb627-1"><a href="garchモデル.html#cb627-1" tabindex="-1"></a>v1 <span class="ot">&lt;-</span> <span class="fu">ts</span>(v1, <span class="at">frequency =</span> <span class="dv">12</span>, <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">1980</span>, <span class="dv">1</span>))</span>
<span id="cb627-2"><a href="garchモデル.html#cb627-2" tabindex="-1"></a>v2 <span class="ot">&lt;-</span> <span class="fu">ts</span>(v2, <span class="at">frequency =</span> <span class="dv">12</span>, <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">1980</span>, <span class="dv">1</span>))</span>
<span id="cb627-3"><a href="garchモデル.html#cb627-3" tabindex="-1"></a>v3 <span class="ot">&lt;-</span> <span class="fu">ts</span>(v3, <span class="at">frequency =</span> <span class="dv">12</span>, <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">1980</span>, <span class="dv">1</span>))</span>
<span id="cb627-4"><a href="garchモデル.html#cb627-4" tabindex="-1"></a><span class="fu">max</span>(v1, v2, v3)</span>
<span id="cb627-5"><a href="garchモデル.html#cb627-5" tabindex="-1"></a><span class="do">## [1] 0.2870294</span></span>
<span id="cb627-6"><a href="garchモデル.html#cb627-6" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb627-7"><a href="garchモデル.html#cb627-7" tabindex="-1"></a><span class="co"># par(mfcol=c(3,1))</span></span>
<span id="cb627-8"><a href="garchモデル.html#cb627-8" tabindex="-1"></a><span class="co"># plot(v1, xlab=&#39;year&#39;, ylab=&#39;vol&#39;, type=&#39;l&#39;, ylim=c(0,.3))</span></span>
<span id="cb627-9"><a href="garchモデル.html#cb627-9" tabindex="-1"></a><span class="co"># title(main=&#39;(a) No correlations&#39;)</span></span>
<span id="cb627-10"><a href="garchモデル.html#cb627-10" tabindex="-1"></a><span class="co"># plot(v2, xlab=&#39;year&#39;, ylab=&#39;vol&#39;, type=&#39;l&#39;, ylim=c(0,.3))</span></span>
<span id="cb627-11"><a href="garchモデル.html#cb627-11" tabindex="-1"></a><span class="co"># title(main=&#39;(b) Lag-1 correlation&#39;)</span></span>
<span id="cb627-12"><a href="garchモデル.html#cb627-12" tabindex="-1"></a><span class="co"># plot(v3, xlab=&#39;year&#39;, ylab=&#39;vol&#39;, type=&#39;l&#39;, ylim=c(0,.3))</span></span>
<span id="cb627-13"><a href="garchモデル.html#cb627-13" tabindex="-1"></a><span class="co"># title(main=&#39;(c) GARCH(1,1)&#39;)</span></span>
<span id="cb627-14"><a href="garchモデル.html#cb627-14" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">ts.intersect</span>(v1, v2, v3))</span></code></pre></div>
<p><img src="074-GARCH-3_files/figure-html/unnamed-chunk-30-1.png" width="75%" /></p>

</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="レジームスイッチングモデル.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="varモデル.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
